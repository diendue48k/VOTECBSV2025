(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();function Sk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lm={exports:{}},Mo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function bk(){if(ty)return Mo;ty=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,l){var o=null;if(l!==void 0&&(o=""+l),i.key!==void 0&&(o=""+i.key),"key"in i){l={};for(var u in i)u!=="key"&&(l[u]=i[u])}else l=i;return i=l.ref,{$$typeof:t,type:n,key:o,ref:i!==void 0?i:null,props:l}}return Mo.Fragment=e,Mo.jsx=r,Mo.jsxs=r,Mo}var ry;function Ck(){return ry||(ry=1,lm.exports=bk()),lm.exports}var y=Ck(),cm={exports:{}},st={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ny;function kk(){if(ny)return st;ny=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),v=Symbol.iterator;function _(H){return H===null||typeof H!="object"?null:(H=v&&H[v]||H["@@iterator"],typeof H=="function"?H:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function N(H,k,j){this.props=H,this.context=k,this.refs=S,this.updater=j||E}N.prototype.isReactComponent={},N.prototype.setState=function(H,k){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,k,"setState")},N.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function M(){}M.prototype=N.prototype;function C(H,k,j){this.props=H,this.context=k,this.refs=S,this.updater=j||E}var z=C.prototype=new M;z.constructor=C,w(z,N.prototype),z.isPureReactComponent=!0;var X=Array.isArray;function G(){}var O={H:null,A:null,T:null,S:null},Q=Object.prototype.hasOwnProperty;function W(H,k,j){var L=j.ref;return{$$typeof:t,type:H,key:k,ref:L!==void 0?L:null,props:j}}function fe(H,k){return W(H.type,k,H.props)}function te(H){return typeof H=="object"&&H!==null&&H.$$typeof===t}function K(H){var k={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(j){return k[j]})}var _e=/\/+/g;function Me(H,k){return typeof H=="object"&&H!==null&&H.key!=null?K(""+H.key):k.toString(36)}function Se(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(G,G):(H.status="pending",H.then(function(k){H.status==="pending"&&(H.status="fulfilled",H.value=k)},function(k){H.status==="pending"&&(H.status="rejected",H.reason=k)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function Y(H,k,j,L,U){var J=typeof H;(J==="undefined"||J==="boolean")&&(H=null);var pe=!1;if(H===null)pe=!0;else switch(J){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(H.$$typeof){case t:case e:pe=!0;break;case p:return pe=H._init,Y(pe(H._payload),k,j,L,U)}}if(pe)return U=U(H),pe=L===""?"."+Me(H,0):L,X(U)?(j="",pe!=null&&(j=pe.replace(_e,"$&/")+"/"),Y(U,k,j,"",function(Ee){return Ee})):U!=null&&(te(U)&&(U=fe(U,j+(U.key==null||H&&H.key===U.key?"":(""+U.key).replace(_e,"$&/")+"/")+pe)),k.push(U)),1;pe=0;var we=L===""?".":L+":";if(X(H))for(var ge=0;ge<H.length;ge++)L=H[ge],J=we+Me(L,ge),pe+=Y(L,k,j,J,U);else if(ge=_(H),typeof ge=="function")for(H=ge.call(H),ge=0;!(L=H.next()).done;)L=L.value,J=we+Me(L,ge++),pe+=Y(L,k,j,J,U);else if(J==="object"){if(typeof H.then=="function")return Y(Se(H),k,j,L,U);throw k=String(H),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.")}return pe}function se(H,k,j){if(H==null)return H;var L=[],U=0;return Y(H,L,"","",function(J){return k.call(j,J,U++)}),L}function Le(H){if(H._status===-1){var k=H._result;k=k(),k.then(function(j){(H._status===0||H._status===-1)&&(H._status=1,H._result=j)},function(j){(H._status===0||H._status===-1)&&(H._status=2,H._result=j)}),H._status===-1&&(H._status=0,H._result=k)}if(H._status===1)return H._result.default;throw H._result}var Z=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var k=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(k))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},Oe={map:se,forEach:function(H,k,j){se(H,function(){k.apply(this,arguments)},j)},count:function(H){var k=0;return se(H,function(){k++}),k},toArray:function(H){return se(H,function(k){return k})||[]},only:function(H){if(!te(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return st.Activity=x,st.Children=Oe,st.Component=N,st.Fragment=r,st.Profiler=i,st.PureComponent=C,st.StrictMode=n,st.Suspense=h,st.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,st.__COMPILER_RUNTIME={__proto__:null,c:function(H){return O.H.useMemoCache(H)}},st.cache=function(H){return function(){return H.apply(null,arguments)}},st.cacheSignal=function(){return null},st.cloneElement=function(H,k,j){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var L=w({},H.props),U=H.key;if(k!=null)for(J in k.key!==void 0&&(U=""+k.key),k)!Q.call(k,J)||J==="key"||J==="__self"||J==="__source"||J==="ref"&&k.ref===void 0||(L[J]=k[J]);var J=arguments.length-2;if(J===1)L.children=j;else if(1<J){for(var pe=Array(J),we=0;we<J;we++)pe[we]=arguments[we+2];L.children=pe}return W(H.type,U,L)},st.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:l,_context:H},H},st.createElement=function(H,k,j){var L,U={},J=null;if(k!=null)for(L in k.key!==void 0&&(J=""+k.key),k)Q.call(k,L)&&L!=="key"&&L!=="__self"&&L!=="__source"&&(U[L]=k[L]);var pe=arguments.length-2;if(pe===1)U.children=j;else if(1<pe){for(var we=Array(pe),ge=0;ge<pe;ge++)we[ge]=arguments[ge+2];U.children=we}if(H&&H.defaultProps)for(L in pe=H.defaultProps,pe)U[L]===void 0&&(U[L]=pe[L]);return W(H,J,U)},st.createRef=function(){return{current:null}},st.forwardRef=function(H){return{$$typeof:u,render:H}},st.isValidElement=te,st.lazy=function(H){return{$$typeof:p,_payload:{_status:-1,_result:H},_init:Le}},st.memo=function(H,k){return{$$typeof:d,type:H,compare:k===void 0?null:k}},st.startTransition=function(H){var k=O.T,j={};O.T=j;try{var L=H(),U=O.S;U!==null&&U(j,L),typeof L=="object"&&L!==null&&typeof L.then=="function"&&L.then(G,Z)}catch(J){Z(J)}finally{k!==null&&j.types!==null&&(k.types=j.types),O.T=k}},st.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},st.use=function(H){return O.H.use(H)},st.useActionState=function(H,k,j){return O.H.useActionState(H,k,j)},st.useCallback=function(H,k){return O.H.useCallback(H,k)},st.useContext=function(H){return O.H.useContext(H)},st.useDebugValue=function(){},st.useDeferredValue=function(H,k){return O.H.useDeferredValue(H,k)},st.useEffect=function(H,k){return O.H.useEffect(H,k)},st.useEffectEvent=function(H){return O.H.useEffectEvent(H)},st.useId=function(){return O.H.useId()},st.useImperativeHandle=function(H,k,j){return O.H.useImperativeHandle(H,k,j)},st.useInsertionEffect=function(H,k){return O.H.useInsertionEffect(H,k)},st.useLayoutEffect=function(H,k){return O.H.useLayoutEffect(H,k)},st.useMemo=function(H,k){return O.H.useMemo(H,k)},st.useOptimistic=function(H,k){return O.H.useOptimistic(H,k)},st.useReducer=function(H,k,j){return O.H.useReducer(H,k,j)},st.useRef=function(H){return O.H.useRef(H)},st.useState=function(H){return O.H.useState(H)},st.useSyncExternalStore=function(H,k,j){return O.H.useSyncExternalStore(H,k,j)},st.useTransition=function(){return O.H.useTransition()},st.version="19.2.1",st}var ay;function Ap(){return ay||(ay=1,cm.exports=kk()),cm.exports}var at=Ap();const Ak=Sk(at);var om={exports:{}},Lo={},um={exports:{}},fm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iy;function Nk(){return iy||(iy=1,(function(t){function e(Y,se){var Le=Y.length;Y.push(se);e:for(;0<Le;){var Z=Le-1>>>1,Oe=Y[Z];if(0<i(Oe,se))Y[Z]=se,Y[Le]=Oe,Le=Z;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var se=Y[0],Le=Y.pop();if(Le!==se){Y[0]=Le;e:for(var Z=0,Oe=Y.length,H=Oe>>>1;Z<H;){var k=2*(Z+1)-1,j=Y[k],L=k+1,U=Y[L];if(0>i(j,Le))L<Oe&&0>i(U,j)?(Y[Z]=U,Y[L]=Le,Z=L):(Y[Z]=j,Y[k]=Le,Z=k);else if(L<Oe&&0>i(U,Le))Y[Z]=U,Y[L]=Le,Z=L;else break e}}return se}function i(Y,se){var Le=Y.sortIndex-se.sortIndex;return Le!==0?Le:Y.id-se.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var h=[],d=[],p=1,x=null,v=3,_=!1,E=!1,w=!1,S=!1,N=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function z(Y){for(var se=r(d);se!==null;){if(se.callback===null)n(d);else if(se.startTime<=Y)n(d),se.sortIndex=se.expirationTime,e(h,se);else break;se=r(d)}}function X(Y){if(w=!1,z(Y),!E)if(r(h)!==null)E=!0,G||(G=!0,K());else{var se=r(d);se!==null&&Se(X,se.startTime-Y)}}var G=!1,O=-1,Q=5,W=-1;function fe(){return S?!0:!(t.unstable_now()-W<Q)}function te(){if(S=!1,G){var Y=t.unstable_now();W=Y;var se=!0;try{e:{E=!1,w&&(w=!1,M(O),O=-1),_=!0;var Le=v;try{t:{for(z(Y),x=r(h);x!==null&&!(x.expirationTime>Y&&fe());){var Z=x.callback;if(typeof Z=="function"){x.callback=null,v=x.priorityLevel;var Oe=Z(x.expirationTime<=Y);if(Y=t.unstable_now(),typeof Oe=="function"){x.callback=Oe,z(Y),se=!0;break t}x===r(h)&&n(h),z(Y)}else n(h);x=r(h)}if(x!==null)se=!0;else{var H=r(d);H!==null&&Se(X,H.startTime-Y),se=!1}}break e}finally{x=null,v=Le,_=!1}se=void 0}}finally{se?K():G=!1}}}var K;if(typeof C=="function")K=function(){C(te)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,Me=_e.port2;_e.port1.onmessage=te,K=function(){Me.postMessage(null)}}else K=function(){N(te,0)};function Se(Y,se){O=N(function(){Y(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var se=3;break;default:se=v}var Le=v;v=se;try{return Y()}finally{v=Le}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(Y,se){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Le=v;v=Y;try{return se()}finally{v=Le}},t.unstable_scheduleCallback=function(Y,se,Le){var Z=t.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?Z+Le:Z):Le=Z,Y){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=Le+Oe,Y={id:p++,callback:se,priorityLevel:Y,startTime:Le,expirationTime:Oe,sortIndex:-1},Le>Z?(Y.sortIndex=Le,e(d,Y),r(h)===null&&Y===r(d)&&(w?(M(O),O=-1):w=!0,Se(X,Le-Z))):(Y.sortIndex=Oe,e(h,Y),E||_||(E=!0,G||(G=!0,K()))),Y},t.unstable_shouldYield=fe,t.unstable_wrapCallback=function(Y){var se=v;return function(){var Le=v;v=se;try{return Y.apply(this,arguments)}finally{v=Le}}}})(fm)),fm}var sy;function Dk(){return sy||(sy=1,um.exports=Nk()),um.exports}var hm={exports:{}},Yr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ly;function Rk(){if(ly)return Yr;ly=1;var t=Ap();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(h,d,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:x==null?null:""+x,children:h,containerInfo:d,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Yr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Yr.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return l(h,d,null,p)},Yr.flushSync=function(h){var d=o.T,p=n.p;try{if(o.T=null,n.p=2,h)return h()}finally{o.T=d,n.p=p,n.d.f()}},Yr.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Yr.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Yr.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,x=u(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:_}):p==="script"&&n.d.X(h,{crossOrigin:x,integrity:v,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Yr.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Yr.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,x=u(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Yr.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Yr.requestFormReset=function(h){n.d.r(h)},Yr.unstable_batchedUpdates=function(h,d){return h(d)},Yr.useFormState=function(h,d,p){return o.H.useFormState(h,d,p)},Yr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Yr.version="19.2.1",Yr}var cy;function Ok(){if(cy)return hm.exports;cy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),hm.exports=Rk(),hm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy;function Fk(){if(oy)return Lo;oy=1;var t=Dk(),e=Ap(),r=Ok();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var s=a,c=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(c=s.return),a=s.return;while(a)}return s.tag===3?c:null}function o(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(a.tag===31){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function h(a){if(l(a)!==a)throw Error(n(188))}function d(a){var s=a.alternate;if(!s){if(s=l(a),s===null)throw Error(n(188));return s!==a?null:a}for(var c=a,f=s;;){var m=c.return;if(m===null)break;var g=m.alternate;if(g===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===c)return h(m),a;if(g===f)return h(m),s;g=g.sibling}throw Error(n(188))}if(c.return!==f.return)c=m,f=g;else{for(var T=!1,A=m.child;A;){if(A===c){T=!0,c=m,f=g;break}if(A===f){T=!0,f=m,c=g;break}A=A.sibling}if(!T){for(A=g.child;A;){if(A===c){T=!0,c=g,f=m;break}if(A===f){T=!0,f=g,c=m;break}A=A.sibling}if(!T)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:s}function p(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=p(a),s!==null)return s;a=a.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),C=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),W=Symbol.for("react.activity"),fe=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function K(a){return a===null||typeof a!="object"?null:(a=te&&a[te]||a["@@iterator"],typeof a=="function"?a:null)}var _e=Symbol.for("react.client.reference");function Me(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===_e?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case N:return"Profiler";case S:return"StrictMode";case X:return"Suspense";case G:return"SuspenseList";case W:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case E:return"Portal";case C:return a.displayName||"Context";case M:return(a._context.displayName||"Context")+".Consumer";case z:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case O:return s=a.displayName||null,s!==null?s:Me(a.type)||"Memo";case Q:s=a._payload,a=a._init;try{return Me(a(s))}catch{}}return null}var Se=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Le={pending:!1,data:null,method:null,action:null},Z=[],Oe=-1;function H(a){return{current:a}}function k(a){0>Oe||(a.current=Z[Oe],Z[Oe]=null,Oe--)}function j(a,s){Oe++,Z[Oe]=a.current,a.current=s}var L=H(null),U=H(null),J=H(null),pe=H(null);function we(a,s){switch(j(J,s),j(U,a),j(L,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?S2(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=S2(s),a=b2(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}k(L),j(L,a)}function ge(){k(L),k(U),k(J)}function Ee(a){a.memoizedState!==null&&j(pe,a);var s=L.current,c=b2(s,a.type);s!==c&&(j(U,a),j(L,c))}function be(a){U.current===a&&(k(L),k(U)),pe.current===a&&(k(pe),Ro._currentValue=Le)}var D,Te;function Be(a){if(D===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);D=s&&s[1]||"",Te=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+D+a+Te}var je=!1;function He(a,s){if(!a||je)return"";je=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(ue){var ce=ue}Reflect.construct(a,[],ve)}else{try{ve.call()}catch(ue){ce=ue}a.call(ve.prototype)}}else{try{throw Error()}catch(ue){ce=ue}(ve=a())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(ue){if(ue&&ce&&typeof ue.stack=="string")return[ue.stack,ce.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=f.DetermineComponentFrameRoot(),T=g[0],A=g[1];if(T&&A){var V=T.split(`
`),ne=A.split(`
`);for(m=f=0;f<V.length&&!V[f].includes("DetermineComponentFrameRoot");)f++;for(;m<ne.length&&!ne[m].includes("DetermineComponentFrameRoot");)m++;if(f===V.length||m===ne.length)for(f=V.length-1,m=ne.length-1;1<=f&&0<=m&&V[f]!==ne[m];)m--;for(;1<=f&&0<=m;f--,m--)if(V[f]!==ne[m]){if(f!==1||m!==1)do if(f--,m--,0>m||V[f]!==ne[m]){var de=`
`+V[f].replace(" at new "," at ");return a.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",a.displayName)),de}while(1<=f&&0<=m);break}}}finally{je=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?Be(c):""}function ke(a,s){switch(a.tag){case 26:case 27:case 5:return Be(a.type);case 16:return Be("Lazy");case 13:return a.child!==s&&s!==null?Be("Suspense Fallback"):Be("Suspense");case 19:return Be("SuspenseList");case 0:case 15:return He(a.type,!1);case 11:return He(a.type.render,!1);case 1:return He(a.type,!0);case 31:return Be("Activity");default:return""}}function Ct(a){try{var s="",c=null;do s+=ke(a,c),c=a,a=a.return;while(a);return s}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var ir=Object.prototype.hasOwnProperty,Sr=t.unstable_scheduleCallback,qr=t.unstable_cancelCallback,Ga=t.unstable_shouldYield,Hn=t.unstable_requestPaint,Ot=t.unstable_now,Fe=t.unstable_getCurrentPriorityLevel,We=t.unstable_ImmediatePriority,Qe=t.unstable_UserBlockingPriority,tt=t.unstable_NormalPriority,Ze=t.unstable_LowPriority,Ye=t.unstable_IdlePriority,St=t.log,Nr=t.unstable_setDisableYieldValue,pt=null,hr=null;function fa(a){if(typeof St=="function"&&Nr(a),hr&&typeof hr.setStrictMode=="function")try{hr.setStrictMode(pt,a)}catch{}}var sn=Math.clz32?Math.clz32:nf,Qh=Math.log,rf=Math.LN2;function nf(a){return a>>>=0,a===0?32:31-(Qh(a)/rf|0)|0}var ys=256,yl=262144,wl=4194304;function zn(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function El(a,s,c){var f=a.pendingLanes;if(f===0)return 0;var m=0,g=a.suspendedLanes,T=a.pingedLanes;a=a.warmLanes;var A=f&134217727;return A!==0?(f=A&~g,f!==0?m=zn(f):(T&=A,T!==0?m=zn(T):c||(c=A&~a,c!==0&&(m=zn(c))))):(A=f&~g,A!==0?m=zn(A):T!==0?m=zn(T):c||(c=f&~a,c!==0&&(m=zn(c)))),m===0?0:s!==0&&s!==m&&(s&g)===0&&(g=m&-m,c=s&-s,g>=c||g===32&&(c&4194048)!==0)?s:m}function ws(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function Zh(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function af(){var a=wl;return wl<<=1,(wl&62914560)===0&&(wl=4194304),a}function Vc(a){for(var s=[],c=0;31>c;c++)s.push(a);return s}function Es(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Jh(a,s,c,f,m,g){var T=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var A=a.entanglements,V=a.expirationTimes,ne=a.hiddenUpdates;for(c=T&~c;0<c;){var de=31-sn(c),ve=1<<de;A[de]=0,V[de]=-1;var ce=ne[de];if(ce!==null)for(ne[de]=null,de=0;de<ce.length;de++){var ue=ce[de];ue!==null&&(ue.lane&=-536870913)}c&=~ve}f!==0&&sf(a,f,0),g!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=g&~(T&~s))}function sf(a,s,c){a.pendingLanes|=s,a.suspendedLanes&=~s;var f=31-sn(s);a.entangledLanes|=s,a.entanglements[f]=a.entanglements[f]|1073741824|c&261930}function Tl(a,s){var c=a.entangledLanes|=s;for(a=a.entanglements;c;){var f=31-sn(c),m=1<<f;m&s|a[f]&s&&(a[f]|=s),c&=~m}}function lf(a,s){var c=s&-s;return c=(c&42)!==0?1:Gc(c),(c&(a.suspendedLanes|s))!==0?0:c}function Gc(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Wc(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function b(){var a=se.p;return a!==0?a:(a=window.event,a===void 0?32:Y2(a.type))}function B(a,s){var c=se.p;try{return se.p=a,s()}finally{se.p=c}}var R=Math.random().toString(36).slice(2),F="__reactFiber$"+R,I="__reactProps$"+R,P="__reactContainer$"+R,ae="__reactEvents$"+R,me="__reactListeners$"+R,ie="__reactHandles$"+R,le="__reactResources$"+R,oe="__reactMarker$"+R;function Ce(a){delete a[F],delete a[I],delete a[ae],delete a[me],delete a[ie]}function Ne(a){var s=a[F];if(s)return s;for(var c=a.parentNode;c;){if(s=c[P]||c[F]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(a=O2(a);a!==null;){if(c=a[F])return c;a=O2(a)}return s}a=c,c=a.parentNode}return null}function Ue(a){if(a=a[F]||a[P]){var s=a.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return a}return null}function Ae(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function Pe(a){var s=a[le];return s||(s=a[le]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ve(a){a[oe]=!0}var Xt=new Set,qt={};function tr(a,s){Vn(a,s),Vn(a+"Capture",s)}function Vn(a,s){for(qt[a]=s,a=0;a<s.length;a++)Xt.add(s[a])}var Ts=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Si={},Ca={};function Xc(a){return ir.call(Ca,a)?!0:ir.call(Si,a)?!1:Ts.test(a)?Ca[a]=!0:(Si[a]=!0,!1)}function dn(a,s,c){if(Xc(s))if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+c)}}function cf(a,s,c){if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+c)}}function Wa(a,s,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(s,c,""+f)}}function Gn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function gx(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function xC(a,s,c){var f=Object.getOwnPropertyDescriptor(a.constructor.prototype,s);if(!a.hasOwnProperty(s)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var m=f.get,g=f.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return m.call(this)},set:function(T){c=""+T,g.call(this,T)}}),Object.defineProperty(a,s,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(T){c=""+T},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function ed(a){if(!a._valueTracker){var s=gx(a)?"checked":"value";a._valueTracker=xC(a,s,""+a[s])}}function xx(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return a&&(f=gx(a)?a.checked?"true":"false":a.value),a=f,a!==c?(s.setValue(a),!0):!1}function of(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var vC=/[\n"\\]/g;function Wn(a){return a.replace(vC,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function td(a,s,c,f,m,g,T,A){a.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?a.type=T:a.removeAttribute("type"),s!=null?T==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+Gn(s)):a.value!==""+Gn(s)&&(a.value=""+Gn(s)):T!=="submit"&&T!=="reset"||a.removeAttribute("value"),s!=null?rd(a,T,Gn(s)):c!=null?rd(a,T,Gn(c)):f!=null&&a.removeAttribute("value"),m==null&&g!=null&&(a.defaultChecked=!!g),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?a.name=""+Gn(A):a.removeAttribute("name")}function vx(a,s,c,f,m,g,T,A){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(a.type=g),s!=null||c!=null){if(!(g!=="submit"&&g!=="reset"||s!=null)){ed(a);return}c=c!=null?""+Gn(c):"",s=s!=null?""+Gn(s):c,A||s===a.value||(a.value=s),a.defaultValue=s}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=A?a.checked:!!f,a.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(a.name=T),ed(a)}function rd(a,s,c){s==="number"&&of(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function Sl(a,s,c,f){if(a=a.options,s){s={};for(var m=0;m<c.length;m++)s["$"+c[m]]=!0;for(c=0;c<a.length;c++)m=s.hasOwnProperty("$"+a[c].value),a[c].selected!==m&&(a[c].selected=m),m&&f&&(a[c].defaultSelected=!0)}else{for(c=""+Gn(c),s=null,m=0;m<a.length;m++){if(a[m].value===c){a[m].selected=!0,f&&(a[m].defaultSelected=!0);return}s!==null||a[m].disabled||(s=a[m])}s!==null&&(s.selected=!0)}}function _x(a,s,c){if(s!=null&&(s=""+Gn(s),s!==a.value&&(a.value=s),c==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=c!=null?""+Gn(c):""}function yx(a,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(n(92));if(Se(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=Gn(s),a.defaultValue=c,f=a.textContent,f===c&&f!==""&&f!==null&&(a.value=f),ed(a)}function bl(a,s){if(s){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=s;return}}a.textContent=s}var _C=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wx(a,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":f?a.setProperty(s,c):typeof c!="number"||c===0||_C.has(s)?s==="float"?a.cssFloat=c:a[s]=(""+c).trim():a[s]=c+"px"}function Ex(a,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var m in s)f=s[m],s.hasOwnProperty(m)&&c[m]!==f&&wx(a,m,f)}else for(var g in s)s.hasOwnProperty(g)&&wx(a,g,s[g])}function nd(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function uf(a){return wC.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Xa(){}var ad=null;function id(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Cl=null,kl=null;function Tx(a){var s=Ue(a);if(s&&(a=s.stateNode)){var c=a[I]||null;e:switch(a=s.stateNode,s.type){case"input":if(td(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Wn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==a&&f.form===a.form){var m=f[I]||null;if(!m)throw Error(n(90));td(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===a.form&&xx(f)}break e;case"textarea":_x(a,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Sl(a,!!c.multiple,s,!1)}}}var sd=!1;function Sx(a,s,c){if(sd)return a(s,c);sd=!0;try{var f=a(s);return f}finally{if(sd=!1,(Cl!==null||kl!==null)&&(Qf(),Cl&&(s=Cl,a=kl,kl=Cl=null,Tx(s),a)))for(s=0;s<a.length;s++)Tx(a[s])}}function qc(a,s){var c=a.stateNode;if(c===null)return null;var f=c[I]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ld=!1;if(qa)try{var Yc={};Object.defineProperty(Yc,"passive",{get:function(){ld=!0}}),window.addEventListener("test",Yc,Yc),window.removeEventListener("test",Yc,Yc)}catch{ld=!1}var bi=null,cd=null,ff=null;function bx(){if(ff)return ff;var a,s=cd,c=s.length,f,m="value"in bi?bi.value:bi.textContent,g=m.length;for(a=0;a<c&&s[a]===m[a];a++);var T=c-a;for(f=1;f<=T&&s[c-f]===m[g-f];f++);return ff=m.slice(a,1<f?1-f:void 0)}function hf(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function df(){return!0}function Cx(){return!1}function mn(a){function s(c,f,m,g,T){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var A in a)a.hasOwnProperty(A)&&(c=a[A],this[A]=c?c(g):g[A]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?df:Cx,this.isPropagationStopped=Cx,this}return x(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=df)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=df)},persist:function(){},isPersistent:df}),s}var Ss={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mf=mn(Ss),Kc=x({},Ss,{view:0,detail:0}),EC=mn(Kc),od,ud,$c,pf=x({},Kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==$c&&($c&&a.type==="mousemove"?(od=a.screenX-$c.screenX,ud=a.screenY-$c.screenY):ud=od=0,$c=a),od)},movementY:function(a){return"movementY"in a?a.movementY:ud}}),kx=mn(pf),TC=x({},pf,{dataTransfer:0}),SC=mn(TC),bC=x({},Kc,{relatedTarget:0}),fd=mn(bC),CC=x({},Ss,{animationName:0,elapsedTime:0,pseudoElement:0}),kC=mn(CC),AC=x({},Ss,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),NC=mn(AC),DC=x({},Ss,{data:0}),Ax=mn(DC),RC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},OC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IC(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=FC[a])?!!s[a]:!1}function hd(){return IC}var MC=x({},Kc,{key:function(a){if(a.key){var s=RC[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=hf(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?OC[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hd,charCode:function(a){return a.type==="keypress"?hf(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?hf(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),LC=mn(MC),BC=x({},pf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nx=mn(BC),PC=x({},Kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hd}),UC=mn(PC),jC=x({},Ss,{propertyName:0,elapsedTime:0,pseudoElement:0}),HC=mn(jC),zC=x({},pf,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),VC=mn(zC),GC=x({},Ss,{newState:0,oldState:0}),WC=mn(GC),XC=[9,13,27,32],dd=qa&&"CompositionEvent"in window,Qc=null;qa&&"documentMode"in document&&(Qc=document.documentMode);var qC=qa&&"TextEvent"in window&&!Qc,Dx=qa&&(!dd||Qc&&8<Qc&&11>=Qc),Rx=" ",Ox=!1;function Fx(a,s){switch(a){case"keyup":return XC.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ix(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Al=!1;function YC(a,s){switch(a){case"compositionend":return Ix(s);case"keypress":return s.which!==32?null:(Ox=!0,Rx);case"textInput":return a=s.data,a===Rx&&Ox?null:a;default:return null}}function KC(a,s){if(Al)return a==="compositionend"||!dd&&Fx(a,s)?(a=bx(),ff=cd=bi=null,Al=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Dx&&s.locale!=="ko"?null:s.data;default:return null}}var $C={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mx(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!$C[a.type]:s==="textarea"}function Lx(a,s,c,f){Cl?kl?kl.push(f):kl=[f]:Cl=f,s=a0(s,"onChange"),0<s.length&&(c=new mf("onChange","change",null,c,f),a.push({event:c,listeners:s}))}var Zc=null,Jc=null;function QC(a){v2(a,0)}function gf(a){var s=Ae(a);if(xx(s))return a}function Bx(a,s){if(a==="change")return s}var Px=!1;if(qa){var md;if(qa){var pd="oninput"in document;if(!pd){var Ux=document.createElement("div");Ux.setAttribute("oninput","return;"),pd=typeof Ux.oninput=="function"}md=pd}else md=!1;Px=md&&(!document.documentMode||9<document.documentMode)}function jx(){Zc&&(Zc.detachEvent("onpropertychange",Hx),Jc=Zc=null)}function Hx(a){if(a.propertyName==="value"&&gf(Jc)){var s=[];Lx(s,Jc,a,id(a)),Sx(QC,s)}}function ZC(a,s,c){a==="focusin"?(jx(),Zc=s,Jc=c,Zc.attachEvent("onpropertychange",Hx)):a==="focusout"&&jx()}function JC(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return gf(Jc)}function e3(a,s){if(a==="click")return gf(s)}function t3(a,s){if(a==="input"||a==="change")return gf(s)}function r3(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var An=typeof Object.is=="function"?Object.is:r3;function eo(a,s){if(An(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var c=Object.keys(a),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!ir.call(s,m)||!An(a[m],s[m]))return!1}return!0}function zx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Vx(a,s){var c=zx(a);a=0;for(var f;c;){if(c.nodeType===3){if(f=a+c.textContent.length,a<=s&&f>=s)return{node:c,offset:s-a};a=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=zx(c)}}function Gx(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?Gx(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function Wx(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=of(a.document);s instanceof a.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)a=s.contentWindow;else break;s=of(a.document)}return s}function gd(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var n3=qa&&"documentMode"in document&&11>=document.documentMode,Nl=null,xd=null,to=null,vd=!1;function Xx(a,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;vd||Nl==null||Nl!==of(f)||(f=Nl,"selectionStart"in f&&gd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),to&&eo(to,f)||(to=f,f=a0(xd,"onSelect"),0<f.length&&(s=new mf("onSelect","select",null,s,c),a.push({event:s,listeners:f}),s.target=Nl)))}function bs(a,s){var c={};return c[a.toLowerCase()]=s.toLowerCase(),c["Webkit"+a]="webkit"+s,c["Moz"+a]="moz"+s,c}var Dl={animationend:bs("Animation","AnimationEnd"),animationiteration:bs("Animation","AnimationIteration"),animationstart:bs("Animation","AnimationStart"),transitionrun:bs("Transition","TransitionRun"),transitionstart:bs("Transition","TransitionStart"),transitioncancel:bs("Transition","TransitionCancel"),transitionend:bs("Transition","TransitionEnd")},_d={},qx={};qa&&(qx=document.createElement("div").style,"AnimationEvent"in window||(delete Dl.animationend.animation,delete Dl.animationiteration.animation,delete Dl.animationstart.animation),"TransitionEvent"in window||delete Dl.transitionend.transition);function Cs(a){if(_d[a])return _d[a];if(!Dl[a])return a;var s=Dl[a],c;for(c in s)if(s.hasOwnProperty(c)&&c in qx)return _d[a]=s[c];return a}var Yx=Cs("animationend"),Kx=Cs("animationiteration"),$x=Cs("animationstart"),a3=Cs("transitionrun"),i3=Cs("transitionstart"),s3=Cs("transitioncancel"),Qx=Cs("transitionend"),Zx=new Map,yd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");yd.push("scrollEnd");function ha(a,s){Zx.set(a,s),tr(s,[a])}var xf=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Xn=[],Rl=0,wd=0;function vf(){for(var a=Rl,s=wd=Rl=0;s<a;){var c=Xn[s];Xn[s++]=null;var f=Xn[s];Xn[s++]=null;var m=Xn[s];Xn[s++]=null;var g=Xn[s];if(Xn[s++]=null,f!==null&&m!==null){var T=f.pending;T===null?m.next=m:(m.next=T.next,T.next=m),f.pending=m}g!==0&&Jx(c,m,g)}}function _f(a,s,c,f){Xn[Rl++]=a,Xn[Rl++]=s,Xn[Rl++]=c,Xn[Rl++]=f,wd|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function Ed(a,s,c,f){return _f(a,s,c,f),yf(a)}function ks(a,s){return _f(a,null,null,s),yf(a)}function Jx(a,s,c){a.lanes|=c;var f=a.alternate;f!==null&&(f.lanes|=c);for(var m=!1,g=a.return;g!==null;)g.childLanes|=c,f=g.alternate,f!==null&&(f.childLanes|=c),g.tag===22&&(a=g.stateNode,a===null||a._visibility&1||(m=!0)),a=g,g=g.return;return a.tag===3?(g=a.stateNode,m&&s!==null&&(m=31-sn(c),a=g.hiddenUpdates,f=a[m],f===null?a[m]=[s]:f.push(s),s.lane=c|536870912),g):null}function yf(a){if(50<So)throw So=0,R1=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var Ol={};function l3(a,s,c,f){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nn(a,s,c,f){return new l3(a,s,c,f)}function Td(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ya(a,s){var c=a.alternate;return c===null?(c=Nn(a.tag,s,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=s,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,s=a.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function ev(a,s){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,s=c.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function wf(a,s,c,f,m,g){var T=0;if(f=a,typeof a=="function")Td(a)&&(T=1);else if(typeof a=="string")T=hk(a,c,L.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case W:return a=Nn(31,c,s,m),a.elementType=W,a.lanes=g,a;case w:return As(c.children,m,g,s);case S:T=8,m|=24;break;case N:return a=Nn(12,c,s,m|2),a.elementType=N,a.lanes=g,a;case X:return a=Nn(13,c,s,m),a.elementType=X,a.lanes=g,a;case G:return a=Nn(19,c,s,m),a.elementType=G,a.lanes=g,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case C:T=10;break e;case M:T=9;break e;case z:T=11;break e;case O:T=14;break e;case Q:T=16,f=null;break e}T=29,c=Error(n(130,a===null?"null":typeof a,"")),f=null}return s=Nn(T,c,s,m),s.elementType=a,s.type=f,s.lanes=g,s}function As(a,s,c,f){return a=Nn(7,a,f,s),a.lanes=c,a}function Sd(a,s,c){return a=Nn(6,a,null,s),a.lanes=c,a}function tv(a){var s=Nn(18,null,null,0);return s.stateNode=a,s}function bd(a,s,c){return s=Nn(4,a.children!==null?a.children:[],a.key,s),s.lanes=c,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var rv=new WeakMap;function qn(a,s){if(typeof a=="object"&&a!==null){var c=rv.get(a);return c!==void 0?c:(s={value:a,source:s,stack:Ct(s)},rv.set(a,s),s)}return{value:a,source:s,stack:Ct(s)}}var Fl=[],Il=0,Ef=null,ro=0,Yn=[],Kn=0,Ci=null,ka=1,Aa="";function Ka(a,s){Fl[Il++]=ro,Fl[Il++]=Ef,Ef=a,ro=s}function nv(a,s,c){Yn[Kn++]=ka,Yn[Kn++]=Aa,Yn[Kn++]=Ci,Ci=a;var f=ka;a=Aa;var m=32-sn(f)-1;f&=~(1<<m),c+=1;var g=32-sn(s)+m;if(30<g){var T=m-m%5;g=(f&(1<<T)-1).toString(32),f>>=T,m-=T,ka=1<<32-sn(s)+m|c<<m|f,Aa=g+a}else ka=1<<g|c<<m|f,Aa=a}function Cd(a){a.return!==null&&(Ka(a,1),nv(a,1,0))}function kd(a){for(;a===Ef;)Ef=Fl[--Il],Fl[Il]=null,ro=Fl[--Il],Fl[Il]=null;for(;a===Ci;)Ci=Yn[--Kn],Yn[Kn]=null,Aa=Yn[--Kn],Yn[Kn]=null,ka=Yn[--Kn],Yn[Kn]=null}function av(a,s){Yn[Kn++]=ka,Yn[Kn++]=Aa,Yn[Kn++]=Ci,ka=s.id,Aa=s.overflow,Ci=a}var Ur=null,Kt=null,Et=!1,ki=null,$n=!1,Ad=Error(n(519));function Ai(a){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw no(qn(s,a)),Ad}function iv(a){var s=a.stateNode,c=a.type,f=a.memoizedProps;switch(s[F]=a,s[I]=f,c){case"dialog":xt("cancel",s),xt("close",s);break;case"iframe":case"object":case"embed":xt("load",s);break;case"video":case"audio":for(c=0;c<Co.length;c++)xt(Co[c],s);break;case"source":xt("error",s);break;case"img":case"image":case"link":xt("error",s),xt("load",s);break;case"details":xt("toggle",s);break;case"input":xt("invalid",s),vx(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":xt("invalid",s);break;case"textarea":xt("invalid",s),yx(s,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||E2(s.textContent,c)?(f.popover!=null&&(xt("beforetoggle",s),xt("toggle",s)),f.onScroll!=null&&xt("scroll",s),f.onScrollEnd!=null&&xt("scrollend",s),f.onClick!=null&&(s.onclick=Xa),s=!0):s=!1,s||Ai(a,!0)}function sv(a){for(Ur=a.return;Ur;)switch(Ur.tag){case 5:case 31:case 13:$n=!1;return;case 27:case 3:$n=!0;return;default:Ur=Ur.return}}function Ml(a){if(a!==Ur)return!1;if(!Et)return sv(a),Et=!0,!1;var s=a.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||X1(a.type,a.memoizedProps)),c=!c),c&&Kt&&Ai(a),sv(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Kt=R2(a)}else if(s===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Kt=R2(a)}else s===27?(s=Kt,zi(a.type)?(a=Q1,Q1=null,Kt=a):Kt=s):Kt=Ur?Zn(a.stateNode.nextSibling):null;return!0}function Ns(){Kt=Ur=null,Et=!1}function Nd(){var a=ki;return a!==null&&(vn===null?vn=a:vn.push.apply(vn,a),ki=null),a}function no(a){ki===null?ki=[a]:ki.push(a)}var Dd=H(null),Ds=null,$a=null;function Ni(a,s,c){j(Dd,s._currentValue),s._currentValue=c}function Qa(a){a._currentValue=Dd.current,k(Dd)}function Rd(a,s,c){for(;a!==null;){var f=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),a===c)break;a=a.return}}function Od(a,s,c,f){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var g=m.dependencies;if(g!==null){var T=m.child;g=g.firstContext;e:for(;g!==null;){var A=g;g=m;for(var V=0;V<s.length;V++)if(A.context===s[V]){g.lanes|=c,A=g.alternate,A!==null&&(A.lanes|=c),Rd(g.return,c,a),f||(T=null);break e}g=A.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(n(341));T.lanes|=c,g=T.alternate,g!==null&&(g.lanes|=c),Rd(T,c,a),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===a){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function Ll(a,s,c,f){a=null;for(var m=s,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var A=m.type;An(m.pendingProps.value,T.value)||(a!==null?a.push(A):a=[A])}}else if(m===pe.current){if(T=m.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(Ro):a=[Ro])}m=m.return}a!==null&&Od(s,a,c,f),s.flags|=262144}function Tf(a){for(a=a.firstContext;a!==null;){if(!An(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Rs(a){Ds=a,$a=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function jr(a){return lv(Ds,a)}function Sf(a,s){return Ds===null&&Rs(a),lv(a,s)}function lv(a,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},$a===null){if(a===null)throw Error(n(308));$a=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else $a=$a.next=s;return c}var c3=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(c,f){a.push(f)}};this.abort=function(){s.aborted=!0,a.forEach(function(c){return c()})}},o3=t.unstable_scheduleCallback,u3=t.unstable_NormalPriority,xr={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fd(){return{controller:new c3,data:new Map,refCount:0}}function ao(a){a.refCount--,a.refCount===0&&o3(u3,function(){a.controller.abort()})}var io=null,Id=0,Bl=0,Pl=null;function f3(a,s){if(io===null){var c=io=[];Id=0,Bl=B1(),Pl={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Id++,s.then(cv,cv),s}function cv(){if(--Id===0&&io!==null){Pl!==null&&(Pl.status="fulfilled");var a=io;io=null,Bl=0,Pl=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function h3(a,s){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return a.then(function(){f.status="fulfilled",f.value=s;for(var m=0;m<c.length;m++)(0,c[m])(s)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var ov=Y.S;Y.S=function(a,s){X_=Ot(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&f3(a,s),ov!==null&&ov(a,s)};var Os=H(null);function Md(){var a=Os.current;return a!==null?a:Vt.pooledCache}function bf(a,s){s===null?j(Os,Os.current):j(Os,s.pool)}function uv(){var a=Md();return a===null?null:{parent:xr._currentValue,pool:a}}var Ul=Error(n(460)),Ld=Error(n(474)),Cf=Error(n(542)),kf={then:function(){}};function fv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function hv(a,s,c){switch(c=a[c],c===void 0?a.push(s):c!==s&&(s.then(Xa,Xa),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,mv(a),a;default:if(typeof s.status=="string")s.then(Xa,Xa);else{if(a=Vt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(f){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=f}},function(f){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,mv(a),a}throw Is=s,Ul}}function Fs(a){try{var s=a._init;return s(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Is=c,Ul):c}}var Is=null;function dv(){if(Is===null)throw Error(n(459));var a=Is;return Is=null,a}function mv(a){if(a===Ul||a===Cf)throw Error(n(483))}var jl=null,so=0;function Af(a){var s=so;return so+=1,jl===null&&(jl=[]),hv(jl,a,s)}function lo(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function Nf(a,s){throw s.$$typeof===v?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function pv(a){function s(ee,q){if(a){var re=ee.deletions;re===null?(ee.deletions=[q],ee.flags|=16):re.push(q)}}function c(ee,q){if(!a)return null;for(;q!==null;)s(ee,q),q=q.sibling;return null}function f(ee){for(var q=new Map;ee!==null;)ee.key!==null?q.set(ee.key,ee):q.set(ee.index,ee),ee=ee.sibling;return q}function m(ee,q){return ee=Ya(ee,q),ee.index=0,ee.sibling=null,ee}function g(ee,q,re){return ee.index=re,a?(re=ee.alternate,re!==null?(re=re.index,re<q?(ee.flags|=67108866,q):re):(ee.flags|=67108866,q)):(ee.flags|=1048576,q)}function T(ee){return a&&ee.alternate===null&&(ee.flags|=67108866),ee}function A(ee,q,re,xe){return q===null||q.tag!==6?(q=Sd(re,ee.mode,xe),q.return=ee,q):(q=m(q,re),q.return=ee,q)}function V(ee,q,re,xe){var qe=re.type;return qe===w?de(ee,q,re.props.children,xe,re.key):q!==null&&(q.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===Q&&Fs(qe)===q.type)?(q=m(q,re.props),lo(q,re),q.return=ee,q):(q=wf(re.type,re.key,re.props,null,ee.mode,xe),lo(q,re),q.return=ee,q)}function ne(ee,q,re,xe){return q===null||q.tag!==4||q.stateNode.containerInfo!==re.containerInfo||q.stateNode.implementation!==re.implementation?(q=bd(re,ee.mode,xe),q.return=ee,q):(q=m(q,re.children||[]),q.return=ee,q)}function de(ee,q,re,xe,qe){return q===null||q.tag!==7?(q=As(re,ee.mode,xe,qe),q.return=ee,q):(q=m(q,re),q.return=ee,q)}function ve(ee,q,re){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Sd(""+q,ee.mode,re),q.return=ee,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case _:return re=wf(q.type,q.key,q.props,null,ee.mode,re),lo(re,q),re.return=ee,re;case E:return q=bd(q,ee.mode,re),q.return=ee,q;case Q:return q=Fs(q),ve(ee,q,re)}if(Se(q)||K(q))return q=As(q,ee.mode,re,null),q.return=ee,q;if(typeof q.then=="function")return ve(ee,Af(q),re);if(q.$$typeof===C)return ve(ee,Sf(ee,q),re);Nf(ee,q)}return null}function ce(ee,q,re,xe){var qe=q!==null?q.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return qe!==null?null:A(ee,q,""+re,xe);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case _:return re.key===qe?V(ee,q,re,xe):null;case E:return re.key===qe?ne(ee,q,re,xe):null;case Q:return re=Fs(re),ce(ee,q,re,xe)}if(Se(re)||K(re))return qe!==null?null:de(ee,q,re,xe,null);if(typeof re.then=="function")return ce(ee,q,Af(re),xe);if(re.$$typeof===C)return ce(ee,q,Sf(ee,re),xe);Nf(ee,re)}return null}function ue(ee,q,re,xe,qe){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return ee=ee.get(re)||null,A(q,ee,""+xe,qe);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case _:return ee=ee.get(xe.key===null?re:xe.key)||null,V(q,ee,xe,qe);case E:return ee=ee.get(xe.key===null?re:xe.key)||null,ne(q,ee,xe,qe);case Q:return xe=Fs(xe),ue(ee,q,re,xe,qe)}if(Se(xe)||K(xe))return ee=ee.get(re)||null,de(q,ee,xe,qe,null);if(typeof xe.then=="function")return ue(ee,q,re,Af(xe),qe);if(xe.$$typeof===C)return ue(ee,q,re,Sf(q,xe),qe);Nf(q,xe)}return null}function ze(ee,q,re,xe){for(var qe=null,kt=null,Ge=q,ot=q=0,yt=null;Ge!==null&&ot<re.length;ot++){Ge.index>ot?(yt=Ge,Ge=null):yt=Ge.sibling;var At=ce(ee,Ge,re[ot],xe);if(At===null){Ge===null&&(Ge=yt);break}a&&Ge&&At.alternate===null&&s(ee,Ge),q=g(At,q,ot),kt===null?qe=At:kt.sibling=At,kt=At,Ge=yt}if(ot===re.length)return c(ee,Ge),Et&&Ka(ee,ot),qe;if(Ge===null){for(;ot<re.length;ot++)Ge=ve(ee,re[ot],xe),Ge!==null&&(q=g(Ge,q,ot),kt===null?qe=Ge:kt.sibling=Ge,kt=Ge);return Et&&Ka(ee,ot),qe}for(Ge=f(Ge);ot<re.length;ot++)yt=ue(Ge,ee,ot,re[ot],xe),yt!==null&&(a&&yt.alternate!==null&&Ge.delete(yt.key===null?ot:yt.key),q=g(yt,q,ot),kt===null?qe=yt:kt.sibling=yt,kt=yt);return a&&Ge.forEach(function(qi){return s(ee,qi)}),Et&&Ka(ee,ot),qe}function $e(ee,q,re,xe){if(re==null)throw Error(n(151));for(var qe=null,kt=null,Ge=q,ot=q=0,yt=null,At=re.next();Ge!==null&&!At.done;ot++,At=re.next()){Ge.index>ot?(yt=Ge,Ge=null):yt=Ge.sibling;var qi=ce(ee,Ge,At.value,xe);if(qi===null){Ge===null&&(Ge=yt);break}a&&Ge&&qi.alternate===null&&s(ee,Ge),q=g(qi,q,ot),kt===null?qe=qi:kt.sibling=qi,kt=qi,Ge=yt}if(At.done)return c(ee,Ge),Et&&Ka(ee,ot),qe;if(Ge===null){for(;!At.done;ot++,At=re.next())At=ve(ee,At.value,xe),At!==null&&(q=g(At,q,ot),kt===null?qe=At:kt.sibling=At,kt=At);return Et&&Ka(ee,ot),qe}for(Ge=f(Ge);!At.done;ot++,At=re.next())At=ue(Ge,ee,ot,At.value,xe),At!==null&&(a&&At.alternate!==null&&Ge.delete(At.key===null?ot:At.key),q=g(At,q,ot),kt===null?qe=At:kt.sibling=At,kt=At);return a&&Ge.forEach(function(Tk){return s(ee,Tk)}),Et&&Ka(ee,ot),qe}function jt(ee,q,re,xe){if(typeof re=="object"&&re!==null&&re.type===w&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case _:e:{for(var qe=re.key;q!==null;){if(q.key===qe){if(qe=re.type,qe===w){if(q.tag===7){c(ee,q.sibling),xe=m(q,re.props.children),xe.return=ee,ee=xe;break e}}else if(q.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===Q&&Fs(qe)===q.type){c(ee,q.sibling),xe=m(q,re.props),lo(xe,re),xe.return=ee,ee=xe;break e}c(ee,q);break}else s(ee,q);q=q.sibling}re.type===w?(xe=As(re.props.children,ee.mode,xe,re.key),xe.return=ee,ee=xe):(xe=wf(re.type,re.key,re.props,null,ee.mode,xe),lo(xe,re),xe.return=ee,ee=xe)}return T(ee);case E:e:{for(qe=re.key;q!==null;){if(q.key===qe)if(q.tag===4&&q.stateNode.containerInfo===re.containerInfo&&q.stateNode.implementation===re.implementation){c(ee,q.sibling),xe=m(q,re.children||[]),xe.return=ee,ee=xe;break e}else{c(ee,q);break}else s(ee,q);q=q.sibling}xe=bd(re,ee.mode,xe),xe.return=ee,ee=xe}return T(ee);case Q:return re=Fs(re),jt(ee,q,re,xe)}if(Se(re))return ze(ee,q,re,xe);if(K(re)){if(qe=K(re),typeof qe!="function")throw Error(n(150));return re=qe.call(re),$e(ee,q,re,xe)}if(typeof re.then=="function")return jt(ee,q,Af(re),xe);if(re.$$typeof===C)return jt(ee,q,Sf(ee,re),xe);Nf(ee,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,q!==null&&q.tag===6?(c(ee,q.sibling),xe=m(q,re),xe.return=ee,ee=xe):(c(ee,q),xe=Sd(re,ee.mode,xe),xe.return=ee,ee=xe),T(ee)):c(ee,q)}return function(ee,q,re,xe){try{so=0;var qe=jt(ee,q,re,xe);return jl=null,qe}catch(Ge){if(Ge===Ul||Ge===Cf)throw Ge;var kt=Nn(29,Ge,null,ee.mode);return kt.lanes=xe,kt.return=ee,kt}finally{}}}var Ms=pv(!0),gv=pv(!1),Di=!1;function Bd(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pd(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ri(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Oi(a,s,c){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(Dt&2)!==0){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,s=yf(a),Jx(a,null,c),s}return _f(a,f,s,c),yf(a)}function co(a,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=a.pendingLanes,c|=f,s.lanes=c,Tl(a,c)}}function Ud(a,s){var c=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,g=null;if(c=c.firstBaseUpdate,c!==null){do{var T={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};g===null?m=g=T:g=g.next=T,c=c.next}while(c!==null);g===null?m=g=s:g=g.next=s}else m=g=s;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:f.shared,callbacks:f.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=s:a.next=s,c.lastBaseUpdate=s}var jd=!1;function oo(){if(jd){var a=Pl;if(a!==null)throw a}}function uo(a,s,c,f){jd=!1;var m=a.updateQueue;Di=!1;var g=m.firstBaseUpdate,T=m.lastBaseUpdate,A=m.shared.pending;if(A!==null){m.shared.pending=null;var V=A,ne=V.next;V.next=null,T===null?g=ne:T.next=ne,T=V;var de=a.alternate;de!==null&&(de=de.updateQueue,A=de.lastBaseUpdate,A!==T&&(A===null?de.firstBaseUpdate=ne:A.next=ne,de.lastBaseUpdate=V))}if(g!==null){var ve=m.baseState;T=0,de=ne=V=null,A=g;do{var ce=A.lane&-536870913,ue=ce!==A.lane;if(ue?(_t&ce)===ce:(f&ce)===ce){ce!==0&&ce===Bl&&(jd=!0),de!==null&&(de=de.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var ze=a,$e=A;ce=s;var jt=c;switch($e.tag){case 1:if(ze=$e.payload,typeof ze=="function"){ve=ze.call(jt,ve,ce);break e}ve=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=$e.payload,ce=typeof ze=="function"?ze.call(jt,ve,ce):ze,ce==null)break e;ve=x({},ve,ce);break e;case 2:Di=!0}}ce=A.callback,ce!==null&&(a.flags|=64,ue&&(a.flags|=8192),ue=m.callbacks,ue===null?m.callbacks=[ce]:ue.push(ce))}else ue={lane:ce,tag:A.tag,payload:A.payload,callback:A.callback,next:null},de===null?(ne=de=ue,V=ve):de=de.next=ue,T|=ce;if(A=A.next,A===null){if(A=m.shared.pending,A===null)break;ue=A,A=ue.next,ue.next=null,m.lastBaseUpdate=ue,m.shared.pending=null}}while(!0);de===null&&(V=ve),m.baseState=V,m.firstBaseUpdate=ne,m.lastBaseUpdate=de,g===null&&(m.shared.lanes=0),Bi|=T,a.lanes=T,a.memoizedState=ve}}function xv(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function vv(a,s){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)xv(c[a],s)}var Hl=H(null),Df=H(0);function _v(a,s){a=si,j(Df,a),j(Hl,s),si=a|s.baseLanes}function Hd(){j(Df,si),j(Hl,Hl.current)}function zd(){si=Df.current,k(Hl),k(Df)}var Dn=H(null),Qn=null;function Fi(a){var s=a.alternate;j(dr,dr.current&1),j(Dn,a),Qn===null&&(s===null||Hl.current!==null||s.memoizedState!==null)&&(Qn=a)}function Vd(a){j(dr,dr.current),j(Dn,a),Qn===null&&(Qn=a)}function yv(a){a.tag===22?(j(dr,dr.current),j(Dn,a),Qn===null&&(Qn=a)):Ii()}function Ii(){j(dr,dr.current),j(Dn,Dn.current)}function Rn(a){k(Dn),Qn===a&&(Qn=null),k(dr)}var dr=H(0);function Rf(a){for(var s=a;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||K1(c)||$1(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Za=0,lt=null,Pt=null,vr=null,Of=!1,zl=!1,Ls=!1,Ff=0,fo=0,Vl=null,d3=0;function sr(){throw Error(n(321))}function Gd(a,s){if(s===null)return!1;for(var c=0;c<s.length&&c<a.length;c++)if(!An(a[c],s[c]))return!1;return!0}function Wd(a,s,c,f,m,g){return Za=g,lt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Y.H=a===null||a.memoizedState===null?n_:s1,Ls=!1,g=c(f,m),Ls=!1,zl&&(g=Ev(s,c,f,m)),wv(a),g}function wv(a){Y.H=po;var s=Pt!==null&&Pt.next!==null;if(Za=0,vr=Pt=lt=null,Of=!1,fo=0,Vl=null,s)throw Error(n(300));a===null||_r||(a=a.dependencies,a!==null&&Tf(a)&&(_r=!0))}function Ev(a,s,c,f){lt=a;var m=0;do{if(zl&&(Vl=null),fo=0,zl=!1,25<=m)throw Error(n(301));if(m+=1,vr=Pt=null,a.updateQueue!=null){var g=a.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}Y.H=a_,g=s(c,f)}while(zl);return g}function m3(){var a=Y.H,s=a.useState()[0];return s=typeof s.then=="function"?ho(s):s,a=a.useState()[0],(Pt!==null?Pt.memoizedState:null)!==a&&(lt.flags|=1024),s}function Xd(){var a=Ff!==0;return Ff=0,a}function qd(a,s,c){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~c}function Yd(a){if(Of){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Of=!1}Za=0,vr=Pt=lt=null,zl=!1,fo=Ff=0,Vl=null}function ln(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vr===null?lt.memoizedState=vr=a:vr=vr.next=a,vr}function mr(){if(Pt===null){var a=lt.alternate;a=a!==null?a.memoizedState:null}else a=Pt.next;var s=vr===null?lt.memoizedState:vr.next;if(s!==null)vr=s,Pt=a;else{if(a===null)throw lt.alternate===null?Error(n(467)):Error(n(310));Pt=a,a={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},vr===null?lt.memoizedState=vr=a:vr=vr.next=a}return vr}function If(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ho(a){var s=fo;return fo+=1,Vl===null&&(Vl=[]),a=hv(Vl,a,s),s=lt,(vr===null?s.memoizedState:vr.next)===null&&(s=s.alternate,Y.H=s===null||s.memoizedState===null?n_:s1),a}function Mf(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return ho(a);if(a.$$typeof===C)return jr(a)}throw Error(n(438,String(a)))}function Kd(a){var s=null,c=lt.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=lt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=If(),lt.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(a),f=0;f<a;f++)c[f]=fe;return s.index++,c}function Ja(a,s){return typeof s=="function"?s(a):s}function Lf(a){var s=mr();return $d(s,Pt,a)}function $d(a,s,c){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var m=a.baseQueue,g=f.pending;if(g!==null){if(m!==null){var T=m.next;m.next=g.next,g.next=T}s.baseQueue=m=g,f.pending=null}if(g=a.baseState,m===null)a.memoizedState=g;else{s=m.next;var A=T=null,V=null,ne=s,de=!1;do{var ve=ne.lane&-536870913;if(ve!==ne.lane?(_t&ve)===ve:(Za&ve)===ve){var ce=ne.revertLane;if(ce===0)V!==null&&(V=V.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),ve===Bl&&(de=!0);else if((Za&ce)===ce){ne=ne.next,ce===Bl&&(de=!0);continue}else ve={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},V===null?(A=V=ve,T=g):V=V.next=ve,lt.lanes|=ce,Bi|=ce;ve=ne.action,Ls&&c(g,ve),g=ne.hasEagerState?ne.eagerState:c(g,ve)}else ce={lane:ve,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},V===null?(A=V=ce,T=g):V=V.next=ce,lt.lanes|=ve,Bi|=ve;ne=ne.next}while(ne!==null&&ne!==s);if(V===null?T=g:V.next=A,!An(g,a.memoizedState)&&(_r=!0,de&&(c=Pl,c!==null)))throw c;a.memoizedState=g,a.baseState=T,a.baseQueue=V,f.lastRenderedState=g}return m===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Qd(a){var s=mr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var f=c.dispatch,m=c.pending,g=s.memoizedState;if(m!==null){c.pending=null;var T=m=m.next;do g=a(g,T.action),T=T.next;while(T!==m);An(g,s.memoizedState)||(_r=!0),s.memoizedState=g,s.baseQueue===null&&(s.baseState=g),c.lastRenderedState=g}return[g,f]}function Tv(a,s,c){var f=lt,m=mr(),g=Et;if(g){if(c===void 0)throw Error(n(407));c=c()}else c=s();var T=!An((Pt||m).memoizedState,c);if(T&&(m.memoizedState=c,_r=!0),m=m.queue,e1(Cv.bind(null,f,m,a),[a]),m.getSnapshot!==s||T||vr!==null&&vr.memoizedState.tag&1){if(f.flags|=2048,Gl(9,{destroy:void 0},bv.bind(null,f,m,c,s),null),Vt===null)throw Error(n(349));g||(Za&127)!==0||Sv(f,s,c)}return c}function Sv(a,s,c){a.flags|=16384,a={getSnapshot:s,value:c},s=lt.updateQueue,s===null?(s=If(),lt.updateQueue=s,s.stores=[a]):(c=s.stores,c===null?s.stores=[a]:c.push(a))}function bv(a,s,c,f){s.value=c,s.getSnapshot=f,kv(s)&&Av(a)}function Cv(a,s,c){return c(function(){kv(s)&&Av(a)})}function kv(a){var s=a.getSnapshot;a=a.value;try{var c=s();return!An(a,c)}catch{return!0}}function Av(a){var s=ks(a,2);s!==null&&_n(s,a,2)}function Zd(a){var s=ln();if(typeof a=="function"){var c=a;if(a=c(),Ls){fa(!0);try{c()}finally{fa(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:a},s}function Nv(a,s,c,f){return a.baseState=c,$d(a,Pt,typeof f=="function"?f:Ja)}function p3(a,s,c,f,m){if(Uf(a))throw Error(n(485));if(a=s.action,a!==null){var g={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};Y.T!==null?c(!0):g.isTransition=!1,f(g),c=s.pending,c===null?(g.next=s.pending=g,Dv(s,g)):(g.next=c.next,s.pending=c.next=g)}}function Dv(a,s){var c=s.action,f=s.payload,m=a.state;if(s.isTransition){var g=Y.T,T={};Y.T=T;try{var A=c(m,f),V=Y.S;V!==null&&V(T,A),Rv(a,s,A)}catch(ne){Jd(a,s,ne)}finally{g!==null&&T.types!==null&&(g.types=T.types),Y.T=g}}else try{g=c(m,f),Rv(a,s,g)}catch(ne){Jd(a,s,ne)}}function Rv(a,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){Ov(a,s,f)},function(f){return Jd(a,s,f)}):Ov(a,s,c)}function Ov(a,s,c){s.status="fulfilled",s.value=c,Fv(s),a.state=c,s=a.pending,s!==null&&(c=s.next,c===s?a.pending=null:(c=c.next,s.next=c,Dv(a,c)))}function Jd(a,s,c){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,Fv(s),s=s.next;while(s!==f)}a.action=null}function Fv(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function Iv(a,s){return s}function Mv(a,s){if(Et){var c=Vt.formState;if(c!==null){e:{var f=lt;if(Et){if(Kt){t:{for(var m=Kt,g=$n;m.nodeType!==8;){if(!g){m=null;break t}if(m=Zn(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){Kt=Zn(m.nextSibling),f=m.data==="F!";break e}}Ai(f)}f=!1}f&&(s=c[0])}}return c=ln(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Iv,lastRenderedState:s},c.queue=f,c=e_.bind(null,lt,f),f.dispatch=c,f=Zd(!1),g=i1.bind(null,lt,!1,f.queue),f=ln(),m={state:s,dispatch:null,action:a,pending:null},f.queue=m,c=p3.bind(null,lt,m,g,c),m.dispatch=c,f.memoizedState=a,[s,c,!1]}function Lv(a){var s=mr();return Bv(s,Pt,a)}function Bv(a,s,c){if(s=$d(a,s,Iv)[0],a=Lf(Ja)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=ho(s)}catch(T){throw T===Ul?Cf:T}else f=s;s=mr();var m=s.queue,g=m.dispatch;return c!==s.memoizedState&&(lt.flags|=2048,Gl(9,{destroy:void 0},g3.bind(null,m,c),null)),[f,g,a]}function g3(a,s){a.action=s}function Pv(a){var s=mr(),c=Pt;if(c!==null)return Bv(s,c,a);mr(),s=s.memoizedState,c=mr();var f=c.queue.dispatch;return c.memoizedState=a,[s,f,!1]}function Gl(a,s,c,f){return a={tag:a,create:c,deps:f,inst:s,next:null},s=lt.updateQueue,s===null&&(s=If(),lt.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=a.next=a:(f=c.next,c.next=a,a.next=f,s.lastEffect=a),a}function Uv(){return mr().memoizedState}function Bf(a,s,c,f){var m=ln();lt.flags|=a,m.memoizedState=Gl(1|s,{destroy:void 0},c,f===void 0?null:f)}function Pf(a,s,c,f){var m=mr();f=f===void 0?null:f;var g=m.memoizedState.inst;Pt!==null&&f!==null&&Gd(f,Pt.memoizedState.deps)?m.memoizedState=Gl(s,g,c,f):(lt.flags|=a,m.memoizedState=Gl(1|s,g,c,f))}function jv(a,s){Bf(8390656,8,a,s)}function e1(a,s){Pf(2048,8,a,s)}function x3(a){lt.flags|=4;var s=lt.updateQueue;if(s===null)s=If(),lt.updateQueue=s,s.events=[a];else{var c=s.events;c===null?s.events=[a]:c.push(a)}}function Hv(a){var s=mr().memoizedState;return x3({ref:s,nextImpl:a}),function(){if((Dt&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function zv(a,s){return Pf(4,2,a,s)}function Vv(a,s){return Pf(4,4,a,s)}function Gv(a,s){if(typeof s=="function"){a=a();var c=s(a);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function Wv(a,s,c){c=c!=null?c.concat([a]):null,Pf(4,4,Gv.bind(null,s,a),c)}function t1(){}function Xv(a,s){var c=mr();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&Gd(s,f[1])?f[0]:(c.memoizedState=[a,s],a)}function qv(a,s){var c=mr();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&Gd(s,f[1]))return f[0];if(f=a(),Ls){fa(!0);try{a()}finally{fa(!1)}}return c.memoizedState=[f,s],f}function r1(a,s,c){return c===void 0||(Za&1073741824)!==0&&(_t&261930)===0?a.memoizedState=s:(a.memoizedState=c,a=Y_(),lt.lanes|=a,Bi|=a,c)}function Yv(a,s,c,f){return An(c,s)?c:Hl.current!==null?(a=r1(a,c,f),An(a,s)||(_r=!0),a):(Za&42)===0||(Za&1073741824)!==0&&(_t&261930)===0?(_r=!0,a.memoizedState=c):(a=Y_(),lt.lanes|=a,Bi|=a,s)}function Kv(a,s,c,f,m){var g=se.p;se.p=g!==0&&8>g?g:8;var T=Y.T,A={};Y.T=A,i1(a,!1,s,c);try{var V=m(),ne=Y.S;if(ne!==null&&ne(A,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var de=h3(V,f);mo(a,s,de,In(a))}else mo(a,s,f,In(a))}catch(ve){mo(a,s,{then:function(){},status:"rejected",reason:ve},In())}finally{se.p=g,T!==null&&A.types!==null&&(T.types=A.types),Y.T=T}}function v3(){}function n1(a,s,c,f){if(a.tag!==5)throw Error(n(476));var m=$v(a).queue;Kv(a,m,s,Le,c===null?v3:function(){return Qv(a),c(f)})}function $v(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:Le,baseState:Le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:Le},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:c},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function Qv(a){var s=$v(a);s.next===null&&(s=a.alternate.memoizedState),mo(a,s.next.queue,{},In())}function a1(){return jr(Ro)}function Zv(){return mr().memoizedState}function Jv(){return mr().memoizedState}function _3(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var c=In();a=Ri(c);var f=Oi(s,a,c);f!==null&&(_n(f,s,c),co(f,s,c)),s={cache:Fd()},a.payload=s;return}s=s.return}}function y3(a,s,c){var f=In();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Uf(a)?t_(s,c):(c=Ed(a,s,c,f),c!==null&&(_n(c,a,f),r_(c,s,f)))}function e_(a,s,c){var f=In();mo(a,s,c,f)}function mo(a,s,c,f){var m={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Uf(a))t_(s,m);else{var g=a.alternate;if(a.lanes===0&&(g===null||g.lanes===0)&&(g=s.lastRenderedReducer,g!==null))try{var T=s.lastRenderedState,A=g(T,c);if(m.hasEagerState=!0,m.eagerState=A,An(A,T))return _f(a,s,m,0),Vt===null&&vf(),!1}catch{}finally{}if(c=Ed(a,s,m,f),c!==null)return _n(c,a,f),r_(c,s,f),!0}return!1}function i1(a,s,c,f){if(f={lane:2,revertLane:B1(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Uf(a)){if(s)throw Error(n(479))}else s=Ed(a,c,f,2),s!==null&&_n(s,a,2)}function Uf(a){var s=a.alternate;return a===lt||s!==null&&s===lt}function t_(a,s){zl=Of=!0;var c=a.pending;c===null?s.next=s:(s.next=c.next,c.next=s),a.pending=s}function r_(a,s,c){if((c&4194048)!==0){var f=s.lanes;f&=a.pendingLanes,c|=f,s.lanes=c,Tl(a,c)}}var po={readContext:jr,use:Mf,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useLayoutEffect:sr,useInsertionEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useSyncExternalStore:sr,useId:sr,useHostTransitionStatus:sr,useFormState:sr,useActionState:sr,useOptimistic:sr,useMemoCache:sr,useCacheRefresh:sr};po.useEffectEvent=sr;var n_={readContext:jr,use:Mf,useCallback:function(a,s){return ln().memoizedState=[a,s===void 0?null:s],a},useContext:jr,useEffect:jv,useImperativeHandle:function(a,s,c){c=c!=null?c.concat([a]):null,Bf(4194308,4,Gv.bind(null,s,a),c)},useLayoutEffect:function(a,s){return Bf(4194308,4,a,s)},useInsertionEffect:function(a,s){Bf(4,2,a,s)},useMemo:function(a,s){var c=ln();s=s===void 0?null:s;var f=a();if(Ls){fa(!0);try{a()}finally{fa(!1)}}return c.memoizedState=[f,s],f},useReducer:function(a,s,c){var f=ln();if(c!==void 0){var m=c(s);if(Ls){fa(!0);try{c(s)}finally{fa(!1)}}}else m=s;return f.memoizedState=f.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},f.queue=a,a=a.dispatch=y3.bind(null,lt,a),[f.memoizedState,a]},useRef:function(a){var s=ln();return a={current:a},s.memoizedState=a},useState:function(a){a=Zd(a);var s=a.queue,c=e_.bind(null,lt,s);return s.dispatch=c,[a.memoizedState,c]},useDebugValue:t1,useDeferredValue:function(a,s){var c=ln();return r1(c,a,s)},useTransition:function(){var a=Zd(!1);return a=Kv.bind(null,lt,a.queue,!0,!1),ln().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,c){var f=lt,m=ln();if(Et){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),Vt===null)throw Error(n(349));(_t&127)!==0||Sv(f,s,c)}m.memoizedState=c;var g={value:c,getSnapshot:s};return m.queue=g,jv(Cv.bind(null,f,g,a),[a]),f.flags|=2048,Gl(9,{destroy:void 0},bv.bind(null,f,g,c,s),null),c},useId:function(){var a=ln(),s=Vt.identifierPrefix;if(Et){var c=Aa,f=ka;c=(f&~(1<<32-sn(f)-1)).toString(32)+c,s="_"+s+"R_"+c,c=Ff++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=d3++,s="_"+s+"r_"+c.toString(32)+"_";return a.memoizedState=s},useHostTransitionStatus:a1,useFormState:Mv,useActionState:Mv,useOptimistic:function(a){var s=ln();s.memoizedState=s.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=i1.bind(null,lt,!0,c),c.dispatch=s,[a,s]},useMemoCache:Kd,useCacheRefresh:function(){return ln().memoizedState=_3.bind(null,lt)},useEffectEvent:function(a){var s=ln(),c={impl:a};return s.memoizedState=c,function(){if((Dt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},s1={readContext:jr,use:Mf,useCallback:Xv,useContext:jr,useEffect:e1,useImperativeHandle:Wv,useInsertionEffect:zv,useLayoutEffect:Vv,useMemo:qv,useReducer:Lf,useRef:Uv,useState:function(){return Lf(Ja)},useDebugValue:t1,useDeferredValue:function(a,s){var c=mr();return Yv(c,Pt.memoizedState,a,s)},useTransition:function(){var a=Lf(Ja)[0],s=mr().memoizedState;return[typeof a=="boolean"?a:ho(a),s]},useSyncExternalStore:Tv,useId:Zv,useHostTransitionStatus:a1,useFormState:Lv,useActionState:Lv,useOptimistic:function(a,s){var c=mr();return Nv(c,Pt,a,s)},useMemoCache:Kd,useCacheRefresh:Jv};s1.useEffectEvent=Hv;var a_={readContext:jr,use:Mf,useCallback:Xv,useContext:jr,useEffect:e1,useImperativeHandle:Wv,useInsertionEffect:zv,useLayoutEffect:Vv,useMemo:qv,useReducer:Qd,useRef:Uv,useState:function(){return Qd(Ja)},useDebugValue:t1,useDeferredValue:function(a,s){var c=mr();return Pt===null?r1(c,a,s):Yv(c,Pt.memoizedState,a,s)},useTransition:function(){var a=Qd(Ja)[0],s=mr().memoizedState;return[typeof a=="boolean"?a:ho(a),s]},useSyncExternalStore:Tv,useId:Zv,useHostTransitionStatus:a1,useFormState:Pv,useActionState:Pv,useOptimistic:function(a,s){var c=mr();return Pt!==null?Nv(c,Pt,a,s):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:Kd,useCacheRefresh:Jv};a_.useEffectEvent=Hv;function l1(a,s,c,f){s=a.memoizedState,c=c(f,s),c=c==null?s:x({},s,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var c1={enqueueSetState:function(a,s,c){a=a._reactInternals;var f=In(),m=Ri(f);m.payload=s,c!=null&&(m.callback=c),s=Oi(a,m,f),s!==null&&(_n(s,a,f),co(s,a,f))},enqueueReplaceState:function(a,s,c){a=a._reactInternals;var f=In(),m=Ri(f);m.tag=1,m.payload=s,c!=null&&(m.callback=c),s=Oi(a,m,f),s!==null&&(_n(s,a,f),co(s,a,f))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var c=In(),f=Ri(c);f.tag=2,s!=null&&(f.callback=s),s=Oi(a,f,c),s!==null&&(_n(s,a,c),co(s,a,c))}};function i_(a,s,c,f,m,g,T){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,g,T):s.prototype&&s.prototype.isPureReactComponent?!eo(c,f)||!eo(m,g):!0}function s_(a,s,c,f){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==a&&c1.enqueueReplaceState(s,s.state,null)}function Bs(a,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(a=a.defaultProps){c===s&&(c=x({},c));for(var m in a)c[m]===void 0&&(c[m]=a[m])}return c}function l_(a){xf(a)}function c_(a){console.error(a)}function o_(a){xf(a)}function jf(a,s){try{var c=a.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function u_(a,s,c){try{var f=a.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function o1(a,s,c){return c=Ri(c),c.tag=3,c.payload={element:null},c.callback=function(){jf(a,s)},c}function f_(a){return a=Ri(a),a.tag=3,a}function h_(a,s,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var g=f.value;a.payload=function(){return m(g)},a.callback=function(){u_(s,c,f)}}var T=c.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(a.callback=function(){u_(s,c,f),typeof m!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var A=f.stack;this.componentDidCatch(f.value,{componentStack:A!==null?A:""})})}function w3(a,s,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&Ll(s,c,m,!0),c=Dn.current,c!==null){switch(c.tag){case 31:case 13:return Qn===null?Zf():c.alternate===null&&lr===0&&(lr=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===kf?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),I1(a,f,m)),!1;case 22:return c.flags|=65536,f===kf?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),I1(a,f,m)),!1}throw Error(n(435,c.tag))}return I1(a,f,m),Zf(),!1}if(Et)return s=Dn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=m,f!==Ad&&(a=Error(n(422),{cause:f}),no(qn(a,c)))):(f!==Ad&&(s=Error(n(423),{cause:f}),no(qn(s,c))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,f=qn(f,c),m=o1(a.stateNode,f,m),Ud(a,m),lr!==4&&(lr=2)),!1;var g=Error(n(520),{cause:f});if(g=qn(g,c),To===null?To=[g]:To.push(g),lr!==4&&(lr=2),s===null)return!0;f=qn(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,a=m&-m,c.lanes|=a,a=o1(c.stateNode,f,a),Ud(c,a),!1;case 1:if(s=c.type,g=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Pi===null||!Pi.has(g))))return c.flags|=65536,m&=-m,c.lanes|=m,m=f_(m),h_(m,a,c,f),Ud(c,m),!1}c=c.return}while(c!==null);return!1}var u1=Error(n(461)),_r=!1;function Hr(a,s,c,f){s.child=a===null?gv(s,null,c,f):Ms(s,a.child,c,f)}function d_(a,s,c,f,m){c=c.render;var g=s.ref;if("ref"in f){var T={};for(var A in f)A!=="ref"&&(T[A]=f[A])}else T=f;return Rs(s),f=Wd(a,s,c,T,g,m),A=Xd(),a!==null&&!_r?(qd(a,s,m),ei(a,s,m)):(Et&&A&&Cd(s),s.flags|=1,Hr(a,s,f,m),s.child)}function m_(a,s,c,f,m){if(a===null){var g=c.type;return typeof g=="function"&&!Td(g)&&g.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=g,p_(a,s,g,f,m)):(a=wf(c.type,null,f,s,s.mode,m),a.ref=s.ref,a.return=s,s.child=a)}if(g=a.child,!v1(a,m)){var T=g.memoizedProps;if(c=c.compare,c=c!==null?c:eo,c(T,f)&&a.ref===s.ref)return ei(a,s,m)}return s.flags|=1,a=Ya(g,f),a.ref=s.ref,a.return=s,s.child=a}function p_(a,s,c,f,m){if(a!==null){var g=a.memoizedProps;if(eo(g,f)&&a.ref===s.ref)if(_r=!1,s.pendingProps=f=g,v1(a,m))(a.flags&131072)!==0&&(_r=!0);else return s.lanes=a.lanes,ei(a,s,m)}return f1(a,s,c,f,m)}function g_(a,s,c,f){var m=f.children,g=a!==null?a.memoizedState:null;if(a===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((s.flags&128)!==0){if(g=g!==null?g.baseLanes|c:c,a!==null){for(f=s.child=a.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;f=m&~g}else f=0,s.child=null;return x_(a,s,g,c,f)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&bf(s,g!==null?g.cachePool:null),g!==null?_v(s,g):Hd(),yv(s);else return f=s.lanes=536870912,x_(a,s,g!==null?g.baseLanes|c:c,c,f)}else g!==null?(bf(s,g.cachePool),_v(s,g),Ii(),s.memoizedState=null):(a!==null&&bf(s,null),Hd(),Ii());return Hr(a,s,m,c),s.child}function go(a,s){return a!==null&&a.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function x_(a,s,c,f,m){var g=Md();return g=g===null?null:{parent:xr._currentValue,pool:g},s.memoizedState={baseLanes:c,cachePool:g},a!==null&&bf(s,null),Hd(),yv(s),a!==null&&Ll(a,s,f,!0),s.childLanes=m,null}function Hf(a,s){return s=Vf({mode:s.mode,children:s.children},a.mode),s.ref=a.ref,a.child=s,s.return=a,s}function v_(a,s,c){return Ms(s,a.child,null,c),a=Hf(s,s.pendingProps),a.flags|=2,Rn(s),s.memoizedState=null,a}function E3(a,s,c){var f=s.pendingProps,m=(s.flags&128)!==0;if(s.flags&=-129,a===null){if(Et){if(f.mode==="hidden")return a=Hf(s,f),s.lanes=536870912,go(null,a);if(Vd(s),(a=Kt)?(a=D2(a,$n),a=a!==null&&a.data==="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:Ci!==null?{id:ka,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},c=tv(a),c.return=s,s.child=c,Ur=s,Kt=null)):a=null,a===null)throw Ai(s);return s.lanes=536870912,null}return Hf(s,f)}var g=a.memoizedState;if(g!==null){var T=g.dehydrated;if(Vd(s),m)if(s.flags&256)s.flags&=-257,s=v_(a,s,c);else if(s.memoizedState!==null)s.child=a.child,s.flags|=128,s=null;else throw Error(n(558));else if(_r||Ll(a,s,c,!1),m=(c&a.childLanes)!==0,_r||m){if(f=Vt,f!==null&&(T=lf(f,c),T!==0&&T!==g.retryLane))throw g.retryLane=T,ks(a,T),_n(f,a,T),u1;Zf(),s=v_(a,s,c)}else a=g.treeContext,Kt=Zn(T.nextSibling),Ur=s,Et=!0,ki=null,$n=!1,a!==null&&av(s,a),s=Hf(s,f),s.flags|=4096;return s}return a=Ya(a.child,{mode:f.mode,children:f.children}),a.ref=s.ref,s.child=a,a.return=s,a}function zf(a,s){var c=s.ref;if(c===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(s.flags|=4194816)}}function f1(a,s,c,f,m){return Rs(s),c=Wd(a,s,c,f,void 0,m),f=Xd(),a!==null&&!_r?(qd(a,s,m),ei(a,s,m)):(Et&&f&&Cd(s),s.flags|=1,Hr(a,s,c,m),s.child)}function __(a,s,c,f,m,g){return Rs(s),s.updateQueue=null,c=Ev(s,f,c,m),wv(a),f=Xd(),a!==null&&!_r?(qd(a,s,g),ei(a,s,g)):(Et&&f&&Cd(s),s.flags|=1,Hr(a,s,c,g),s.child)}function y_(a,s,c,f,m){if(Rs(s),s.stateNode===null){var g=Ol,T=c.contextType;typeof T=="object"&&T!==null&&(g=jr(T)),g=new c(f,g),s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=c1,s.stateNode=g,g._reactInternals=s,g=s.stateNode,g.props=f,g.state=s.memoizedState,g.refs={},Bd(s),T=c.contextType,g.context=typeof T=="object"&&T!==null?jr(T):Ol,g.state=s.memoizedState,T=c.getDerivedStateFromProps,typeof T=="function"&&(l1(s,c,T,f),g.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&c1.enqueueReplaceState(g,g.state,null),uo(s,f,g,m),oo(),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(a===null){g=s.stateNode;var A=s.memoizedProps,V=Bs(c,A);g.props=V;var ne=g.context,de=c.contextType;T=Ol,typeof de=="object"&&de!==null&&(T=jr(de));var ve=c.getDerivedStateFromProps;de=typeof ve=="function"||typeof g.getSnapshotBeforeUpdate=="function",A=s.pendingProps!==A,de||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(A||ne!==T)&&s_(s,g,f,T),Di=!1;var ce=s.memoizedState;g.state=ce,uo(s,f,g,m),oo(),ne=s.memoizedState,A||ce!==ne||Di?(typeof ve=="function"&&(l1(s,c,ve,f),ne=s.memoizedState),(V=Di||i_(s,c,V,f,ce,ne,T))?(de||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(s.flags|=4194308)):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=ne),g.props=f,g.state=ne,g.context=T,f=V):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{g=s.stateNode,Pd(a,s),T=s.memoizedProps,de=Bs(c,T),g.props=de,ve=s.pendingProps,ce=g.context,ne=c.contextType,V=Ol,typeof ne=="object"&&ne!==null&&(V=jr(ne)),A=c.getDerivedStateFromProps,(ne=typeof A=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==ve||ce!==V)&&s_(s,g,f,V),Di=!1,ce=s.memoizedState,g.state=ce,uo(s,f,g,m),oo();var ue=s.memoizedState;T!==ve||ce!==ue||Di||a!==null&&a.dependencies!==null&&Tf(a.dependencies)?(typeof A=="function"&&(l1(s,c,A,f),ue=s.memoizedState),(de=Di||i_(s,c,de,f,ce,ue,V)||a!==null&&a.dependencies!==null&&Tf(a.dependencies))?(ne||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(f,ue,V),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(f,ue,V)),typeof g.componentDidUpdate=="function"&&(s.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===a.memoizedProps&&ce===a.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===a.memoizedProps&&ce===a.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=ue),g.props=f,g.state=ue,g.context=V,f=de):(typeof g.componentDidUpdate!="function"||T===a.memoizedProps&&ce===a.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===a.memoizedProps&&ce===a.memoizedState||(s.flags|=1024),f=!1)}return g=f,zf(a,s),f=(s.flags&128)!==0,g||f?(g=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:g.render(),s.flags|=1,a!==null&&f?(s.child=Ms(s,a.child,null,m),s.child=Ms(s,null,c,m)):Hr(a,s,c,m),s.memoizedState=g.state,a=s.child):a=ei(a,s,m),a}function w_(a,s,c,f){return Ns(),s.flags|=256,Hr(a,s,c,f),s.child}var h1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function d1(a){return{baseLanes:a,cachePool:uv()}}function m1(a,s,c){return a=a!==null?a.childLanes&~c:0,s&&(a|=Fn),a}function E_(a,s,c){var f=s.pendingProps,m=!1,g=(s.flags&128)!==0,T;if((T=g)||(T=a!==null&&a.memoizedState===null?!1:(dr.current&2)!==0),T&&(m=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,a===null){if(Et){if(m?Fi(s):Ii(),(a=Kt)?(a=D2(a,$n),a=a!==null&&a.data!=="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:Ci!==null?{id:ka,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},c=tv(a),c.return=s,s.child=c,Ur=s,Kt=null)):a=null,a===null)throw Ai(s);return $1(a)?s.lanes=32:s.lanes=536870912,null}var A=f.children;return f=f.fallback,m?(Ii(),m=s.mode,A=Vf({mode:"hidden",children:A},m),f=As(f,m,c,null),A.return=s,f.return=s,A.sibling=f,s.child=A,f=s.child,f.memoizedState=d1(c),f.childLanes=m1(a,T,c),s.memoizedState=h1,go(null,f)):(Fi(s),p1(s,A))}var V=a.memoizedState;if(V!==null&&(A=V.dehydrated,A!==null)){if(g)s.flags&256?(Fi(s),s.flags&=-257,s=g1(a,s,c)):s.memoizedState!==null?(Ii(),s.child=a.child,s.flags|=128,s=null):(Ii(),A=f.fallback,m=s.mode,f=Vf({mode:"visible",children:f.children},m),A=As(A,m,c,null),A.flags|=2,f.return=s,A.return=s,f.sibling=A,s.child=f,Ms(s,a.child,null,c),f=s.child,f.memoizedState=d1(c),f.childLanes=m1(a,T,c),s.memoizedState=h1,s=go(null,f));else if(Fi(s),$1(A)){if(T=A.nextSibling&&A.nextSibling.dataset,T)var ne=T.dgst;T=ne,f=Error(n(419)),f.stack="",f.digest=T,no({value:f,source:null,stack:null}),s=g1(a,s,c)}else if(_r||Ll(a,s,c,!1),T=(c&a.childLanes)!==0,_r||T){if(T=Vt,T!==null&&(f=lf(T,c),f!==0&&f!==V.retryLane))throw V.retryLane=f,ks(a,f),_n(T,a,f),u1;K1(A)||Zf(),s=g1(a,s,c)}else K1(A)?(s.flags|=192,s.child=a.child,s=null):(a=V.treeContext,Kt=Zn(A.nextSibling),Ur=s,Et=!0,ki=null,$n=!1,a!==null&&av(s,a),s=p1(s,f.children),s.flags|=4096);return s}return m?(Ii(),A=f.fallback,m=s.mode,V=a.child,ne=V.sibling,f=Ya(V,{mode:"hidden",children:f.children}),f.subtreeFlags=V.subtreeFlags&65011712,ne!==null?A=Ya(ne,A):(A=As(A,m,c,null),A.flags|=2),A.return=s,f.return=s,f.sibling=A,s.child=f,go(null,f),f=s.child,A=a.child.memoizedState,A===null?A=d1(c):(m=A.cachePool,m!==null?(V=xr._currentValue,m=m.parent!==V?{parent:V,pool:V}:m):m=uv(),A={baseLanes:A.baseLanes|c,cachePool:m}),f.memoizedState=A,f.childLanes=m1(a,T,c),s.memoizedState=h1,go(a.child,f)):(Fi(s),c=a.child,a=c.sibling,c=Ya(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,a!==null&&(T=s.deletions,T===null?(s.deletions=[a],s.flags|=16):T.push(a)),s.child=c,s.memoizedState=null,c)}function p1(a,s){return s=Vf({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Vf(a,s){return a=Nn(22,a,null,s),a.lanes=0,a}function g1(a,s,c){return Ms(s,a.child,null,c),a=p1(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function T_(a,s,c){a.lanes|=s;var f=a.alternate;f!==null&&(f.lanes|=s),Rd(a.return,s,c)}function x1(a,s,c,f,m,g){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m,treeForkCount:g}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=f,T.tail=c,T.tailMode=m,T.treeForkCount=g)}function S_(a,s,c){var f=s.pendingProps,m=f.revealOrder,g=f.tail;f=f.children;var T=dr.current,A=(T&2)!==0;if(A?(T=T&1|2,s.flags|=128):T&=1,j(dr,T),Hr(a,s,f,c),f=Et?ro:0,!A&&a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&T_(a,c,s);else if(a.tag===19)T_(a,c,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(m){case"forwards":for(c=s.child,m=null;c!==null;)a=c.alternate,a!==null&&Rf(a)===null&&(m=c),c=c.sibling;c=m,c===null?(m=s.child,s.child=null):(m=c.sibling,c.sibling=null),x1(s,!1,m,c,g,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,m=s.child,s.child=null;m!==null;){if(a=m.alternate,a!==null&&Rf(a)===null){s.child=m;break}a=m.sibling,m.sibling=c,c=m,m=a}x1(s,!0,c,null,g,f);break;case"together":x1(s,!1,null,null,void 0,f);break;default:s.memoizedState=null}return s.child}function ei(a,s,c){if(a!==null&&(s.dependencies=a.dependencies),Bi|=s.lanes,(c&s.childLanes)===0)if(a!==null){if(Ll(a,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,c=Ya(a,a.pendingProps),s.child=c,c.return=s;a.sibling!==null;)a=a.sibling,c=c.sibling=Ya(a,a.pendingProps),c.return=s;c.sibling=null}return s.child}function v1(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&Tf(a)))}function T3(a,s,c){switch(s.tag){case 3:we(s,s.stateNode.containerInfo),Ni(s,xr,a.memoizedState.cache),Ns();break;case 27:case 5:Ee(s);break;case 4:we(s,s.stateNode.containerInfo);break;case 10:Ni(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Vd(s),null;break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(Fi(s),s.flags|=128,null):(c&s.child.childLanes)!==0?E_(a,s,c):(Fi(s),a=ei(a,s,c),a!==null?a.sibling:null);Fi(s);break;case 19:var m=(a.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(Ll(a,s,c,!1),f=(c&s.childLanes)!==0),m){if(f)return S_(a,s,c);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),j(dr,dr.current),f)break;return null;case 22:return s.lanes=0,g_(a,s,c,s.pendingProps);case 24:Ni(s,xr,a.memoizedState.cache)}return ei(a,s,c)}function b_(a,s,c){if(a!==null)if(a.memoizedProps!==s.pendingProps)_r=!0;else{if(!v1(a,c)&&(s.flags&128)===0)return _r=!1,T3(a,s,c);_r=(a.flags&131072)!==0}else _r=!1,Et&&(s.flags&1048576)!==0&&nv(s,ro,s.index);switch(s.lanes=0,s.tag){case 16:e:{var f=s.pendingProps;if(a=Fs(s.elementType),s.type=a,typeof a=="function")Td(a)?(f=Bs(a,f),s.tag=1,s=y_(null,s,a,f,c)):(s.tag=0,s=f1(null,s,a,f,c));else{if(a!=null){var m=a.$$typeof;if(m===z){s.tag=11,s=d_(null,s,a,f,c);break e}else if(m===O){s.tag=14,s=m_(null,s,a,f,c);break e}}throw s=Me(a)||a,Error(n(306,s,""))}}return s;case 0:return f1(a,s,s.type,s.pendingProps,c);case 1:return f=s.type,m=Bs(f,s.pendingProps),y_(a,s,f,m,c);case 3:e:{if(we(s,s.stateNode.containerInfo),a===null)throw Error(n(387));f=s.pendingProps;var g=s.memoizedState;m=g.element,Pd(a,s),uo(s,f,null,c);var T=s.memoizedState;if(f=T.cache,Ni(s,xr,f),f!==g.cache&&Od(s,[xr],c,!0),oo(),f=T.element,g.isDehydrated)if(g={element:f,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=g,s.memoizedState=g,s.flags&256){s=w_(a,s,f,c);break e}else if(f!==m){m=qn(Error(n(424)),s),no(m),s=w_(a,s,f,c);break e}else{switch(a=s.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Kt=Zn(a.firstChild),Ur=s,Et=!0,ki=null,$n=!0,c=gv(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Ns(),f===m){s=ei(a,s,c);break e}Hr(a,s,f,c)}s=s.child}return s;case 26:return zf(a,s),a===null?(c=L2(s.type,null,s.pendingProps,null))?s.memoizedState=c:Et||(c=s.type,a=s.pendingProps,f=i0(J.current).createElement(c),f[F]=s,f[I]=a,zr(f,c,a),Ve(f),s.stateNode=f):s.memoizedState=L2(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Ee(s),a===null&&Et&&(f=s.stateNode=F2(s.type,s.pendingProps,J.current),Ur=s,$n=!0,m=Kt,zi(s.type)?(Q1=m,Kt=Zn(f.firstChild)):Kt=m),Hr(a,s,s.pendingProps.children,c),zf(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&Et&&((m=f=Kt)&&(f=J3(f,s.type,s.pendingProps,$n),f!==null?(s.stateNode=f,Ur=s,Kt=Zn(f.firstChild),$n=!1,m=!0):m=!1),m||Ai(s)),Ee(s),m=s.type,g=s.pendingProps,T=a!==null?a.memoizedProps:null,f=g.children,X1(m,g)?f=null:T!==null&&X1(m,T)&&(s.flags|=32),s.memoizedState!==null&&(m=Wd(a,s,m3,null,null,c),Ro._currentValue=m),zf(a,s),Hr(a,s,f,c),s.child;case 6:return a===null&&Et&&((a=c=Kt)&&(c=ek(c,s.pendingProps,$n),c!==null?(s.stateNode=c,Ur=s,Kt=null,a=!0):a=!1),a||Ai(s)),null;case 13:return E_(a,s,c);case 4:return we(s,s.stateNode.containerInfo),f=s.pendingProps,a===null?s.child=Ms(s,null,f,c):Hr(a,s,f,c),s.child;case 11:return d_(a,s,s.type,s.pendingProps,c);case 7:return Hr(a,s,s.pendingProps,c),s.child;case 8:return Hr(a,s,s.pendingProps.children,c),s.child;case 12:return Hr(a,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,Ni(s,s.type,f.value),Hr(a,s,f.children,c),s.child;case 9:return m=s.type._context,f=s.pendingProps.children,Rs(s),m=jr(m),f=f(m),s.flags|=1,Hr(a,s,f,c),s.child;case 14:return m_(a,s,s.type,s.pendingProps,c);case 15:return p_(a,s,s.type,s.pendingProps,c);case 19:return S_(a,s,c);case 31:return E3(a,s,c);case 22:return g_(a,s,c,s.pendingProps);case 24:return Rs(s),f=jr(xr),a===null?(m=Md(),m===null&&(m=Vt,g=Fd(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=c),m=g),s.memoizedState={parent:f,cache:m},Bd(s),Ni(s,xr,m)):((a.lanes&c)!==0&&(Pd(a,s),uo(s,null,null,c),oo()),m=a.memoizedState,g=s.memoizedState,m.parent!==f?(m={parent:f,cache:f},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),Ni(s,xr,f)):(f=g.cache,Ni(s,xr,f),f!==m.cache&&Od(s,[xr],c,!0))),Hr(a,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function ti(a){a.flags|=4}function _1(a,s,c,f,m){if((s=(a.mode&32)!==0)&&(s=!1),s){if(a.flags|=16777216,(m&335544128)===m)if(a.stateNode.complete)a.flags|=8192;else if(Z_())a.flags|=8192;else throw Is=kf,Ld}else a.flags&=-16777217}function C_(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!H2(s))if(Z_())a.flags|=8192;else throw Is=kf,Ld}function Gf(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?af():536870912,a.lanes|=s,Yl|=s)}function xo(a,s){if(!Et)switch(a.tailMode){case"hidden":s=a.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function $t(a){var s=a.alternate!==null&&a.alternate.child===a.child,c=0,f=0;if(s)for(var m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=c,s}function S3(a,s,c){var f=s.pendingProps;switch(kd(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(s),null;case 1:return $t(s),null;case 3:return c=s.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Qa(xr),ge(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(Ml(s)?ti(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Nd())),$t(s),null;case 26:var m=s.type,g=s.memoizedState;return a===null?(ti(s),g!==null?($t(s),C_(s,g)):($t(s),_1(s,m,null,f,c))):g?g!==a.memoizedState?(ti(s),$t(s),C_(s,g)):($t(s),s.flags&=-16777217):(a=a.memoizedProps,a!==f&&ti(s),$t(s),_1(s,m,a,f,c)),null;case 27:if(be(s),c=J.current,m=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&ti(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return $t(s),null}a=L.current,Ml(s)?iv(s):(a=F2(m,f,c),s.stateNode=a,ti(s))}return $t(s),null;case 5:if(be(s),m=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&ti(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return $t(s),null}if(g=L.current,Ml(s))iv(s);else{var T=i0(J.current);switch(g){case 1:g=T.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:g=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":g=T.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":g=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":g=T.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof f.is=="string"?T.createElement("select",{is:f.is}):T.createElement("select"),f.multiple?g.multiple=!0:f.size&&(g.size=f.size);break;default:g=typeof f.is=="string"?T.createElement(m,{is:f.is}):T.createElement(m)}}g[F]=s,g[I]=f;e:for(T=s.child;T!==null;){if(T.tag===5||T.tag===6)g.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===s)break e;for(;T.sibling===null;){if(T.return===null||T.return===s)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}s.stateNode=g;e:switch(zr(g,m,f),m){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&ti(s)}}return $t(s),_1(s,s.type,a===null?null:a.memoizedProps,s.pendingProps,c),null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==f&&ti(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(a=J.current,Ml(s)){if(a=s.stateNode,c=s.memoizedProps,f=null,m=Ur,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}a[F]=s,a=!!(a.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||E2(a.nodeValue,c)),a||Ai(s,!0)}else a=i0(a).createTextNode(f),a[F]=s,s.stateNode=a}return $t(s),null;case 31:if(c=s.memoizedState,a===null||a.memoizedState!==null){if(f=Ml(s),c!==null){if(a===null){if(!f)throw Error(n(318));if(a=s.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[F]=s}else Ns(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;$t(s),a=!1}else c=Nd(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return s.flags&256?(Rn(s),s):(Rn(s),null);if((s.flags&128)!==0)throw Error(n(558))}return $t(s),null;case 13:if(f=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=Ml(s),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[F]=s}else Ns(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;$t(s),m=!1}else m=Nd(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return s.flags&256?(Rn(s),s):(Rn(s),null)}return Rn(s),(s.flags&128)!==0?(s.lanes=c,s):(c=f!==null,a=a!==null&&a.memoizedState!==null,c&&(f=s.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool),g=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(g=f.memoizedState.cachePool.pool),g!==m&&(f.flags|=2048)),c!==a&&c&&(s.child.flags|=8192),Gf(s,s.updateQueue),$t(s),null);case 4:return ge(),a===null&&H1(s.stateNode.containerInfo),$t(s),null;case 10:return Qa(s.type),$t(s),null;case 19:if(k(dr),f=s.memoizedState,f===null)return $t(s),null;if(m=(s.flags&128)!==0,g=f.rendering,g===null)if(m)xo(f,!1);else{if(lr!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(g=Rf(a),g!==null){for(s.flags|=128,xo(f,!1),a=g.updateQueue,s.updateQueue=a,Gf(s,a),s.subtreeFlags=0,a=c,c=s.child;c!==null;)ev(c,a),c=c.sibling;return j(dr,dr.current&1|2),Et&&Ka(s,f.treeForkCount),s.child}a=a.sibling}f.tail!==null&&Ot()>Kf&&(s.flags|=128,m=!0,xo(f,!1),s.lanes=4194304)}else{if(!m)if(a=Rf(g),a!==null){if(s.flags|=128,m=!0,a=a.updateQueue,s.updateQueue=a,Gf(s,a),xo(f,!0),f.tail===null&&f.tailMode==="hidden"&&!g.alternate&&!Et)return $t(s),null}else 2*Ot()-f.renderingStartTime>Kf&&c!==536870912&&(s.flags|=128,m=!0,xo(f,!1),s.lanes=4194304);f.isBackwards?(g.sibling=s.child,s.child=g):(a=f.last,a!==null?a.sibling=g:s.child=g,f.last=g)}return f.tail!==null?(a=f.tail,f.rendering=a,f.tail=a.sibling,f.renderingStartTime=Ot(),a.sibling=null,c=dr.current,j(dr,m?c&1|2:c&1),Et&&Ka(s,f.treeForkCount),a):($t(s),null);case 22:case 23:return Rn(s),zd(),f=s.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&($t(s),s.subtreeFlags&6&&(s.flags|=8192)):$t(s),c=s.updateQueue,c!==null&&Gf(s,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),a!==null&&k(Os),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Qa(xr),$t(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function b3(a,s){switch(kd(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Qa(xr),ge(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return be(s),null;case 31:if(s.memoizedState!==null){if(Rn(s),s.alternate===null)throw Error(n(340));Ns()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 13:if(Rn(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Ns()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return k(dr),null;case 4:return ge(),null;case 10:return Qa(s.type),null;case 22:case 23:return Rn(s),zd(),a!==null&&k(Os),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Qa(xr),null;case 25:return null;default:return null}}function k_(a,s){switch(kd(s),s.tag){case 3:Qa(xr),ge();break;case 26:case 27:case 5:be(s);break;case 4:ge();break;case 31:s.memoizedState!==null&&Rn(s);break;case 13:Rn(s);break;case 19:k(dr);break;case 10:Qa(s.type);break;case 22:case 23:Rn(s),zd(),a!==null&&k(Os);break;case 24:Qa(xr)}}function vo(a,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&a)===a){f=void 0;var g=c.create,T=c.inst;f=g(),T.destroy=f}c=c.next}while(c!==m)}}catch(A){It(s,s.return,A)}}function Mi(a,s,c){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var g=m.next;f=g;do{if((f.tag&a)===a){var T=f.inst,A=T.destroy;if(A!==void 0){T.destroy=void 0,m=s;var V=c,ne=A;try{ne()}catch(de){It(m,V,de)}}}f=f.next}while(f!==g)}}catch(de){It(s,s.return,de)}}function A_(a){var s=a.updateQueue;if(s!==null){var c=a.stateNode;try{vv(s,c)}catch(f){It(a,a.return,f)}}}function N_(a,s,c){c.props=Bs(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(f){It(a,s,f)}}function _o(a,s){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof c=="function"?a.refCleanup=c(f):c.current=f}}catch(m){It(a,s,m)}}function Na(a,s){var c=a.ref,f=a.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){It(a,s,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){It(a,s,m)}else c.current=null}function D_(a){var s=a.type,c=a.memoizedProps,f=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){It(a,a.return,m)}}function y1(a,s,c){try{var f=a.stateNode;q3(f,a.type,c,s),f[I]=s}catch(m){It(a,a.return,m)}}function R_(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&zi(a.type)||a.tag===4}function w1(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||R_(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&zi(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function E1(a,s,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(a),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Xa));else if(f!==4&&(f===27&&zi(a.type)&&(c=a.stateNode,s=null),a=a.child,a!==null))for(E1(a,s,c),a=a.sibling;a!==null;)E1(a,s,c),a=a.sibling}function Wf(a,s,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?c.insertBefore(a,s):c.appendChild(a);else if(f!==4&&(f===27&&zi(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(Wf(a,s,c),a=a.sibling;a!==null;)Wf(a,s,c),a=a.sibling}function O_(a){var s=a.stateNode,c=a.memoizedProps;try{for(var f=a.type,m=s.attributes;m.length;)s.removeAttributeNode(m[0]);zr(s,f,c),s[F]=a,s[I]=c}catch(g){It(a,a.return,g)}}var ri=!1,yr=!1,T1=!1,F_=typeof WeakSet=="function"?WeakSet:Set,Dr=null;function C3(a,s){if(a=a.containerInfo,G1=h0,a=Wx(a),gd(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,g=f.focusNode;f=f.focusOffset;try{c.nodeType,g.nodeType}catch{c=null;break e}var T=0,A=-1,V=-1,ne=0,de=0,ve=a,ce=null;t:for(;;){for(var ue;ve!==c||m!==0&&ve.nodeType!==3||(A=T+m),ve!==g||f!==0&&ve.nodeType!==3||(V=T+f),ve.nodeType===3&&(T+=ve.nodeValue.length),(ue=ve.firstChild)!==null;)ce=ve,ve=ue;for(;;){if(ve===a)break t;if(ce===c&&++ne===m&&(A=T),ce===g&&++de===f&&(V=T),(ue=ve.nextSibling)!==null)break;ve=ce,ce=ve.parentNode}ve=ue}c=A===-1||V===-1?null:{start:A,end:V}}else c=null}c=c||{start:0,end:0}}else c=null;for(W1={focusedElem:a,selectionRange:c},h0=!1,Dr=s;Dr!==null;)if(s=Dr,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,Dr=a;else for(;Dr!==null;){switch(s=Dr,g=s.alternate,a=s.flags,s.tag){case 0:if((a&4)!==0&&(a=s.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)m=a[c],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&g!==null){a=void 0,c=s,m=g.memoizedProps,g=g.memoizedState,f=c.stateNode;try{var ze=Bs(c.type,m);a=f.getSnapshotBeforeUpdate(ze,g),f.__reactInternalSnapshotBeforeUpdate=a}catch($e){It(c,c.return,$e)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,c=a.nodeType,c===9)Y1(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Y1(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,Dr=a;break}Dr=s.return}}function I_(a,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:ai(a,c),f&4&&vo(5,c);break;case 1:if(ai(a,c),f&4)if(a=c.stateNode,s===null)try{a.componentDidMount()}catch(T){It(c,c.return,T)}else{var m=Bs(c.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(m,s,a.__reactInternalSnapshotBeforeUpdate)}catch(T){It(c,c.return,T)}}f&64&&A_(c),f&512&&_o(c,c.return);break;case 3:if(ai(a,c),f&64&&(a=c.updateQueue,a!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{vv(a,s)}catch(T){It(c,c.return,T)}}break;case 27:s===null&&f&4&&O_(c);case 26:case 5:ai(a,c),s===null&&f&4&&D_(c),f&512&&_o(c,c.return);break;case 12:ai(a,c);break;case 31:ai(a,c),f&4&&B_(a,c);break;case 13:ai(a,c),f&4&&P_(a,c),f&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=M3.bind(null,c),tk(a,c))));break;case 22:if(f=c.memoizedState!==null||ri,!f){s=s!==null&&s.memoizedState!==null||yr,m=ri;var g=yr;ri=f,(yr=s)&&!g?ii(a,c,(c.subtreeFlags&8772)!==0):ai(a,c),ri=m,yr=g}break;case 30:break;default:ai(a,c)}}function M_(a){var s=a.alternate;s!==null&&(a.alternate=null,M_(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&Ce(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var rr=null,pn=!1;function ni(a,s,c){for(c=c.child;c!==null;)L_(a,s,c),c=c.sibling}function L_(a,s,c){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(pt,c)}catch{}switch(c.tag){case 26:yr||Na(c,s),ni(a,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:yr||Na(c,s);var f=rr,m=pn;zi(c.type)&&(rr=c.stateNode,pn=!1),ni(a,s,c),Ao(c.stateNode),rr=f,pn=m;break;case 5:yr||Na(c,s);case 6:if(f=rr,m=pn,rr=null,ni(a,s,c),rr=f,pn=m,rr!==null)if(pn)try{(rr.nodeType===9?rr.body:rr.nodeName==="HTML"?rr.ownerDocument.body:rr).removeChild(c.stateNode)}catch(g){It(c,s,g)}else try{rr.removeChild(c.stateNode)}catch(g){It(c,s,g)}break;case 18:rr!==null&&(pn?(a=rr,A2(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),rc(a)):A2(rr,c.stateNode));break;case 4:f=rr,m=pn,rr=c.stateNode.containerInfo,pn=!0,ni(a,s,c),rr=f,pn=m;break;case 0:case 11:case 14:case 15:Mi(2,c,s),yr||Mi(4,c,s),ni(a,s,c);break;case 1:yr||(Na(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&N_(c,s,f)),ni(a,s,c);break;case 21:ni(a,s,c);break;case 22:yr=(f=yr)||c.memoizedState!==null,ni(a,s,c),yr=f;break;default:ni(a,s,c)}}function B_(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{rc(a)}catch(c){It(s,s.return,c)}}}function P_(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{rc(a)}catch(c){It(s,s.return,c)}}function k3(a){switch(a.tag){case 31:case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new F_),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new F_),s;default:throw Error(n(435,a.tag))}}function Xf(a,s){var c=k3(a);s.forEach(function(f){if(!c.has(f)){c.add(f);var m=L3.bind(null,a,f);f.then(m,m)}})}function gn(a,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],g=a,T=s,A=T;e:for(;A!==null;){switch(A.tag){case 27:if(zi(A.type)){rr=A.stateNode,pn=!1;break e}break;case 5:rr=A.stateNode,pn=!1;break e;case 3:case 4:rr=A.stateNode.containerInfo,pn=!0;break e}A=A.return}if(rr===null)throw Error(n(160));L_(g,T,m),rr=null,pn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)U_(s,a),s=s.sibling}var da=null;function U_(a,s){var c=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:gn(s,a),xn(a),f&4&&(Mi(3,a,a.return),vo(3,a),Mi(5,a,a.return));break;case 1:gn(s,a),xn(a),f&512&&(yr||c===null||Na(c,c.return)),f&64&&ri&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=da;if(gn(s,a),xn(a),f&512&&(yr||c===null||Na(c,c.return)),f&4){var g=c!==null?c.memoizedState:null;if(f=a.memoizedState,c===null)if(f===null)if(a.stateNode===null){e:{f=a.type,c=a.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":g=m.getElementsByTagName("title")[0],(!g||g[oe]||g[F]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(f),m.head.insertBefore(g,m.querySelector("head > title"))),zr(g,f,c),g[F]=a,Ve(g),f=g;break e;case"link":var T=U2("link","href",m).get(f+(c.href||""));if(T){for(var A=0;A<T.length;A++)if(g=T[A],g.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&g.getAttribute("rel")===(c.rel==null?null:c.rel)&&g.getAttribute("title")===(c.title==null?null:c.title)&&g.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){T.splice(A,1);break t}}g=m.createElement(f),zr(g,f,c),m.head.appendChild(g);break;case"meta":if(T=U2("meta","content",m).get(f+(c.content||""))){for(A=0;A<T.length;A++)if(g=T[A],g.getAttribute("content")===(c.content==null?null:""+c.content)&&g.getAttribute("name")===(c.name==null?null:c.name)&&g.getAttribute("property")===(c.property==null?null:c.property)&&g.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&g.getAttribute("charset")===(c.charSet==null?null:c.charSet)){T.splice(A,1);break t}}g=m.createElement(f),zr(g,f,c),m.head.appendChild(g);break;default:throw Error(n(468,f))}g[F]=a,Ve(g),f=g}a.stateNode=f}else j2(m,a.type,a.stateNode);else a.stateNode=P2(m,f,a.memoizedProps);else g!==f?(g===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):g.count--,f===null?j2(m,a.type,a.stateNode):P2(m,f,a.memoizedProps)):f===null&&a.stateNode!==null&&y1(a,a.memoizedProps,c.memoizedProps)}break;case 27:gn(s,a),xn(a),f&512&&(yr||c===null||Na(c,c.return)),c!==null&&f&4&&y1(a,a.memoizedProps,c.memoizedProps);break;case 5:if(gn(s,a),xn(a),f&512&&(yr||c===null||Na(c,c.return)),a.flags&32){m=a.stateNode;try{bl(m,"")}catch(ze){It(a,a.return,ze)}}f&4&&a.stateNode!=null&&(m=a.memoizedProps,y1(a,m,c!==null?c.memoizedProps:m)),f&1024&&(T1=!0);break;case 6:if(gn(s,a),xn(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,c=a.stateNode;try{c.nodeValue=f}catch(ze){It(a,a.return,ze)}}break;case 3:if(c0=null,m=da,da=s0(s.containerInfo),gn(s,a),da=m,xn(a),f&4&&c!==null&&c.memoizedState.isDehydrated)try{rc(s.containerInfo)}catch(ze){It(a,a.return,ze)}T1&&(T1=!1,j_(a));break;case 4:f=da,da=s0(a.stateNode.containerInfo),gn(s,a),xn(a),da=f;break;case 12:gn(s,a),xn(a);break;case 31:gn(s,a),xn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,Xf(a,f)));break;case 13:gn(s,a),xn(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Yf=Ot()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,Xf(a,f)));break;case 22:m=a.memoizedState!==null;var V=c!==null&&c.memoizedState!==null,ne=ri,de=yr;if(ri=ne||m,yr=de||V,gn(s,a),yr=de,ri=ne,xn(a),f&8192)e:for(s=a.stateNode,s._visibility=m?s._visibility&-2:s._visibility|1,m&&(c===null||V||ri||yr||Ps(a)),c=null,s=a;;){if(s.tag===5||s.tag===26){if(c===null){V=c=s;try{if(g=V.stateNode,m)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{A=V.stateNode;var ve=V.memoizedProps.style,ce=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;A.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(ze){It(V,V.return,ze)}}}else if(s.tag===6){if(c===null){V=s;try{V.stateNode.nodeValue=m?"":V.memoizedProps}catch(ze){It(V,V.return,ze)}}}else if(s.tag===18){if(c===null){V=s;try{var ue=V.stateNode;m?N2(ue,!0):N2(V.stateNode,!1)}catch(ze){It(V,V.return,ze)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=a.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Xf(a,c))));break;case 19:gn(s,a),xn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,Xf(a,f)));break;case 30:break;case 21:break;default:gn(s,a),xn(a)}}function xn(a){var s=a.flags;if(s&2){try{for(var c,f=a.return;f!==null;){if(R_(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var m=c.stateNode,g=w1(a);Wf(a,g,m);break;case 5:var T=c.stateNode;c.flags&32&&(bl(T,""),c.flags&=-33);var A=w1(a);Wf(a,A,T);break;case 3:case 4:var V=c.stateNode.containerInfo,ne=w1(a);E1(a,ne,V);break;default:throw Error(n(161))}}catch(de){It(a,a.return,de)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function j_(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;j_(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function ai(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)I_(a,s.alternate,s),s=s.sibling}function Ps(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:Mi(4,s,s.return),Ps(s);break;case 1:Na(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&N_(s,s.return,c),Ps(s);break;case 27:Ao(s.stateNode);case 26:case 5:Na(s,s.return),Ps(s);break;case 22:s.memoizedState===null&&Ps(s);break;case 30:Ps(s);break;default:Ps(s)}a=a.sibling}}function ii(a,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,m=a,g=s,T=g.flags;switch(g.tag){case 0:case 11:case 15:ii(m,g,c),vo(4,g);break;case 1:if(ii(m,g,c),f=g,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ne){It(f,f.return,ne)}if(f=g,m=f.updateQueue,m!==null){var A=f.stateNode;try{var V=m.shared.hiddenCallbacks;if(V!==null)for(m.shared.hiddenCallbacks=null,m=0;m<V.length;m++)xv(V[m],A)}catch(ne){It(f,f.return,ne)}}c&&T&64&&A_(g),_o(g,g.return);break;case 27:O_(g);case 26:case 5:ii(m,g,c),c&&f===null&&T&4&&D_(g),_o(g,g.return);break;case 12:ii(m,g,c);break;case 31:ii(m,g,c),c&&T&4&&B_(m,g);break;case 13:ii(m,g,c),c&&T&4&&P_(m,g);break;case 22:g.memoizedState===null&&ii(m,g,c),_o(g,g.return);break;case 30:break;default:ii(m,g,c)}s=s.sibling}}function S1(a,s){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&ao(c))}function b1(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&ao(a))}function ma(a,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)H_(a,s,c,f),s=s.sibling}function H_(a,s,c,f){var m=s.flags;switch(s.tag){case 0:case 11:case 15:ma(a,s,c,f),m&2048&&vo(9,s);break;case 1:ma(a,s,c,f);break;case 3:ma(a,s,c,f),m&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&ao(a)));break;case 12:if(m&2048){ma(a,s,c,f),a=s.stateNode;try{var g=s.memoizedProps,T=g.id,A=g.onPostCommit;typeof A=="function"&&A(T,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(V){It(s,s.return,V)}}else ma(a,s,c,f);break;case 31:ma(a,s,c,f);break;case 13:ma(a,s,c,f);break;case 23:break;case 22:g=s.stateNode,T=s.alternate,s.memoizedState!==null?g._visibility&2?ma(a,s,c,f):yo(a,s):g._visibility&2?ma(a,s,c,f):(g._visibility|=2,Wl(a,s,c,f,(s.subtreeFlags&10256)!==0||!1)),m&2048&&S1(T,s);break;case 24:ma(a,s,c,f),m&2048&&b1(s.alternate,s);break;default:ma(a,s,c,f)}}function Wl(a,s,c,f,m){for(m=m&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var g=a,T=s,A=c,V=f,ne=T.flags;switch(T.tag){case 0:case 11:case 15:Wl(g,T,A,V,m),vo(8,T);break;case 23:break;case 22:var de=T.stateNode;T.memoizedState!==null?de._visibility&2?Wl(g,T,A,V,m):yo(g,T):(de._visibility|=2,Wl(g,T,A,V,m)),m&&ne&2048&&S1(T.alternate,T);break;case 24:Wl(g,T,A,V,m),m&&ne&2048&&b1(T.alternate,T);break;default:Wl(g,T,A,V,m)}s=s.sibling}}function yo(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=a,f=s,m=f.flags;switch(f.tag){case 22:yo(c,f),m&2048&&S1(f.alternate,f);break;case 24:yo(c,f),m&2048&&b1(f.alternate,f);break;default:yo(c,f)}s=s.sibling}}var wo=8192;function Xl(a,s,c){if(a.subtreeFlags&wo)for(a=a.child;a!==null;)z_(a,s,c),a=a.sibling}function z_(a,s,c){switch(a.tag){case 26:Xl(a,s,c),a.flags&wo&&a.memoizedState!==null&&dk(c,da,a.memoizedState,a.memoizedProps);break;case 5:Xl(a,s,c);break;case 3:case 4:var f=da;da=s0(a.stateNode.containerInfo),Xl(a,s,c),da=f;break;case 22:a.memoizedState===null&&(f=a.alternate,f!==null&&f.memoizedState!==null?(f=wo,wo=16777216,Xl(a,s,c),wo=f):Xl(a,s,c));break;default:Xl(a,s,c)}}function V_(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function Eo(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];Dr=f,W_(f,a)}V_(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)G_(a),a=a.sibling}function G_(a){switch(a.tag){case 0:case 11:case 15:Eo(a),a.flags&2048&&Mi(9,a,a.return);break;case 3:Eo(a);break;case 12:Eo(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,qf(a)):Eo(a);break;default:Eo(a)}}function qf(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];Dr=f,W_(f,a)}V_(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:Mi(8,s,s.return),qf(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,qf(s));break;default:qf(s)}a=a.sibling}}function W_(a,s){for(;Dr!==null;){var c=Dr;switch(c.tag){case 0:case 11:case 15:Mi(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:ao(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,Dr=f;else e:for(c=a;Dr!==null;){f=Dr;var m=f.sibling,g=f.return;if(M_(f),f===c){Dr=null;break e}if(m!==null){m.return=g,Dr=m;break e}Dr=g}}}var A3={getCacheForType:function(a){var s=jr(xr),c=s.data.get(a);return c===void 0&&(c=a(),s.data.set(a,c)),c},cacheSignal:function(){return jr(xr).controller.signal}},N3=typeof WeakMap=="function"?WeakMap:Map,Dt=0,Vt=null,gt=null,_t=0,Ft=0,On=null,Li=!1,ql=!1,C1=!1,si=0,lr=0,Bi=0,Us=0,k1=0,Fn=0,Yl=0,To=null,vn=null,A1=!1,Yf=0,X_=0,Kf=1/0,$f=null,Pi=null,br=0,Ui=null,Kl=null,li=0,N1=0,D1=null,q_=null,So=0,R1=null;function In(){return(Dt&2)!==0&&_t!==0?_t&-_t:Y.T!==null?B1():b()}function Y_(){if(Fn===0)if((_t&536870912)===0||Et){var a=yl;yl<<=1,(yl&3932160)===0&&(yl=262144),Fn=a}else Fn=536870912;return a=Dn.current,a!==null&&(a.flags|=32),Fn}function _n(a,s,c){(a===Vt&&(Ft===2||Ft===9)||a.cancelPendingCommit!==null)&&($l(a,0),ji(a,_t,Fn,!1)),Es(a,c),((Dt&2)===0||a!==Vt)&&(a===Vt&&((Dt&2)===0&&(Us|=c),lr===4&&ji(a,_t,Fn,!1)),Da(a))}function K_(a,s,c){if((Dt&6)!==0)throw Error(n(327));var f=!c&&(s&127)===0&&(s&a.expiredLanes)===0||ws(a,s),m=f?O3(a,s):F1(a,s,!0),g=f;do{if(m===0){ql&&!f&&ji(a,s,0,!1);break}else{if(c=a.current.alternate,g&&!D3(c)){m=F1(a,s,!1),g=!1;continue}if(m===2){if(g=s,a.errorRecoveryDisabledLanes&g)var T=0;else T=a.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;e:{var A=a;m=To;var V=A.current.memoizedState.isDehydrated;if(V&&($l(A,T).flags|=256),T=F1(A,T,!1),T!==2){if(C1&&!V){A.errorRecoveryDisabledLanes|=g,Us|=g,m=4;break e}g=vn,vn=m,g!==null&&(vn===null?vn=g:vn.push.apply(vn,g))}m=T}if(g=!1,m!==2)continue}}if(m===1){$l(a,0),ji(a,s,0,!0);break}e:{switch(f=a,g=m,g){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:ji(f,s,Fn,!Li);break e;case 2:vn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(m=Yf+300-Ot(),10<m)){if(ji(f,s,Fn,!Li),El(f,0,!0)!==0)break e;li=s,f.timeoutHandle=C2($_.bind(null,f,c,vn,$f,A1,s,Fn,Us,Yl,Li,g,"Throttled",-0,0),m);break e}$_(f,c,vn,$f,A1,s,Fn,Us,Yl,Li,g,null,-0,0)}}break}while(!0);Da(a)}function $_(a,s,c,f,m,g,T,A,V,ne,de,ve,ce,ue){if(a.timeoutHandle=-1,ve=s.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xa},z_(s,g,ve);var ze=(g&62914560)===g?Yf-Ot():(g&4194048)===g?X_-Ot():0;if(ze=mk(ve,ze),ze!==null){li=g,a.cancelPendingCommit=ze(a2.bind(null,a,s,g,c,f,m,T,A,V,de,ve,null,ce,ue)),ji(a,g,T,!ne);return}}a2(a,s,g,c,f,m,T,A,V)}function D3(a){for(var s=a;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],g=m.getSnapshot;m=m.value;try{if(!An(g(),m))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ji(a,s,c,f){s&=~k1,s&=~Us,a.suspendedLanes|=s,a.pingedLanes&=~s,f&&(a.warmLanes|=s),f=a.expirationTimes;for(var m=s;0<m;){var g=31-sn(m),T=1<<g;f[g]=-1,m&=~T}c!==0&&sf(a,c,s)}function Qf(){return(Dt&6)===0?(bo(0),!1):!0}function O1(){if(gt!==null){if(Ft===0)var a=gt.return;else a=gt,$a=Ds=null,Yd(a),jl=null,so=0,a=gt;for(;a!==null;)k_(a.alternate,a),a=a.return;gt=null}}function $l(a,s){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,$3(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),li=0,O1(),Vt=a,gt=c=Ya(a.current,null),_t=s,Ft=0,On=null,Li=!1,ql=ws(a,s),C1=!1,Yl=Fn=k1=Us=Bi=lr=0,vn=To=null,A1=!1,(s&8)!==0&&(s|=s&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=s;0<f;){var m=31-sn(f),g=1<<m;s|=a[m],f&=~g}return si=s,vf(),c}function Q_(a,s){lt=null,Y.H=po,s===Ul||s===Cf?(s=dv(),Ft=3):s===Ld?(s=dv(),Ft=4):Ft=s===u1?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,On=s,gt===null&&(lr=1,jf(a,qn(s,a.current)))}function Z_(){var a=Dn.current;return a===null?!0:(_t&4194048)===_t?Qn===null:(_t&62914560)===_t||(_t&536870912)!==0?a===Qn:!1}function J_(){var a=Y.H;return Y.H=po,a===null?po:a}function e2(){var a=Y.A;return Y.A=A3,a}function Zf(){lr=4,Li||(_t&4194048)!==_t&&Dn.current!==null||(ql=!0),(Bi&134217727)===0&&(Us&134217727)===0||Vt===null||ji(Vt,_t,Fn,!1)}function F1(a,s,c){var f=Dt;Dt|=2;var m=J_(),g=e2();(Vt!==a||_t!==s)&&($f=null,$l(a,s)),s=!1;var T=lr;e:do try{if(Ft!==0&&gt!==null){var A=gt,V=On;switch(Ft){case 8:O1(),T=6;break e;case 3:case 2:case 9:case 6:Dn.current===null&&(s=!0);var ne=Ft;if(Ft=0,On=null,Ql(a,A,V,ne),c&&ql){T=0;break e}break;default:ne=Ft,Ft=0,On=null,Ql(a,A,V,ne)}}R3(),T=lr;break}catch(de){Q_(a,de)}while(!0);return s&&a.shellSuspendCounter++,$a=Ds=null,Dt=f,Y.H=m,Y.A=g,gt===null&&(Vt=null,_t=0,vf()),T}function R3(){for(;gt!==null;)t2(gt)}function O3(a,s){var c=Dt;Dt|=2;var f=J_(),m=e2();Vt!==a||_t!==s?($f=null,Kf=Ot()+500,$l(a,s)):ql=ws(a,s);e:do try{if(Ft!==0&&gt!==null){s=gt;var g=On;t:switch(Ft){case 1:Ft=0,On=null,Ql(a,s,g,1);break;case 2:case 9:if(fv(g)){Ft=0,On=null,r2(s);break}s=function(){Ft!==2&&Ft!==9||Vt!==a||(Ft=7),Da(a)},g.then(s,s);break e;case 3:Ft=7;break e;case 4:Ft=5;break e;case 7:fv(g)?(Ft=0,On=null,r2(s)):(Ft=0,On=null,Ql(a,s,g,7));break;case 5:var T=null;switch(gt.tag){case 26:T=gt.memoizedState;case 5:case 27:var A=gt;if(T?H2(T):A.stateNode.complete){Ft=0,On=null;var V=A.sibling;if(V!==null)gt=V;else{var ne=A.return;ne!==null?(gt=ne,Jf(ne)):gt=null}break t}}Ft=0,On=null,Ql(a,s,g,5);break;case 6:Ft=0,On=null,Ql(a,s,g,6);break;case 8:O1(),lr=6;break e;default:throw Error(n(462))}}F3();break}catch(de){Q_(a,de)}while(!0);return $a=Ds=null,Y.H=f,Y.A=m,Dt=c,gt!==null?0:(Vt=null,_t=0,vf(),lr)}function F3(){for(;gt!==null&&!Ga();)t2(gt)}function t2(a){var s=b_(a.alternate,a,si);a.memoizedProps=a.pendingProps,s===null?Jf(a):gt=s}function r2(a){var s=a,c=s.alternate;switch(s.tag){case 15:case 0:s=__(c,s,s.pendingProps,s.type,void 0,_t);break;case 11:s=__(c,s,s.pendingProps,s.type.render,s.ref,_t);break;case 5:Yd(s);default:k_(c,s),s=gt=ev(s,si),s=b_(c,s,si)}a.memoizedProps=a.pendingProps,s===null?Jf(a):gt=s}function Ql(a,s,c,f){$a=Ds=null,Yd(s),jl=null,so=0;var m=s.return;try{if(w3(a,m,s,c,_t)){lr=1,jf(a,qn(c,a.current)),gt=null;return}}catch(g){if(m!==null)throw gt=m,g;lr=1,jf(a,qn(c,a.current)),gt=null;return}s.flags&32768?(Et||f===1?a=!0:ql||(_t&536870912)!==0?a=!1:(Li=a=!0,(f===2||f===9||f===3||f===6)&&(f=Dn.current,f!==null&&f.tag===13&&(f.flags|=16384))),n2(s,a)):Jf(s)}function Jf(a){var s=a;do{if((s.flags&32768)!==0){n2(s,Li);return}a=s.return;var c=S3(s.alternate,s,si);if(c!==null){gt=c;return}if(s=s.sibling,s!==null){gt=s;return}gt=s=a}while(s!==null);lr===0&&(lr=5)}function n2(a,s){do{var c=b3(a.alternate,a);if(c!==null){c.flags&=32767,gt=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(a=a.sibling,a!==null)){gt=a;return}gt=a=c}while(a!==null);lr=6,gt=null}function a2(a,s,c,f,m,g,T,A,V){a.cancelPendingCommit=null;do e0();while(br!==0);if((Dt&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(g=s.lanes|s.childLanes,g|=wd,Jh(a,c,g,T,A,V),a===Vt&&(gt=Vt=null,_t=0),Kl=s,Ui=a,li=c,N1=g,D1=m,q_=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,B3(tt,function(){return o2(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=Y.T,Y.T=null,m=se.p,se.p=2,T=Dt,Dt|=4;try{C3(a,s,c)}finally{Dt=T,se.p=m,Y.T=f}}br=1,i2(),s2(),l2()}}function i2(){if(br===1){br=0;var a=Ui,s=Kl,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=Y.T,Y.T=null;var f=se.p;se.p=2;var m=Dt;Dt|=4;try{U_(s,a);var g=W1,T=Wx(a.containerInfo),A=g.focusedElem,V=g.selectionRange;if(T!==A&&A&&A.ownerDocument&&Gx(A.ownerDocument.documentElement,A)){if(V!==null&&gd(A)){var ne=V.start,de=V.end;if(de===void 0&&(de=ne),"selectionStart"in A)A.selectionStart=ne,A.selectionEnd=Math.min(de,A.value.length);else{var ve=A.ownerDocument||document,ce=ve&&ve.defaultView||window;if(ce.getSelection){var ue=ce.getSelection(),ze=A.textContent.length,$e=Math.min(V.start,ze),jt=V.end===void 0?$e:Math.min(V.end,ze);!ue.extend&&$e>jt&&(T=jt,jt=$e,$e=T);var ee=Vx(A,$e),q=Vx(A,jt);if(ee&&q&&(ue.rangeCount!==1||ue.anchorNode!==ee.node||ue.anchorOffset!==ee.offset||ue.focusNode!==q.node||ue.focusOffset!==q.offset)){var re=ve.createRange();re.setStart(ee.node,ee.offset),ue.removeAllRanges(),$e>jt?(ue.addRange(re),ue.extend(q.node,q.offset)):(re.setEnd(q.node,q.offset),ue.addRange(re))}}}}for(ve=[],ue=A;ue=ue.parentNode;)ue.nodeType===1&&ve.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<ve.length;A++){var xe=ve[A];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}h0=!!G1,W1=G1=null}finally{Dt=m,se.p=f,Y.T=c}}a.current=s,br=2}}function s2(){if(br===2){br=0;var a=Ui,s=Kl,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=Y.T,Y.T=null;var f=se.p;se.p=2;var m=Dt;Dt|=4;try{I_(a,s.alternate,s)}finally{Dt=m,se.p=f,Y.T=c}}br=3}}function l2(){if(br===4||br===3){br=0,Hn();var a=Ui,s=Kl,c=li,f=q_;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?br=5:(br=0,Kl=Ui=null,c2(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(Pi=null),Wc(c),s=s.stateNode,hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(pt,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=Y.T,m=se.p,se.p=2,Y.T=null;try{for(var g=a.onRecoverableError,T=0;T<f.length;T++){var A=f[T];g(A.value,{componentStack:A.stack})}}finally{Y.T=s,se.p=m}}(li&3)!==0&&e0(),Da(a),m=a.pendingLanes,(c&261930)!==0&&(m&42)!==0?a===R1?So++:(So=0,R1=a):So=0,bo(0)}}function c2(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,ao(s)))}function e0(){return i2(),s2(),l2(),o2()}function o2(){if(br!==5)return!1;var a=Ui,s=N1;N1=0;var c=Wc(li),f=Y.T,m=se.p;try{se.p=32>c?32:c,Y.T=null,c=D1,D1=null;var g=Ui,T=li;if(br=0,Kl=Ui=null,li=0,(Dt&6)!==0)throw Error(n(331));var A=Dt;if(Dt|=4,G_(g.current),H_(g,g.current,T,c),Dt=A,bo(0,!1),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(pt,g)}catch{}return!0}finally{se.p=m,Y.T=f,c2(a,s)}}function u2(a,s,c){s=qn(c,s),s=o1(a.stateNode,s,2),a=Oi(a,s,2),a!==null&&(Es(a,2),Da(a))}function It(a,s,c){if(a.tag===3)u2(a,a,c);else for(;s!==null;){if(s.tag===3){u2(s,a,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Pi===null||!Pi.has(f))){a=qn(c,a),c=f_(2),f=Oi(s,c,2),f!==null&&(h_(c,f,s,a),Es(f,2),Da(f));break}}s=s.return}}function I1(a,s,c){var f=a.pingCache;if(f===null){f=a.pingCache=new N3;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(c)||(C1=!0,m.add(c),a=I3.bind(null,a,s,c),s.then(a,a))}function I3(a,s,c){var f=a.pingCache;f!==null&&f.delete(s),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Vt===a&&(_t&c)===c&&(lr===4||lr===3&&(_t&62914560)===_t&&300>Ot()-Yf?(Dt&2)===0&&$l(a,0):k1|=c,Yl===_t&&(Yl=0)),Da(a)}function f2(a,s){s===0&&(s=af()),a=ks(a,s),a!==null&&(Es(a,s),Da(a))}function M3(a){var s=a.memoizedState,c=0;s!==null&&(c=s.retryLane),f2(a,c)}function L3(a,s){var c=0;switch(a.tag){case 31:case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),f2(a,c)}function B3(a,s){return Sr(a,s)}var t0=null,Zl=null,M1=!1,r0=!1,L1=!1,Hi=0;function Da(a){a!==Zl&&a.next===null&&(Zl===null?t0=Zl=a:Zl=Zl.next=a),r0=!0,M1||(M1=!0,U3())}function bo(a,s){if(!L1&&r0){L1=!0;do for(var c=!1,f=t0;f!==null;){if(a!==0){var m=f.pendingLanes;if(m===0)var g=0;else{var T=f.suspendedLanes,A=f.pingedLanes;g=(1<<31-sn(42|a)+1)-1,g&=m&~(T&~A),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(c=!0,p2(f,g))}else g=_t,g=El(f,f===Vt?g:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(g&3)===0||ws(f,g)||(c=!0,p2(f,g));f=f.next}while(c);L1=!1}}function P3(){h2()}function h2(){r0=M1=!1;var a=0;Hi!==0&&K3()&&(a=Hi);for(var s=Ot(),c=null,f=t0;f!==null;){var m=f.next,g=d2(f,s);g===0?(f.next=null,c===null?t0=m:c.next=m,m===null&&(Zl=c)):(c=f,(a!==0||(g&3)!==0)&&(r0=!0)),f=m}br!==0&&br!==5||bo(a),Hi!==0&&(Hi=0)}function d2(a,s){for(var c=a.suspendedLanes,f=a.pingedLanes,m=a.expirationTimes,g=a.pendingLanes&-62914561;0<g;){var T=31-sn(g),A=1<<T,V=m[T];V===-1?((A&c)===0||(A&f)!==0)&&(m[T]=Zh(A,s)):V<=s&&(a.expiredLanes|=A),g&=~A}if(s=Vt,c=_t,c=El(a,a===s?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,c===0||a===s&&(Ft===2||Ft===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&qr(f),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||ws(a,c)){if(s=c&-c,s===a.callbackPriority)return s;switch(f!==null&&qr(f),Wc(c)){case 2:case 8:c=Qe;break;case 32:c=tt;break;case 268435456:c=Ye;break;default:c=tt}return f=m2.bind(null,a),c=Sr(c,f),a.callbackPriority=s,a.callbackNode=c,s}return f!==null&&f!==null&&qr(f),a.callbackPriority=2,a.callbackNode=null,2}function m2(a,s){if(br!==0&&br!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(e0()&&a.callbackNode!==c)return null;var f=_t;return f=El(a,a===Vt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(K_(a,f,s),d2(a,Ot()),a.callbackNode!=null&&a.callbackNode===c?m2.bind(null,a):null)}function p2(a,s){if(e0())return null;K_(a,s,!0)}function U3(){Q3(function(){(Dt&6)!==0?Sr(We,P3):h2()})}function B1(){if(Hi===0){var a=Bl;a===0&&(a=ys,ys<<=1,(ys&261888)===0&&(ys=256)),Hi=a}return Hi}function g2(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:uf(""+a)}function x2(a,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,a.id&&c.setAttribute("form",a.id),s.parentNode.insertBefore(c,s),a=new FormData(a),c.parentNode.removeChild(c),a}function j3(a,s,c,f,m){if(s==="submit"&&c&&c.stateNode===m){var g=g2((m[I]||null).action),T=f.submitter;T&&(s=(s=T[I]||null)?g2(s.formAction):T.getAttribute("formAction"),s!==null&&(g=s,T=null));var A=new mf("action","action",null,f,m);a.push({event:A,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Hi!==0){var V=T?x2(m,T):new FormData(m);n1(c,{pending:!0,data:V,method:m.method,action:g},null,V)}}else typeof g=="function"&&(A.preventDefault(),V=T?x2(m,T):new FormData(m),n1(c,{pending:!0,data:V,method:m.method,action:g},g,V))},currentTarget:m}]})}}for(var P1=0;P1<yd.length;P1++){var U1=yd[P1],H3=U1.toLowerCase(),z3=U1[0].toUpperCase()+U1.slice(1);ha(H3,"on"+z3)}ha(Yx,"onAnimationEnd"),ha(Kx,"onAnimationIteration"),ha($x,"onAnimationStart"),ha("dblclick","onDoubleClick"),ha("focusin","onFocus"),ha("focusout","onBlur"),ha(a3,"onTransitionRun"),ha(i3,"onTransitionStart"),ha(s3,"onTransitionCancel"),ha(Qx,"onTransitionEnd"),Vn("onMouseEnter",["mouseout","mouseover"]),Vn("onMouseLeave",["mouseout","mouseover"]),Vn("onPointerEnter",["pointerout","pointerover"]),Vn("onPointerLeave",["pointerout","pointerover"]),tr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),tr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),tr("onBeforeInput",["compositionend","keypress","textInput","paste"]),tr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),tr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),tr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Co));function v2(a,s){s=(s&4)!==0;for(var c=0;c<a.length;c++){var f=a[c],m=f.event;f=f.listeners;e:{var g=void 0;if(s)for(var T=f.length-1;0<=T;T--){var A=f[T],V=A.instance,ne=A.currentTarget;if(A=A.listener,V!==g&&m.isPropagationStopped())break e;g=A,m.currentTarget=ne;try{g(m)}catch(de){xf(de)}m.currentTarget=null,g=V}else for(T=0;T<f.length;T++){if(A=f[T],V=A.instance,ne=A.currentTarget,A=A.listener,V!==g&&m.isPropagationStopped())break e;g=A,m.currentTarget=ne;try{g(m)}catch(de){xf(de)}m.currentTarget=null,g=V}}}}function xt(a,s){var c=s[ae];c===void 0&&(c=s[ae]=new Set);var f=a+"__bubble";c.has(f)||(_2(s,a,2,!1),c.add(f))}function j1(a,s,c){var f=0;s&&(f|=4),_2(c,a,f,s)}var n0="_reactListening"+Math.random().toString(36).slice(2);function H1(a){if(!a[n0]){a[n0]=!0,Xt.forEach(function(c){c!=="selectionchange"&&(V3.has(c)||j1(c,!1,a),j1(c,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[n0]||(s[n0]=!0,j1("selectionchange",!1,s))}}function _2(a,s,c,f){switch(Y2(s)){case 2:var m=xk;break;case 8:m=vk;break;default:m=rm}c=m.bind(null,s,c,a),m=void 0,!ld||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?a.addEventListener(s,c,{capture:!0,passive:m}):a.addEventListener(s,c,!0):m!==void 0?a.addEventListener(s,c,{passive:m}):a.addEventListener(s,c,!1)}function z1(a,s,c,f,m){var g=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var A=f.stateNode.containerInfo;if(A===m)break;if(T===4)for(T=f.return;T!==null;){var V=T.tag;if((V===3||V===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;A!==null;){if(T=Ne(A),T===null)return;if(V=T.tag,V===5||V===6||V===26||V===27){f=g=T;continue e}A=A.parentNode}}f=f.return}Sx(function(){var ne=g,de=id(c),ve=[];e:{var ce=Zx.get(a);if(ce!==void 0){var ue=mf,ze=a;switch(a){case"keypress":if(hf(c)===0)break e;case"keydown":case"keyup":ue=LC;break;case"focusin":ze="focus",ue=fd;break;case"focusout":ze="blur",ue=fd;break;case"beforeblur":case"afterblur":ue=fd;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=kx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=SC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=UC;break;case Yx:case Kx:case $x:ue=kC;break;case Qx:ue=HC;break;case"scroll":case"scrollend":ue=EC;break;case"wheel":ue=VC;break;case"copy":case"cut":case"paste":ue=NC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=Nx;break;case"toggle":case"beforetoggle":ue=WC}var $e=(s&4)!==0,jt=!$e&&(a==="scroll"||a==="scrollend"),ee=$e?ce!==null?ce+"Capture":null:ce;$e=[];for(var q=ne,re;q!==null;){var xe=q;if(re=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||re===null||ee===null||(xe=qc(q,ee),xe!=null&&$e.push(ko(q,xe,re))),jt)break;q=q.return}0<$e.length&&(ce=new ue(ce,ze,null,c,de),ve.push({event:ce,listeners:$e}))}}if((s&7)===0){e:{if(ce=a==="mouseover"||a==="pointerover",ue=a==="mouseout"||a==="pointerout",ce&&c!==ad&&(ze=c.relatedTarget||c.fromElement)&&(Ne(ze)||ze[P]))break e;if((ue||ce)&&(ce=de.window===de?de:(ce=de.ownerDocument)?ce.defaultView||ce.parentWindow:window,ue?(ze=c.relatedTarget||c.toElement,ue=ne,ze=ze?Ne(ze):null,ze!==null&&(jt=l(ze),$e=ze.tag,ze!==jt||$e!==5&&$e!==27&&$e!==6)&&(ze=null)):(ue=null,ze=ne),ue!==ze)){if($e=kx,xe="onMouseLeave",ee="onMouseEnter",q="mouse",(a==="pointerout"||a==="pointerover")&&($e=Nx,xe="onPointerLeave",ee="onPointerEnter",q="pointer"),jt=ue==null?ce:Ae(ue),re=ze==null?ce:Ae(ze),ce=new $e(xe,q+"leave",ue,c,de),ce.target=jt,ce.relatedTarget=re,xe=null,Ne(de)===ne&&($e=new $e(ee,q+"enter",ze,c,de),$e.target=re,$e.relatedTarget=jt,xe=$e),jt=xe,ue&&ze)t:{for($e=G3,ee=ue,q=ze,re=0,xe=ee;xe;xe=$e(xe))re++;xe=0;for(var qe=q;qe;qe=$e(qe))xe++;for(;0<re-xe;)ee=$e(ee),re--;for(;0<xe-re;)q=$e(q),xe--;for(;re--;){if(ee===q||q!==null&&ee===q.alternate){$e=ee;break t}ee=$e(ee),q=$e(q)}$e=null}else $e=null;ue!==null&&y2(ve,ce,ue,$e,!1),ze!==null&&jt!==null&&y2(ve,jt,ze,$e,!0)}}e:{if(ce=ne?Ae(ne):window,ue=ce.nodeName&&ce.nodeName.toLowerCase(),ue==="select"||ue==="input"&&ce.type==="file")var kt=Bx;else if(Mx(ce))if(Px)kt=t3;else{kt=JC;var Ge=ZC}else ue=ce.nodeName,!ue||ue.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ne&&nd(ne.elementType)&&(kt=Bx):kt=e3;if(kt&&(kt=kt(a,ne))){Lx(ve,kt,c,de);break e}Ge&&Ge(a,ce,ne),a==="focusout"&&ne&&ce.type==="number"&&ne.memoizedProps.value!=null&&rd(ce,"number",ce.value)}switch(Ge=ne?Ae(ne):window,a){case"focusin":(Mx(Ge)||Ge.contentEditable==="true")&&(Nl=Ge,xd=ne,to=null);break;case"focusout":to=xd=Nl=null;break;case"mousedown":vd=!0;break;case"contextmenu":case"mouseup":case"dragend":vd=!1,Xx(ve,c,de);break;case"selectionchange":if(n3)break;case"keydown":case"keyup":Xx(ve,c,de)}var ot;if(dd)e:{switch(a){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else Al?Fx(a,c)&&(yt="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(yt="onCompositionStart");yt&&(Dx&&c.locale!=="ko"&&(Al||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&Al&&(ot=bx()):(bi=de,cd="value"in bi?bi.value:bi.textContent,Al=!0)),Ge=a0(ne,yt),0<Ge.length&&(yt=new Ax(yt,a,null,c,de),ve.push({event:yt,listeners:Ge}),ot?yt.data=ot:(ot=Ix(c),ot!==null&&(yt.data=ot)))),(ot=qC?YC(a,c):KC(a,c))&&(yt=a0(ne,"onBeforeInput"),0<yt.length&&(Ge=new Ax("onBeforeInput","beforeinput",null,c,de),ve.push({event:Ge,listeners:yt}),Ge.data=ot)),j3(ve,a,ne,c,de)}v2(ve,s)})}function ko(a,s,c){return{instance:a,listener:s,currentTarget:c}}function a0(a,s){for(var c=s+"Capture",f=[];a!==null;){var m=a,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=qc(a,c),m!=null&&f.unshift(ko(a,m,g)),m=qc(a,s),m!=null&&f.push(ko(a,m,g))),a.tag===3)return f;a=a.return}return[]}function G3(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function y2(a,s,c,f,m){for(var g=s._reactName,T=[];c!==null&&c!==f;){var A=c,V=A.alternate,ne=A.stateNode;if(A=A.tag,V!==null&&V===f)break;A!==5&&A!==26&&A!==27||ne===null||(V=ne,m?(ne=qc(c,g),ne!=null&&T.unshift(ko(c,ne,V))):m||(ne=qc(c,g),ne!=null&&T.push(ko(c,ne,V)))),c=c.return}T.length!==0&&a.push({event:s,listeners:T})}var W3=/\r\n?/g,X3=/\u0000|\uFFFD/g;function w2(a){return(typeof a=="string"?a:""+a).replace(W3,`
`).replace(X3,"")}function E2(a,s){return s=w2(s),w2(a)===s}function Ut(a,s,c,f,m,g){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||bl(a,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&bl(a,""+f);break;case"className":cf(a,"class",f);break;case"tabIndex":cf(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":cf(a,c,f);break;case"style":Ex(a,f,g);break;case"data":if(s!=="object"){cf(a,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){a.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=uf(""+f),a.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(c==="formAction"?(s!=="input"&&Ut(a,s,"name",m.name,m,null),Ut(a,s,"formEncType",m.formEncType,m,null),Ut(a,s,"formMethod",m.formMethod,m,null),Ut(a,s,"formTarget",m.formTarget,m,null)):(Ut(a,s,"encType",m.encType,m,null),Ut(a,s,"method",m.method,m,null),Ut(a,s,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=uf(""+f),a.setAttribute(c,f);break;case"onClick":f!=null&&(a.onclick=Xa);break;case"onScroll":f!=null&&xt("scroll",a);break;case"onScrollEnd":f!=null&&xt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}c=uf(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""+f):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":f===!0?a.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,f):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(c,f):a.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(c):a.setAttribute(c,f);break;case"popover":xt("beforetoggle",a),xt("toggle",a),dn(a,"popover",f);break;case"xlinkActuate":Wa(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Wa(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Wa(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Wa(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Wa(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Wa(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Wa(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Wa(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Wa(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":dn(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=yC.get(c)||c,dn(a,c,f))}}function V1(a,s,c,f,m,g){switch(c){case"style":Ex(a,f,g);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof f=="string"?bl(a,f):(typeof f=="number"||typeof f=="bigint")&&bl(a,""+f);break;case"onScroll":f!=null&&xt("scroll",a);break;case"onScrollEnd":f!=null&&xt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Xa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),s=c.slice(2,m?c.length-7:void 0),g=a[I]||null,g=g!=null?g[c]:null,typeof g=="function"&&a.removeEventListener(s,g,m),typeof f=="function")){typeof g!="function"&&g!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(s,f,m);break e}c in a?a[c]=f:f===!0?a.setAttribute(c,""):dn(a,c,f)}}}function zr(a,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",a),xt("load",a);var f=!1,m=!1,g;for(g in c)if(c.hasOwnProperty(g)){var T=c[g];if(T!=null)switch(g){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ut(a,s,g,T,c,null)}}m&&Ut(a,s,"srcSet",c.srcSet,c,null),f&&Ut(a,s,"src",c.src,c,null);return;case"input":xt("invalid",a);var A=g=T=m=null,V=null,ne=null;for(f in c)if(c.hasOwnProperty(f)){var de=c[f];if(de!=null)switch(f){case"name":m=de;break;case"type":T=de;break;case"checked":V=de;break;case"defaultChecked":ne=de;break;case"value":g=de;break;case"defaultValue":A=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(n(137,s));break;default:Ut(a,s,f,de,c,null)}}vx(a,g,A,V,ne,T,m,!1);return;case"select":xt("invalid",a),f=T=g=null;for(m in c)if(c.hasOwnProperty(m)&&(A=c[m],A!=null))switch(m){case"value":g=A;break;case"defaultValue":T=A;break;case"multiple":f=A;default:Ut(a,s,m,A,c,null)}s=g,c=T,a.multiple=!!f,s!=null?Sl(a,!!f,s,!1):c!=null&&Sl(a,!!f,c,!0);return;case"textarea":xt("invalid",a),g=m=f=null;for(T in c)if(c.hasOwnProperty(T)&&(A=c[T],A!=null))switch(T){case"value":f=A;break;case"defaultValue":m=A;break;case"children":g=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:Ut(a,s,T,A,c,null)}yx(a,f,m,g);return;case"option":for(V in c)if(c.hasOwnProperty(V)&&(f=c[V],f!=null))switch(V){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ut(a,s,V,f,c,null)}return;case"dialog":xt("beforetoggle",a),xt("toggle",a),xt("cancel",a),xt("close",a);break;case"iframe":case"object":xt("load",a);break;case"video":case"audio":for(f=0;f<Co.length;f++)xt(Co[f],a);break;case"image":xt("error",a),xt("load",a);break;case"details":xt("toggle",a);break;case"embed":case"source":case"link":xt("error",a),xt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in c)if(c.hasOwnProperty(ne)&&(f=c[ne],f!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ut(a,s,ne,f,c,null)}return;default:if(nd(s)){for(de in c)c.hasOwnProperty(de)&&(f=c[de],f!==void 0&&V1(a,s,de,f,c,void 0));return}}for(A in c)c.hasOwnProperty(A)&&(f=c[A],f!=null&&Ut(a,s,A,f,c,null))}function q3(a,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,T=null,A=null,V=null,ne=null,de=null;for(ue in c){var ve=c[ue];if(c.hasOwnProperty(ue)&&ve!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":V=ve;default:f.hasOwnProperty(ue)||Ut(a,s,ue,null,f,ve)}}for(var ce in f){var ue=f[ce];if(ve=c[ce],f.hasOwnProperty(ce)&&(ue!=null||ve!=null))switch(ce){case"type":g=ue;break;case"name":m=ue;break;case"checked":ne=ue;break;case"defaultChecked":de=ue;break;case"value":T=ue;break;case"defaultValue":A=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(n(137,s));break;default:ue!==ve&&Ut(a,s,ce,ue,f,ve)}}td(a,T,A,V,ne,de,g,m);return;case"select":ue=T=A=ce=null;for(g in c)if(V=c[g],c.hasOwnProperty(g)&&V!=null)switch(g){case"value":break;case"multiple":ue=V;default:f.hasOwnProperty(g)||Ut(a,s,g,null,f,V)}for(m in f)if(g=f[m],V=c[m],f.hasOwnProperty(m)&&(g!=null||V!=null))switch(m){case"value":ce=g;break;case"defaultValue":A=g;break;case"multiple":T=g;default:g!==V&&Ut(a,s,m,g,f,V)}s=A,c=T,f=ue,ce!=null?Sl(a,!!c,ce,!1):!!f!=!!c&&(s!=null?Sl(a,!!c,s,!0):Sl(a,!!c,c?[]:"",!1));return;case"textarea":ue=ce=null;for(A in c)if(m=c[A],c.hasOwnProperty(A)&&m!=null&&!f.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:Ut(a,s,A,null,f,m)}for(T in f)if(m=f[T],g=c[T],f.hasOwnProperty(T)&&(m!=null||g!=null))switch(T){case"value":ce=m;break;case"defaultValue":ue=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==g&&Ut(a,s,T,m,f,g)}_x(a,ce,ue);return;case"option":for(var ze in c)if(ce=c[ze],c.hasOwnProperty(ze)&&ce!=null&&!f.hasOwnProperty(ze))switch(ze){case"selected":a.selected=!1;break;default:Ut(a,s,ze,null,f,ce)}for(V in f)if(ce=f[V],ue=c[V],f.hasOwnProperty(V)&&ce!==ue&&(ce!=null||ue!=null))switch(V){case"selected":a.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:Ut(a,s,V,ce,f,ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $e in c)ce=c[$e],c.hasOwnProperty($e)&&ce!=null&&!f.hasOwnProperty($e)&&Ut(a,s,$e,null,f,ce);for(ne in f)if(ce=f[ne],ue=c[ne],f.hasOwnProperty(ne)&&ce!==ue&&(ce!=null||ue!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(n(137,s));break;default:Ut(a,s,ne,ce,f,ue)}return;default:if(nd(s)){for(var jt in c)ce=c[jt],c.hasOwnProperty(jt)&&ce!==void 0&&!f.hasOwnProperty(jt)&&V1(a,s,jt,void 0,f,ce);for(de in f)ce=f[de],ue=c[de],!f.hasOwnProperty(de)||ce===ue||ce===void 0&&ue===void 0||V1(a,s,de,ce,f,ue);return}}for(var ee in c)ce=c[ee],c.hasOwnProperty(ee)&&ce!=null&&!f.hasOwnProperty(ee)&&Ut(a,s,ee,null,f,ce);for(ve in f)ce=f[ve],ue=c[ve],!f.hasOwnProperty(ve)||ce===ue||ce==null&&ue==null||Ut(a,s,ve,ce,f,ue)}function T2(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Y3(){if(typeof performance.getEntriesByType=="function"){for(var a=0,s=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var m=c[f],g=m.transferSize,T=m.initiatorType,A=m.duration;if(g&&A&&T2(T)){for(T=0,A=m.responseEnd,f+=1;f<c.length;f++){var V=c[f],ne=V.startTime;if(ne>A)break;var de=V.transferSize,ve=V.initiatorType;de&&T2(ve)&&(V=V.responseEnd,T+=de*(V<A?1:(A-ne)/(V-ne)))}if(--f,s+=8*(g+T)/(m.duration/1e3),a++,10<a)break}}if(0<a)return s/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var G1=null,W1=null;function i0(a){return a.nodeType===9?a:a.ownerDocument}function S2(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function b2(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function X1(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var q1=null;function K3(){var a=window.event;return a&&a.type==="popstate"?a===q1?!1:(q1=a,!0):(q1=null,!1)}var C2=typeof setTimeout=="function"?setTimeout:void 0,$3=typeof clearTimeout=="function"?clearTimeout:void 0,k2=typeof Promise=="function"?Promise:void 0,Q3=typeof queueMicrotask=="function"?queueMicrotask:typeof k2<"u"?function(a){return k2.resolve(null).then(a).catch(Z3)}:C2;function Z3(a){setTimeout(function(){throw a})}function zi(a){return a==="head"}function A2(a,s){var c=s,f=0;do{var m=c.nextSibling;if(a.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"||c==="/&"){if(f===0){a.removeChild(m),rc(s);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Ao(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,Ao(c);for(var g=c.firstChild;g;){var T=g.nextSibling,A=g.nodeName;g[oe]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&g.rel.toLowerCase()==="stylesheet"||c.removeChild(g),g=T}}else c==="body"&&Ao(a.ownerDocument.body);c=m}while(c);rc(s)}function N2(a,s){var c=a;a=0;do{var f=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=f}while(c)}function Y1(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Y1(c),Ce(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function J3(a,s,c,f){for(;a.nodeType===1;){var m=c;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[oe])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(g=a.getAttribute("rel"),g==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(g!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(g=a.getAttribute("src"),(g!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===g)return a}else return a;if(a=Zn(a.nextSibling),a===null)break}return null}function ek(a,s,c){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=Zn(a.nextSibling),a===null))return null;return a}function D2(a,s){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!s||(a=Zn(a.nextSibling),a===null))return null;return a}function K1(a){return a.data==="$?"||a.data==="$~"}function $1(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function tk(a,s){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=s;else if(a.data!=="$?"||c.readyState!=="loading")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function Zn(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return a}var Q1=null;function R2(a){a=a.nextSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(s===0)return Zn(a.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}a=a.nextSibling}return null}function O2(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return a;s--}else c!=="/$"&&c!=="/&"||s++}a=a.previousSibling}return null}function F2(a,s,c){switch(s=i0(c),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function Ao(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);Ce(a)}var Jn=new Map,I2=new Set;function s0(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ci=se.d;se.d={f:rk,r:nk,D:ak,C:ik,L:sk,m:lk,X:ok,S:ck,M:uk};function rk(){var a=ci.f(),s=Qf();return a||s}function nk(a){var s=Ue(a);s!==null&&s.tag===5&&s.type==="form"?Qv(s):ci.r(a)}var Jl=typeof document>"u"?null:document;function M2(a,s,c){var f=Jl;if(f&&typeof s=="string"&&s){var m=Wn(s);m='link[rel="'+a+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),I2.has(m)||(I2.add(m),a={rel:a,crossOrigin:c,href:s},f.querySelector(m)===null&&(s=f.createElement("link"),zr(s,"link",a),Ve(s),f.head.appendChild(s)))}}function ak(a){ci.D(a),M2("dns-prefetch",a,null)}function ik(a,s){ci.C(a,s),M2("preconnect",a,s)}function sk(a,s,c){ci.L(a,s,c);var f=Jl;if(f&&a&&s){var m='link[rel="preload"][as="'+Wn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+Wn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+Wn(c.imageSizes)+'"]')):m+='[href="'+Wn(a)+'"]';var g=m;switch(s){case"style":g=ec(a);break;case"script":g=tc(a)}Jn.has(g)||(a=x({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:a,as:s},c),Jn.set(g,a),f.querySelector(m)!==null||s==="style"&&f.querySelector(No(g))||s==="script"&&f.querySelector(Do(g))||(s=f.createElement("link"),zr(s,"link",a),Ve(s),f.head.appendChild(s)))}}function lk(a,s){ci.m(a,s);var c=Jl;if(c&&a){var f=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+Wn(f)+'"][href="'+Wn(a)+'"]',g=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=tc(a)}if(!Jn.has(g)&&(a=x({rel:"modulepreload",href:a},s),Jn.set(g,a),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Do(g)))return}f=c.createElement("link"),zr(f,"link",a),Ve(f),c.head.appendChild(f)}}}function ck(a,s,c){ci.S(a,s,c);var f=Jl;if(f&&a){var m=Pe(f).hoistableStyles,g=ec(a);s=s||"default";var T=m.get(g);if(!T){var A={loading:0,preload:null};if(T=f.querySelector(No(g)))A.loading=5;else{a=x({rel:"stylesheet",href:a,"data-precedence":s},c),(c=Jn.get(g))&&Z1(a,c);var V=T=f.createElement("link");Ve(V),zr(V,"link",a),V._p=new Promise(function(ne,de){V.onload=ne,V.onerror=de}),V.addEventListener("load",function(){A.loading|=1}),V.addEventListener("error",function(){A.loading|=2}),A.loading|=4,l0(T,s,f)}T={type:"stylesheet",instance:T,count:1,state:A},m.set(g,T)}}}function ok(a,s){ci.X(a,s);var c=Jl;if(c&&a){var f=Pe(c).hoistableScripts,m=tc(a),g=f.get(m);g||(g=c.querySelector(Do(m)),g||(a=x({src:a,async:!0},s),(s=Jn.get(m))&&J1(a,s),g=c.createElement("script"),Ve(g),zr(g,"link",a),c.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(m,g))}}function uk(a,s){ci.M(a,s);var c=Jl;if(c&&a){var f=Pe(c).hoistableScripts,m=tc(a),g=f.get(m);g||(g=c.querySelector(Do(m)),g||(a=x({src:a,async:!0,type:"module"},s),(s=Jn.get(m))&&J1(a,s),g=c.createElement("script"),Ve(g),zr(g,"link",a),c.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(m,g))}}function L2(a,s,c,f){var m=(m=J.current)?s0(m):null;if(!m)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=ec(c.href),c=Pe(m).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=ec(c.href);var g=Pe(m).hoistableStyles,T=g.get(a);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(a,T),(g=m.querySelector(No(a)))&&!g._p&&(T.instance=g,T.state.loading=5),Jn.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Jn.set(a,c),g||fk(m,a,c,T.state))),s&&f===null)throw Error(n(528,""));return T}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=tc(c),c=Pe(m).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function ec(a){return'href="'+Wn(a)+'"'}function No(a){return'link[rel="stylesheet"]['+a+"]"}function B2(a){return x({},a,{"data-precedence":a.precedence,precedence:null})}function fk(a,s,c,f){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=a.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),zr(s,"link",c),Ve(s),a.head.appendChild(s))}function tc(a){return'[src="'+Wn(a)+'"]'}function Do(a){return"script[async]"+a}function P2(a,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=a.querySelector('style[data-href~="'+Wn(c.href)+'"]');if(f)return s.instance=f,Ve(f),f;var m=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),Ve(f),zr(f,"style",m),l0(f,c.precedence,a),s.instance=f;case"stylesheet":m=ec(c.href);var g=a.querySelector(No(m));if(g)return s.state.loading|=4,s.instance=g,Ve(g),g;f=B2(c),(m=Jn.get(m))&&Z1(f,m),g=(a.ownerDocument||a).createElement("link"),Ve(g);var T=g;return T._p=new Promise(function(A,V){T.onload=A,T.onerror=V}),zr(g,"link",f),s.state.loading|=4,l0(g,c.precedence,a),s.instance=g;case"script":return g=tc(c.src),(m=a.querySelector(Do(g)))?(s.instance=m,Ve(m),m):(f=c,(m=Jn.get(g))&&(f=x({},c),J1(f,m)),a=a.ownerDocument||a,m=a.createElement("script"),Ve(m),zr(m,"link",f),a.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,l0(f,c.precedence,a));return s.instance}function l0(a,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,g=m,T=0;T<f.length;T++){var A=f[T];if(A.dataset.precedence===s)g=A;else if(g!==m)break}g?g.parentNode.insertBefore(a,g.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(a,s.firstChild))}function Z1(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function J1(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var c0=null;function U2(a,s,c){if(c0===null){var f=new Map,m=c0=new Map;m.set(c,f)}else m=c0,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(a))return f;for(f.set(a,null),c=c.getElementsByTagName(a),m=0;m<c.length;m++){var g=c[m];if(!(g[oe]||g[F]||a==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(s)||"";T=a+T;var A=f.get(T);A?A.push(g):f.set(T,[g])}}return f}function j2(a,s,c){a=a.ownerDocument||a,a.head.insertBefore(c,s==="title"?a.querySelector("head > title"):null)}function hk(a,s,c){if(c===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function H2(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function dk(a,s,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var m=ec(f.href),g=s.querySelector(No(m));if(g){s=g._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(a.count++,a=o0.bind(a),s.then(a,a)),c.state.loading|=4,c.instance=g,Ve(g);return}g=s.ownerDocument||s,f=B2(f),(m=Jn.get(m))&&Z1(f,m),g=g.createElement("link"),Ve(g);var T=g;T._p=new Promise(function(A,V){T.onload=A,T.onerror=V}),zr(g,"link",f),c.instance=g}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=o0.bind(a),s.addEventListener("load",c),s.addEventListener("error",c))}}var em=0;function mk(a,s){return a.stylesheets&&a.count===0&&f0(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var f=setTimeout(function(){if(a.stylesheets&&f0(a,a.stylesheets),a.unsuspend){var g=a.unsuspend;a.unsuspend=null,g()}},6e4+s);0<a.imgBytes&&em===0&&(em=62500*Y3());var m=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&f0(a,a.stylesheets),a.unsuspend)){var g=a.unsuspend;a.unsuspend=null,g()}},(a.imgBytes>em?50:800)+s);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(f),clearTimeout(m)}}:null}function o0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)f0(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var u0=null;function f0(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,u0=new Map,s.forEach(pk,a),u0=null,o0.call(a))}function pk(a,s){if(!(s.state.loading&4)){var c=u0.get(a);if(c)var f=c.get(null);else{c=new Map,u0.set(a,c);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var T=m[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(c.set(T.dataset.precedence,T),f=T)}f&&c.set(null,f)}m=s.instance,T=m.getAttribute("data-precedence"),g=c.get(T)||f,g===f&&c.set(null,m),c.set(T,m),this.count++,f=o0.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),g?g.parentNode.insertBefore(m,g.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),s.state.loading|=4}}var Ro={$$typeof:C,Provider:null,Consumer:null,_currentValue:Le,_currentValue2:Le,_threadCount:0};function gk(a,s,c,f,m,g,T,A,V){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Vc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vc(0),this.hiddenUpdates=Vc(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function z2(a,s,c,f,m,g,T,A,V,ne,de,ve){return a=new gk(a,s,c,T,V,ne,de,ve,A),s=1,g===!0&&(s|=24),g=Nn(3,null,null,s),a.current=g,g.stateNode=a,s=Fd(),s.refCount++,a.pooledCache=s,s.refCount++,g.memoizedState={element:f,isDehydrated:c,cache:s},Bd(g),a}function V2(a){return a?(a=Ol,a):Ol}function G2(a,s,c,f,m,g){m=V2(m),f.context===null?f.context=m:f.pendingContext=m,f=Ri(s),f.payload={element:c},g=g===void 0?null:g,g!==null&&(f.callback=g),c=Oi(a,f,s),c!==null&&(_n(c,a,s),co(c,a,s))}function W2(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<s?c:s}}function tm(a,s){W2(a,s),(a=a.alternate)&&W2(a,s)}function X2(a){if(a.tag===13||a.tag===31){var s=ks(a,67108864);s!==null&&_n(s,a,67108864),tm(a,67108864)}}function q2(a){if(a.tag===13||a.tag===31){var s=In();s=Gc(s);var c=ks(a,s);c!==null&&_n(c,a,s),tm(a,s)}}var h0=!0;function xk(a,s,c,f){var m=Y.T;Y.T=null;var g=se.p;try{se.p=2,rm(a,s,c,f)}finally{se.p=g,Y.T=m}}function vk(a,s,c,f){var m=Y.T;Y.T=null;var g=se.p;try{se.p=8,rm(a,s,c,f)}finally{se.p=g,Y.T=m}}function rm(a,s,c,f){if(h0){var m=nm(f);if(m===null)z1(a,s,f,d0,c),K2(a,f);else if(yk(m,a,s,c,f))f.stopPropagation();else if(K2(a,f),s&4&&-1<_k.indexOf(a)){for(;m!==null;){var g=Ue(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=zn(g.pendingLanes);if(T!==0){var A=g;for(A.pendingLanes|=2,A.entangledLanes|=2;T;){var V=1<<31-sn(T);A.entanglements[1]|=V,T&=~V}Da(g),(Dt&6)===0&&(Kf=Ot()+500,bo(0))}}break;case 31:case 13:A=ks(g,2),A!==null&&_n(A,g,2),Qf(),tm(g,2)}if(g=nm(f),g===null&&z1(a,s,f,d0,c),g===m)break;m=g}m!==null&&f.stopPropagation()}else z1(a,s,f,null,c)}}function nm(a){return a=id(a),am(a)}var d0=null;function am(a){if(d0=null,a=Ne(a),a!==null){var s=l(a);if(s===null)a=null;else{var c=s.tag;if(c===13){if(a=o(s),a!==null)return a;a=null}else if(c===31){if(a=u(s),a!==null)return a;a=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return d0=a,null}function Y2(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fe()){case We:return 2;case Qe:return 8;case tt:case Ze:return 32;case Ye:return 268435456;default:return 32}default:return 32}}var im=!1,Vi=null,Gi=null,Wi=null,Oo=new Map,Fo=new Map,Xi=[],_k="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function K2(a,s){switch(a){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":Gi=null;break;case"mouseover":case"mouseout":Wi=null;break;case"pointerover":case"pointerout":Oo.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fo.delete(s.pointerId)}}function Io(a,s,c,f,m,g){return a===null||a.nativeEvent!==g?(a={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:g,targetContainers:[m]},s!==null&&(s=Ue(s),s!==null&&X2(s)),a):(a.eventSystemFlags|=f,s=a.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),a)}function yk(a,s,c,f,m){switch(s){case"focusin":return Vi=Io(Vi,a,s,c,f,m),!0;case"dragenter":return Gi=Io(Gi,a,s,c,f,m),!0;case"mouseover":return Wi=Io(Wi,a,s,c,f,m),!0;case"pointerover":var g=m.pointerId;return Oo.set(g,Io(Oo.get(g)||null,a,s,c,f,m)),!0;case"gotpointercapture":return g=m.pointerId,Fo.set(g,Io(Fo.get(g)||null,a,s,c,f,m)),!0}return!1}function $2(a){var s=Ne(a.target);if(s!==null){var c=l(s);if(c!==null){if(s=c.tag,s===13){if(s=o(c),s!==null){a.blockedOn=s,B(a.priority,function(){q2(c)});return}}else if(s===31){if(s=u(c),s!==null){a.blockedOn=s,B(a.priority,function(){q2(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function m0(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var c=nm(a.nativeEvent);if(c===null){c=a.nativeEvent;var f=new c.constructor(c.type,c);ad=f,c.target.dispatchEvent(f),ad=null}else return s=Ue(c),s!==null&&X2(s),a.blockedOn=c,!1;s.shift()}return!0}function Q2(a,s,c){m0(a)&&c.delete(s)}function wk(){im=!1,Vi!==null&&m0(Vi)&&(Vi=null),Gi!==null&&m0(Gi)&&(Gi=null),Wi!==null&&m0(Wi)&&(Wi=null),Oo.forEach(Q2),Fo.forEach(Q2)}function p0(a,s){a.blockedOn===s&&(a.blockedOn=null,im||(im=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,wk)))}var g0=null;function Z2(a){g0!==a&&(g0=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){g0===a&&(g0=null);for(var s=0;s<a.length;s+=3){var c=a[s],f=a[s+1],m=a[s+2];if(typeof f!="function"){if(am(f||c)===null)continue;break}var g=Ue(c);g!==null&&(a.splice(s,3),s-=3,n1(g,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function rc(a){function s(V){return p0(V,a)}Vi!==null&&p0(Vi,a),Gi!==null&&p0(Gi,a),Wi!==null&&p0(Wi,a),Oo.forEach(s),Fo.forEach(s);for(var c=0;c<Xi.length;c++){var f=Xi[c];f.blockedOn===a&&(f.blockedOn=null)}for(;0<Xi.length&&(c=Xi[0],c.blockedOn===null);)$2(c),c.blockedOn===null&&Xi.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],g=c[f+1],T=m[I]||null;if(typeof g=="function")T||Z2(c);else if(T){var A=null;if(g&&g.hasAttribute("formAction")){if(m=g,T=g[I]||null)A=T.formAction;else if(am(m)!==null)continue}else A=T.action;typeof A=="function"?c[f+1]=A:(c.splice(f,3),f-=3),Z2(c)}}}function J2(){function a(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(T){return m=T})},focusReset:"manual",scroll:"manual"})}function s(){m!==null&&(m(),m=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,m=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),m!==null&&(m(),m=null)}}}function sm(a){this._internalRoot=a}x0.prototype.render=sm.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,f=In();G2(c,f,a,s,null,null)},x0.prototype.unmount=sm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;G2(a.current,2,null,a,null,null),Qf(),s[P]=null}};function x0(a){this._internalRoot=a}x0.prototype.unstable_scheduleHydration=function(a){if(a){var s=b();a={blockedOn:null,target:a,priority:s};for(var c=0;c<Xi.length&&s!==0&&s<Xi[c].priority;c++);Xi.splice(c,0,a),c===0&&$2(a)}};var ey=e.version;if(ey!=="19.2.1")throw Error(n(527,ey,"19.2.1"));se.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=d(s),a=a!==null?p(a):null,a=a===null?null:a.stateNode,a};var Ek={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var v0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!v0.isDisabled&&v0.supportsFiber)try{pt=v0.inject(Ek),hr=v0}catch{}}return Lo.createRoot=function(a,s){if(!i(a))throw Error(n(299));var c=!1,f="",m=l_,g=c_,T=o_;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(g=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),s=z2(a,1,!1,null,null,c,f,null,m,g,T,J2),a[P]=s.current,H1(a),new sm(s)},Lo.hydrateRoot=function(a,s,c){if(!i(a))throw Error(n(299));var f=!1,m="",g=l_,T=c_,A=o_,V=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(g=c.onUncaughtError),c.onCaughtError!==void 0&&(T=c.onCaughtError),c.onRecoverableError!==void 0&&(A=c.onRecoverableError),c.formState!==void 0&&(V=c.formState)),s=z2(a,1,!0,s,c??null,f,m,V,g,T,A,J2),s.context=V2(null),c=s.current,f=In(),f=Gc(f),m=Ri(f),m.callback=null,Oi(c,m,f),c=f,s.current.lanes=c,Es(s,c),Da(s),a[P]=s.current,H1(a),new x0(s)},Lo.version="19.2.1",Lo}var uy;function Ik(){if(uy)return om.exports;uy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),om.exports=Fk(),om.exports}var Mk=Ik();const Lk=()=>{};var fy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re=function(t,e){if(!t)throw Rc(e)},Rc=function(t){return new Error("Firebase Database ("+XE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Bk=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const l=t[r++];e[n++]=String.fromCharCode((i&31)<<6|l&63)}else if(i>239&&i<365){const l=t[r++],o=t[r++],u=t[r++],h=((i&7)<<18|(l&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const l=t[r++],o=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(l&63)<<6|o&63)}}return e.join("")},Np={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const l=t[i],o=i+1<t.length,u=o?t[i+1]:0,h=i+2<t.length,d=h?t[i+2]:0,p=l>>2,x=(l&3)<<4|u>>4;let v=(u&15)<<2|d>>6,_=d&63;h||(_=64,o||(v=64)),n.push(r[p],r[x],r[v],r[_])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(qE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Bk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const l=r[t.charAt(i++)],u=i<t.length?r[t.charAt(i)]:0;++i;const d=i<t.length?r[t.charAt(i)]:64;++i;const x=i<t.length?r[t.charAt(i)]:64;if(++i,l==null||u==null||d==null||x==null)throw new Pk;const v=l<<2|u>>4;if(n.push(v),d!==64){const _=u<<4&240|d>>2;if(n.push(_),x!==64){const E=d<<6&192|x;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Pk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const YE=function(t){const e=qE(t);return Np.encodeByteArray(e,!0)},P0=function(t){return YE(t).replace(/\./g,"")},U0=function(t){try{return Np.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(t){return KE(void 0,t)}function KE(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const r=e;return new Date(r.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)!e.hasOwnProperty(r)||!jk(r)||(t[r]=KE(t[r],e[r]));return t}function jk(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk=()=>Hk().__FIREBASE_DEFAULTS__,Vk=()=>{if(typeof process>"u"||typeof fy>"u")return;const t=fy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Gk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&U0(t[1]);return e&&JSON.parse(e)},Dp=()=>{try{return Lk()||zk()||Vk()||Gk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},$E=t=>{var e,r;return(r=(e=Dp())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},Wk=t=>{const e=$E(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},QE=()=>{var t;return(t=Dp())==null?void 0:t.config},ZE=t=>{var e;return(e=Dp())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function JE(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[P0(JSON.stringify(r)),P0(JSON.stringify(o)),""].join(".")}const Wo={};function qk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Wo))Wo[e]?t.emulator.push(e):t.prod.push(e);return t}function Yk(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let hy=!1;function eT(t,e){if(typeof window>"u"||typeof document>"u"||!Oc(window.location.host)||Wo[t]===e||Wo[t]||hy)return;Wo[t]=e;function r(v){return`__firebase__banner__${v}`}const n="__firebase__banner",l=qk().prod.length>0;function o(){const v=document.getElementById(n);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,_){v.setAttribute("width","24"),v.setAttribute("id",_),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function d(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{hy=!0,o()},v}function p(v,_){v.setAttribute("id",_),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function x(){const v=Yk(n),_=r("text"),E=document.getElementById(_)||document.createElement("span"),w=r("learnmore"),S=document.getElementById(w)||document.createElement("a"),N=r("preprendIcon"),M=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const C=v.element;u(C),p(S,w);const z=d();h(M,N),C.append(M,E,S,z),document.body.appendChild(C)}l?(E.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Rp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fn())}function Kk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $k(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function tT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Qk(){const t=fn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Zk(){return XE.NODE_ADMIN===!0}function Jk(){try{return typeof indexedDB=="object"}catch{return!1}}function eA(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var l;e(((l=i.error)==null?void 0:l.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA="FirebaseError";class gs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=tA,Object.setPrototypeOf(this,gs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Lu.prototype.create)}}class Lu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,l=this.errors[e],o=l?rA(l,n):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new gs(i,u,n)}}function rA(t,e){return t.replace(nA,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const nA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t){return JSON.parse(t)}function Lr(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT=function(t){let e={},r={},n={},i="";try{const l=t.split(".");e=uu(U0(l[0])||""),r=uu(U0(l[1])||""),i=l[2],n=r.d||{},delete r.d}catch{}return{header:e,claims:r,data:n,signature:i}},aA=function(t){const e=rT(t),r=e.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},iA=function(t){const e=rT(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ba(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $s(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Xm(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function j0(t,e,r){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=e.call(r,t[i],i,t));return n}function Qs(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const l=t[i],o=e[i];if(dy(l)&&dy(o)){if(!Qs(l,o))return!1}else if(l!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function dy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,r){r||(r=0);const n=this.W_;if(typeof e=="string")for(let x=0;x<16;x++)n[x]=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),r+=4;else for(let x=0;x<16;x++)n[x]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4;for(let x=16;x<80;x++){const v=n[x-3]^n[x-8]^n[x-14]^n[x-16];n[x]=(v<<1|v>>>31)&4294967295}let i=this.chain_[0],l=this.chain_[1],o=this.chain_[2],u=this.chain_[3],h=this.chain_[4],d,p;for(let x=0;x<80;x++){x<40?x<20?(d=u^l&(o^u),p=1518500249):(d=l^o^u,p=1859775393):x<60?(d=l&o|u&(l|o),p=2400959708):(d=l^o^u,p=3395469782);const v=(i<<5|i>>>27)+d+h+p+n[x]&4294967295;h=u,u=o,o=(l<<30|l>>>2)&4294967295,l=i,i=v}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,r){if(e==null)return;r===void 0&&(r=e.length);const n=r-this.blockSize;let i=0;const l=this.buf_;let o=this.inbuf_;for(;i<r;){if(o===0)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<r;)if(l[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(l),o=0;break}}else for(;i<r;)if(l[o]=e[i],++o,++i,o===this.blockSize){this.compress_(l),o=0;break}}this.inbuf_=o,this.total_+=r}digest(){const e=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=r&255,r/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let l=24;l>=0;l-=8)e[n]=this.chain_[i]>>l&255,++n;return e}}function lA(t,e){const r=new cA(t,e);return r.subscribe.bind(r)}class cA{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");oA(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=dm),i.error===void 0&&(i.error=dm),i.complete===void 0&&(i.complete=dm);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function oA(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function dm(){}function Op(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i>=55296&&i<=56319){const l=i-55296;n++,Re(n<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(n)-56320;i=65536+(l<<10)+o}i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):i<65536?(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},_h=function(t){let e=0;for(let r=0;r<t.length;r++){const n=t.charCodeAt(r);n<128?e++:n<2048?e+=2:n>=55296&&n<=56319?(e+=4,r++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oa(t){return t&&t._delegate?t._delegate:t}class Zs{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Mu;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(dA(e))try{this.getOrInitializeService({instanceIdentifier:js})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const l=this.getOrInitializeService({instanceIdentifier:i});n.resolve(l)}catch{}}}}clearInstance(e=js){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=js){return this.instances.has(e)}getOptions(e=js){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[l,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(l);n===u&&o.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const l=this.instances.get(n);return l&&e(l,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:hA(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=js){return this.component?this.component.multipleInstances?e:js:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hA(t){return t===js?void 0:t}function dA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new fA(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ht;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ht||(Ht={}));const pA={debug:Ht.DEBUG,verbose:Ht.VERBOSE,info:Ht.INFO,warn:Ht.WARN,error:Ht.ERROR,silent:Ht.SILENT},gA=Ht.INFO,xA={[Ht.DEBUG]:"log",[Ht.VERBOSE]:"log",[Ht.INFO]:"info",[Ht.WARN]:"warn",[Ht.ERROR]:"error"},vA=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=xA[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Fp{constructor(e){this.name=e,this._logLevel=gA,this._logHandler=vA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ht))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ht.DEBUG,...e),this._logHandler(this,Ht.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ht.VERBOSE,...e),this._logHandler(this,Ht.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ht.INFO,...e),this._logHandler(this,Ht.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ht.WARN,...e),this._logHandler(this,Ht.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ht.ERROR,...e),this._logHandler(this,Ht.ERROR,...e)}}const _A=(t,e)=>e.some(r=>t instanceof r);let my,py;function yA(){return my||(my=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wA(){return py||(py=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nT=new WeakMap,qm=new WeakMap,aT=new WeakMap,mm=new WeakMap,Ip=new WeakMap;function EA(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",l),t.removeEventListener("error",o)},l=()=>{r(as(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",l),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&nT.set(r,t)}).catch(()=>{}),Ip.set(e,t),e}function TA(t){if(qm.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",o),t.removeEventListener("abort",o)},l=()=>{r(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",l),t.addEventListener("error",o),t.addEventListener("abort",o)});qm.set(t,e)}let Ym={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return qm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||aT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return as(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function SA(t){Ym=t(Ym)}function bA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(pm(this),e,...r);return aT.set(n,e.sort?e.sort():[e]),as(n)}:wA().includes(t)?function(...e){return t.apply(pm(this),e),as(nT.get(this))}:function(...e){return as(t.apply(pm(this),e))}}function CA(t){return typeof t=="function"?bA(t):(t instanceof IDBTransaction&&TA(t),_A(t,yA())?new Proxy(t,Ym):t)}function as(t){if(t instanceof IDBRequest)return EA(t);if(mm.has(t))return mm.get(t);const e=CA(t);return e!==t&&(mm.set(t,e),Ip.set(e,t)),e}const pm=t=>Ip.get(t);function kA(t,e,{blocked:r,upgrade:n,blocking:i,terminated:l}={}){const o=indexedDB.open(t,e),u=as(o);return n&&o.addEventListener("upgradeneeded",h=>{n(as(o.result),h.oldVersion,h.newVersion,as(o.transaction),h)}),r&&o.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{l&&h.addEventListener("close",()=>l()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const AA=["get","getKey","getAll","getAllKeys","count"],NA=["put","add","delete","clear"],gm=new Map;function gy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(gm.get(e))return gm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=NA.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||AA.includes(r)))return;const l=async function(o,...u){const h=this.transaction(o,i?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),i&&h.done]))[0]};return gm.set(e,l),l}SA(t=>({...t,get:(e,r,n)=>gy(e,r)||t.get(e,r,n),has:(e,r)=>!!gy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(RA(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function RA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Km="@firebase/app",xy="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi=new Fp("@firebase/app"),OA="@firebase/app-compat",FA="@firebase/analytics-compat",IA="@firebase/analytics",MA="@firebase/app-check-compat",LA="@firebase/app-check",BA="@firebase/auth",PA="@firebase/auth-compat",UA="@firebase/database",jA="@firebase/data-connect",HA="@firebase/database-compat",zA="@firebase/functions",VA="@firebase/functions-compat",GA="@firebase/installations",WA="@firebase/installations-compat",XA="@firebase/messaging",qA="@firebase/messaging-compat",YA="@firebase/performance",KA="@firebase/performance-compat",$A="@firebase/remote-config",QA="@firebase/remote-config-compat",ZA="@firebase/storage",JA="@firebase/storage-compat",eN="@firebase/firestore",tN="@firebase/ai",rN="@firebase/firestore-compat",nN="firebase",aN="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $m="[DEFAULT]",iN={[Km]:"fire-core",[OA]:"fire-core-compat",[IA]:"fire-analytics",[FA]:"fire-analytics-compat",[LA]:"fire-app-check",[MA]:"fire-app-check-compat",[BA]:"fire-auth",[PA]:"fire-auth-compat",[UA]:"fire-rtdb",[jA]:"fire-data-connect",[HA]:"fire-rtdb-compat",[zA]:"fire-fn",[VA]:"fire-fn-compat",[GA]:"fire-iid",[WA]:"fire-iid-compat",[XA]:"fire-fcm",[qA]:"fire-fcm-compat",[YA]:"fire-perf",[KA]:"fire-perf-compat",[$A]:"fire-rc",[QA]:"fire-rc-compat",[ZA]:"fire-gcs",[JA]:"fire-gcs-compat",[eN]:"fire-fst",[rN]:"fire-fst-compat",[tN]:"fire-vertex","fire-js":"fire-js",[nN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0=new Map,sN=new Map,Qm=new Map;function vy(t,e){try{t.container.addComponent(e)}catch(r){gi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Sc(t){const e=t.name;if(Qm.has(e))return gi.debug(`There were multiple attempts to register component ${e}.`),!1;Qm.set(e,t);for(const r of H0.values())vy(r,t);for(const r of sN.values())vy(r,t);return!0}function Mp(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ga(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},is=new Lu("app","Firebase",lN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Zs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw is.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic=aN;function iT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:$m,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw is.create("bad-app-name",{appName:String(i)});if(r||(r=QE()),!r)throw is.create("no-options");const l=H0.get(i);if(l){if(Qs(r,l.options)&&Qs(n,l.config))return l;throw is.create("duplicate-app",{appName:i})}const o=new mA(i);for(const h of Qm.values())o.addComponent(h);const u=new cN(r,n,o);return H0.set(i,u),u}function sT(t=$m){const e=H0.get(t);if(!e&&t===$m&&QE())return iT();if(!e)throw is.create("no-app",{appName:t});return e}function ss(t,e,r){let n=iN[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),l=e.match(/\s|\//);if(i||l){const o=[`Unable to register library "${n}" with version "${e}":`];i&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&l&&o.push("and"),l&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gi.warn(o.join(" "));return}Sc(new Zs(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN="firebase-heartbeat-database",uN=1,fu="firebase-heartbeat-store";let xm=null;function lT(){return xm||(xm=kA(oN,uN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(fu)}catch(r){console.warn(r)}}}}).catch(t=>{throw is.create("idb-open",{originalErrorMessage:t.message})})),xm}async function fN(t){try{const r=(await lT()).transaction(fu),n=await r.objectStore(fu).get(cT(t));return await r.done,n}catch(e){if(e instanceof gs)gi.warn(e.message);else{const r=is.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gi.warn(r.message)}}}async function _y(t,e){try{const n=(await lT()).transaction(fu,"readwrite");await n.objectStore(fu).put(e,cT(t)),await n.done}catch(r){if(r instanceof gs)gi.warn(r.message);else{const n=is.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});gi.warn(n.message)}}}function cT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN=1024,dN=30;class mN{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new gN(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=yy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(o=>o.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:i}),this._heartbeatsCache.heartbeats.length>dN){const o=xN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){gi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=yy(),{heartbeatsToSend:n,unsentEntries:i}=pN(this._heartbeatsCache.heartbeats),l=P0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(r){return gi.warn(r),""}}}function yy(){return new Date().toISOString().substring(0,10)}function pN(t,e=hN){const r=[];let n=t.slice();for(const i of t){const l=r.find(o=>o.agent===i.agent);if(l){if(l.dates.push(i.date),wy(r)>e){l.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),wy(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class gN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Jk()?eA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await fN(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return _y(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return _y(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function wy(t){return P0(JSON.stringify({version:2,heartbeats:t})).length}function xN(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN(t){Sc(new Zs("platform-logger",e=>new DA(e),"PRIVATE")),Sc(new Zs("heartbeat",e=>new mN(e),"PRIVATE")),ss(Km,xy,t),ss(Km,xy,"esm2020"),ss("fire-js","")}vN("");var _N="firebase",yN="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ss(_N,yN,"app");var Ey={};const Ty="@firebase/database",Sy="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oT="";function wN(t){oT=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,r){r==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Lr(r))}get(e){const r=this.domStorage_.getItem(this.prefixedName_(e));return r==null?null:uu(r)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,r){r==null?delete this.cache_[e]:this.cache_[e]=r}get(e){return ba(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uT=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new EN(e)}}catch{}return new TN},Vs=uT("localStorage"),SN=uT("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc=new Fp("@firebase/database"),fT=(function(){let t=1;return function(){return t++}})(),hT=function(t){const e=uA(t),r=new sA;r.update(e);const n=r.digest();return Np.encodeByteArray(n)},Bu=function(...t){let e="";for(let r=0;r<t.length;r++){const n=t[r];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?e+=Bu.apply(null,n):typeof n=="object"?e+=Lr(n):e+=n,e+=" "}return e};let Xo=null,by=!0;const bN=function(t,e){Re(!0,"Can't turn on custom loggers persistently."),dc.logLevel=Ht.VERBOSE,Xo=dc.log.bind(dc)},Zr=function(...t){if(by===!0&&(by=!1,Xo===null&&SN.get("logging_enabled")===!0&&bN()),Xo){const e=Bu.apply(null,t);Xo(e)}},Pu=function(t){return function(...e){Zr(t,...e)}},Zm=function(...t){const e="FIREBASE INTERNAL ERROR: "+Bu(...t);dc.error(e)},xi=function(...t){const e=`FIREBASE FATAL ERROR: ${Bu(...t)}`;throw dc.error(e),new Error(e)},bn=function(...t){const e="FIREBASE WARNING: "+Bu(...t);dc.warn(e)},CN=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&bn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Lp=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},kN=function(t){if(document.readyState==="complete")t();else{let e=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},bc="[MIN_NAME]",Js="[MAX_NAME]",Mc=function(t,e){if(t===e)return 0;if(t===bc||e===Js)return-1;if(e===bc||t===Js)return 1;{const r=Cy(t),n=Cy(e);return r!==null?n!==null?r-n===0?t.length-e.length:r-n:-1:n!==null?1:t<e?-1:1}},AN=function(t,e){return t===e?0:t<e?-1:1},Bo=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Lr(e))},Bp=function(t){if(typeof t!="object"||t===null)return Lr(t);const e=[];for(const n in t)e.push(n);e.sort();let r="{";for(let n=0;n<e.length;n++)n!==0&&(r+=","),r+=Lr(e[n]),r+=":",r+=Bp(t[e[n]]);return r+="}",r},dT=function(t,e){const r=t.length;if(r<=e)return[t];const n=[];for(let i=0;i<r;i+=e)i+e>r?n.push(t.substring(i,r)):n.push(t.substring(i,i+e));return n};function kn(t,e){for(const r in t)t.hasOwnProperty(r)&&e(r,t[r])}const mT=function(t){Re(!Lp(t),"Invalid JSON number");const e=11,r=52,n=(1<<e-1)-1;let i,l,o,u,h;t===0?(l=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-n)?(u=Math.min(Math.floor(Math.log(t)/Math.LN2),n),l=u+n,o=Math.round(t*Math.pow(2,r-u)-Math.pow(2,r))):(l=0,o=Math.round(t/Math.pow(2,1-n-r))));const d=[];for(h=r;h;h-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(h=e;h;h-=1)d.push(l%2?1:0),l=Math.floor(l/2);d.push(i?1:0),d.reverse();const p=d.join("");let x="";for(h=0;h<64;h+=8){let v=parseInt(p.substr(h,8),2).toString(16);v.length===1&&(v="0"+v),x=x+v}return x.toLowerCase()},NN=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},DN=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function RN(t,e){let r="Unknown Error";t==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?r="Client doesn't have permission to access the desired data.":t==="unavailable"&&(r="The service is unavailable");const n=new Error(t+" at "+e._path.toString()+": "+r);return n.code=t.toUpperCase(),n}const ON=new RegExp("^-?(0*)\\d{1,10}$"),FN=-2147483648,IN=2147483647,Cy=function(t){if(ON.test(t)){const e=Number(t);if(e>=FN&&e<=IN)return e}return null},Lc=function(t){try{t()}catch(e){setTimeout(()=>{const r=e.stack||"";throw bn("Exception was thrown by user callback.",r),e},Math.floor(0))}},MN=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qo=function(t,e){const r=setTimeout(t,e);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(e,r){this.appCheckProvider=r,this.appName=e.name,ga(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(n=>this.appCheck=n)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((r,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(r,n):r(null)},0)})}addTokenChangeListener(e){var r;(r=this.appCheckProvider)==null||r.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){bn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e,r,n){this.appName_=e,this.firebaseOptions_=r,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(r=>r&&r.code==="auth/token-not-initialized"?(Zr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(r,n):r(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(r=>r.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(r=>r.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',bn(e)}}class O0{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}O0.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp="5",pT="v",gT="s",xT="r",vT="f",_T=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,yT="ls",wT="p",Jm="ac",ET="websocket",TT="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e,r,n,i,l=!1,o="",u=!1,h=!1,d=null){this.secure=r,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=l,this.persistenceKey=o,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=h,this.emulatorOptions=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Vs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Vs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${r}`}}function PN(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function bT(t,e,r){Re(typeof e=="string","typeof type must == string"),Re(typeof r=="object","typeof params must == object");let n;if(e===ET)n=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===TT)n=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);PN(t)&&(r.ns=t.namespace);const i=[];return kn(r,(l,o)=>{i.push(l+"="+o)}),n+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(){this.counters_={}}incrementCounter(e,r=1){ba(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=r}get(){return Uk(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm={},_m={};function Up(t){const e=t.toString();return vm[e]||(vm[e]=new UN),vm[e]}function jN(t,e){const r=t.toString();return _m[r]||(_m[r]=e()),_m[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,r){this.closeAfterResponse=e,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,r){for(this.pendingResponses[e]=r;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<n.length;++i)n[i]&&Lc(()=>{this.onMessage_(n[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky="start",zN="close",VN="pLPCommand",GN="pRTLPCB",CT="id",kT="pw",AT="ser",WN="cb",XN="seg",qN="ts",YN="d",KN="dframe",NT=1870,DT=30,$N=NT-DT,QN=25e3,ZN=3e4;class oc{constructor(e,r,n,i,l,o,u){this.connId=e,this.repoInfo=r,this.applicationId=n,this.appCheckToken=i,this.authToken=l,this.transportSessionId=o,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Pu(e),this.stats_=Up(r),this.urlFn=h=>(this.appCheckToken&&(h[Jm]=this.appCheckToken),bT(r,TT,h))}open(e,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new HN(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(ZN)),kN(()=>{if(this.isClosed_)return;this.scriptTagHolder=new jp((...l)=>{const[o,u,h,d,p]=l;if(this.incrementIncomingBytes_(l),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===ky)this.id=u,this.password=h;else if(o===zN)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...l)=>{const[o,u]=l;this.incrementIncomingBytes_(l),this.myPacketOrderer.handleResponse(o,u)},()=>{this.onClosed_()},this.urlFn);const n={};n[ky]="t",n[AT]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[WN]=this.scriptTagHolder.uniqueCallbackIdentifier),n[pT]=Pp,this.transportSessionId&&(n[gT]=this.transportSessionId),this.lastSessionId&&(n[yT]=this.lastSessionId),this.applicationId&&(n[wT]=this.applicationId),this.appCheckToken&&(n[Jm]=this.appCheckToken),typeof location<"u"&&location.hostname&&_T.test(location.hostname)&&(n[xT]=vT);const i=this.urlFn(n);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){oc.forceAllow_=!0}static forceDisallow(){oc.forceDisallow_=!0}static isAvailable(){return oc.forceAllow_?!0:!oc.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!NN()&&!DN()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const r=Lr(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=YE(r),i=dT(n,$N);for(let l=0;l<i.length;l++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[l]),this.curSegmentNum++}addDisconnectPingFrame(e,r){this.myDisconnFrame=document.createElement("iframe");const n={};n[KN]="t",n[CT]=e,n[kT]=r,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const r=Lr(e).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class jp{constructor(e,r,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=fT(),window[VN+this.uniqueCallbackIdentifier]=e,window[GN+this.uniqueCallbackIdentifier]=r,this.myIFrame=jp.createIFrame_();let l="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(l='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+l+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(u){Zr("frame writing exception"),u.stack&&Zr(u.stack),Zr(u)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Zr("No IE domain setting required")}catch{const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,r){for(this.myID=e,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[CT]=this.myID,e[kT]=this.myPW,e[AT]=this.currentSerial;let r=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+DT+n.length<=NT;){const o=this.pendingSegs.shift();n=n+"&"+XN+i+"="+o.seg+"&"+qN+i+"="+o.ts+"&"+YN+i+"="+o.d,i++}return r=r+n,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(e,r,n){this.pendingSegs.push({seg:e,ts:r,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,r){this.outstandingRequests.add(r);const n=()=>{this.outstandingRequests.delete(r),this.newRequest_()},i=setTimeout(n,Math.floor(QN)),l=()=>{clearTimeout(i),n()};this.addTag(e,l)}addTag(e,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const i=n.readyState;(!i||i==="loaded"||i==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),r())},n.onerror=()=>{Zr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JN=16384,e6=45e3;let z0=null;typeof MozWebSocket<"u"?z0=MozWebSocket:typeof WebSocket<"u"&&(z0=WebSocket);class xa{constructor(e,r,n,i,l,o,u){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Pu(this.connId),this.stats_=Up(r),this.connURL=xa.connectionURL_(r,o,u,i,n),this.nodeAdmin=r.nodeAdmin}static connectionURL_(e,r,n,i,l){const o={};return o[pT]=Pp,typeof location<"u"&&location.hostname&&_T.test(location.hostname)&&(o[xT]=vT),r&&(o[gT]=r),n&&(o[yT]=n),i&&(o[Jm]=i),l&&(o[wT]=l),bT(e,ET,o)}open(e,r){this.onDisconnect=r,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Vs.set("previous_websocket_failure",!0);try{let n;Zk(),this.mySock=new z0(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){xa.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(r);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&z0!==null&&!xa.forceDisallow_}static previouslyFailed(){return Vs.isInMemoryStorage||Vs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Vs.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const n=uu(r);this.onMessage(n)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Re(this.frames===null,"We already have a frame buffer"),e.length<=6){const r=Number(e);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const r=e.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const n=this.extractFrameCount_(r);n!==null&&this.appendFrame_(n)}}send(e){this.resetKeepAlive();const r=Lr(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=dT(r,JN);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(e6))}sendString_(e){try{this.mySock.send(e)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}xa.responsesRequiredToBeHealthy=2;xa.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{static get ALL_TRANSPORTS(){return[oc,xa]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const r=xa&&xa.isAvailable();let n=r&&!xa.previouslyFailed();if(e.webSocketOnly&&(r||bn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[xa];else{const i=this.transports_=[];for(const l of hu.ALL_TRANSPORTS)l&&l.isAvailable()&&i.push(l);hu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}hu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6=6e4,r6=5e3,n6=10*1024,a6=100*1024,ym="t",Ay="d",i6="s",Ny="r",s6="e",Dy="o",Ry="a",Oy="n",Fy="p",l6="h";class c6{constructor(e,r,n,i,l,o,u,h,d,p){this.id=e,this.repoInfo_=r,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=l,this.onMessage_=o,this.onReady_=u,this.onDisconnect_=h,this.onKill_=d,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Pu("c:"+this.id+":"),this.transportManager_=new hu(r),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=qo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>a6?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>n6?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return r=>{e===this.conn_?this.onConnectionLost_(r):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return r=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(r):e===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(e){const r={t:"d",d:e};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ym in e){const r=e[ym];r===Ry?this.upgradeIfSecondaryHealthy_():r===Ny?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===Dy&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const r=Bo("t",e),n=Bo("d",e);if(r==="c")this.onSecondaryControl_(n);else if(r==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Fy,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Ry,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Oy,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const r=Bo("t",e),n=Bo("d",e);r==="c"?this.onControl_(n):r==="d"&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const r=Bo(ym,e);if(Ay in e){const n=e[Ay];if(r===l6){const i={...n};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(r===Oy){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===i6?this.onConnectionShutdown_(n):r===Ny?this.onReset_(n):r===s6?Zm("Server Error: "+n):r===Dy?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Zm("Unknown control packet command: "+r)}}onHandshake_(e){const r=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),Pp!==n&&bn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),qo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(t6))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,r){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(r6))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Fy,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Vs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{put(e,r,n,i){}merge(e,r,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,r,n){}onDisconnectMerge(e,r,n){}onDisconnectCancel(e,r){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(e){this.allowedEvents_=e,this.listeners_={},Re(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...r){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,r)}}on(e,r,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:r,context:n});const i=this.getInitialEvent(e);i&&r.apply(n,i)}off(e,r,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let l=0;l<i.length;l++)if(i[l].callback===r&&(!n||n===i[l].context)){i.splice(l,1);return}}validateEventType_(e){Re(this.allowedEvents_.find(r=>r===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0 extends OT{static getInstance(){return new V0}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Rp()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Re(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy=32,My=768;class Wt{constructor(e,r){if(r===void 0){this.pieces_=e.split("/");let n=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=r}toString(){let e="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(e+="/"+this.pieces_[r]);return e||"/"}}function Rt(){return new Wt("")}function dt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function os(t){return t.pieces_.length-t.pieceNum_}function Yt(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Wt(t.pieces_,e)}function FT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function o6(t){let e="";for(let r=t.pieceNum_;r<t.pieces_.length;r++)t.pieces_[r]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[r])));return e||"/"}function IT(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function MT(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let r=t.pieceNum_;r<t.pieces_.length-1;r++)e.push(t.pieces_[r]);return new Wt(e,0)}function Cr(t,e){const r=[];for(let n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);if(e instanceof Wt)for(let n=e.pieceNum_;n<e.pieces_.length;n++)r.push(e.pieces_[n]);else{const n=e.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&r.push(n[i])}return new Wt(r,0)}function vt(t){return t.pieceNum_>=t.pieces_.length}function Tn(t,e){const r=dt(t),n=dt(e);if(r===null)return e;if(r===n)return Tn(Yt(t),Yt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Hp(t,e){if(os(t)!==os(e))return!1;for(let r=t.pieceNum_,n=e.pieceNum_;r<=t.pieces_.length;r++,n++)if(t.pieces_[r]!==e.pieces_[n])return!1;return!0}function va(t,e){let r=t.pieceNum_,n=e.pieceNum_;if(os(t)>os(e))return!1;for(;r<t.pieces_.length;){if(t.pieces_[r]!==e.pieces_[n])return!1;++r,++n}return!0}class u6{constructor(e,r){this.errorPrefix_=r,this.parts_=IT(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=_h(this.parts_[n]);LT(this)}}function f6(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=_h(e),LT(t)}function h6(t){const e=t.parts_.pop();t.byteLength_-=_h(e),t.parts_.length>0&&(t.byteLength_-=1)}function LT(t){if(t.byteLength_>My)throw new Error(t.errorPrefix_+"has a key path longer than "+My+" bytes ("+t.byteLength_+").");if(t.parts_.length>Iy)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Iy+") or object contains a cycle "+Hs(t))}function Hs(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp extends OT{static getInstance(){return new zp}constructor(){super(["visible"]);let e,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const n=!document[e];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}getInitialEvent(e){return Re(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=1e3,d6=300*1e3,Ly=30*1e3,m6=1.3,p6=3e4,g6="server_kill",By=3;class di extends RT{constructor(e,r,n,i,l,o,u,h){if(super(),this.repoInfo_=e,this.applicationId_=r,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=l,this.authTokenProvider_=o,this.appCheckTokenProvider_=u,this.authOverride_=h,this.id=di.nextPersistentConnectionId_++,this.log_=Pu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Po,this.maxReconnectDelay_=d6,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,h)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");zp.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&V0.getInstance().on("online",this.onOnline_,this)}sendRequest(e,r,n){const i=++this.requestNumber_,l={r:i,a:e,b:r};this.log_(Lr(l)),Re(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const r=new Mu,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const u=o.d;o.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const l=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(l),r.promise}listen(e,r,n,i){this.initConnection_();const l=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+l),this.listens.has(o)||this.listens.set(o,new Map),Re(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Re(!this.listens.get(o).has(l),"listen() called twice for same path/queryId.");const u={onComplete:i,hashFn:r,query:e,tag:n};this.listens.get(o).set(l,u),this.connected_&&this.sendListen_(u)}sendGet_(e){const r=this.outstandingGets_[e];this.sendRequest("g",r.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(n)})}sendListen_(e){const r=e.query,n=r._path.toString(),i=r._queryIdentifier;this.log_("Listen on "+n+" for "+i);const l={p:n},o="q";e.tag&&(l.q=r._queryObject,l.t=e.tag),l.h=e.hashFn(),this.sendRequest(o,l,u=>{const h=u.d,d=u.s;di.warnOnListenWarnings_(h,r),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",u),d!=="ok"&&this.removeListen_(n,i),e.onComplete&&e.onComplete(d,h))})}static warnOnListenWarnings_(e,r){if(e&&typeof e=="object"&&ba(e,"w")){const n=$s(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const i='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();bn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||iA(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Ly)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,r=aA(e)?"auth":"gauth",n={cred:e};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(r,n,i=>{const l=i.s,o=i.d||"error";this.authToken_===e&&(l==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const r=e.s,n=e.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,n)})}unlisten(e,r){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),Re(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,r)}sendUnlisten_(e,r,n,i){this.log_("Unlisten on "+e+" for "+r);const l={p:e},o="n";i&&(l.q=n,l.t=i),this.sendRequest(o,l)}onDisconnectPut(e,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,r,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:r,onComplete:n})}onDisconnectMerge(e,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,r,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:r,onComplete:n})}onDisconnectCancel(e,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(e,r,n,i){const l={p:r,d:n};this.log_("onDisconnect "+e,l),this.sendRequest(e,l,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,r,n,i){this.putInternal("p",e,r,n,i)}merge(e,r,n,i){this.putInternal("m",e,r,n,i)}putInternal(e,r,n,i,l){this.initConnection_();const o={p:r,d:n};l!==void 0&&(o.h=l),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(e){const r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(l.s,l.d)})}reportStats(e){if(this.connected_){const r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,n=>{if(n.s!=="ok"){const l=n.d;this.log_("reportStats","Error sending stats: "+l)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Lr(e));const r=e.r,n=this.requestCBHash_[r];n&&(delete this.requestCBHash_[r],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,r){this.log_("handleServerMessage",e,r),e==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):e==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):e==="c"?this.onListenRevoked_(r.p,r.q):e==="ac"?this.onAuthRevoked_(r.s,r.d):e==="apc"?this.onAppCheckRevoked_(r.s,r.d):e==="sd"?this.onSecurityDebugPacket_(r):Zm("Unrecognized action received from server: "+Lr(e)+`
Are you using the latest client?`)}onReady_(e,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Re(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Po,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Po,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>p6&&(this.reconnectDelay_=Po),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-e);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*m6)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+di.nextConnectionId_++,l=this.lastSessionId;let o=!1,u=null;const h=function(){u?u.close():(o=!0,n())},d=function(x){Re(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(x)};this.realtime_={close:h,sendRequest:d};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[x,v]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?Zr("getToken() completed but was canceled"):(Zr("getToken() completed. Creating connection."),this.authToken_=x&&x.accessToken,this.appCheckToken_=v&&v.token,u=new c6(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,r,n,_=>{bn(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(g6)},l))}catch(x){this.log_("Failed to get token: "+x),o||(this.repoInfo_.nodeAdmin&&bn(x),h())}}}interrupt(e){Zr("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Zr("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Xm(this.interruptReasons_)&&(this.reconnectDelay_=Po,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const r=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const r=this.outstandingPuts_[e];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,r){let n;r?n=r.map(l=>Bp(l)).join("$"):n="default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,r){const n=new Wt(e).toString();let i;if(this.listens.has(n)){const l=this.listens.get(n);i=l.get(r),l.delete(r),l.size===0&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,r){Zr("Auth token revoked: "+e+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=By&&(this.reconnectDelay_=Ly,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,r){Zr("App check token revoked: "+e+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=By&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const r of e.values())this.sendListen_(r);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let r="js";e["sdk."+r+"."+oT.replace(/\./g,"-")]=1,Rp()?e["framework.cordova"]=1:tT()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=V0.getInstance().currentlyOnline();return Xm(this.interruptReasons_)&&e}}di.nextPersistentConnectionId_=0;di.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,r){this.name=e,this.node=r}static Wrap(e,r){return new mt(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,r){const n=new mt(bc,e),i=new mt(bc,r);return this.compare(n,i)!==0}minPost(){return mt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _0;class BT extends yh{static get __EMPTY_NODE(){return _0}static set __EMPTY_NODE(e){_0=e}compare(e,r){return Mc(e.name,r.name)}isDefinedOn(e){throw Rc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,r){return!1}minPost(){return mt.MIN}maxPost(){return new mt(Js,_0)}makePost(e,r){return Re(typeof e=="string","KeyIndex indexValue must always be a string."),new mt(e,_0)}toString(){return".key"}}const mc=new BT;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,r,n,i,l=null){this.isReverse_=i,this.resultGenerator_=l,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=r?n(e.key,r):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(e.key,e.value):r={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Fr{constructor(e,r,n,i,l){this.key=e,this.value=r,this.color=n??Fr.RED,this.left=i??Sn.EMPTY_NODE,this.right=l??Sn.EMPTY_NODE}copy(e,r,n,i,l){return new Fr(e??this.key,r??this.value,n??this.color,i??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const l=n(e,i.key);return l<0?i=i.copy(null,null,null,i.left.insert(e,r,n),null):l===0?i=i.copy(null,r,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Sn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,r){let n,i;if(n=this,r(e,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,r),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),r(e,n.key)===0){if(n.right.isEmpty())return Sn.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,r))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Fr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Fr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Fr.RED=!0;Fr.BLACK=!1;class x6{copy(e,r,n,i,l){return this}insert(e,r,n){return new Fr(e,r,null)}remove(e,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Sn{constructor(e,r=Sn.EMPTY_NODE){this.comparator_=e,this.root_=r}insert(e,r){return new Sn(this.comparator_,this.root_.insert(e,r,this.comparator_).copy(null,null,Fr.BLACK,null,null))}remove(e){return new Sn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Fr.BLACK,null,null))}get(e){let r,n=this.root_;for(;!n.isEmpty();){if(r=this.comparator_(e,n.key),r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}getPredecessorKey(e){let r,n=this.root_,i=null;for(;!n.isEmpty();)if(r=this.comparator_(e,n.key),r===0){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else r<0?n=n.left:r>0&&(i=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new y0(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,r){return new y0(this.root_,e,this.comparator_,!1,r)}getReverseIteratorFrom(e,r){return new y0(this.root_,e,this.comparator_,!0,r)}getReverseIterator(e){return new y0(this.root_,null,this.comparator_,!0,e)}}Sn.EMPTY_NODE=new x6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v6(t,e){return Mc(t.name,e.name)}function Vp(t,e){return Mc(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep;function _6(t){ep=t}const PT=function(t){return typeof t=="number"?"number:"+mT(t):"string:"+t},UT=function(t){if(t.isLeafNode()){const e=t.val();Re(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ba(e,".sv"),"Priority must be a string or number.")}else Re(t===ep||t.isEmpty(),"priority of unexpected type.");Re(t===ep||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Py;class Rr{static set __childrenNodeConstructor(e){Py=e}static get __childrenNodeConstructor(){return Py}constructor(e,r=Rr.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=r,this.lazyHash_=null,Re(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),UT(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Rr(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Rr.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return vt(e)?this:dt(e)===".priority"?this.priorityNode_:Rr.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,r){return null}updateImmediateChild(e,r){return e===".priority"?this.updatePriority(r):r.isEmpty()&&e!==".priority"?this:Rr.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,r).updatePriority(this.priorityNode_)}updateChild(e,r){const n=dt(e);return n===null?r:r.isEmpty()&&n!==".priority"?this:(Re(n!==".priority"||os(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,Rr.__childrenNodeConstructor.EMPTY_NODE.updateChild(Yt(e),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,r){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+PT(this.priorityNode_.val())+":");const r=typeof this.value_;e+=r+":",r==="number"?e+=mT(this.value_):e+=this.value_,this.lazyHash_=hT(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Rr.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Rr.__childrenNodeConstructor?-1:(Re(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const r=typeof e.value_,n=typeof this.value_,i=Rr.VALUE_TYPE_ORDER.indexOf(r),l=Rr.VALUE_TYPE_ORDER.indexOf(n);return Re(i>=0,"Unknown leaf type: "+r),Re(l>=0,"Unknown leaf type: "+n),i===l?n==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:l-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const r=e;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}Rr.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jT,HT;function y6(t){jT=t}function w6(t){HT=t}class E6 extends yh{compare(e,r){const n=e.node.getPriority(),i=r.node.getPriority(),l=n.compareTo(i);return l===0?Mc(e.name,r.name):l}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,r){return!e.getPriority().equals(r.getPriority())}minPost(){return mt.MIN}maxPost(){return new mt(Js,new Rr("[PRIORITY-POST]",HT))}makePost(e,r){const n=jT(e);return new mt(r,new Rr("[PRIORITY-POST]",n))}toString(){return".priority"}}const nr=new E6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6=Math.log(2);class S6{constructor(e){const r=l=>parseInt(Math.log(l)/T6,10),n=l=>parseInt(Array(l+1).join("1"),2);this.count=r(e+1),this.current_=this.count-1;const i=n(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const G0=function(t,e,r,n){t.sort(e);const i=function(h,d){const p=d-h;let x,v;if(p===0)return null;if(p===1)return x=t[h],v=r?r(x):x,new Fr(v,x.node,Fr.BLACK,null,null);{const _=parseInt(p/2,10)+h,E=i(h,_),w=i(_+1,d);return x=t[_],v=r?r(x):x,new Fr(v,x.node,Fr.BLACK,E,w)}},l=function(h){let d=null,p=null,x=t.length;const v=function(E,w){const S=x-E,N=x;x-=E;const M=i(S+1,N),C=t[S],z=r?r(C):C;_(new Fr(z,C.node,w,null,M))},_=function(E){d?(d.left=E,d=E):(p=E,d=E)};for(let E=0;E<h.count;++E){const w=h.nextBitIsOne(),S=Math.pow(2,h.count-(E+1));w?v(S,Fr.BLACK):(v(S,Fr.BLACK),v(S,Fr.RED))}return p},o=new S6(t.length),u=l(o);return new Sn(n||e,u)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wm;const nc={};class oi{static get Default(){return Re(nc&&nr,"ChildrenNode.ts has not been loaded"),wm=wm||new oi({".priority":nc},{".priority":nr}),wm}constructor(e,r){this.indexes_=e,this.indexSet_=r}get(e){const r=$s(this.indexes_,e);if(!r)throw new Error("No index defined for "+e);return r instanceof Sn?r:null}hasIndex(e){return ba(this.indexSet_,e.toString())}addIndex(e,r){Re(e!==mc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const l=r.getIterator(mt.Wrap);let o=l.getNext();for(;o;)i=i||e.isDefinedOn(o.node),n.push(o),o=l.getNext();let u;i?u=G0(n,e.getCompare()):u=nc;const h=e.toString(),d={...this.indexSet_};d[h]=e;const p={...this.indexes_};return p[h]=u,new oi(p,d)}addToIndexes(e,r){const n=j0(this.indexes_,(i,l)=>{const o=$s(this.indexSet_,l);if(Re(o,"Missing index implementation for "+l),i===nc)if(o.isDefinedOn(e.node)){const u=[],h=r.getIterator(mt.Wrap);let d=h.getNext();for(;d;)d.name!==e.name&&u.push(d),d=h.getNext();return u.push(e),G0(u,o.getCompare())}else return nc;else{const u=r.get(e.name);let h=i;return u&&(h=h.remove(new mt(e.name,u))),h.insert(e,e.node)}});return new oi(n,this.indexSet_)}removeFromIndexes(e,r){const n=j0(this.indexes_,i=>{if(i===nc)return i;{const l=r.get(e.name);return l?i.remove(new mt(e.name,l)):i}});return new oi(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uo;class et{static get EMPTY_NODE(){return Uo||(Uo=new et(new Sn(Vp),null,oi.Default))}constructor(e,r,n){this.children_=e,this.priorityNode_=r,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&UT(this.priorityNode_),this.children_.isEmpty()&&Re(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Uo}updatePriority(e){return this.children_.isEmpty()?this:new et(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const r=this.children_.get(e);return r===null?Uo:r}}getChild(e){const r=dt(e);return r===null?this:this.getImmediateChild(r).getChild(Yt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,r){if(Re(r,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(r);{const n=new mt(e,r);let i,l;r.isEmpty()?(i=this.children_.remove(e),l=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,r),l=this.indexMap_.addToIndexes(n,this.children_));const o=i.isEmpty()?Uo:this.priorityNode_;return new et(i,o,l)}}updateChild(e,r){const n=dt(e);if(n===null)return r;{Re(dt(e)!==".priority"||os(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(Yt(e),r);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const r={};let n=0,i=0,l=!0;if(this.forEachChild(nr,(o,u)=>{r[o]=u.val(e),n++,l&&et.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):l=!1}),!e&&l&&i<2*n){const o=[];for(const u in r)o[u]=r[u];return o}else return e&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+PT(this.getPriority().val())+":"),this.forEachChild(nr,(r,n)=>{const i=n.hash();i!==""&&(e+=":"+r+":"+i)}),this.lazyHash_=e===""?"":hT(e)}return this.lazyHash_}getPredecessorChildName(e,r,n){const i=this.resolveIndex_(n);if(i){const l=i.getPredecessorKey(new mt(e,r));return l?l.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const r=this.resolveIndex_(e);if(r){const n=r.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(e){const r=this.getFirstChildName(e);return r?new mt(r,this.children_.get(r)):null}getLastChildName(e){const r=this.resolveIndex_(e);if(r){const n=r.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(e){const r=this.getLastChildName(e);return r?new mt(r,this.children_.get(r)):null}forEachChild(e,r){const n=this.resolveIndex_(e);return n?n.inorderTraversal(i=>r(i.name,i.node)):this.children_.inorderTraversal(r)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,r){const n=this.resolveIndex_(r);if(n)return n.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,mt.Wrap);let l=i.peek();for(;l!=null&&r.compare(l,e)<0;)i.getNext(),l=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,r){const n=this.resolveIndex_(r);if(n)return n.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,mt.Wrap);let l=i.peek();for(;l!=null&&r.compare(l,e)>0;)i.getNext(),l=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Uu?-1:0}withIndex(e){if(e===mc||this.indexMap_.hasIndex(e))return this;{const r=this.indexMap_.addIndex(e,this.children_);return new et(this.children_,this.priorityNode_,r)}}isIndexed(e){return e===mc||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const r=e;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const n=this.getIterator(nr),i=r.getIterator(nr);let l=n.getNext(),o=i.getNext();for(;l&&o;){if(l.name!==o.name||!l.node.equals(o.node))return!1;l=n.getNext(),o=i.getNext()}return l===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===mc?null:this.indexMap_.get(e.toString())}}et.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class b6 extends et{constructor(){super(new Sn(Vp),et.EMPTY_NODE,oi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return et.EMPTY_NODE}isEmpty(){return!1}}const Uu=new b6;Object.defineProperties(mt,{MIN:{value:new mt(bc,et.EMPTY_NODE)},MAX:{value:new mt(Js,Uu)}});BT.__EMPTY_NODE=et.EMPTY_NODE;Rr.__childrenNodeConstructor=et;_6(Uu);w6(Uu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=!0;function Ir(t,e=null){if(t===null)return et.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),Re(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const r=t;return new Rr(r,Ir(e))}if(!(t instanceof Array)&&C6){const r=[];let n=!1;if(kn(t,(o,u)=>{if(o.substring(0,1)!=="."){const h=Ir(u);h.isEmpty()||(n=n||!h.getPriority().isEmpty(),r.push(new mt(o,h)))}}),r.length===0)return et.EMPTY_NODE;const l=G0(r,v6,o=>o.name,Vp);if(n){const o=G0(r,nr.getCompare());return new et(l,Ir(e),new oi({".priority":o},{".priority":nr}))}else return new et(l,Ir(e),oi.Default)}else{let r=et.EMPTY_NODE;return kn(t,(n,i)=>{if(ba(t,n)&&n.substring(0,1)!=="."){const l=Ir(i);(l.isLeafNode()||!l.isEmpty())&&(r=r.updateImmediateChild(n,l))}}),r.updatePriority(Ir(e))}}y6(Ir);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6 extends yh{constructor(e){super(),this.indexPath_=e,Re(!vt(e)&&dt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,r){const n=this.extractChild(e.node),i=this.extractChild(r.node),l=n.compareTo(i);return l===0?Mc(e.name,r.name):l}makePost(e,r){const n=Ir(e),i=et.EMPTY_NODE.updateChild(this.indexPath_,n);return new mt(r,i)}maxPost(){const e=et.EMPTY_NODE.updateChild(this.indexPath_,Uu);return new mt(Js,e)}toString(){return IT(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6 extends yh{compare(e,r){const n=e.node.compareTo(r.node);return n===0?Mc(e.name,r.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,r){return!e.equals(r)}minPost(){return mt.MIN}maxPost(){return mt.MAX}makePost(e,r){const n=Ir(e);return new mt(r,n)}toString(){return".value"}}const N6=new A6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(t){return{type:"value",snapshotNode:t}}function Cc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function du(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function mu(t,e,r){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:r}}function D6(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e){this.index_=e}updateChild(e,r,n,i,l,o){Re(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const u=e.getImmediateChild(r);return u.getChild(i).equals(n.getChild(i))&&u.isEmpty()===n.isEmpty()||(o!=null&&(n.isEmpty()?e.hasChild(r)?o.trackChildChange(du(r,u)):Re(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?o.trackChildChange(Cc(r,n)):o.trackChildChange(mu(r,n,u))),e.isLeafNode()&&n.isEmpty())?e:e.updateImmediateChild(r,n).withIndex(this.index_)}updateFullNode(e,r,n){return n!=null&&(e.isLeafNode()||e.forEachChild(nr,(i,l)=>{r.hasChild(i)||n.trackChildChange(du(i,l))}),r.isLeafNode()||r.forEachChild(nr,(i,l)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(l)||n.trackChildChange(mu(i,l,o))}else n.trackChildChange(Cc(i,l))})),r.withIndex(this.index_)}updatePriority(e,r){return e.isEmpty()?et.EMPTY_NODE:e.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this.indexedFilter_=new Gp(e.getIndex()),this.index_=e.getIndex(),this.startPost_=pu.getStartPost_(e),this.endPost_=pu.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return r&&n}updateChild(e,r,n,i,l,o){return this.matches(new mt(r,n))||(n=et.EMPTY_NODE),this.indexedFilter_.updateChild(e,r,n,i,l,o)}updateFullNode(e,r,n){r.isLeafNode()&&(r=et.EMPTY_NODE);let i=r.withIndex(this.index_);i=i.updatePriority(et.EMPTY_NODE);const l=this;return r.forEachChild(nr,(o,u)=>{l.matches(new mt(o,u))||(i=i.updateImmediateChild(o,et.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,r){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const r=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),r)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const r=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),r)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const n=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=r=>{const n=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new pu(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,r,n,i,l,o){return this.rangedFilter_.matches(new mt(r,n))||(n=et.EMPTY_NODE),e.getImmediateChild(r).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,r,n,i,l,o):this.fullLimitUpdateChild_(e,r,n,l,o)}updateFullNode(e,r,n){let i;if(r.isLeafNode()||r.isEmpty())i=et.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){i=et.EMPTY_NODE.withIndex(this.index_);let l;this.reverse_?l=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):l=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;l.hasNext()&&o<this.limit_;){const u=l.getNext();if(this.withinDirectionalStart(u))if(this.withinDirectionalEnd(u))i=i.updateImmediateChild(u.name,u.node),o++;else break;else continue}}else{i=r.withIndex(this.index_),i=i.updatePriority(et.EMPTY_NODE);let l;this.reverse_?l=i.getReverseIterator(this.index_):l=i.getIterator(this.index_);let o=0;for(;l.hasNext();){const u=l.getNext();o<this.limit_&&this.withinDirectionalStart(u)&&this.withinDirectionalEnd(u)?o++:i=i.updateImmediateChild(u.name,et.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,r){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,r,n,i,l){let o;if(this.reverse_){const x=this.index_.getCompare();o=(v,_)=>x(_,v)}else o=this.index_.getCompare();const u=e;Re(u.numChildren()===this.limit_,"");const h=new mt(r,n),d=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),p=this.rangedFilter_.matches(h);if(u.hasChild(r)){const x=u.getImmediateChild(r);let v=i.getChildAfterChild(this.index_,d,this.reverse_);for(;v!=null&&(v.name===r||u.hasChild(v.name));)v=i.getChildAfterChild(this.index_,v,this.reverse_);const _=v==null?1:o(v,h);if(p&&!n.isEmpty()&&_>=0)return l!=null&&l.trackChildChange(mu(r,n,x)),u.updateImmediateChild(r,n);{l!=null&&l.trackChildChange(du(r,x));const w=u.updateImmediateChild(r,et.EMPTY_NODE);return v!=null&&this.rangedFilter_.matches(v)?(l!=null&&l.trackChildChange(Cc(v.name,v.node)),w.updateImmediateChild(v.name,v.node)):w}}else return n.isEmpty()?e:p&&o(d,h)>=0?(l!=null&&(l.trackChildChange(du(d.name,d.node)),l.trackChildChange(Cc(r,n))),u.updateImmediateChild(r,n).updateImmediateChild(d.name,et.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=nr}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Re(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Re(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:bc}hasEnd(){return this.endSet_}getIndexEndValue(){return Re(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Re(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Js}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Re(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===nr}copy(){const e=new Wp;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function O6(t){return t.loadsAllData()?new Gp(t.getIndex()):t.hasLimit()?new R6(t):new pu(t)}function Uy(t){const e={};if(t.isDefault())return e;let r;if(t.index_===nr?r="$priority":t.index_===N6?r="$value":t.index_===mc?r="$key":(Re(t.index_ instanceof k6,"Unrecognized index type!"),r=t.index_.toString()),e.orderBy=Lr(r),t.startSet_){const n=t.startAfterSet_?"startAfter":"startAt";e[n]=Lr(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+Lr(t.indexStartName_))}if(t.endSet_){const n=t.endBeforeSet_?"endBefore":"endAt";e[n]=Lr(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+Lr(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function jy(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let r=t.viewFrom_;r===""&&(t.isViewFromLeft()?r="l":r="r"),e.vf=r}return t.index_!==nr&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0 extends RT{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,r){return r!==void 0?"tag$"+r:(Re(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,r,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=r,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Pu("p:rest:"),this.listens_={}}listen(e,r,n,i){const l=e._path.toString();this.log_("Listen called for "+l+" "+e._queryIdentifier);const o=W0.getListenId_(e,n),u={};this.listens_[o]=u;const h=Uy(e._queryParams);this.restRequest_(l+".json",h,(d,p)=>{let x=p;if(d===404&&(x=null,d=null),d===null&&this.onDataUpdate_(l,x,!1,n),$s(this.listens_,o)===u){let v;d?d===401?v="permission_denied":v="rest_error:"+d:v="ok",i(v,null)}})}unlisten(e,r){const n=W0.getListenId_(e,r);delete this.listens_[n]}get(e){const r=Uy(e._queryParams),n=e._path.toString(),i=new Mu;return this.restRequest_(n+".json",r,(l,o)=>{let u=o;l===404&&(u=null,l=null),l===null?(this.onDataUpdate_(n,u,!1,null),i.resolve(u)):i.reject(new Error(u))}),i.promise}refreshAuthToken(e){}restRequest_(e,r={},n){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,l])=>{i&&i.accessToken&&(r.auth=i.accessToken),l&&l.token&&(r.ac=l.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Fc(r);this.log_("Sending REST request for "+o);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(n&&u.readyState===4){this.log_("REST Response for "+o+" received. status:",u.status,"response:",u.responseText);let h=null;if(u.status>=200&&u.status<300){try{h=uu(u.responseText)}catch{bn("Failed to parse JSON response for "+o+": "+u.responseText)}n(null,h)}else u.status!==401&&u.status!==404&&bn("Got unsuccessful REST response for "+o+" Status: "+u.status),n(u.status);n=null}},u.open("GET",o,!0),u.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(){this.rootNode_=et.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,r){this.rootNode_=this.rootNode_.updateChild(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(){return{value:null,children:new Map}}function VT(t,e,r){if(vt(e))t.value=r,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,r);else{const n=dt(e);t.children.has(n)||t.children.set(n,X0());const i=t.children.get(n);e=Yt(e),VT(i,e,r)}}function tp(t,e,r){t.value!==null?r(e,t.value):I6(t,(n,i)=>{const l=new Wt(e.toString()+"/"+n);tp(i,l,r)})}function I6(t,e){t.children.forEach((r,n)=>{e(n,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),r={...e};return this.last_&&kn(this.last_,(n,i)=>{r[n]=r[n]-i}),this.last_=e,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy=10*1e3,L6=30*1e3,B6=300*1e3;class P6{constructor(e,r){this.server_=r,this.statsToReport_={},this.statsListener_=new M6(e);const n=Hy+(L6-Hy)*Math.random();qo(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),r={};let n=!1;kn(e,(i,l)=>{l>0&&ba(this.statsToReport_,i)&&(r[i]=l,n=!0)}),n&&this.server_.reportStats(r),qo(this.reportStats_.bind(this),Math.floor(Math.random()*2*B6))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(_a||(_a={}));function GT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Xp(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function qp(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(e,r,n){this.path=e,this.affectedTree=r,this.revert=n,this.type=_a.ACK_USER_WRITE,this.source=GT()}operationForChild(e){if(vt(this.path)){if(this.affectedTree.value!=null)return Re(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Wt(e));return new q0(Rt(),r,this.revert)}}else return Re(dt(this.path)===e,"operationForChild called for unrelated child."),new q0(Yt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,r){this.source=e,this.path=r,this.type=_a.LISTEN_COMPLETE}operationForChild(e){return vt(this.path)?new gu(this.source,Rt()):new gu(this.source,Yt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,r,n){this.source=e,this.path=r,this.snap=n,this.type=_a.OVERWRITE}operationForChild(e){return vt(this.path)?new el(this.source,Rt(),this.snap.getImmediateChild(e)):new el(this.source,Yt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,r,n){this.source=e,this.path=r,this.children=n,this.type=_a.MERGE}operationForChild(e){if(vt(this.path)){const r=this.children.subtree(new Wt(e));return r.isEmpty()?null:r.value?new el(this.source,Rt(),r.value):new xu(this.source,Rt(),r)}else return Re(dt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new xu(this.source,Yt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,r,n){this.node_=e,this.fullyInitialized_=r,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(vt(e))return this.isFullyInitialized()&&!this.filtered_;const r=dt(e);return this.isCompleteForChild(r)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U6{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function j6(t,e,r,n){const i=[],l=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&l.push(D6(o.childName,o.snapshotNode))}),jo(t,i,"child_removed",e,n,r),jo(t,i,"child_added",e,n,r),jo(t,i,"child_moved",l,n,r),jo(t,i,"child_changed",e,n,r),jo(t,i,"value",e,n,r),i}function jo(t,e,r,n,i,l){const o=n.filter(u=>u.type===r);o.sort((u,h)=>z6(t,u,h)),o.forEach(u=>{const h=H6(t,u,l);i.forEach(d=>{d.respondsTo(u.type)&&e.push(d.createEvent(h,t.query_))})})}function H6(t,e,r){return e.type==="value"||e.type==="child_removed"||(e.prevName=r.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function z6(t,e,r){if(e.childName==null||r.childName==null)throw Rc("Should only compare child_ events.");const n=new mt(e.childName,e.snapshotNode),i=new mt(r.childName,r.snapshotNode);return t.index_.compare(n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t,e){return{eventCache:t,serverCache:e}}function Yo(t,e,r,n){return wh(new tl(e,r,n),t.serverCache)}function WT(t,e,r,n){return wh(t.eventCache,new tl(e,r,n))}function rp(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function rl(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Em;const V6=()=>(Em||(Em=new Sn(AN)),Em);class Qt{static fromObject(e){let r=new Qt(null);return kn(e,(n,i)=>{r=r.set(new Wt(n),i)}),r}constructor(e,r=V6()){this.value=e,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,r){if(this.value!=null&&r(this.value))return{path:Rt(),value:this.value};if(vt(e))return null;{const n=dt(e),i=this.children.get(n);if(i!==null){const l=i.findRootMostMatchingPathAndValue(Yt(e),r);return l!=null?{path:Cr(new Wt(n),l.path),value:l.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(vt(e))return this;{const r=dt(e),n=this.children.get(r);return n!==null?n.subtree(Yt(e)):new Qt(null)}}set(e,r){if(vt(e))return new Qt(r,this.children);{const n=dt(e),l=(this.children.get(n)||new Qt(null)).set(Yt(e),r),o=this.children.insert(n,l);return new Qt(this.value,o)}}remove(e){if(vt(e))return this.children.isEmpty()?new Qt(null):new Qt(null,this.children);{const r=dt(e),n=this.children.get(r);if(n){const i=n.remove(Yt(e));let l;return i.isEmpty()?l=this.children.remove(r):l=this.children.insert(r,i),this.value===null&&l.isEmpty()?new Qt(null):new Qt(this.value,l)}else return this}}get(e){if(vt(e))return this.value;{const r=dt(e),n=this.children.get(r);return n?n.get(Yt(e)):null}}setTree(e,r){if(vt(e))return r;{const n=dt(e),l=(this.children.get(n)||new Qt(null)).setTree(Yt(e),r);let o;return l.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,l),new Qt(this.value,o)}}fold(e){return this.fold_(Rt(),e)}fold_(e,r){const n={};return this.children.inorderTraversal((i,l)=>{n[i]=l.fold_(Cr(e,i),r)}),r(e,this.value,n)}findOnPath(e,r){return this.findOnPath_(e,Rt(),r)}findOnPath_(e,r,n){const i=this.value?n(r,this.value):!1;if(i)return i;if(vt(e))return null;{const l=dt(e),o=this.children.get(l);return o?o.findOnPath_(Yt(e),Cr(r,l),n):null}}foreachOnPath(e,r){return this.foreachOnPath_(e,Rt(),r)}foreachOnPath_(e,r,n){if(vt(e))return this;{this.value&&n(r,this.value);const i=dt(e),l=this.children.get(i);return l?l.foreachOnPath_(Yt(e),Cr(r,i),n):new Qt(null)}}foreach(e){this.foreach_(Rt(),e)}foreach_(e,r){this.children.inorderTraversal((n,i)=>{i.foreach_(Cr(e,n),r)}),this.value&&r(e,this.value)}foreachChild(e){this.children.inorderTraversal((r,n)=>{n.value&&e(r,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e){this.writeTree_=e}static empty(){return new Ea(new Qt(null))}}function Ko(t,e,r){if(vt(e))return new Ea(new Qt(r));{const n=t.writeTree_.findRootMostValueAndPath(e);if(n!=null){const i=n.path;let l=n.value;const o=Tn(i,e);return l=l.updateChild(o,r),new Ea(t.writeTree_.set(i,l))}else{const i=new Qt(r),l=t.writeTree_.setTree(e,i);return new Ea(l)}}}function zy(t,e,r){let n=t;return kn(r,(i,l)=>{n=Ko(n,Cr(e,i),l)}),n}function Vy(t,e){if(vt(e))return Ea.empty();{const r=t.writeTree_.setTree(e,new Qt(null));return new Ea(r)}}function np(t,e){return fl(t,e)!=null}function fl(t,e){const r=t.writeTree_.findRootMostValueAndPath(e);return r!=null?t.writeTree_.get(r.path).getChild(Tn(r.path,e)):null}function Gy(t){const e=[],r=t.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(nr,(n,i)=>{e.push(new mt(n,i))}):t.writeTree_.children.inorderTraversal((n,i)=>{i.value!=null&&e.push(new mt(n,i.value))}),e}function ls(t,e){if(vt(e))return t;{const r=fl(t,e);return r!=null?new Ea(new Qt(r)):new Ea(t.writeTree_.subtree(e))}}function ap(t){return t.writeTree_.isEmpty()}function kc(t,e){return XT(Rt(),t.writeTree_,e)}function XT(t,e,r){if(e.value!=null)return r.updateChild(t,e.value);{let n=null;return e.children.inorderTraversal((i,l)=>{i===".priority"?(Re(l.value!==null,"Priority writes must always be leaf nodes"),n=l.value):r=XT(Cr(t,i),l,r)}),!r.getChild(t).isEmpty()&&n!==null&&(r=r.updateChild(Cr(t,".priority"),n)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(t,e){return $T(e,t)}function G6(t,e,r,n,i){Re(n>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:r,writeId:n,visible:i}),i&&(t.visibleWrites=Ko(t.visibleWrites,e,r)),t.lastWriteId=n}function W6(t,e){for(let r=0;r<t.allWrites.length;r++){const n=t.allWrites[r];if(n.writeId===e)return n}return null}function X6(t,e){const r=t.allWrites.findIndex(u=>u.writeId===e);Re(r>=0,"removeWrite called with nonexistent writeId.");const n=t.allWrites[r];t.allWrites.splice(r,1);let i=n.visible,l=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const u=t.allWrites[o];u.visible&&(o>=r&&q6(u,n.path)?i=!1:va(n.path,u.path)&&(l=!0)),o--}if(i){if(l)return Y6(t),!0;if(n.snap)t.visibleWrites=Vy(t.visibleWrites,n.path);else{const u=n.children;kn(u,h=>{t.visibleWrites=Vy(t.visibleWrites,Cr(n.path,h))})}return!0}else return!1}function q6(t,e){if(t.snap)return va(t.path,e);for(const r in t.children)if(t.children.hasOwnProperty(r)&&va(Cr(t.path,r),e))return!0;return!1}function Y6(t){t.visibleWrites=qT(t.allWrites,K6,Rt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function K6(t){return t.visible}function qT(t,e,r){let n=Ea.empty();for(let i=0;i<t.length;++i){const l=t[i];if(e(l)){const o=l.path;let u;if(l.snap)va(r,o)?(u=Tn(r,o),n=Ko(n,u,l.snap)):va(o,r)&&(u=Tn(o,r),n=Ko(n,Rt(),l.snap.getChild(u)));else if(l.children){if(va(r,o))u=Tn(r,o),n=zy(n,u,l.children);else if(va(o,r))if(u=Tn(o,r),vt(u))n=zy(n,Rt(),l.children);else{const h=$s(l.children,dt(u));if(h){const d=h.getChild(Yt(u));n=Ko(n,Rt(),d)}}}else throw Rc("WriteRecord should have .snap or .children")}}return n}function YT(t,e,r,n,i){if(!n&&!i){const l=fl(t.visibleWrites,e);if(l!=null)return l;{const o=ls(t.visibleWrites,e);if(ap(o))return r;if(r==null&&!np(o,Rt()))return null;{const u=r||et.EMPTY_NODE;return kc(o,u)}}}else{const l=ls(t.visibleWrites,e);if(!i&&ap(l))return r;if(!i&&r==null&&!np(l,Rt()))return null;{const o=function(d){return(d.visible||i)&&(!n||!~n.indexOf(d.writeId))&&(va(d.path,e)||va(e,d.path))},u=qT(t.allWrites,o,e),h=r||et.EMPTY_NODE;return kc(u,h)}}}function $6(t,e,r){let n=et.EMPTY_NODE;const i=fl(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(nr,(l,o)=>{n=n.updateImmediateChild(l,o)}),n;if(r){const l=ls(t.visibleWrites,e);return r.forEachChild(nr,(o,u)=>{const h=kc(ls(l,new Wt(o)),u);n=n.updateImmediateChild(o,h)}),Gy(l).forEach(o=>{n=n.updateImmediateChild(o.name,o.node)}),n}else{const l=ls(t.visibleWrites,e);return Gy(l).forEach(o=>{n=n.updateImmediateChild(o.name,o.node)}),n}}function Q6(t,e,r,n,i){Re(n||i,"Either existingEventSnap or existingServerSnap must exist");const l=Cr(e,r);if(np(t.visibleWrites,l))return null;{const o=ls(t.visibleWrites,l);return ap(o)?i.getChild(r):kc(o,i.getChild(r))}}function Z6(t,e,r,n){const i=Cr(e,r),l=fl(t.visibleWrites,i);if(l!=null)return l;if(n.isCompleteForChild(r)){const o=ls(t.visibleWrites,i);return kc(o,n.getNode().getImmediateChild(r))}else return null}function J6(t,e){return fl(t.visibleWrites,e)}function e8(t,e,r,n,i,l,o){let u;const h=ls(t.visibleWrites,e),d=fl(h,Rt());if(d!=null)u=d;else if(r!=null)u=kc(h,r);else return[];if(u=u.withIndex(o),!u.isEmpty()&&!u.isLeafNode()){const p=[],x=o.getCompare(),v=l?u.getReverseIteratorFrom(n,o):u.getIteratorFrom(n,o);let _=v.getNext();for(;_&&p.length<i;)x(_,n)!==0&&p.push(_),_=v.getNext();return p}else return[]}function t8(){return{visibleWrites:Ea.empty(),allWrites:[],lastWriteId:-1}}function Y0(t,e,r,n){return YT(t.writeTree,t.treePath,e,r,n)}function Kp(t,e){return $6(t.writeTree,t.treePath,e)}function Wy(t,e,r,n){return Q6(t.writeTree,t.treePath,e,r,n)}function K0(t,e){return J6(t.writeTree,Cr(t.treePath,e))}function r8(t,e,r,n,i,l){return e8(t.writeTree,t.treePath,e,r,n,i,l)}function $p(t,e,r){return Z6(t.writeTree,t.treePath,e,r)}function KT(t,e){return $T(Cr(t.treePath,e),t.writeTree)}function $T(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n8{constructor(){this.changeMap=new Map}trackChildChange(e){const r=e.type,n=e.childName;Re(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),Re(n!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const l=i.type;if(r==="child_added"&&l==="child_removed")this.changeMap.set(n,mu(n,e.snapshotNode,i.snapshotNode));else if(r==="child_removed"&&l==="child_added")this.changeMap.delete(n);else if(r==="child_removed"&&l==="child_changed")this.changeMap.set(n,du(n,i.oldSnap));else if(r==="child_changed"&&l==="child_added")this.changeMap.set(n,Cc(n,e.snapshotNode));else if(r==="child_changed"&&l==="child_changed")this.changeMap.set(n,mu(n,e.snapshotNode,i.oldSnap));else throw Rc("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{getCompleteChild(e){return null}getChildAfterChild(e,r,n){return null}}const QT=new a8;class Qp{constructor(e,r,n=null){this.writes_=e,this.viewCache_=r,this.optCompleteServerCache_=n}getCompleteChild(e){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(e))return r.getNode().getImmediateChild(e);{const n=this.optCompleteServerCache_!=null?new tl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return $p(this.writes_,e,n)}}getChildAfterChild(e,r,n){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:rl(this.viewCache_),l=r8(this.writes_,i,r,1,n,e);return l.length===0?null:l[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i8(t){return{filter:t}}function s8(t,e){Re(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),Re(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function l8(t,e,r,n,i){const l=new n8;let o,u;if(r.type===_a.OVERWRITE){const d=r;d.source.fromUser?o=ip(t,e,d.path,d.snap,n,i,l):(Re(d.source.fromServer,"Unknown source."),u=d.source.tagged||e.serverCache.isFiltered()&&!vt(d.path),o=$0(t,e,d.path,d.snap,n,i,u,l))}else if(r.type===_a.MERGE){const d=r;d.source.fromUser?o=o8(t,e,d.path,d.children,n,i,l):(Re(d.source.fromServer,"Unknown source."),u=d.source.tagged||e.serverCache.isFiltered(),o=sp(t,e,d.path,d.children,n,i,u,l))}else if(r.type===_a.ACK_USER_WRITE){const d=r;d.revert?o=h8(t,e,d.path,n,i,l):o=u8(t,e,d.path,d.affectedTree,n,i,l)}else if(r.type===_a.LISTEN_COMPLETE)o=f8(t,e,r.path,n,l);else throw Rc("Unknown operation type: "+r.type);const h=l.getChanges();return c8(e,o,h),{viewCache:o,changes:h}}function c8(t,e,r){const n=e.eventCache;if(n.isFullyInitialized()){const i=n.getNode().isLeafNode()||n.getNode().isEmpty(),l=rp(t);(r.length>0||!t.eventCache.isFullyInitialized()||i&&!n.getNode().equals(l)||!n.getNode().getPriority().equals(l.getPriority()))&&r.push(zT(rp(e)))}}function ZT(t,e,r,n,i,l){const o=e.eventCache;if(K0(n,r)!=null)return e;{let u,h;if(vt(r))if(Re(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=rl(e),p=d instanceof et?d:et.EMPTY_NODE,x=Kp(n,p);u=t.filter.updateFullNode(e.eventCache.getNode(),x,l)}else{const d=Y0(n,rl(e));u=t.filter.updateFullNode(e.eventCache.getNode(),d,l)}else{const d=dt(r);if(d===".priority"){Re(os(r)===1,"Can't have a priority with additional path components");const p=o.getNode();h=e.serverCache.getNode();const x=Wy(n,r,p,h);x!=null?u=t.filter.updatePriority(p,x):u=o.getNode()}else{const p=Yt(r);let x;if(o.isCompleteForChild(d)){h=e.serverCache.getNode();const v=Wy(n,r,o.getNode(),h);v!=null?x=o.getNode().getImmediateChild(d).updateChild(p,v):x=o.getNode().getImmediateChild(d)}else x=$p(n,d,e.serverCache);x!=null?u=t.filter.updateChild(o.getNode(),d,x,p,i,l):u=o.getNode()}}return Yo(e,u,o.isFullyInitialized()||vt(r),t.filter.filtersNodes())}}function $0(t,e,r,n,i,l,o,u){const h=e.serverCache;let d;const p=o?t.filter:t.filter.getIndexedFilter();if(vt(r))d=p.updateFullNode(h.getNode(),n,null);else if(p.filtersNodes()&&!h.isFiltered()){const _=h.getNode().updateChild(r,n);d=p.updateFullNode(h.getNode(),_,null)}else{const _=dt(r);if(!h.isCompleteForPath(r)&&os(r)>1)return e;const E=Yt(r),S=h.getNode().getImmediateChild(_).updateChild(E,n);_===".priority"?d=p.updatePriority(h.getNode(),S):d=p.updateChild(h.getNode(),_,S,E,QT,null)}const x=WT(e,d,h.isFullyInitialized()||vt(r),p.filtersNodes()),v=new Qp(i,x,l);return ZT(t,x,r,i,v,u)}function ip(t,e,r,n,i,l,o){const u=e.eventCache;let h,d;const p=new Qp(i,e,l);if(vt(r))d=t.filter.updateFullNode(e.eventCache.getNode(),n,o),h=Yo(e,d,!0,t.filter.filtersNodes());else{const x=dt(r);if(x===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),n),h=Yo(e,d,u.isFullyInitialized(),u.isFiltered());else{const v=Yt(r),_=u.getNode().getImmediateChild(x);let E;if(vt(v))E=n;else{const w=p.getCompleteChild(x);w!=null?FT(v)===".priority"&&w.getChild(MT(v)).isEmpty()?E=w:E=w.updateChild(v,n):E=et.EMPTY_NODE}if(_.equals(E))h=e;else{const w=t.filter.updateChild(u.getNode(),x,E,v,p,o);h=Yo(e,w,u.isFullyInitialized(),t.filter.filtersNodes())}}}return h}function Xy(t,e){return t.eventCache.isCompleteForChild(e)}function o8(t,e,r,n,i,l,o){let u=e;return n.foreach((h,d)=>{const p=Cr(r,h);Xy(e,dt(p))&&(u=ip(t,u,p,d,i,l,o))}),n.foreach((h,d)=>{const p=Cr(r,h);Xy(e,dt(p))||(u=ip(t,u,p,d,i,l,o))}),u}function qy(t,e,r){return r.foreach((n,i)=>{e=e.updateChild(n,i)}),e}function sp(t,e,r,n,i,l,o,u){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,d;vt(r)?d=n:d=new Qt(null).setTree(r,n);const p=e.serverCache.getNode();return d.children.inorderTraversal((x,v)=>{if(p.hasChild(x)){const _=e.serverCache.getNode().getImmediateChild(x),E=qy(t,_,v);h=$0(t,h,new Wt(x),E,i,l,o,u)}}),d.children.inorderTraversal((x,v)=>{const _=!e.serverCache.isCompleteForChild(x)&&v.value===null;if(!p.hasChild(x)&&!_){const E=e.serverCache.getNode().getImmediateChild(x),w=qy(t,E,v);h=$0(t,h,new Wt(x),w,i,l,o,u)}}),h}function u8(t,e,r,n,i,l,o){if(K0(i,r)!=null)return e;const u=e.serverCache.isFiltered(),h=e.serverCache;if(n.value!=null){if(vt(r)&&h.isFullyInitialized()||h.isCompleteForPath(r))return $0(t,e,r,h.getNode().getChild(r),i,l,u,o);if(vt(r)){let d=new Qt(null);return h.getNode().forEachChild(mc,(p,x)=>{d=d.set(new Wt(p),x)}),sp(t,e,r,d,i,l,u,o)}else return e}else{let d=new Qt(null);return n.foreach((p,x)=>{const v=Cr(r,p);h.isCompleteForPath(v)&&(d=d.set(p,h.getNode().getChild(v)))}),sp(t,e,r,d,i,l,u,o)}}function f8(t,e,r,n,i){const l=e.serverCache,o=WT(e,l.getNode(),l.isFullyInitialized()||vt(r),l.isFiltered());return ZT(t,o,r,n,QT,i)}function h8(t,e,r,n,i,l){let o;if(K0(n,r)!=null)return e;{const u=new Qp(n,e,i),h=e.eventCache.getNode();let d;if(vt(r)||dt(r)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=Y0(n,rl(e));else{const x=e.serverCache.getNode();Re(x instanceof et,"serverChildren would be complete if leaf node"),p=Kp(n,x)}p=p,d=t.filter.updateFullNode(h,p,l)}else{const p=dt(r);let x=$p(n,p,e.serverCache);x==null&&e.serverCache.isCompleteForChild(p)&&(x=h.getImmediateChild(p)),x!=null?d=t.filter.updateChild(h,p,x,Yt(r),u,l):e.eventCache.getNode().hasChild(p)?d=t.filter.updateChild(h,p,et.EMPTY_NODE,Yt(r),u,l):d=h,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Y0(n,rl(e)),o.isLeafNode()&&(d=t.filter.updateFullNode(d,o,l)))}return o=e.serverCache.isFullyInitialized()||K0(n,Rt())!=null,Yo(e,d,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e,r){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new Gp(n.getIndex()),l=O6(n);this.processor_=i8(l);const o=r.serverCache,u=r.eventCache,h=i.updateFullNode(et.EMPTY_NODE,o.getNode(),null),d=l.updateFullNode(et.EMPTY_NODE,u.getNode(),null),p=new tl(h,o.isFullyInitialized(),i.filtersNodes()),x=new tl(d,u.isFullyInitialized(),l.filtersNodes());this.viewCache_=wh(x,p),this.eventGenerator_=new U6(this.query_)}get query(){return this.query_}}function m8(t){return t.viewCache_.serverCache.getNode()}function p8(t,e){const r=rl(t.viewCache_);return r&&(t.query._queryParams.loadsAllData()||!vt(e)&&!r.getImmediateChild(dt(e)).isEmpty())?r.getChild(e):null}function Yy(t){return t.eventRegistrations_.length===0}function g8(t,e){t.eventRegistrations_.push(e)}function Ky(t,e,r){const n=[];if(r){Re(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(l=>{const o=l.createCancelEvent(r,i);o&&n.push(o)})}if(e){let i=[];for(let l=0;l<t.eventRegistrations_.length;++l){const o=t.eventRegistrations_[l];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(l+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return n}function $y(t,e,r,n){e.type===_a.MERGE&&e.source.queryId!==null&&(Re(rl(t.viewCache_),"We should always have a full cache before handling merges"),Re(rp(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,l=l8(t.processor_,i,e,r,n);return s8(t.processor_,l.viewCache),Re(l.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=l.viewCache,JT(t,l.changes,l.viewCache.eventCache.getNode(),null)}function x8(t,e){const r=t.viewCache_.eventCache,n=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(nr,(l,o)=>{n.push(Cc(l,o))}),r.isFullyInitialized()&&n.push(zT(r.getNode())),JT(t,n,r.getNode(),e)}function JT(t,e,r,n){const i=n?[n]:t.eventRegistrations_;return j6(t.eventGenerator_,e,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q0;class v8{constructor(){this.views=new Map}}function _8(t){Re(!Q0,"__referenceConstructor has already been defined"),Q0=t}function y8(){return Re(Q0,"Reference.ts has not been loaded"),Q0}function w8(t){return t.views.size===0}function Zp(t,e,r,n){const i=e.source.queryId;if(i!==null){const l=t.views.get(i);return Re(l!=null,"SyncTree gave us an op for an invalid query."),$y(l,e,r,n)}else{let l=[];for(const o of t.views.values())l=l.concat($y(o,e,r,n));return l}}function E8(t,e,r,n,i){const l=e._queryIdentifier,o=t.views.get(l);if(!o){let u=Y0(r,i?n:null),h=!1;u?h=!0:n instanceof et?(u=Kp(r,n),h=!1):(u=et.EMPTY_NODE,h=!1);const d=wh(new tl(u,h,!1),new tl(n,i,!1));return new d8(e,d)}return o}function T8(t,e,r,n,i,l){const o=E8(t,e,n,i,l);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),g8(o,r),x8(o,r)}function S8(t,e,r,n){const i=e._queryIdentifier,l=[];let o=[];const u=us(t);if(i==="default")for(const[h,d]of t.views.entries())o=o.concat(Ky(d,r,n)),Yy(d)&&(t.views.delete(h),d.query._queryParams.loadsAllData()||l.push(d.query));else{const h=t.views.get(i);h&&(o=o.concat(Ky(h,r,n)),Yy(h)&&(t.views.delete(i),h.query._queryParams.loadsAllData()||l.push(h.query)))}return u&&!us(t)&&l.push(new(y8())(e._repo,e._path)),{removed:l,events:o}}function eS(t){const e=[];for(const r of t.views.values())r.query._queryParams.loadsAllData()||e.push(r);return e}function pc(t,e){let r=null;for(const n of t.views.values())r=r||p8(n,e);return r}function tS(t,e){if(e._queryParams.loadsAllData())return Eh(t);{const n=e._queryIdentifier;return t.views.get(n)}}function rS(t,e){return tS(t,e)!=null}function us(t){return Eh(t)!=null}function Eh(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0;function b8(t){Re(!Z0,"__referenceConstructor has already been defined"),Z0=t}function C8(){return Re(Z0,"Reference.ts has not been loaded"),Z0}let k8=1;class Qy{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Qt(null),this.pendingWriteTree_=t8(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Jp(t,e,r,n,i){return G6(t.pendingWriteTree_,e,r,n,i),i?ju(t,new el(GT(),e,r)):[]}function Gs(t,e,r=!1){const n=W6(t.pendingWriteTree_,e);if(X6(t.pendingWriteTree_,e)){let l=new Qt(null);return n.snap!=null?l=l.set(Rt(),!0):kn(n.children,o=>{l=l.set(new Wt(o),!0)}),ju(t,new q0(n.path,l,r))}else return[]}function Th(t,e,r){return ju(t,new el(Xp(),e,r))}function A8(t,e,r){const n=Qt.fromObject(r);return ju(t,new xu(Xp(),e,n))}function N8(t,e){return ju(t,new gu(Xp(),e))}function D8(t,e,r){const n=eg(t,r);if(n){const i=tg(n),l=i.path,o=i.queryId,u=Tn(l,e),h=new gu(qp(o),u);return rg(t,l,h)}else return[]}function lp(t,e,r,n,i=!1){const l=e._path,o=t.syncPointTree_.get(l);let u=[];if(o&&(e._queryIdentifier==="default"||rS(o,e))){const h=S8(o,e,r,n);w8(o)&&(t.syncPointTree_=t.syncPointTree_.remove(l));const d=h.removed;if(u=h.events,!i){const p=d.findIndex(v=>v._queryParams.loadsAllData())!==-1,x=t.syncPointTree_.findOnPath(l,(v,_)=>us(_));if(p&&!x){const v=t.syncPointTree_.subtree(l);if(!v.isEmpty()){const _=F8(v);for(let E=0;E<_.length;++E){const w=_[E],S=w.query,N=iS(t,w);t.listenProvider_.startListening($o(S),J0(t,S),N.hashFn,N.onComplete)}}}!x&&d.length>0&&!n&&(p?t.listenProvider_.stopListening($o(e),null):d.forEach(v=>{const _=t.queryToTagMap.get(bh(v));t.listenProvider_.stopListening($o(v),_)}))}I8(t,d)}return u}function R8(t,e,r,n){const i=eg(t,n);if(i!=null){const l=tg(i),o=l.path,u=l.queryId,h=Tn(o,e),d=new el(qp(u),h,r);return rg(t,o,d)}else return[]}function O8(t,e,r,n){const i=eg(t,n);if(i){const l=tg(i),o=l.path,u=l.queryId,h=Tn(o,e),d=Qt.fromObject(r),p=new xu(qp(u),h,d);return rg(t,o,p)}else return[]}function Zy(t,e,r,n=!1){const i=e._path;let l=null,o=!1;t.syncPointTree_.foreachOnPath(i,(v,_)=>{const E=Tn(v,i);l=l||pc(_,E),o=o||us(_)});let u=t.syncPointTree_.get(i);u?(o=o||us(u),l=l||pc(u,Rt())):(u=new v8,t.syncPointTree_=t.syncPointTree_.set(i,u));let h;l!=null?h=!0:(h=!1,l=et.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((_,E)=>{const w=pc(E,Rt());w&&(l=l.updateImmediateChild(_,w))}));const d=rS(u,e);if(!d&&!e._queryParams.loadsAllData()){const v=bh(e);Re(!t.queryToTagMap.has(v),"View does not exist, but we have a tag");const _=M8();t.queryToTagMap.set(v,_),t.tagToQueryMap.set(_,v)}const p=Yp(t.pendingWriteTree_,i);let x=T8(u,e,r,p,l,h);if(!d&&!o&&!n){const v=tS(u,e);x=x.concat(L8(t,e,v))}return x}function Sh(t,e,r){const i=t.pendingWriteTree_,l=t.syncPointTree_.findOnPath(e,(o,u)=>{const h=Tn(o,e),d=pc(u,h);if(d)return d});return YT(i,e,l,r,!0)}function ju(t,e){return nS(e,t.syncPointTree_,null,Yp(t.pendingWriteTree_,Rt()))}function nS(t,e,r,n){if(vt(t.path))return aS(t,e,r,n);{const i=e.get(Rt());r==null&&i!=null&&(r=pc(i,Rt()));let l=[];const o=dt(t.path),u=t.operationForChild(o),h=e.children.get(o);if(h&&u){const d=r?r.getImmediateChild(o):null,p=KT(n,o);l=l.concat(nS(u,h,d,p))}return i&&(l=l.concat(Zp(i,t,n,r))),l}}function aS(t,e,r,n){const i=e.get(Rt());r==null&&i!=null&&(r=pc(i,Rt()));let l=[];return e.children.inorderTraversal((o,u)=>{const h=r?r.getImmediateChild(o):null,d=KT(n,o),p=t.operationForChild(o);p&&(l=l.concat(aS(p,u,h,d)))}),i&&(l=l.concat(Zp(i,t,n,r))),l}function iS(t,e){const r=e.query,n=J0(t,r);return{hashFn:()=>(m8(e)||et.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return n?D8(t,r._path,n):N8(t,r._path);{const l=RN(i,r);return lp(t,r,null,l)}}}}function J0(t,e){const r=bh(e);return t.queryToTagMap.get(r)}function bh(t){return t._path.toString()+"$"+t._queryIdentifier}function eg(t,e){return t.tagToQueryMap.get(e)}function tg(t){const e=t.indexOf("$");return Re(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Wt(t.substr(0,e))}}function rg(t,e,r){const n=t.syncPointTree_.get(e);Re(n,"Missing sync point for query tag that we're tracking");const i=Yp(t.pendingWriteTree_,e);return Zp(n,r,i,null)}function F8(t){return t.fold((e,r,n)=>{if(r&&us(r))return[Eh(r)];{let i=[];return r&&(i=eS(r)),kn(n,(l,o)=>{i=i.concat(o)}),i}})}function $o(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(C8())(t._repo,t._path):t}function I8(t,e){for(let r=0;r<e.length;++r){const n=e[r];if(!n._queryParams.loadsAllData()){const i=bh(n),l=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(l)}}}function M8(){return k8++}function L8(t,e,r){const n=e._path,i=J0(t,e),l=iS(t,r),o=t.listenProvider_.startListening($o(e),i,l.hashFn,l.onComplete),u=t.syncPointTree_.subtree(n);if(i)Re(!us(u.value),"If we're adding a query, it shouldn't be shadowed");else{const h=u.fold((d,p,x)=>{if(!vt(d)&&p&&us(p))return[Eh(p).query];{let v=[];return p&&(v=v.concat(eS(p).map(_=>_.query))),kn(x,(_,E)=>{v=v.concat(E)}),v}});for(let d=0;d<h.length;++d){const p=h[d];t.listenProvider_.stopListening($o(p),J0(t,p))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this.node_=e}getImmediateChild(e){const r=this.node_.getImmediateChild(e);return new ng(r)}node(){return this.node_}}class ag{constructor(e,r){this.syncTree_=e,this.path_=r}getImmediateChild(e){const r=Cr(this.path_,e);return new ag(this.syncTree_,r)}node(){return Sh(this.syncTree_,this.path_)}}const B8=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Jy=function(t,e,r){if(!t||typeof t!="object")return t;if(Re(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return P8(t[".sv"],e,r);if(typeof t[".sv"]=="object")return U8(t[".sv"],e);Re(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},P8=function(t,e,r){switch(t){case"timestamp":return r.timestamp;default:Re(!1,"Unexpected server value: "+t)}},U8=function(t,e,r){t.hasOwnProperty("increment")||Re(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const n=t.increment;typeof n!="number"&&Re(!1,"Unexpected increment value: "+n);const i=e.node();if(Re(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;const o=i.getValue();return typeof o!="number"?n:o+n},j8=function(t,e,r,n){return sg(e,new ag(r,t),n)},ig=function(t,e,r){return sg(t,new ng(e),r)};function sg(t,e,r){const n=t.getPriority().val(),i=Jy(n,e.getImmediateChild(".priority"),r);let l;if(t.isLeafNode()){const o=t,u=Jy(o.getValue(),e,r);return u!==o.getValue()||i!==o.getPriority().val()?new Rr(u,Ir(i)):t}else{const o=t;return l=o,i!==o.getPriority().val()&&(l=l.updatePriority(new Rr(i))),o.forEachChild(nr,(u,h)=>{const d=sg(h,e.getImmediateChild(u),r);d!==h&&(l=l.updateImmediateChild(u,d))}),l}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e="",r=null,n={children:{},childCount:0}){this.name=e,this.parent=r,this.node=n}}function Ch(t,e){let r=e instanceof Wt?e:new Wt(e),n=t,i=dt(r);for(;i!==null;){const l=$s(n.node.children,i)||{children:{},childCount:0};n=new lg(i,n,l),r=Yt(r),i=dt(r)}return n}function hl(t){return t.node.value}function cg(t,e){t.node.value=e,cp(t)}function sS(t){return t.node.childCount>0}function H8(t){return hl(t)===void 0&&!sS(t)}function kh(t,e){kn(t.node.children,(r,n)=>{e(new lg(r,t,n))})}function lS(t,e,r,n){r&&e(t),kh(t,i=>{lS(i,e,!0)})}function z8(t,e,r){let n=t.parent;for(;n!==null;){if(e(n))return!0;n=n.parent}return!1}function Hu(t){return new Wt(t.parent===null?t.name:Hu(t.parent)+"/"+t.name)}function cp(t){t.parent!==null&&V8(t.parent,t.name,t)}function V8(t,e,r){const n=H8(r),i=ba(t.node.children,e);n&&i?(delete t.node.children[e],t.node.childCount--,cp(t)):!n&&!i&&(t.node.children[e]=r.node,t.node.childCount++,cp(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G8=/[\[\].#$\/\u0000-\u001F\u007F]/,W8=/[\[\].#$\u0000-\u001F\u007F]/,Tm=10*1024*1024,cS=function(t){return typeof t=="string"&&t.length!==0&&!G8.test(t)},oS=function(t){return typeof t=="string"&&t.length!==0&&!W8.test(t)},X8=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),oS(t)},q8=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Lp(t)||t&&typeof t=="object"&&ba(t,".sv")},Y8=function(t,e,r,n){Ah(Op(t,"value"),e,r)},Ah=function(t,e,r){const n=r instanceof Wt?new u6(r,t):r;if(e===void 0)throw new Error(t+"contains undefined "+Hs(n));if(typeof e=="function")throw new Error(t+"contains a function "+Hs(n)+" with contents = "+e.toString());if(Lp(e))throw new Error(t+"contains "+e.toString()+" "+Hs(n));if(typeof e=="string"&&e.length>Tm/3&&_h(e)>Tm)throw new Error(t+"contains a string greater than "+Tm+" utf8 bytes "+Hs(n)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,l=!1;if(kn(e,(o,u)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(l=!0,!cS(o)))throw new Error(t+" contains an invalid key ("+o+") "+Hs(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);f6(n,o),Ah(t,u,n),h6(n)}),i&&l)throw new Error(t+' contains ".value" child '+Hs(n)+" in addition to actual children.")}},uS=function(t,e,r,n){if(!oS(r))throw new Error(Op(t,e)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},K8=function(t,e,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),uS(t,e,r)},fS=function(t,e){if(dt(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},$8=function(t,e){const r=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!cS(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!X8(r))throw new Error(Op(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function og(t,e){let r=null;for(let n=0;n<e.length;n++){const i=e[n],l=i.getPath();r!==null&&!Hp(l,r.path)&&(t.eventLists_.push(r),r=null),r===null&&(r={events:[],path:l}),r.events.push(i)}r&&t.eventLists_.push(r)}function hS(t,e,r){og(t,r),dS(t,n=>Hp(n,e))}function Ua(t,e,r){og(t,r),dS(t,n=>va(n,e)||va(e,n))}function dS(t,e){t.recursionDepth_++;let r=!0;for(let n=0;n<t.eventLists_.length;n++){const i=t.eventLists_[n];if(i){const l=i.path;e(l)?(Z8(t.eventLists_[n]),t.eventLists_[n]=null):r=!1}}r&&(t.eventLists_=[]),t.recursionDepth_--}function Z8(t){for(let e=0;e<t.events.length;e++){const r=t.events[e];if(r!==null){t.events[e]=null;const n=r.getEventRunner();Xo&&Zr("event: "+r.toString()),Lc(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J8="repo_interrupt",eD=25;class tD{constructor(e,r,n,i){this.repoInfo_=e,this.forceRestClient_=r,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Q8,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=X0(),this.transactionQueueTree_=new lg,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function rD(t,e,r){if(t.stats_=Up(t.repoInfo_),t.forceRestClient_||MN())t.server_=new W0(t.repoInfo_,(n,i,l,o)=>{ew(t,n,i,l,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>tw(t,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Lr(r)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}t.persistentConnection_=new di(t.repoInfo_,e,(n,i,l,o)=>{ew(t,n,i,l,o)},n=>{tw(t,n)},n=>{aD(t,n)},t.authTokenProvider_,t.appCheckProvider_,r),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(n=>{t.server_.refreshAuthToken(n)}),t.appCheckProvider_.addTokenChangeListener(n=>{t.server_.refreshAppCheckToken(n.token)}),t.statsReporter_=jN(t.repoInfo_,()=>new P6(t.stats_,t.server_)),t.infoData_=new F6,t.infoSyncTree_=new Qy({startListening:(n,i,l,o)=>{let u=[];const h=t.infoData_.getNode(n._path);return h.isEmpty()||(u=Th(t.infoSyncTree_,n._path,h),setTimeout(()=>{o("ok")},0)),u},stopListening:()=>{}}),ug(t,"connected",!1),t.serverSyncTree_=new Qy({startListening:(n,i,l,o)=>(t.server_.listen(n,l,i,(u,h)=>{const d=o(u,h);Ua(t.eventQueue_,n._path,d)}),[]),stopListening:(n,i)=>{t.server_.unlisten(n,i)}})}function nD(t){const r=t.infoData_.getNode(new Wt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function Nh(t){return B8({timestamp:nD(t)})}function ew(t,e,r,n,i){t.dataUpdateCount++;const l=new Wt(e);r=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,r):r;let o=[];if(i)if(n){const h=j0(r,d=>Ir(d));o=O8(t.serverSyncTree_,l,h,i)}else{const h=Ir(r);o=R8(t.serverSyncTree_,l,h,i)}else if(n){const h=j0(r,d=>Ir(d));o=A8(t.serverSyncTree_,l,h)}else{const h=Ir(r);o=Th(t.serverSyncTree_,l,h)}let u=l;o.length>0&&(u=Oh(t,l)),Ua(t.eventQueue_,u,o)}function tw(t,e){ug(t,"connected",e),e===!1&&sD(t)}function aD(t,e){kn(e,(r,n)=>{ug(t,r,n)})}function ug(t,e,r){const n=new Wt("/.info/"+e),i=Ir(r);t.infoData_.updateSnapshot(n,i);const l=Th(t.infoSyncTree_,n,i);Ua(t.eventQueue_,n,l)}function fg(t){return t.nextWriteId_++}function iD(t,e,r,n,i){Dh(t,"set",{path:e.toString(),value:r,priority:n});const l=Nh(t),o=Ir(r,n),u=Sh(t.serverSyncTree_,e),h=ig(o,u,l),d=fg(t),p=Jp(t.serverSyncTree_,e,h,d,!0);og(t.eventQueue_,p),t.server_.put(e.toString(),o.val(!0),(v,_)=>{const E=v==="ok";E||bn("set at "+e+" failed: "+v);const w=Gs(t.serverSyncTree_,d,!E);Ua(t.eventQueue_,e,w),oD(t,i,v,_)});const x=xS(t,e);Oh(t,x),Ua(t.eventQueue_,x,[])}function sD(t){Dh(t,"onDisconnectEvents");const e=Nh(t),r=X0();tp(t.onDisconnect_,Rt(),(i,l)=>{const o=j8(i,l,t.serverSyncTree_,e);VT(r,i,o)});let n=[];tp(r,Rt(),(i,l)=>{n=n.concat(Th(t.serverSyncTree_,i,l));const o=xS(t,i);Oh(t,o)}),t.onDisconnect_=X0(),Ua(t.eventQueue_,Rt(),n)}function lD(t,e,r){let n;dt(e._path)===".info"?n=Zy(t.infoSyncTree_,e,r):n=Zy(t.serverSyncTree_,e,r),hS(t.eventQueue_,e._path,n)}function rw(t,e,r){let n;dt(e._path)===".info"?n=lp(t.infoSyncTree_,e,r):n=lp(t.serverSyncTree_,e,r),hS(t.eventQueue_,e._path,n)}function cD(t){t.persistentConnection_&&t.persistentConnection_.interrupt(J8)}function Dh(t,...e){let r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),Zr(r,...e)}function oD(t,e,r,n){e&&Lc(()=>{if(r==="ok")e(null);else{const i=(r||"error").toUpperCase();let l=i;n&&(l+=": "+n);const o=new Error(l);o.code=i,e(o)}})}function uD(t,e,r,n,i,l){Dh(t,"transaction on "+e);const o={path:e,update:r,onComplete:n,status:null,order:fT(),applyLocally:l,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=hg(t,e,void 0);o.currentInputSnapshot=u;const h=o.update(u.val());if(h===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Ah("transaction failed: Data returned ",h,o.path),o.status=0;const d=Ch(t.transactionQueueTree_,e),p=hl(d)||[];p.push(o),cg(d,p);let x;typeof h=="object"&&h!==null&&ba(h,".priority")?(x=$s(h,".priority"),Re(q8(x),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):x=(Sh(t.serverSyncTree_,e)||et.EMPTY_NODE).getPriority().val();const v=Nh(t),_=Ir(h,x),E=ig(_,u,v);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=E,o.currentWriteId=fg(t);const w=Jp(t.serverSyncTree_,e,E,o.currentWriteId,o.applyLocally);Ua(t.eventQueue_,e,w),Rh(t,t.transactionQueueTree_)}}function hg(t,e,r){return Sh(t.serverSyncTree_,e,r)||et.EMPTY_NODE}function Rh(t,e=t.transactionQueueTree_){if(e||Fh(t,e),hl(e)){const r=pS(t,e);Re(r.length>0,"Sending zero length transaction queue"),r.every(i=>i.status===0)&&fD(t,Hu(e),r)}else sS(e)&&kh(e,r=>{Rh(t,r)})}function fD(t,e,r){const n=r.map(d=>d.currentWriteId),i=hg(t,e,n);let l=i;const o=i.hash();for(let d=0;d<r.length;d++){const p=r[d];Re(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const x=Tn(e,p.path);l=l.updateChild(x,p.currentOutputSnapshotRaw)}const u=l.val(!0),h=e;t.server_.put(h.toString(),u,d=>{Dh(t,"transaction put response",{path:h.toString(),status:d});let p=[];if(d==="ok"){const x=[];for(let v=0;v<r.length;v++)r[v].status=2,p=p.concat(Gs(t.serverSyncTree_,r[v].currentWriteId)),r[v].onComplete&&x.push(()=>r[v].onComplete(null,!0,r[v].currentOutputSnapshotResolved)),r[v].unwatcher();Fh(t,Ch(t.transactionQueueTree_,e)),Rh(t,t.transactionQueueTree_),Ua(t.eventQueue_,e,p);for(let v=0;v<x.length;v++)Lc(x[v])}else{if(d==="datastale")for(let x=0;x<r.length;x++)r[x].status===3?r[x].status=4:r[x].status=0;else{bn("transaction at "+h.toString()+" failed: "+d);for(let x=0;x<r.length;x++)r[x].status=4,r[x].abortReason=d}Oh(t,e)}},o)}function Oh(t,e){const r=mS(t,e),n=Hu(r),i=pS(t,r);return hD(t,i,n),n}function hD(t,e,r){if(e.length===0)return;const n=[];let i=[];const o=e.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<e.length;u++){const h=e[u],d=Tn(r,h.path);let p=!1,x;if(Re(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)p=!0,x=h.abortReason,i=i.concat(Gs(t.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=eD)p=!0,x="maxretry",i=i.concat(Gs(t.serverSyncTree_,h.currentWriteId,!0));else{const v=hg(t,h.path,o);h.currentInputSnapshot=v;const _=e[u].update(v.val());if(_!==void 0){Ah("transaction failed: Data returned ",_,h.path);let E=Ir(_);typeof _=="object"&&_!=null&&ba(_,".priority")||(E=E.updatePriority(v.getPriority()));const S=h.currentWriteId,N=Nh(t),M=ig(E,v,N);h.currentOutputSnapshotRaw=E,h.currentOutputSnapshotResolved=M,h.currentWriteId=fg(t),o.splice(o.indexOf(S),1),i=i.concat(Jp(t.serverSyncTree_,h.path,M,h.currentWriteId,h.applyLocally)),i=i.concat(Gs(t.serverSyncTree_,S,!0))}else p=!0,x="nodata",i=i.concat(Gs(t.serverSyncTree_,h.currentWriteId,!0))}Ua(t.eventQueue_,r,i),i=[],p&&(e[u].status=2,(function(v){setTimeout(v,Math.floor(0))})(e[u].unwatcher),e[u].onComplete&&(x==="nodata"?n.push(()=>e[u].onComplete(null,!1,e[u].currentInputSnapshot)):n.push(()=>e[u].onComplete(new Error(x),!1,null))))}Fh(t,t.transactionQueueTree_);for(let u=0;u<n.length;u++)Lc(n[u]);Rh(t,t.transactionQueueTree_)}function mS(t,e){let r,n=t.transactionQueueTree_;for(r=dt(e);r!==null&&hl(n)===void 0;)n=Ch(n,r),e=Yt(e),r=dt(e);return n}function pS(t,e){const r=[];return gS(t,e,r),r.sort((n,i)=>n.order-i.order),r}function gS(t,e,r){const n=hl(e);if(n)for(let i=0;i<n.length;i++)r.push(n[i]);kh(e,i=>{gS(t,i,r)})}function Fh(t,e){const r=hl(e);if(r){let n=0;for(let i=0;i<r.length;i++)r[i].status!==2&&(r[n]=r[i],n++);r.length=n,cg(e,r.length>0?r:void 0)}kh(e,n=>{Fh(t,n)})}function xS(t,e){const r=Hu(mS(t,e)),n=Ch(t.transactionQueueTree_,e);return z8(n,i=>{Sm(t,i)}),Sm(t,n),lS(n,i=>{Sm(t,i)}),r}function Sm(t,e){const r=hl(e);if(r){const n=[];let i=[],l=-1;for(let o=0;o<r.length;o++)r[o].status===3||(r[o].status===1?(Re(l===o-1,"All SENT items should be at beginning of queue."),l=o,r[o].status=3,r[o].abortReason="set"):(Re(r[o].status===0,"Unexpected transaction status in abort"),r[o].unwatcher(),i=i.concat(Gs(t.serverSyncTree_,r[o].currentWriteId,!0)),r[o].onComplete&&n.push(r[o].onComplete.bind(null,new Error("set"),!1,null))));l===-1?cg(e,void 0):r.length=l+1,Ua(t.eventQueue_,Hu(e),i);for(let o=0;o<n.length;o++)Lc(n[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dD(t){let e="";const r=t.split("/");for(let n=0;n<r.length;n++)if(r[n].length>0){let i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function mD(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const r of t.split("&")){if(r.length===0)continue;const n=r.split("=");n.length===2?e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):bn(`Invalid query segment '${r}' in query '${t}'`)}return e}const nw=function(t,e){const r=pD(t),n=r.namespace;r.domain==="firebase.com"&&xi(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&r.domain!=="localhost"&&xi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||CN();const i=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new ST(r.host,r.secure,n,i,e,"",n!==r.subdomain),path:new Wt(r.pathString)}},pD=function(t){let e="",r="",n="",i="",l="",o=!0,u="https",h=443;if(typeof t=="string"){let d=t.indexOf("//");d>=0&&(u=t.substring(0,d-1),t=t.substring(d+2));let p=t.indexOf("/");p===-1&&(p=t.length);let x=t.indexOf("?");x===-1&&(x=t.length),e=t.substring(0,Math.min(p,x)),p<x&&(i=dD(t.substring(p,x)));const v=mD(t.substring(Math.min(t.length,x)));d=e.indexOf(":"),d>=0?(o=u==="https"||u==="wss",h=parseInt(e.substring(d+1),10)):d=e.length;const _=e.slice(0,d);if(_.toLowerCase()==="localhost")r="localhost";else if(_.split(".").length<=2)r=_;else{const E=e.indexOf(".");n=e.substring(0,E).toLowerCase(),r=e.substring(E+1),l=n}"ns"in v&&(l=v.ns)}return{host:e,port:h,domain:r,subdomain:n,secure:o,scheme:u,pathString:i,namespace:l}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e,r,n,i){this.eventType=e,this.eventRegistration=r,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Lr(this.snapshot.exportVal())}}class xD{constructor(e,r,n){this.eventRegistration=e,this.error=r,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e,r){this.snapshotCallback=e,this.cancelCallback=r}onValue(e,r){this.snapshotCallback.call(null,e,r)}onCancel(e){return Re(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e,r,n,i){this._repo=e,this._path=r,this._queryParams=n,this._orderByCalled=i}get key(){return vt(this._path)?null:FT(this._path)}get ref(){return new yi(this._repo,this._path)}get _queryIdentifier(){const e=jy(this._queryParams),r=Bp(e);return r==="{}"?"default":r}get _queryObject(){return jy(this._queryParams)}isEqual(e){if(e=oa(e),!(e instanceof dg))return!1;const r=this._repo===e._repo,n=Hp(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return r&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+o6(this._path)}}class yi extends dg{constructor(e,r){super(e,r,new Wp,!1)}get parent(){const e=MT(this._path);return e===null?null:new yi(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class vu{constructor(e,r,n){this._node=e,this.ref=r,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const r=new Wt(e),n=op(this.ref,e);return new vu(this._node.getChild(r),n,nr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,i)=>e(new vu(i,op(this.ref,n),nr)))}hasChild(e){const r=new Wt(e);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function zu(t,e){return t=oa(t),t._checkNotDeleted("ref"),op(t._root,e)}function op(t,e){return t=oa(t),dt(t._path)===null?K8("child","path",e):uS("child","path",e),new yi(t._repo,Cr(t._path,e))}function vS(t,e){t=oa(t),fS("set",t._path),Y8("set",e,t._path);const r=new Mu;return iD(t._repo,t._path,e,null,r.wrapCallback(()=>{})),r.promise}class mg{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,r){const n=r._queryParams.getIndex();return new gD("value",this,new vu(e.snapshotNode,new yi(r._repo,r._path),n))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,r){return this.callbackContext.hasCancelCallback?new xD(this,e,r):null}matches(e){return e instanceof mg?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function _D(t,e,r,n,i){let l;if(typeof n=="object"&&(l=void 0,i=n),typeof n=="function"&&(l=n),i&&i.onlyOnce){const h=r,d=(p,x)=>{rw(t._repo,t,u),h(p,x)};d.userCallback=r.userCallback,d.context=r.context,r=d}const o=new vD(r,l||void 0),u=new mg(o);return lD(t._repo,t,u),()=>rw(t._repo,t,u)}function _S(t,e,r,n){return _D(t,"value",e,r,n)}_8(yi);b8(yi);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD="FIREBASE_DATABASE_EMULATOR_HOST",up={};let wD=!1;function ED(t,e,r,n){const i=e.lastIndexOf(":"),l=e.substring(0,i),o=Oc(l);t.repoInfo_=new ST(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,r),n&&(t.authTokenProvider_=n)}function TD(t,e,r,n,i){let l=n||t.options.databaseURL;l===void 0&&(t.options.projectId||xi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Zr("Using default host for project ",t.options.projectId),l=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=nw(l,i),u=o.repoInfo,h;typeof process<"u"&&Ey&&(h=Ey[yD]),h?(l=`http://${h}?ns=${u.namespace}`,o=nw(l,i),u=o.repoInfo):o.repoInfo.secure;const d=new BN(t.name,t.options,e);$8("Invalid Firebase Database URL",o),vt(o.path)||xi("Database URL must point to the root of a Firebase Database (not including a child path).");const p=bD(u,t,d,new LN(t,r));return new CD(p,t)}function SD(t,e){const r=up[e];(!r||r[t.key]!==t)&&xi(`Database ${e}(${t.repoInfo_}) has already been deleted.`),cD(t),delete r[t.key]}function bD(t,e,r,n){let i=up[e.name];i||(i={},up[e.name]=i);let l=i[t.toURLString()];return l&&xi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),l=new tD(t,wD,r,n),i[t.toURLString()]=l,l}class CD{constructor(e,r){this._repoInternal=e,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(rD(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new yi(this._repo,Rt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(SD(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&xi("Cannot call "+e+" on a deleted database.")}}function kD(t=sT(),e){const r=Mp(t,"database").getImmediate({identifier:e});if(!r._instanceStarted){const n=Wk("database");n&&AD(r,...n)}return r}function AD(t,e,r,n={}){t=oa(t),t._checkNotDeleted("useEmulator");const i=`${e}:${r}`,l=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&Qs(n,l.repoInfo_.emulatorOptions))return;xi("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(l.repoInfo_.nodeAdmin)n.mockUserToken&&xi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new O0(O0.OWNER);else if(n.mockUserToken){const u=typeof n.mockUserToken=="string"?n.mockUserToken:Xk(n.mockUserToken,t.app.options.projectId);o=new O0(u)}Oc(e)&&(JE(e),eT("Database",!0)),ED(l,i,n,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t){wN(Ic),Sc(new Zs("database",(e,{instanceIdentifier:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),l=e.getProvider("app-check-internal");return TD(n,i,l,r)},"PUBLIC").setMultipleInstances(!0)),ss(Ty,Sy,t),ss(Ty,Sy,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e,r){this.committed=e,this.snapshot=r}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function yS(t,e,r){if(t=oa(t),fS("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const n=!0,i=new Mu,l=(u,h,d)=>{let p=null;u?i.reject(u):(p=new vu(d,new yi(t._repo,t._path),nr),i.resolve(new DD(h,p)))},o=_S(t,()=>{});return uD(t._repo,t._path,e,l,o,n),i.promise}di.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};di.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};ND();function wS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RD=wS,ES=new Lu("auth","Firebase",wS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh=new Fp("@firebase/auth");function OD(t,...e){eh.logLevel<=Ht.WARN&&eh.warn(`Auth (${Ic}): ${t}`,...e)}function F0(t,...e){eh.logLevel<=Ht.ERROR&&eh.error(`Auth (${Ic}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(t,...e){throw pg(t,...e)}function La(t,...e){return pg(t,...e)}function TS(t,e,r){const n={...RD(),[e]:r};return new Lu("auth","Firebase",n).create(e,{appName:t.name})}function cs(t){return TS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return ES.create(t,...e)}function nt(t,e,...r){if(!t)throw pg(e,...r)}function ui(t){const e="INTERNAL ASSERTION FAILED: "+t;throw F0(e),new Error(e)}function _i(t,e){t||ui(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function FD(){return aw()==="http:"||aw()==="https:"}function aw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ID(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FD()||$k()||"connection"in navigator)?navigator.onLine:!0}function MD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,r){this.shortDelay=e,this.longDelay=r,_i(r>e,"Short delay should be less than long delay!"),this.isMobile=Rp()||tT()}get(){return ID()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(t,e){_i(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],PD=new Vu(3e4,6e4);function Ih(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Bc(t,e,r,n,i={}){return bS(t,i,async()=>{let l={},o={};n&&(e==="GET"?o=n:l={body:JSON.stringify(n)});const u=Fc({key:t.config.apiKey,...o}).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:h,...l};return Kk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Oc(t.emulatorConfig.host)&&(d.credentials="include"),SS.fetch()(await kS(t,t.config.apiHost,r,u),d)})}async function bS(t,e,r){t._canInitEmulator=!1;const n={...LD,...e};try{const i=new UD(t),l=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const o=await l.json();if("needConfirmation"in o)throw w0(t,"account-exists-with-different-credential",o);if(l.ok&&!("errorMessage"in o))return o;{const u=l.ok?o.errorMessage:o.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw w0(t,"credential-already-in-use",o);if(h==="EMAIL_EXISTS")throw w0(t,"email-already-in-use",o);if(h==="USER_DISABLED")throw w0(t,"user-disabled",o);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw TS(t,p,d);vi(t,p)}}catch(i){if(i instanceof gs)throw i;vi(t,"network-request-failed",{message:String(i)})}}async function CS(t,e,r,n,i={}){const l=await Bc(t,e,r,n,i);return"mfaPendingCredential"in l&&vi(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function kS(t,e,r,n){const i=`${e}${r}?${n}`,l=t,o=l.config.emulator?gg(t.config,i):`${t.config.apiScheme}://${i}`;return BD.includes(r)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(o).toString():o}class UD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(La(this.auth,"network-request-failed")),PD.get())})}}function w0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=La(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jD(t,e){return Bc(t,"POST","/v1/accounts:delete",e)}async function th(t,e){return Bc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HD(t,e=!1){const r=oa(t),n=await r.getIdToken(e),i=xg(n);nt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const l=typeof i.firebase=="object"?i.firebase:void 0,o=l==null?void 0:l.sign_in_provider;return{claims:i,token:n,authTime:Qo(bm(i.auth_time)),issuedAtTime:Qo(bm(i.iat)),expirationTime:Qo(bm(i.exp)),signInProvider:o||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function bm(t){return Number(t)*1e3}function xg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return F0("JWT malformed, contained fewer than 3 sections"),null;try{const i=U0(r);return i?JSON.parse(i):(F0("Failed to decode base64 JWT payload"),null)}catch(i){return F0("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function iw(t){const e=xg(t);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _u(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof gs&&zD(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function zD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qo(this.lastLoginAt),this.creationTime=Qo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rh(t){var x;const e=t.auth,r=await t.getIdToken(),n=await _u(t,th(e,{idToken:r}));nt(n==null?void 0:n.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const l=(x=i.providerUserInfo)!=null&&x.length?AS(i.providerUserInfo):[],o=WD(t.providerData,l),u=t.isAnonymous,h=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=u?h:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new hp(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,p)}async function GD(t){const e=oa(t);await rh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function WD(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function AS(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(t,e){const r=await bS(t,{},async()=>{const n=Fc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:l}=t.config,o=await kS(t,i,"/v1/token",`key=${l}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&Oc(t.emulatorConfig.host)&&(h.credentials="include"),SS.fetch()(o,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function qD(t,e){return Bc(t,"POST","/v2/accounts:revokeToken",Ih(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):iw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const r=iw(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:l}=await XD(e,r);this.updateTokensAndExpiration(n,i,Number(l))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:l}=r,o=new gc;return n&&(nt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(nt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),l&&(nt(typeof l=="number","internal-error",{appName:e}),o.expirationTime=l),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gc,this.toJSON())}_performRefresh(){return ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t,e){nt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ya{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new VD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new hp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await _u(this,this.stsTokenManager.getToken(this.auth,e));return nt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return HD(this,e)}reload(){return GD(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ya({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await rh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ga(this.auth.app))return Promise.reject(cs(this.auth));const e=await this.getIdToken();return await _u(this,jD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,l=r.phoneNumber??void 0,o=r.photoURL??void 0,u=r.tenantId??void 0,h=r._redirectEventId??void 0,d=r.createdAt??void 0,p=r.lastLoginAt??void 0,{uid:x,emailVerified:v,isAnonymous:_,providerData:E,stsTokenManager:w}=r;nt(x&&w,e,"internal-error");const S=gc.fromJSON(this.name,w);nt(typeof x=="string",e,"internal-error"),Yi(n,e.name),Yi(i,e.name),nt(typeof v=="boolean",e,"internal-error"),nt(typeof _=="boolean",e,"internal-error"),Yi(l,e.name),Yi(o,e.name),Yi(u,e.name),Yi(h,e.name),Yi(d,e.name),Yi(p,e.name);const N=new ya({uid:x,auth:e,email:i,emailVerified:v,displayName:n,isAnonymous:_,photoURL:o,phoneNumber:l,tenantId:u,stsTokenManager:S,createdAt:d,lastLoginAt:p});return E&&Array.isArray(E)&&(N.providerData=E.map(M=>({...M}))),h&&(N._redirectEventId=h),N}static async _fromIdTokenResponse(e,r,n=!1){const i=new gc;i.updateFromServerResponse(r);const l=new ya({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await rh(l),l}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];nt(i.localId!==void 0,"internal-error");const l=i.providerUserInfo!==void 0?AS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(l!=null&&l.length),u=new gc;u.updateFromIdToken(n);const h=new ya({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new hp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(l!=null&&l.length)};return Object.assign(h,d),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sw=new Map;function fi(t){_i(t instanceof Function,"Expected a class definition");let e=sw.get(t);return e?(_i(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,sw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}NS.type="NONE";const lw=NS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(t,e,r){return`firebase:${t}:${e}:${r}`}class xc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:l}=this.auth;this.fullUserKey=I0(this.userKey,i.apiKey,l),this.fullPersistenceKey=I0("persistence",i.apiKey,l),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await th(this.auth,{idToken:e}).catch(()=>{});return r?ya._fromGetAccountInfoResponse(this.auth,r,e):null}return ya._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new xc(fi(lw),e,n);const i=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let l=i[0]||fi(lw);const o=I0(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const p=await d._get(o);if(p){let x;if(typeof p=="string"){const v=await th(e,{idToken:p}).catch(()=>{});if(!v)break;x=await ya._fromGetAccountInfoResponse(e,v,p)}else x=ya._fromJSON(e,p);d!==l&&(u=x),l=d;break}}catch{}const h=i.filter(d=>d._shouldAllowMigration);return!l._shouldAllowMigration||!h.length?new xc(l,e,n):(l=h[0],u&&await l._set(o,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==l)try{await d._remove(o)}catch{}})),new xc(l,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(FS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(DS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(MS(e))return"Blackberry";if(LS(e))return"Webos";if(RS(e))return"Safari";if((e.includes("chrome/")||OS(e))&&!e.includes("edge/"))return"Chrome";if(IS(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function DS(t=fn()){return/firefox\//i.test(t)}function RS(t=fn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function OS(t=fn()){return/crios\//i.test(t)}function FS(t=fn()){return/iemobile/i.test(t)}function IS(t=fn()){return/android/i.test(t)}function MS(t=fn()){return/blackberry/i.test(t)}function LS(t=fn()){return/webos/i.test(t)}function vg(t=fn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function YD(t=fn()){var e;return vg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function KD(){return Qk()&&document.documentMode===10}function BS(t=fn()){return vg(t)||IS(t)||LS(t)||MS(t)||/windows phone/i.test(t)||FS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PS(t,e=[]){let r;switch(t){case"Browser":r=cw(fn());break;case"Worker":r=`${cw(fn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ic}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=l=>new Promise((o,u)=>{try{const h=e(l);o(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QD(t,e={}){return Bc(t,"GET","/v2/passwordPolicy",Ih(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD=6;class JD{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??ZD,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ow(this),this.idTokenSubscription=new ow(this),this.beforeStateQueue=new $D(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ES,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=fi(r)),this._initializationPromise=this.queue(async()=>{var n,i,l;if(!this._deleted&&(this.persistenceManager=await xc.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await th(this,{idToken:e}),n=await ya._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(ga(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(l=this.redirectUser)==null?void 0:l._redirectEventId,u=n==null?void 0:n._redirectEventId,h=await this.tryRedirectSignIn(e);(!o||o===u)&&(h!=null&&h.user)&&(n=h.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await rh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=MD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ga(this.app))return Promise.reject(cs(this));const r=e?oa(e):null;return r&&nt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ga(this.app)?Promise.reject(cs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ga(this.app)?Promise.reject(cs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await QD(this),r=new JD(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Lu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await qD(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&fi(e)||this._popupRedirectResolver;nt(r,this,"argument-error"),this.redirectPersistenceManager=await xc.create(this,[fi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const l=typeof r=="function"?r:r.next.bind(r);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(u,this,"internal-error"),u.then(()=>{o||l(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,i);return()=>{o=!0,h()}}else{const h=e.addObserver(r);return()=>{o=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(ga(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&OD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Mh(t){return oa(t)}class ow{constructor(e){this.auth=e,this.observer=null,this.addObserver=lA(r=>this.observer=r)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _g={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function t5(t){_g=t}function r5(t){return _g.loadJS(t)}function n5(){return _g.gapiScript}function a5(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i5(t,e){const r=Mp(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),l=r.getOptions();if(Qs(l,e??{}))return i;vi(i,"already-initialized")}return r.initialize({options:e})}function s5(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(fi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function l5(t,e,r){const n=Mh(t);nt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,l=US(e),{host:o,port:u}=c5(e),h=u===null?"":`:${u}`,d={url:`${l}//${o}${h}/`},p=Object.freeze({host:o,port:u,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){nt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),nt(Qs(d,n.config.emulator)&&Qs(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,Oc(o)?(JE(`${l}//${o}${h}`),eT("Auth",!0)):o5()}function US(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function c5(t){const e=US(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const l=i[1];return{host:l,port:uw(n.substr(l.length+1))}}else{const[l,o]=n.split(":");return{host:l,port:uw(o)}}}function uw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function o5(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ui("not implemented")}_getIdTokenResponse(e){return ui("not implemented")}_linkToIdToken(e,r){return ui("not implemented")}_getReauthenticationResolver(e){return ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vc(t,e){return CS(t,"POST","/v1/accounts:signInWithIdp",Ih(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5="http://localhost";class nl extends jS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new nl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):vi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...l}=r;if(!n||!i)return null;const o=new nl(n,i);return o.idToken=l.idToken||void 0,o.accessToken=l.accessToken||void 0,o.secret=l.secret,o.nonce=l.nonce,o.pendingToken=l.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return vc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,vc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,vc(e,r)}buildRequest(){const e={requestUri:u5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Fc(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu extends HS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends Gu{constructor(){super("facebook.com")}static credential(e){return nl._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $i.credential(e.oauthAccessToken)}catch{return null}}}$i.FACEBOOK_SIGN_IN_METHOD="facebook.com";$i.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends Gu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return nl._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Qi.credential(r,n)}catch{return null}}}Qi.GOOGLE_SIGN_IN_METHOD="google.com";Qi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi extends Gu{constructor(){super("github.com")}static credential(e){return nl._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zi.credential(e.oauthAccessToken)}catch{return null}}}Zi.GITHUB_SIGN_IN_METHOD="github.com";Zi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji extends Gu{constructor(){super("twitter.com")}static credential(e,r){return nl._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ji.credential(r,n)}catch{return null}}}Ji.TWITTER_SIGN_IN_METHOD="twitter.com";Ji.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f5(t,e){return CS(t,"POST","/v1/accounts:signUp",Ih(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const l=await ya._fromIdTokenResponse(e,n,i),o=fw(n);return new fs({user:l,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=fw(n);return new fs({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function fw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h5(t){var i;if(ga(t.app))return Promise.reject(cs(t));const e=Mh(t);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new fs({user:e.currentUser,providerId:null,operationType:"signIn"});const r=await f5(e,{returnSecureToken:!0}),n=await fs._fromIdTokenResponse(e,"signIn",r,!0);return await e._updateCurrentUser(n.user),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh extends gs{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,nh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new nh(e,r,n,i)}}function zS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?nh._fromErrorAndOperation(t,l,e,n):l})}async function d5(t,e,r=!1){const n=await _u(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return fs._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m5(t,e,r=!1){const{auth:n}=t;if(ga(n.app))return Promise.reject(cs(n));const i="reauthenticate";try{const l=await _u(t,zS(n,i,e,t),r);nt(l.idToken,n,"internal-error");const o=xg(l.idToken);nt(o,n,"internal-error");const{sub:u}=o;return nt(t.uid===u,n,"user-mismatch"),fs._forOperation(t,i,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&vi(n,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p5(t,e,r=!1){if(ga(t.app))return Promise.reject(cs(t));const n="signIn",i=await zS(t,n,e),l=await fs._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(l.user),l}function g5(t,e,r,n){return oa(t).onIdTokenChanged(e,r,n)}function x5(t,e,r){return oa(t).beforeAuthStateChanged(e,r)}const ah="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ah,"1"),this.storage.removeItem(ah),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5=1e3,_5=10;class GS extends VS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=BS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,u,h)=>{this.notifyListeners(o,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},l=this.storage.getItem(n);KD()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_5):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},v5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}GS.type="LOCAL";const y5=GS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS extends VS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}WS.type="SESSION";const XS=WS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w5(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Lh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:l}=r.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const u=Array.from(o).map(async d=>d(r.origin,l)),h=await w5(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Lh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let l,o;return new Promise((u,h)=>{const d=yg("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(x){const v=x;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(p),l=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),u(v.data.response);break;default:clearTimeout(p),clearTimeout(l),h(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(){return window}function T5(t){Ba().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(){return typeof Ba().WorkerGlobalScope<"u"&&typeof Ba().importScripts=="function"}async function S5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function b5(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function C5(){return qS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS="firebaseLocalStorageDb",k5=1,ih="firebaseLocalStorage",KS="fbase_key";class Wu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Bh(t,e){return t.transaction([ih],e?"readwrite":"readonly").objectStore(ih)}function A5(){const t=indexedDB.deleteDatabase(YS);return new Wu(t).toPromise()}function dp(){const t=indexedDB.open(YS,k5);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(ih,{keyPath:KS})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(ih)?e(n):(n.close(),await A5(),e(await dp()))})})}async function hw(t,e,r){const n=Bh(t,!0).put({[KS]:e,value:r});return new Wu(n).toPromise()}async function N5(t,e){const r=Bh(t,!1).get(e),n=await new Wu(r).toPromise();return n===void 0?null:n.value}function dw(t,e){const r=Bh(t,!0).delete(e);return new Wu(r).toPromise()}const D5=800,R5=3;class $S{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>R5)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return qS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lh._getInstance(C5()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await S5(),!this.activeServiceWorker)return;this.sender=new E5(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||b5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dp();return await hw(e,ah,"1"),await dw(e,ah),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>hw(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>N5(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>dw(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const l=Bh(i,!1).getAll();return new Wu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:l}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(l)&&(this.notifyListeners(i,l),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),D5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$S.type="LOCAL";const O5=$S;new Vu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(t,e){return e?fi(e):(nt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg extends jS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return vc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return vc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function I5(t){return p5(t.auth,new wg(t),t.bypassAuthState)}function M5(t){const{auth:e,user:r}=t;return nt(r,e,"internal-error"),m5(r,new wg(t),t.bypassAuthState)}async function L5(t){const{auth:e,user:r}=t;return nt(r,e,"internal-error"),d5(r,new wg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,r,n,i,l=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:l,error:o,type:u}=e;if(o){this.reject(o);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:l||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return I5;case"linkViaPopup":case"linkViaRedirect":return L5;case"reauthViaPopup":case"reauthViaRedirect":return M5;default:vi(this.auth,"internal-error")}}resolve(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B5=new Vu(2e3,1e4);class uc extends QS{constructor(e,r,n,i,l){super(e,r,i,l),this.provider=n,this.authWindow=null,this.pollId=null,uc.currentPopupAction&&uc.currentPopupAction.cancel(),uc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){_i(this.filter.length===1,"Popup operations only handle one event");const e=yg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(La(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(La(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,uc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(La(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,B5.get())};e()}}uc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P5="pendingRedirect",M0=new Map;class U5 extends QS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=M0.get(this.auth._key());if(!e){try{const n=await j5(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}M0.set(this.auth._key(),e)}return this.bypassAuthState||M0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function j5(t,e){const r=V5(e),n=z5(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function H5(t,e){M0.set(t._key(),e)}function z5(t){return fi(t._redirectPersistence)}function V5(t){return I0(P5,t.config.apiKey,t.name)}async function G5(t,e,r=!1){if(ga(t.app))return Promise.reject(cs(t));const n=Mh(t),i=F5(n,e),o=await new U5(n,i,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W5=600*1e3;class X5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!q5(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!ZS(e)){const i=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(La(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=W5&&this.cachedEventUids.clear(),this.cachedEventUids.has(mw(e))}saveEventToCache(e){this.cachedEventUids.add(mw(e)),this.lastProcessedEventTime=Date.now()}}function mw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ZS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function q5(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y5(t,e={}){return Bc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$5=/^https?/;async function Q5(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Y5(t);for(const r of e)try{if(Z5(r))return}catch{}vi(t,"unauthorized-domain")}function Z5(t){const e=fp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!$5.test(r))return!1;if(K5.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5=new Vu(3e4,6e4);function pw(){const t=Ba().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function eR(t){return new Promise((e,r)=>{var i,l,o;function n(){pw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pw(),r(La(t,"network-request-failed"))},timeout:J5.get()})}if((l=(i=Ba().gapi)==null?void 0:i.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((o=Ba().gapi)!=null&&o.load)n();else{const u=a5("iframefcb");return Ba()[u]=()=>{gapi.load?n():r(La(t,"network-request-failed"))},r5(`${n5()}?onload=${u}`).catch(h=>r(h))}}).catch(e=>{throw L0=null,e})}let L0=null;function tR(t){return L0=L0||eR(t),L0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=new Vu(5e3,15e3),nR="__/auth/iframe",aR="emulator/auth/iframe",iR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lR(t){const e=t.config;nt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?gg(e,aR):`https://${t.config.authDomain}/${nR}`,n={apiKey:e.apiKey,appName:t.name,v:Ic},i=sR.get(t.config.apiHost);i&&(n.eid=i);const l=t._getFrameworks();return l.length&&(n.fw=l.join(",")),`${r}?${Fc(n).slice(1)}`}async function cR(t){const e=await tR(t),r=Ba().gapi;return nt(r,t,"internal-error"),e.open({where:document.body,url:lR(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:iR,dontclear:!0},n=>new Promise(async(i,l)=>{await n.restyle({setHideOnLeave:!1});const o=La(t,"network-request-failed"),u=Ba().setTimeout(()=>{l(o)},rR.get());function h(){Ba().clearTimeout(u),i(n)}n.ping(h).then(h,()=>{l(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uR=500,fR=600,hR="_blank",dR="http://localhost";class gw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mR(t,e,r,n=uR,i=fR){const l=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h={...oR,width:n.toString(),height:i.toString(),top:l,left:o},d=fn().toLowerCase();r&&(u=OS(d)?hR:r),DS(d)&&(e=e||dR,h.scrollbars="yes");const p=Object.entries(h).reduce((v,[_,E])=>`${v}${_}=${E},`,"");if(YD(d)&&u!=="_self")return pR(e||"",u),new gw(null);const x=window.open(e||"",u,p);nt(x,t,"popup-blocked");try{x.focus()}catch{}return new gw(x)}function pR(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR="__/auth/handler",xR="emulator/auth/handler",vR=encodeURIComponent("fac");async function xw(t,e,r,n,i,l){nt(t.config.authDomain,t,"auth-domain-config-required"),nt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ic,eventId:i};if(e instanceof HS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Xm(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,x]of Object.entries({}))o[p]=x}if(e instanceof Gu){const p=e.getScopes().filter(x=>x!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await t._getAppCheckToken(),d=h?`#${vR}=${encodeURIComponent(h)}`:"";return`${_R(t)}?${Fc(u).slice(1)}${d}`}function _R({config:t}){return t.emulator?gg(t,xR):`https://${t.authDomain}/${gR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="webStorageSupport";class yR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=XS,this._completeRedirectFn=G5,this._overrideRedirectResult=H5}async _openPopup(e,r,n,i){var o;_i((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const l=await xw(e,r,n,fp(),i);return mR(e,l,yg())}async _openRedirect(e,r,n,i){await this._originValidation(e);const l=await xw(e,r,n,fp(),i);return T5(l),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:l}=this.eventManagers[r];return i?Promise.resolve(i):(_i(l,"If manager is not set, promise should be"),l)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await cR(e),n=new X5(e);return r.register("authEvent",i=>(nt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Cm,{type:Cm},i=>{var o;const l=(o=i==null?void 0:i[0])==null?void 0:o[Cm];l!==void 0&&r(!!l),vi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Q5(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return BS()||RS()||vg()}}const wR=yR;var vw="@firebase/auth",_w="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function SR(t){Sc(new Zs("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;nt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PS(t)},d=new e5(n,i,l,h);return s5(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Sc(new Zs("auth-internal",e=>{const r=Mh(e.getProvider("auth").getImmediate());return(n=>new ER(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ss(vw,_w,TR(t)),ss(vw,_w,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=300,CR=ZE("authIdTokenMaxAge")||bR;let yw=null;const kR=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>CR)return;const i=r==null?void 0:r.token;yw!==i&&(yw=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function AR(t=sT()){const e=Mp(t,"auth");if(e.isInitialized())return e.getImmediate();const r=i5(t,{popupRedirectResolver:wR,persistence:[O5,y5,XS]}),n=ZE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(n,location.origin);if(location.origin===l.origin){const o=kR(l.toString());x5(r,o,()=>o(r.currentUser)),g5(r,u=>o(u))}}const i=$E("auth");return i&&l5(r,`http://${i}`),r}function NR(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}t5({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const l=La("internal-error");l.customData=i,r(l)},n.type="text/javascript",n.charset="UTF-8",NR().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});SR("Browser");const mp={apiKey:"AIzaSyBpFRM3vgdTIwlRXe6uR6Oxk9Dr2hEOoCo",authDomain:"quan-ly-chi-bo-4ea6b.firebaseapp.com",databaseURL:"https://quan-ly-chi-bo-4ea6b-default-rtdb.firebaseio.com",projectId:"quan-ly-chi-bo-4ea6b",storageBucket:"quan-ly-chi-bo-4ea6b.firebasestorage.app",messagingSenderId:"1043830977640",appId:"1:1043830977640:web:63c57c51a0589c826a37dd",measurementId:"G-E7H6HTHXVB"},Pc=()=>mp.apiKey!=="DN_API_KEY_CA_BN_VO_Y"&&mp.databaseURL!=="",JS="DANG_VIEN_VOTE_DB_V2_PRO",Ws={voters:[],candidatesP1:[],candidatesP2:[],votesP1:[],votesP2:[],config:{maxExcellentVotes:5,isPhase1Open:!0,isPhase2Open:!0,p1Display:{showCCCD:!1,showMSSV:!0,showNgayVaoDang:!1,showLoaiDangVien:!0,showNhom:!0,showKhoa:!0,showChucVu:!0,showDiemHT:!0,showDiemRL:!0,showThanhTich:!1,showTuDanhGia:!0},p2Display:{showCCCD:!1,showMSSV:!0,showNgayVaoDang:!1,showLoaiDangVien:!1,showNhom:!0,showKhoa:!0,showChucVu:!0,showDiemHT:!0,showDiemRL:!0,showThanhTich:!1,showChiBoDeXuat:!0}}};let cn=JSON.parse(JSON.stringify(Ws)),DR=!1,ja=null;const wn=t=>String(t||"").trim(),Eg=()=>window.dispatchEvent(new Event("db_update")),Xu=t=>{console.error("Firebase Error:",t);const e=(t.message||JSON.stringify(t)).toLowerCase();e.includes("permission_denied")||e.includes("permission denied")?setTimeout(()=>{alert(`LI QUYN TRUY CP (PERMISSION DENIED)!

Nguyn nhn: Firebase Database ang chn ng dng c/ghi d liu.

CCH KHC PHC:
1. Vo Firebase Console (console.firebase.google.com)
2. Chn Project -> Realtime Database -> Tab 'Rules'
3. Xa ht code c v dn on sau:

{
  "rules": {
    ".read": true,
    ".write": true
  }
}

4. Bm 'Publish' (Xut bn)`)},1e3):console.warn("Li kt ni Cloud khc: "+e)},RR=()=>{if(Pc())try{console.log("ang kt ni Firebase...");const t=iT(mp),e=AR(t);h5(e).then(()=>{console.log(" ng nhp n danh vo Firebase.")}).catch(n=>{console.warn("Li ng nhp n danh (C th cha bt Anonymous Provider):",n)}),ja=kD(t);const r=zu(ja,"app_data");_S(r,n=>{var l,o;const i=n.val();i?(cn={...Ws,...i,config:{...Ws.config,...i.config}},cn.config.p1Display={...Ws.config.p1Display,...(l=i.config)==null?void 0:l.p1Display},cn.config.p2Display={...Ws.config.p2Display,...(o=i.config)==null?void 0:o.p2Display},cn.voters=Array.isArray(cn.voters)?cn.voters:[],cn.votesP1=Array.isArray(cn.votesP1)?cn.votesP1:[],cn.votesP2=Array.isArray(cn.votesP2)?cn.votesP2:[],console.log(" ng b d liu t Cloud")):console.log("Cloud cha c d liu, dng mc nh."),DR=!0,Eg()},n=>{console.error("Li c d liu:",n),Xu(n)})}catch(t){console.error("Li kt ni Firebase Init:",t),ww()}else console.warn("Cha cu hnh Firebase. S dng LocalStorage (Ch offline)."),ww()},ww=()=>{try{const t=localStorage.getItem(JS);if(t){const e=JSON.parse(t);cn={...Ws,...e}}Eg()}catch(t){console.error(t)}};RR();const Gr=()=>JSON.parse(JSON.stringify(cn)),Ia=async t=>{if(cn=t,Eg(),Pc()&&ja)try{return await vS(zu(ja,"app_data"),t),!0}catch(e){return Xu(e),!1}else return localStorage.setItem(JS,JSON.stringify(t)),!0},OR=async()=>{if(!Pc()||!ja)return{success:!1,message:"Cha kt ni c Firebase."};try{console.log("ang bt buc y d liu ln Cloud...");const t=Gr();return await vS(zu(ja,"app_data"),t),{success:!0,message:" ng b thnh cng! Ngi khc c th thy d liu ngay by gi."}}catch(t){return Xu(t),{success:!1,message:"Li: "+(t.message||"Khng xc nh")}}},eb=async(t=!1)=>{(t||confirm("CNH BO: Bn c chc chn mun XA TON B d liu trn h thng?"))&&(await Ia(JSON.parse(JSON.stringify(Ws))),t||window.location.reload())},FR=async()=>{const t=Gr();return t.candidatesP1=[],t.votesP1=[],t.voters=t.voters.map(e=>({...e,hasVotedPhase1:!1})),await Ia(t)},IR=async()=>{const t=Gr();return t.candidatesP2=[],t.votesP2=[],t.voters=t.voters.map(e=>({...e,hasVotedPhase2:!1})),await Ia(t)},MR=async()=>{const t=Gr();return t.voters=[],t.votesP1=[],t.votesP2=[],await Ia(t)},LR=async(t,e)=>{const r=wn(t);if(Pc()&&ja)try{return await yS(zu(ja,"app_data"),n=>{if(!n)return n;if(n.voters){const i=n.voters.findIndex(l=>wn(l.cccd)===r);i!==-1&&(n.voters[i].hasVotedPhase1=!0)}return Array.isArray(n.votesP1)||(n.votesP1=[]),n.votesP1=n.votesP1.filter(i=>wn(i.voterCCCD)!==r),e.forEach(i=>{n.votesP1.push({voterCCCD:r,candidateCCCD:wn(i.candidateCCCD),level:i.level})}),n}),!0}catch(n){return Xu(n),!1}else{const n=Gr(),i=n.voters.findIndex(l=>wn(l.cccd)===r);return i===-1?!1:(n.voters[i].hasVotedPhase1=!0,n.votesP1=n.votesP1.filter(l=>wn(l.voterCCCD)!==r),e.forEach(l=>{n.votesP1.push({voterCCCD:r,candidateCCCD:wn(l.candidateCCCD),level:l.level})}),await Ia(n))}},BR=async(t,e)=>{const r=wn(t);if(Pc()&&ja)try{return await yS(zu(ja,"app_data"),n=>{if(!n)return n;if(n.voters){const i=n.voters.findIndex(l=>wn(l.cccd)===r);i!==-1&&(n.voters[i].hasVotedPhase2=!0)}return Array.isArray(n.votesP2)||(n.votesP2=[]),n.votesP2=n.votesP2.filter(i=>wn(i.voterCCCD)!==r),e.forEach(i=>{n.votesP2.push({voterCCCD:r,candidateCCCD:wn(i)})}),n}),!0}catch(n){return Xu(n),!1}else{const n=Gr(),i=n.voters.findIndex(l=>wn(l.cccd)===r);return i===-1?!1:(n.voters[i].hasVotedPhase2=!0,n.votesP2=n.votesP2.filter(l=>wn(l.voterCCCD)!==r),e.forEach(l=>{n.votesP2.push({voterCCCD:r,candidateCCCD:wn(l)})}),await Ia(n))}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yu={};yu.version="0.18.5";var Pn=1200,al=1252,PR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Tg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ph=function(t){PR.indexOf(t)!=-1&&(al=Tg[0]=t)};function UR(){Ph(1252)}var la=function(t){Pn=t,Ph(t)};function Uh(){la(1200),UR()}function sh(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function jR(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function tb(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var fc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?jR(t.slice(2)):e==254&&r==255?tb(t.slice(2)):e==65279?t.slice(1):t},zo=function(e){return String.fromCharCode(e)},pp=function(e){return String.fromCharCode(e)},Tt;function HR(t){Tt=t,la=function(e){Pn=e,Ph(e)},fc=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?Tt.utils.decode(1200,sh(e.slice(2))):e},zo=function(r){return Pn===1200?String.fromCharCode(r):Tt.utils.decode(Pn,[r&255,r>>8])[0]},pp=function(r){return Tt.utils.decode(al,[r])[0]},Db()}var es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function wu(t){for(var e="",r=0,n=0,i=0,l=0,o=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),l=r>>2,n=t.charCodeAt(d++),o=(r&3)<<4|n>>4,i=t.charCodeAt(d++),u=(n&15)<<2|i>>6,h=i&63,isNaN(n)?u=h=64:isNaN(i)&&(h=64),e+=es.charAt(l)+es.charAt(o)+es.charAt(u)+es.charAt(h);return e}function Un(t){var e="",r=0,n=0,i=0,l=0,o=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)l=es.indexOf(t.charAt(d++)),o=es.indexOf(t.charAt(d++)),r=l<<2|o>>4,e+=String.fromCharCode(r),u=es.indexOf(t.charAt(d++)),n=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=es.indexOf(t.charAt(d++)),i=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(i));return e}var ft=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),wi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function hs(t){return ft?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Ew(t){return ft?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ln=function(e){return ft?wi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function qu(t){if(typeof ArrayBuffer>"u")return Ln(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function xs(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function zR(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Sg(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Sg(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Br=ft?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:wi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function VR(t){for(var e=[],r=0,n=t.length+250,i=hs(t.length+255),l=0;l<t.length;++l){var o=t.charCodeAt(l);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=t.charCodeAt(++l)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|u>>6&15|(o&3)<<4,i[r++]=128|u&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=hs(65535),n=65530)}return e.push(i.slice(0,r)),Br(e)}var tn=/\u0000/g,Vo=/[\u0001-\u0006]/g;function _c(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function wa(t,e){var r=""+t;return r.length>=e?r:cr("0",e-r.length)+r}function bg(t,e){var r=""+t;return r.length>=e?r:cr(" ",e-r.length)+r}function lh(t,e){var r=""+t;return r.length>=e?r:r+cr(" ",e-r.length)}function GR(t,e){var r=""+Math.round(t);return r.length>=e?r:cr("0",e-r.length)+r}function WR(t,e){var r=""+t;return r.length>=e?r:cr("0",e-r.length)+r}var Tw=Math.pow(2,32);function ac(t,e){if(t>Tw||t<-Tw)return GR(t,e);var r=Math.round(t);return WR(r,e)}function ch(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Sw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],km=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function XR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},bw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function oh(t,e,r){for(var n=t<0?-1:1,i=t*n,l=0,o=1,u=0,h=1,d=0,p=0,x=Math.floor(i);d<e&&(x=Math.floor(i),u=x*o+l,p=x*d+h,!(i-x<5e-8));)i=1/(i-x),l=o,o=u,h=d,d=p;if(p>e&&(d>e?(p=h,u=l):(p=d,u=o)),!r)return[0,n*u,p];var v=Math.floor(n*u/p);return[v,n*u-v*p,p]}function ts(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),l=0,o=[],u={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),n<60&&(l=(l+6)%7),r&&(l=JR(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=l,u}var rb=new Date(1899,11,31,0,0,0),YR=rb.getTime(),KR=new Date(1900,2,1,0,0,0);function nb(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=KR&&(r+=1440*60*1e3),(r-(YR+(t.getTimezoneOffset()-rb.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Cg(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $R(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function QR(t){var e=t<0?12:11,r=Cg(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function ZR(t){var e=Cg(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Eu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=QR(t):e===10?r=t.toFixed(10).substr(0,12):r=ZR(t),Cg($R(r.toUpperCase()))}function il(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Eu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return jn(14,nb(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function JR(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function eO(t,e,r,n){var i="",l=0,o=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return km[r.m-1][1];case 5:return km[r.m-1][0];default:return km[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return Sw[r.q][0];default:return Sw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?wa(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),e==="s"?l===0?"0":""+l/o:(i=wa(l,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var p=d>0?wa(h,d):"";return p}function rs(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var ab=/%/g;function tO(t,e,r){var n=e.replace(ab,""),i=e.length-n.length;return mi(t,n,r*Math.pow(10,2*i))+cr("%",i)}function rO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return mi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function ib(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ib(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(e/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var sb=/# (\?+)( ?)\/( ?)(\d+)/;function nO(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),l=Math.floor(i/n),o=i-l*n,u=n;return r+(l===0?"":""+l)+" "+(o===0?cr(" ",t[1].length+1+t[4].length):bg(o,t[1].length)+t[2]+"/"+t[3]+wa(u,t[4].length))}function aO(t,e,r){return r+(e===0?"":""+e)+cr(" ",t[1].length+2+t[4].length)}var lb=/^#*0*\.([0#]+)/,cb=/\).*[0#]/,ob=/\(###\) ###\\?-####/;function on(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Cw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function kw(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function iO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function sO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ta(t,e,r){if(t.charCodeAt(0)===40&&!e.match(cb)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ta("n",n,r):"("+ta("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return rO(t,e,r);if(e.indexOf("%")!==-1)return tO(t,e,r);if(e.indexOf("E")!==-1)return ib(e,r);if(e.charCodeAt(0)===36)return"$"+ta(t,e.substr(e.charAt(1)==" "?2:1),r);var i,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+ac(h,e.length);if(e.match(/^[#?]+$/))return i=ac(r,0),i==="0"&&(i=""),i.length>e.length?i:on(e.substr(0,e.length-i.length))+i;if(l=e.match(sb))return nO(l,h,d);if(e.match(/^#+0+$/))return d+ac(h,e.length-e.indexOf("0"));if(l=e.match(lb))return i=Cw(r,l[1].length).replace(/^([^\.]+)$/,"$1."+on(l[1])).replace(/\.$/,"."+on(l[1])).replace(/\.(\d*)$/,function(E,w){return"."+w+cr("0",on(l[1]).length-w.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return d+Cw(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return d+rs(ac(h,0));if(l=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ta(t,e,-r):rs(""+(Math.floor(r)+iO(r,l[1].length)))+"."+wa(kw(r,l[1].length),l[1].length);if(l=e.match(/^#,#*,#0/))return ta(t,e.replace(/^#,#*,/,""),r);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_c(ta(t,e.replace(/[\\-]/g,""),r)),o=0,_c(_c(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(e.match(ob))return i=ta(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=oh(h,Math.pow(10,o)-1,!1),i=""+d,p=mi("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=lh(u[2],o),p.length<l[4].length&&(p=on(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=oh(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?bg(u[1],o)+l[2]+"/"+l[3]+lh(u[2],o):cr(" ",2*o+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return i=ac(r,0),e.length<=i.length?i:on(e.substr(0,e.length-i.length))+i;if(l=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=e.indexOf(".")-o,v=e.length-i.length-x;return on(e.substr(0,x)+i+e.substr(e.length-v))}if(l=e.match(/^00,000\.([#0]*0)$/))return o=kw(r,l[1].length),r<0?"-"+ta(t,e,-r):rs(sO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?wa(0,3-E.length):"")+E})+"."+wa(o,l[1].length);switch(e){case"###,##0.00":return ta(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=rs(ac(h,0));return _!=="0"?d+_:"";case"###,###.00":return ta(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ta(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function lO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return mi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function cO(t,e,r){var n=e.replace(ab,""),i=e.length-n.length;return mi(t,n,r*Math.pow(10,2*i))+cr("%",i)}function ub(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ub(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(e/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Oa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(cb)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Oa("n",n,r):"("+Oa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return lO(t,e,r);if(e.indexOf("%")!==-1)return cO(t,e,r);if(e.indexOf("E")!==-1)return ub(e,r);if(e.charCodeAt(0)===36)return"$"+Oa(t,e.substr(e.charAt(1)==" "?2:1),r);var i,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+wa(h,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:on(e.substr(0,e.length-i.length))+i;if(l=e.match(sb))return aO(l,h,d);if(e.match(/^#+0+$/))return d+wa(h,e.length-e.indexOf("0"));if(l=e.match(lb))return i=(""+r).replace(/^([^\.]+)$/,"$1."+on(l[1])).replace(/\.$/,"."+on(l[1])),i=i.replace(/\.(\d*)$/,function(E,w){return"."+w+cr("0",on(l[1]).length-w.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return d+rs(""+h);if(l=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Oa(t,e,-r):rs(""+r)+"."+cr("0",l[1].length);if(l=e.match(/^#,#*,#0/))return Oa(t,e.replace(/^#,#*,/,""),r);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_c(Oa(t,e.replace(/[\\-]/g,""),r)),o=0,_c(_c(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(e.match(ob))return i=Oa(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=oh(h,Math.pow(10,o)-1,!1),i=""+d,p=mi("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=lh(u[2],o),p.length<l[4].length&&(p=on(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=oh(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?bg(u[1],o)+l[2]+"/"+l[3]+lh(u[2],o):cr(" ",2*o+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:on(e.substr(0,e.length-i.length))+i;if(l=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=e.indexOf(".")-o,v=e.length-i.length-x;return on(e.substr(0,x)+i+e.substr(e.length-v))}if(l=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Oa(t,e,-r):rs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?wa(0,3-E.length):"")+E})+"."+wa(0,l[1].length);switch(e){case"###,###":case"##,###":case"#,###":var _=rs(""+h);return _!=="0"?d+_:"";default:if(e.match(/\.[0#?]*$/))return Oa(t,e.slice(0,e.lastIndexOf(".")),r)+on(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function mi(t,e,r){return(r|0)===r?Oa(t,e,r):ta(t,e,r)}function oO(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var fb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function dl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":ch(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(fb))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function uO(t,e,r,n){for(var i=[],l="",o=0,u="",h="t",d,p,x,v="H";o<t.length;)switch(u=t.charAt(o)){case"G":if(!ch(t,o))throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(x=t.charCodeAt(++o))!==34&&o<t.length;)l+=String.fromCharCode(x);i[i.length]={t:"t",v:l},++o;break;case"\\":var _=t.charAt(++o),E=_==="("||_===")"?_:"t";i[i.length]={t:E,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=ts(e,r,t.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=ts(e,r),d==null))return"";for(l=u;++o<t.length&&t.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),i[i.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var w={t:u,v:u};if(d==null&&(d=ts(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",v="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",o+=5,v="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(w.v=d.H>=12?"":""),w.t="T",o+=5,v="h"):(w.t="t",++o),d==null&&w.t==="T")return"";i[i.length]=w,h=u;break;case"[":for(l=u;t.charAt(o++)!=="]"&&o<t.length;)l+=t.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(fb)){if(d==null&&(d=ts(e,r),d==null))return"";i[i.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",dl(t)||(i[i.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++o<t.length&&(u=t.charAt(o))==="0";)l+=u;i[i.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(o))>-1;)l+=u;i[i.length]={t:"n",v:l};break;case"?":for(l=u;t.charAt(++o)===u;)l+=u;i[i.length]={t:u,v:l},h=u;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)l+=t.charAt(o);i[i.length]={t:"D",v:l};break;case" ":i[i.length]={t:u,v:u},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"t",v:u},++o;break}var S=0,N=0,M;for(o=i.length-1,h="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,h="h",S<1&&(S=1);break;case"s":(M=i[o].v.match(/\.0+$/))&&(N=Math.max(N,M[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=i[o].t;break;case"m":h==="s"&&(i[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[o].v.match(/[Hh]/)&&(S=1),S<2&&i[o].v.match(/[Mm]/)&&(S=2),S<3&&i[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",z;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=eO(i[o].t.charCodeAt(0),i[o].v,d,N),i[o].t="t";break;case"n":case"?":for(z=o+1;i[z]!=null&&((u=i[z].t)==="?"||u==="D"||(u===" "||u==="t")&&i[z+1]!=null&&(i[z+1].t==="?"||i[z+1].t==="t"&&i[z+1].v==="/")||i[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[z].v==="/"||i[z].v===" "&&i[z+1]!=null&&i[z+1].t=="?"));)i[o].v+=i[z].v,i[z]={v:"",t:";"},++z;C+=i[o].v,o=z-1;break;case"G":i[o].t="t",i[o].v=il(e,r);break}var X="",G,O;if(C.length>0){C.charCodeAt(0)==40?(G=e<0&&C.charCodeAt(0)===45?-e:e,O=mi("n",C,G)):(G=e<0&&n>1?-e:e,O=mi("n",C,G),G<0&&i[0]&&i[0].t=="t"&&(O=O.substr(1),i[0].v="-"+i[0].v)),z=O.length-1;var Q=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){Q=o;break}var W=i.length;if(Q===i.length&&O.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(z>=i[o].v.length-1?(z-=i[o].v.length,i[o].v=O.substr(z+1,i[o].v.length)):z<0?i[o].v="":(i[o].v=O.substr(0,z+1),z=-1),i[o].t="t",W=o);z>=0&&W<i.length&&(i[W].v=O.substr(0,z+1)+i[W].v)}else if(Q!==i.length&&O.indexOf("E")===-1){for(z=O.indexOf(".")-1,o=Q;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(p=i[o].v.indexOf(".")>-1&&o===Q?i[o].v.indexOf(".")-1:i[o].v.length-1,X=i[o].v.substr(p+1);p>=0;--p)z>=0&&(i[o].v.charAt(p)==="0"||i[o].v.charAt(p)==="#")&&(X=O.charAt(z--)+X);i[o].v=X,i[o].t="t",W=o}for(z>=0&&W<i.length&&(i[W].v=O.substr(0,z+1)+i[W].v),z=O.indexOf(".")+1,o=Q;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==Q)){for(p=i[o].v.indexOf(".")>-1&&o===Q?i[o].v.indexOf(".")+1:0,X=i[o].v.substr(0,p);p<i[o].v.length;++p)z<O.length&&(X+=O.charAt(z++));i[o].v=X,i[o].t="t",W=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(G=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=mi(i[o].t,i[o].v,G),i[o].t="t");var fe="";for(o=0;o!==i.length;++o)i[o]!=null&&(fe+=i[o].v);return fe}var Aw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Nw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function fO(t,e){var r=oO(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Aw),u=r[1].match(Aw);return Nw(e,o)?[n,r[0]]:Nw(e,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,l]}function jn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ke)[t],n==null&&(n=r.table&&r.table[bw[t]]||Ke[bw[t]]),n==null&&(n=qR[t]||"General");break}if(ch(n,0))return il(e,r);e instanceof Date&&(e=nb(e,r.date1904));var i=fO(n,e);if(ch(i[1]))return il(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return uO(i[1],e,r,i[0])}function Pa(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ke[r]==null){e<0&&(e=r);continue}if(Ke[r]==t){e=r;break}}e<0&&(e=391)}return Ke[e]=t,e}function Yu(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Pa(t[e],e)}function Uc(){Ke=XR()}var hb={format:jn,load:Pa,_table:Ke,load_table:Yu,parse_date_code:ts,is_date:dl,get_table:function(){return hb._table=Ke}},hO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},db=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dO(t){var e=typeof t=="number"?Ke[t]:t;return e=e.replace(db,"(\\d+)"),new RegExp("^"+e+"$")}function mO(t,e,r){var n=-1,i=-1,l=-1,o=-1,u=-1,h=-1;(e.match(db)||[]).forEach(function(x,v){var _=parseInt(r[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=_;break;case"d":l=_;break;case"h":o=_;break;case"s":h=_;break;case"m":o>=0?u=_:i=_;break}}),h>=0&&u==-1&&i>=0&&(u=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?d:n==-1&&i==-1&&l==-1?p:d+"T"+p}var pO=(function(){var t={};t.version="1.2.0";function e(){for(var O=0,Q=new Array(256),W=0;W!=256;++W)O=W,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,Q[W]=O;return typeof Int32Array<"u"?new Int32Array(Q):Q}var r=e();function n(O){var Q=0,W=0,fe=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(fe=0;fe!=256;++fe)te[fe]=O[fe];for(fe=0;fe!=256;++fe)for(W=O[fe],Q=256+fe;Q<4096;Q+=256)W=te[Q]=W>>>8^O[W&255];var K=[];for(fe=1;fe!=16;++fe)K[fe-1]=typeof Int32Array<"u"?te.subarray(fe*256,fe*256+256):te.slice(fe*256,fe*256+256);return K}var i=n(r),l=i[0],o=i[1],u=i[2],h=i[3],d=i[4],p=i[5],x=i[6],v=i[7],_=i[8],E=i[9],w=i[10],S=i[11],N=i[12],M=i[13],C=i[14];function z(O,Q){for(var W=Q^-1,fe=0,te=O.length;fe<te;)W=W>>>8^r[(W^O.charCodeAt(fe++))&255];return~W}function X(O,Q){for(var W=Q^-1,fe=O.length-15,te=0;te<fe;)W=C[O[te++]^W&255]^M[O[te++]^W>>8&255]^N[O[te++]^W>>16&255]^S[O[te++]^W>>>24]^w[O[te++]]^E[O[te++]]^_[O[te++]]^v[O[te++]]^x[O[te++]]^p[O[te++]]^d[O[te++]]^h[O[te++]]^u[O[te++]]^o[O[te++]]^l[O[te++]]^r[O[te++]];for(fe+=15;te<fe;)W=W>>>8^r[(W^O[te++])&255];return~W}function G(O,Q){for(var W=Q^-1,fe=0,te=O.length,K=0,_e=0;fe<te;)K=O.charCodeAt(fe++),K<128?W=W>>>8^r[(W^K)&255]:K<2048?(W=W>>>8^r[(W^(192|K>>6&31))&255],W=W>>>8^r[(W^(128|K&63))&255]):K>=55296&&K<57344?(K=(K&1023)+64,_e=O.charCodeAt(fe++)&1023,W=W>>>8^r[(W^(240|K>>8&7))&255],W=W>>>8^r[(W^(128|K>>2&63))&255],W=W>>>8^r[(W^(128|_e>>6&15|(K&3)<<4))&255],W=W>>>8^r[(W^(128|_e&63))&255]):(W=W>>>8^r[(W^(224|K>>12&15))&255],W=W>>>8^r[(W^(128|K>>6&63))&255],W=W>>>8^r[(W^(128|K&63))&255]);return~W}return t.table=r,t.bstr=z,t.buf=X,t.str=G,t})(),Xe=(function(){var e={};e.version="1.2.1";function r(b,B){for(var R=b.split("/"),F=B.split("/"),I=0,P=0,ae=Math.min(R.length,F.length);I<ae;++I){if(P=R[I].length-F[I].length)return P;if(R[I]!=F[I])return R[I]<F[I]?-1:1}return R.length-F.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var B=b.lastIndexOf("/");return B===-1?b:b.slice(0,B+1)}function i(b){if(b.charAt(b.length-1)=="/")return i(b.slice(0,-1));var B=b.lastIndexOf("/");return B===-1?b:b.slice(B+1)}function l(b,B){typeof B=="string"&&(B=new Date(B));var R=B.getHours();R=R<<6|B.getMinutes(),R=R<<5|B.getSeconds()>>>1,b.write_shift(2,R);var F=B.getFullYear()-1980;F=F<<4|B.getMonth()+1,F=F<<5|B.getDate(),b.write_shift(2,F)}function o(b){var B=b.read_shift(2)&65535,R=b.read_shift(2)&65535,F=new Date,I=R&31;R>>>=5;var P=R&15;R>>>=4,F.setMilliseconds(0),F.setFullYear(R+1980),F.setMonth(P-1),F.setDate(I);var ae=B&31;B>>>=5;var me=B&63;return B>>>=6,F.setHours(B),F.setMinutes(me),F.setSeconds(ae<<1),F}function u(b){Wr(b,0);for(var B={},R=0;b.l<=b.length-4;){var F=b.read_shift(2),I=b.read_shift(2),P=b.l+I,ae={};switch(F){case 21589:R=b.read_shift(1),R&1&&(ae.mtime=b.read_shift(4)),I>5&&(R&2&&(ae.atime=b.read_shift(4)),R&4&&(ae.ctime=b.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}b.l=P,B[F]=ae}return B}var h;function d(){return h||(h={})}function p(b,B){if(b[0]==80&&b[1]==75)return ys(b,B);if((b[0]|32)==109&&(b[1]|32)==105)return Es(b,B);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var R=3,F=512,I=0,P=0,ae=0,me=0,ie=0,le=[],oe=b.slice(0,512);Wr(oe,0);var Ce=x(oe);switch(R=Ce[0],R){case 3:F=512;break;case 4:F=4096;break;case 0:if(Ce[1]==0)return ys(b,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}F!==512&&(oe=b.slice(0,F),Wr(oe,28));var Ne=b.slice(0,F);v(oe,R);var Ue=oe.read_shift(4,"i");if(R===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);oe.l+=4,ae=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),me=oe.read_shift(4,"i"),I=oe.read_shift(4,"i"),ie=oe.read_shift(4,"i"),P=oe.read_shift(4,"i");for(var Ae=-1,Pe=0;Pe<109&&(Ae=oe.read_shift(4,"i"),!(Ae<0));++Pe)le[Pe]=Ae;var Ve=_(b,F);S(ie,P,Ve,F,le);var Xt=M(Ve,ae,le,F);Xt[ae].name="!Directory",I>0&&me!==_e&&(Xt[me].name="!MiniFAT"),Xt[le[0]].name="!FAT",Xt.fat_addrs=le,Xt.ssz=F;var qt={},tr=[],Vn=[],Ts=[];C(ae,Xt,Ve,tr,I,qt,Vn,me),E(Vn,Ts,tr),tr.shift();var Si={FileIndex:Vn,FullPaths:Ts};return B&&B.raw&&(Si.raw={header:Ne,sectors:Ve}),Si}function x(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(Me,"Header Signature: "),b.l+=16;var B=b.read_shift(2,"u");return[b.read_shift(2,"u"),B]}function v(b,B){var R=9;switch(b.l+=2,R=b.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function _(b,B){for(var R=Math.ceil(b.length/B)-1,F=[],I=1;I<R;++I)F[I-1]=b.slice(I*B,(I+1)*B);return F[R-1]=b.slice(R*B),F}function E(b,B,R){for(var F=0,I=0,P=0,ae=0,me=0,ie=R.length,le=[],oe=[];F<ie;++F)le[F]=oe[F]=F,B[F]=R[F];for(;me<oe.length;++me)F=oe[me],I=b[F].L,P=b[F].R,ae=b[F].C,le[F]===F&&(I!==-1&&le[I]!==I&&(le[F]=le[I]),P!==-1&&le[P]!==P&&(le[F]=le[P])),ae!==-1&&(le[ae]=F),I!==-1&&F!=le[F]&&(le[I]=le[F],oe.lastIndexOf(I)<me&&oe.push(I)),P!==-1&&F!=le[F]&&(le[P]=le[F],oe.lastIndexOf(P)<me&&oe.push(P));for(F=1;F<ie;++F)le[F]===F&&(P!==-1&&le[P]!==P?le[F]=le[P]:I!==-1&&le[I]!==I&&(le[F]=le[I]));for(F=1;F<ie;++F)if(b[F].type!==0){if(me=F,me!=le[me])do me=le[me],B[F]=B[me]+"/"+B[F];while(me!==0&&le[me]!==-1&&me!=le[me]);le[F]=-1}for(B[0]+="/",F=1;F<ie;++F)b[F].type!==2&&(B[F]+="/")}function w(b,B,R){for(var F=b.start,I=b.size,P=[],ae=F;R&&I>0&&ae>=0;)P.push(B.slice(ae*K,ae*K+K)),I-=K,ae=zs(R,ae*4);return P.length===0?he(0):Br(P).slice(0,b.size)}function S(b,B,R,F,I){var P=_e;if(b===_e){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var ae=R[b],me=(F>>>2)-1;if(!ae)return;for(var ie=0;ie<me&&(P=zs(ae,ie*4))!==_e;++ie)I.push(P);S(zs(ae,F-4),B-1,R,F,I)}}function N(b,B,R,F,I){var P=[],ae=[];I||(I=[]);var me=F-1,ie=0,le=0;for(ie=B;ie>=0;){I[ie]=!0,P[P.length]=ie,ae.push(b[ie]);var oe=R[Math.floor(ie*4/F)];if(le=ie*4&me,F<4+le)throw new Error("FAT boundary crossed: "+ie+" 4 "+F);if(!b[oe])break;ie=zs(b[oe],le)}return{nodes:P,data:Hw([ae])}}function M(b,B,R,F){var I=b.length,P=[],ae=[],me=[],ie=[],le=F-1,oe=0,Ce=0,Ne=0,Ue=0;for(oe=0;oe<I;++oe)if(me=[],Ne=oe+B,Ne>=I&&(Ne-=I),!ae[Ne]){ie=[];var Ae=[];for(Ce=Ne;Ce>=0;){Ae[Ce]=!0,ae[Ce]=!0,me[me.length]=Ce,ie.push(b[Ce]);var Pe=R[Math.floor(Ce*4/F)];if(Ue=Ce*4&le,F<4+Ue)throw new Error("FAT boundary crossed: "+Ce+" 4 "+F);if(!b[Pe]||(Ce=zs(b[Pe],Ue),Ae[Ce]))break}P[Ne]={nodes:me,data:Hw([ie])}}return P}function C(b,B,R,F,I,P,ae,me){for(var ie=0,le=F.length?2:0,oe=B[b].data,Ce=0,Ne=0,Ue;Ce<oe.length;Ce+=128){var Ae=oe.slice(Ce,Ce+128);Wr(Ae,64),Ne=Ae.read_shift(2),Ue=Vh(Ae,0,Ne-le),F.push(Ue);var Pe={name:Ue,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},Ve=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Ve!==0&&(Pe.ct=z(Ae,Ae.l-8));var Xt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Xt!==0&&(Pe.mt=z(Ae,Ae.l-8)),Pe.start=Ae.read_shift(4,"i"),Pe.size=Ae.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=_e,Pe.name=""),Pe.type===5?(ie=Pe.start,I>0&&ie!==_e&&(B[ie].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",B[Pe.start]===void 0&&(B[Pe.start]=N(R,Pe.start,B.fat_addrs,B.ssz)),B[Pe.start].name=Pe.name,Pe.content=B[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:ie!==_e&&Pe.start!==_e&&B[ie]&&(Pe.content=w(Pe,B[ie].data,(B[me]||{}).data))),Pe.content&&Wr(Pe.content,0),P[Ue]=Pe,ae.push(Pe)}}function z(b,B){return new Date((Mr(b,B+4)/1e7*Math.pow(2,32)+Mr(b,B)/1e7-11644473600)*1e3)}function X(b,B){return d(),p(h.readFileSync(b),B)}function G(b,B){var R=B&&B.type;switch(R||ft&&Buffer.isBuffer(b)&&(R="buffer"),R||"base64"){case"file":return X(b,B);case"base64":return p(Ln(Un(b)),B);case"binary":return p(Ln(b),B)}return p(b,B)}function O(b,B){var R=B||{},F=R.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=F+"/",b.FileIndex[0]={name:F,type:5}),R.CLSID&&(b.FileIndex[0].clsid=R.CLSID),Q(b)}function Q(b){var B="Sh33tJ5";if(!Xe.find(b,"/"+B)){var R=he(4);R[0]=55,R[1]=R[3]=50,R[2]=54,b.FileIndex.push({name:B,type:2,content:R,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+B),W(b)}}function W(b,B){O(b);for(var R=!1,F=!1,I=b.FullPaths.length-1;I>=0;--I){var P=b.FileIndex[I];switch(P.type){case 0:F?R=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(P.R*P.L*P.C)&&(R=!0),P.R>-1&&P.L>-1&&P.R==P.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!B)){var ae=new Date(1987,1,19),me=0,ie=Object.create?Object.create(null):{},le=[];for(I=0;I<b.FullPaths.length;++I)ie[b.FullPaths[I]]=!0,b.FileIndex[I].type!==0&&le.push([b.FullPaths[I],b.FileIndex[I]]);for(I=0;I<le.length;++I){var oe=n(le[I][0]);F=ie[oe],F||(le.push([oe,{name:i(oe).replace("/",""),type:1,clsid:Y,ct:ae,mt:ae,content:null}]),ie[oe]=!0)}for(le.sort(function(Ue,Ae){return r(Ue[0],Ae[0])}),b.FullPaths=[],b.FileIndex=[],I=0;I<le.length;++I)b.FullPaths[I]=le[I][0],b.FileIndex[I]=le[I][1];for(I=0;I<le.length;++I){var Ce=b.FileIndex[I],Ne=b.FullPaths[I];if(Ce.name=i(Ne).replace("/",""),Ce.L=Ce.R=Ce.C=-(Ce.color=1),Ce.size=Ce.content?Ce.content.length:0,Ce.start=0,Ce.clsid=Ce.clsid||Y,I===0)Ce.C=le.length>1?1:-1,Ce.size=0,Ce.type=5;else if(Ne.slice(-1)=="/"){for(me=I+1;me<le.length&&n(b.FullPaths[me])!=Ne;++me);for(Ce.C=me>=le.length?-1:me,me=I+1;me<le.length&&n(b.FullPaths[me])!=n(Ne);++me);Ce.R=me>=le.length?-1:me,Ce.type=1}else n(b.FullPaths[I+1]||"")==n(Ne)&&(Ce.R=I+1),Ce.type=2}}}function fe(b,B){var R=B||{};if(R.fileType=="mad")return Jh(b,R);switch(W(b),R.fileType){case"zip":return wl(b,R)}var F=(function(Ue){for(var Ae=0,Pe=0,Ve=0;Ve<Ue.FileIndex.length;++Ve){var Xt=Ue.FileIndex[Ve];if(Xt.content){var qt=Xt.content.length;qt>0&&(qt<4096?Ae+=qt+63>>6:Pe+=qt+511>>9)}}for(var tr=Ue.FullPaths.length+3>>2,Vn=Ae+7>>3,Ts=Ae+127>>7,Si=Vn+Pe+tr+Ts,Ca=Si+127>>7,Xc=Ca<=109?0:Math.ceil((Ca-109)/127);Si+Ca+Xc+127>>7>Ca;)Xc=++Ca<=109?0:Math.ceil((Ca-109)/127);var dn=[1,Xc,Ca,Ts,tr,Pe,Ae,0];return Ue.FileIndex[0].size=Ae<<6,dn[7]=(Ue.FileIndex[0].start=dn[0]+dn[1]+dn[2]+dn[3]+dn[4]+dn[5])+(dn[6]+7>>3),dn})(b),I=he(F[7]<<9),P=0,ae=0;{for(P=0;P<8;++P)I.write_shift(1,Se[P]);for(P=0;P<8;++P)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),P=0;P<3;++P)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,F[2]),I.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:_e),I.write_shift(4,F[3]),I.write_shift(-4,F[1]?F[0]-1:_e),I.write_shift(4,F[1]),P=0;P<109;++P)I.write_shift(-4,P<F[2]?F[1]+P:-1)}if(F[1])for(ae=0;ae<F[1];++ae){for(;P<236+ae*127;++P)I.write_shift(-4,P<F[2]?F[1]+P:-1);I.write_shift(-4,ae===F[1]-1?_e:ae+1)}var me=function(Ue){for(ae+=Ue;P<ae-1;++P)I.write_shift(-4,P+1);Ue&&(++P,I.write_shift(-4,_e))};for(ae=P=0,ae+=F[1];P<ae;++P)I.write_shift(-4,se.DIFSECT);for(ae+=F[2];P<ae;++P)I.write_shift(-4,se.FATSECT);me(F[3]),me(F[4]);for(var ie=0,le=0,oe=b.FileIndex[0];ie<b.FileIndex.length;++ie)oe=b.FileIndex[ie],oe.content&&(le=oe.content.length,!(le<4096)&&(oe.start=ae,me(le+511>>9)));for(me(F[6]+7>>3);I.l&511;)I.write_shift(-4,se.ENDOFCHAIN);for(ae=P=0,ie=0;ie<b.FileIndex.length;++ie)oe=b.FileIndex[ie],oe.content&&(le=oe.content.length,!(!le||le>=4096)&&(oe.start=ae,me(le+63>>6)));for(;I.l&511;)I.write_shift(-4,se.ENDOFCHAIN);for(P=0;P<F[4]<<2;++P){var Ce=b.FullPaths[P];if(!Ce||Ce.length===0){for(ie=0;ie<17;++ie)I.write_shift(4,0);for(ie=0;ie<3;++ie)I.write_shift(4,-1);for(ie=0;ie<12;++ie)I.write_shift(4,0);continue}oe=b.FileIndex[P],P===0&&(oe.start=oe.size?oe.start-1:_e);var Ne=P===0&&R.root||oe.name;if(le=2*(Ne.length+1),I.write_shift(64,Ne,"utf16le"),I.write_shift(2,le),I.write_shift(1,oe.type),I.write_shift(1,oe.color),I.write_shift(-4,oe.L),I.write_shift(-4,oe.R),I.write_shift(-4,oe.C),oe.clsid)I.write_shift(16,oe.clsid,"hex");else for(ie=0;ie<4;++ie)I.write_shift(4,0);I.write_shift(4,oe.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,oe.start),I.write_shift(4,oe.size),I.write_shift(4,0)}for(P=1;P<b.FileIndex.length;++P)if(oe=b.FileIndex[P],oe.size>=4096)if(I.l=oe.start+1<<9,ft&&Buffer.isBuffer(oe.content))oe.content.copy(I,I.l,0,oe.size),I.l+=oe.size+511&-512;else{for(ie=0;ie<oe.size;++ie)I.write_shift(1,oe.content[ie]);for(;ie&511;++ie)I.write_shift(1,0)}for(P=1;P<b.FileIndex.length;++P)if(oe=b.FileIndex[P],oe.size>0&&oe.size<4096)if(ft&&Buffer.isBuffer(oe.content))oe.content.copy(I,I.l,0,oe.size),I.l+=oe.size+63&-64;else{for(ie=0;ie<oe.size;++ie)I.write_shift(1,oe.content[ie]);for(;ie&63;++ie)I.write_shift(1,0)}if(ft)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function te(b,B){var R=b.FullPaths.map(function(ie){return ie.toUpperCase()}),F=R.map(function(ie){var le=ie.split("/");return le[le.length-(ie.slice(-1)=="/"?2:1)]}),I=!1;B.charCodeAt(0)===47?(I=!0,B=R[0].slice(0,-1)+B):I=B.indexOf("/")!==-1;var P=B.toUpperCase(),ae=I===!0?R.indexOf(P):F.indexOf(P);if(ae!==-1)return b.FileIndex[ae];var me=!P.match(Vo);for(P=P.replace(tn,""),me&&(P=P.replace(Vo,"!")),ae=0;ae<R.length;++ae)if((me?R[ae].replace(Vo,"!"):R[ae]).replace(tn,"")==P||(me?F[ae].replace(Vo,"!"):F[ae]).replace(tn,"")==P)return b.FileIndex[ae];return null}var K=64,_e=-2,Me="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_e,FREESECT:-1,HEADER_SIGNATURE:Me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Le(b,B,R){d();var F=fe(b,R);h.writeFileSync(B,F)}function Z(b){for(var B=new Array(b.length),R=0;R<b.length;++R)B[R]=String.fromCharCode(b[R]);return B.join("")}function Oe(b,B){var R=fe(b,B);switch(B&&B.type||"buffer"){case"file":return d(),h.writeFileSync(B.filename,R),R;case"binary":return typeof R=="string"?R:Z(R);case"base64":return wu(typeof R=="string"?R:Z(R));case"buffer":if(ft)return Buffer.isBuffer(R)?R:wi(R);case"array":return typeof R=="string"?Ln(R):R}return R}var H;function k(b){try{var B=b.InflateRaw,R=new B;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)H=b;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function j(b,B){if(!H)return rf(b,B);var R=H.InflateRaw,F=new R,I=F._processChunk(b.slice(b.l),F._finishFlushFlag);return b.l+=F.bytesRead,I}function L(b){return H?H.deflateRawSync(b):Ye(b)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(b){var B=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(B>>16|B>>8|B)&255}for(var ge=typeof Uint8Array<"u",Ee=ge?new Uint8Array(256):[],be=0;be<256;++be)Ee[be]=we(be);function D(b,B){var R=Ee[b&255];return B<=8?R>>>8-B:(R=R<<8|Ee[b>>8&255],B<=16?R>>>16-B:(R=R<<8|Ee[b>>16&255],R>>>24-B))}function Te(b,B){var R=B&7,F=B>>>3;return(b[F]|(R<=6?0:b[F+1]<<8))>>>R&3}function Be(b,B){var R=B&7,F=B>>>3;return(b[F]|(R<=5?0:b[F+1]<<8))>>>R&7}function je(b,B){var R=B&7,F=B>>>3;return(b[F]|(R<=4?0:b[F+1]<<8))>>>R&15}function He(b,B){var R=B&7,F=B>>>3;return(b[F]|(R<=3?0:b[F+1]<<8))>>>R&31}function ke(b,B){var R=B&7,F=B>>>3;return(b[F]|(R<=1?0:b[F+1]<<8))>>>R&127}function Ct(b,B,R){var F=B&7,I=B>>>3,P=(1<<R)-1,ae=b[I]>>>F;return R<8-F||(ae|=b[I+1]<<8-F,R<16-F)||(ae|=b[I+2]<<16-F,R<24-F)||(ae|=b[I+3]<<24-F),ae&P}function ir(b,B,R){var F=B&7,I=B>>>3;return F<=5?b[I]|=(R&7)<<F:(b[I]|=R<<F&255,b[I+1]=(R&7)>>8-F),B+3}function Sr(b,B,R){var F=B&7,I=B>>>3;return R=(R&1)<<F,b[I]|=R,B+1}function qr(b,B,R){var F=B&7,I=B>>>3;return R<<=F,b[I]|=R&255,R>>>=8,b[I+1]=R,B+8}function Ga(b,B,R){var F=B&7,I=B>>>3;return R<<=F,b[I]|=R&255,R>>>=8,b[I+1]=R&255,b[I+2]=R>>>8,B+16}function Hn(b,B){var R=b.length,F=2*R>B?2*R:B+5,I=0;if(R>=B)return b;if(ft){var P=Ew(F);if(b.copy)b.copy(P);else for(;I<b.length;++I)P[I]=b[I];return P}else if(ge){var ae=new Uint8Array(F);if(ae.set)ae.set(b);else for(;I<R;++I)ae[I]=b[I];return ae}return b.length=F,b}function Ot(b){for(var B=new Array(b),R=0;R<b;++R)B[R]=0;return B}function Fe(b,B,R){var F=1,I=0,P=0,ae=0,me=0,ie=b.length,le=ge?new Uint16Array(32):Ot(32);for(P=0;P<32;++P)le[P]=0;for(P=ie;P<R;++P)b[P]=0;ie=b.length;var oe=ge?new Uint16Array(ie):Ot(ie);for(P=0;P<ie;++P)le[I=b[P]]++,F<I&&(F=I),oe[P]=0;for(le[0]=0,P=1;P<=F;++P)le[P+16]=me=me+le[P-1]<<1;for(P=0;P<ie;++P)me=b[P],me!=0&&(oe[P]=le[me+16]++);var Ce=0;for(P=0;P<ie;++P)if(Ce=b[P],Ce!=0)for(me=D(oe[P],F)>>F-Ce,ae=(1<<F+4-Ce)-1;ae>=0;--ae)B[me|ae<<Ce]=Ce&15|P<<4;return F}var We=ge?new Uint16Array(512):Ot(512),Qe=ge?new Uint16Array(32):Ot(32);if(!ge){for(var tt=0;tt<512;++tt)We[tt]=0;for(tt=0;tt<32;++tt)Qe[tt]=0}(function(){for(var b=[],B=0;B<32;B++)b.push(5);Fe(b,Qe,32);var R=[];for(B=0;B<=143;B++)R.push(8);for(;B<=255;B++)R.push(9);for(;B<=279;B++)R.push(7);for(;B<=287;B++)R.push(8);Fe(R,We,288)})();var Ze=(function(){for(var B=ge?new Uint8Array(32768):[],R=0,F=0;R<pe.length-1;++R)for(;F<pe[R+1];++F)B[F]=R;for(;F<32768;++F)B[F]=29;var I=ge?new Uint8Array(259):[];for(R=0,F=0;R<J.length-1;++R)for(;F<J[R+1];++F)I[F]=R;function P(me,ie){for(var le=0;le<me.length;){var oe=Math.min(65535,me.length-le),Ce=le+oe==me.length;for(ie.write_shift(1,+Ce),ie.write_shift(2,oe),ie.write_shift(2,~oe&65535);oe-- >0;)ie[ie.l++]=me[le++]}return ie.l}function ae(me,ie){for(var le=0,oe=0,Ce=ge?new Uint16Array(32768):[];oe<me.length;){var Ne=Math.min(65535,me.length-oe);if(Ne<10){for(le=ir(ie,le,+(oe+Ne==me.length)),le&7&&(le+=8-(le&7)),ie.l=le/8|0,ie.write_shift(2,Ne),ie.write_shift(2,~Ne&65535);Ne-- >0;)ie[ie.l++]=me[oe++];le=ie.l*8;continue}le=ir(ie,le,+(oe+Ne==me.length)+2);for(var Ue=0;Ne-- >0;){var Ae=me[oe];Ue=(Ue<<5^Ae)&32767;var Pe=-1,Ve=0;if((Pe=Ce[Ue])&&(Pe|=oe&-32768,Pe>oe&&(Pe-=32768),Pe<oe))for(;me[Pe+Ve]==me[oe+Ve]&&Ve<250;)++Ve;if(Ve>2){Ae=I[Ve],Ae<=22?le=qr(ie,le,Ee[Ae+1]>>1)-1:(qr(ie,le,3),le+=5,qr(ie,le,Ee[Ae-23]>>5),le+=3);var Xt=Ae<8?0:Ae-4>>2;Xt>0&&(Ga(ie,le,Ve-J[Ae]),le+=Xt),Ae=B[oe-Pe],le=qr(ie,le,Ee[Ae]>>3),le-=3;var qt=Ae<4?0:Ae-2>>1;qt>0&&(Ga(ie,le,oe-Pe-pe[Ae]),le+=qt);for(var tr=0;tr<Ve;++tr)Ce[Ue]=oe&32767,Ue=(Ue<<5^me[oe])&32767,++oe;Ne-=Ve-1}else Ae<=143?Ae=Ae+48:le=Sr(ie,le,1),le=qr(ie,le,Ee[Ae]),Ce[Ue]=oe&32767,++oe}le=qr(ie,le,0)-1}return ie.l=(le+7)/8|0,ie.l}return function(ie,le){return ie.length<8?P(ie,le):ae(ie,le)}})();function Ye(b){var B=he(50+Math.floor(b.length*1.1)),R=Ze(b,B);return B.slice(0,R)}var St=ge?new Uint16Array(32768):Ot(32768),Nr=ge?new Uint16Array(32768):Ot(32768),pt=ge?new Uint16Array(128):Ot(128),hr=1,fa=1;function sn(b,B){var R=He(b,B)+257;B+=5;var F=He(b,B)+1;B+=5;var I=je(b,B)+4;B+=4;for(var P=0,ae=ge?new Uint8Array(19):Ot(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,le=ge?new Uint8Array(8):Ot(8),oe=ge?new Uint8Array(8):Ot(8),Ce=ae.length,Ne=0;Ne<I;++Ne)ae[U[Ne]]=P=Be(b,B),ie<P&&(ie=P),le[P]++,B+=3;var Ue=0;for(le[0]=0,Ne=1;Ne<=ie;++Ne)oe[Ne]=Ue=Ue+le[Ne-1]<<1;for(Ne=0;Ne<Ce;++Ne)(Ue=ae[Ne])!=0&&(me[Ne]=oe[Ue]++);var Ae=0;for(Ne=0;Ne<Ce;++Ne)if(Ae=ae[Ne],Ae!=0){Ue=Ee[me[Ne]]>>8-Ae;for(var Pe=(1<<7-Ae)-1;Pe>=0;--Pe)pt[Ue|Pe<<Ae]=Ae&7|Ne<<3}var Ve=[];for(ie=1;Ve.length<R+F;)switch(Ue=pt[ke(b,B)],B+=Ue&7,Ue>>>=3){case 16:for(P=3+Te(b,B),B+=2,Ue=Ve[Ve.length-1];P-- >0;)Ve.push(Ue);break;case 17:for(P=3+Be(b,B),B+=3;P-- >0;)Ve.push(0);break;case 18:for(P=11+ke(b,B),B+=7;P-- >0;)Ve.push(0);break;default:Ve.push(Ue),ie<Ue&&(ie=Ue);break}var Xt=Ve.slice(0,R),qt=Ve.slice(R);for(Ne=R;Ne<286;++Ne)Xt[Ne]=0;for(Ne=F;Ne<30;++Ne)qt[Ne]=0;return hr=Fe(Xt,St,286),fa=Fe(qt,Nr,30),B}function Qh(b,B){if(b[0]==3&&!(b[1]&3))return[hs(B),2];for(var R=0,F=0,I=Ew(B||1<<18),P=0,ae=I.length>>>0,me=0,ie=0;(F&1)==0;){if(F=Be(b,R),R+=3,F>>>1)F>>1==1?(me=9,ie=5):(R=sn(b,R),me=hr,ie=fa);else{R&7&&(R+=8-(R&7));var le=b[R>>>3]|b[(R>>>3)+1]<<8;if(R+=32,le>0)for(!B&&ae<P+le&&(I=Hn(I,P+le),ae=I.length);le-- >0;)I[P++]=b[R>>>3],R+=8;continue}for(;;){!B&&ae<P+32767&&(I=Hn(I,P+32767),ae=I.length);var oe=Ct(b,R,me),Ce=F>>>1==1?We[oe]:St[oe];if(R+=Ce&15,Ce>>>=4,(Ce>>>8&255)===0)I[P++]=Ce;else{if(Ce==256)break;Ce-=257;var Ne=Ce<8?0:Ce-4>>2;Ne>5&&(Ne=0);var Ue=P+J[Ce];Ne>0&&(Ue+=Ct(b,R,Ne),R+=Ne),oe=Ct(b,R,ie),Ce=F>>>1==1?Qe[oe]:Nr[oe],R+=Ce&15,Ce>>>=4;var Ae=Ce<4?0:Ce-2>>1,Pe=pe[Ce];for(Ae>0&&(Pe+=Ct(b,R,Ae),R+=Ae),!B&&ae<Ue&&(I=Hn(I,Ue+100),ae=I.length);P<Ue;)I[P]=I[P-Pe],++P}}}return B?[I,R+7>>>3]:[I.slice(0,P),R+7>>>3]}function rf(b,B){var R=b.slice(b.l||0),F=Qh(R,B);return b.l+=F[1],F[0]}function nf(b,B){if(b)typeof console<"u"&&console.error(B);else throw new Error(B)}function ys(b,B){var R=b;Wr(R,0);var F=[],I=[],P={FileIndex:F,FullPaths:I};O(P,{root:B.root});for(var ae=R.length-4;(R[ae]!=80||R[ae+1]!=75||R[ae+2]!=5||R[ae+3]!=6)&&ae>=0;)--ae;R.l=ae+4,R.l+=4;var me=R.read_shift(2);R.l+=6;var ie=R.read_shift(4);for(R.l=ie,ae=0;ae<me;++ae){R.l+=20;var le=R.read_shift(4),oe=R.read_shift(4),Ce=R.read_shift(2),Ne=R.read_shift(2),Ue=R.read_shift(2);R.l+=8;var Ae=R.read_shift(4),Pe=u(R.slice(R.l+Ce,R.l+Ce+Ne));R.l+=Ce+Ne+Ue;var Ve=R.l;R.l=Ae+4,yl(R,le,oe,P,Pe),R.l=Ve}return P}function yl(b,B,R,F,I){b.l+=2;var P=b.read_shift(2),ae=b.read_shift(2),me=o(b);if(P&8257)throw new Error("Unsupported ZIP encryption");for(var ie=b.read_shift(4),le=b.read_shift(4),oe=b.read_shift(4),Ce=b.read_shift(2),Ne=b.read_shift(2),Ue="",Ae=0;Ae<Ce;++Ae)Ue+=String.fromCharCode(b[b.l++]);if(Ne){var Pe=u(b.slice(b.l,b.l+Ne));(Pe[21589]||{}).mt&&(me=Pe[21589].mt),((I||{})[21589]||{}).mt&&(me=I[21589].mt)}b.l+=Ne;var Ve=b.slice(b.l,b.l+le);switch(ae){case 8:Ve=j(b,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Xt=!1;P&8&&(ie=b.read_shift(4),ie==134695760&&(ie=b.read_shift(4),Xt=!0),le=b.read_shift(4),oe=b.read_shift(4)),le!=B&&nf(Xt,"Bad compressed size: "+B+" != "+le),oe!=R&&nf(Xt,"Bad uncompressed size: "+R+" != "+oe),Tl(F,Ue,Ve,{unsafe:!0,mt:me})}function wl(b,B){var R=B||{},F=[],I=[],P=he(1),ae=R.compression?8:0,me=0,ie=0,le=0,oe=0,Ce=0,Ne=b.FullPaths[0],Ue=Ne,Ae=b.FileIndex[0],Pe=[],Ve=0;for(ie=1;ie<b.FullPaths.length;++ie)if(Ue=b.FullPaths[ie].slice(Ne.length),Ae=b.FileIndex[ie],!(!Ae.size||!Ae.content||Ue=="Sh33tJ5")){var Xt=oe,qt=he(Ue.length);for(le=0;le<Ue.length;++le)qt.write_shift(1,Ue.charCodeAt(le)&127);qt=qt.slice(0,qt.l),Pe[Ce]=pO.buf(Ae.content,0);var tr=Ae.content;ae==8&&(tr=L(tr)),P=he(30),P.write_shift(4,67324752),P.write_shift(2,20),P.write_shift(2,me),P.write_shift(2,ae),Ae.mt?l(P,Ae.mt):P.write_shift(4,0),P.write_shift(-4,Pe[Ce]),P.write_shift(4,tr.length),P.write_shift(4,Ae.content.length),P.write_shift(2,qt.length),P.write_shift(2,0),oe+=P.length,F.push(P),oe+=qt.length,F.push(qt),oe+=tr.length,F.push(tr),P=he(46),P.write_shift(4,33639248),P.write_shift(2,0),P.write_shift(2,20),P.write_shift(2,me),P.write_shift(2,ae),P.write_shift(4,0),P.write_shift(-4,Pe[Ce]),P.write_shift(4,tr.length),P.write_shift(4,Ae.content.length),P.write_shift(2,qt.length),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(4,0),P.write_shift(4,Xt),Ve+=P.l,I.push(P),Ve+=qt.length,I.push(qt),++Ce}return P=he(22),P.write_shift(4,101010256),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,Ce),P.write_shift(2,Ce),P.write_shift(4,Ve),P.write_shift(4,oe),P.write_shift(2,0),Br([Br(F),Br(I),P])}var zn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function El(b,B){if(b.ctype)return b.ctype;var R=b.name||"",F=R.match(/\.([^\.]+)$/);return F&&zn[F[1]]||B&&(F=(R=B).match(/[\.\\]([^\.\\])+$/),F&&zn[F[1]])?zn[F[1]]:"application/octet-stream"}function ws(b){for(var B=wu(b),R=[],F=0;F<B.length;F+=76)R.push(B.slice(F,F+76));return R.join(`\r
`)+`\r
`}function Zh(b){var B=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var oe=le.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],F=B.split(`\r
`),I=0;I<F.length;++I){var P=F[I];if(P.length==0){R.push("");continue}for(var ae=0;ae<P.length;){var me=76,ie=P.slice(ae,ae+me);ie.charAt(me-1)=="="?me--:ie.charAt(me-2)=="="?me-=2:ie.charAt(me-3)=="="&&(me-=3),ie=P.slice(ae,ae+me),ae+=me,ae<P.length&&(ie+="="),R.push(ie)}}return R.join(`\r
`)}function af(b){for(var B=[],R=0;R<b.length;++R){for(var F=b[R];R<=b.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+b[++R];B.push(F)}for(var I=0;I<B.length;++I)B[I]=B[I].replace(/[=][0-9A-Fa-f]{2}/g,function(P){return String.fromCharCode(parseInt(P.slice(1),16))});return Ln(B.join(`\r
`))}function Vc(b,B,R){for(var F="",I="",P="",ae,me=0;me<10;++me){var ie=B[me];if(!ie||ie.match(/^\s*$/))break;var le=ie.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":F=le[2].trim();break;case"content-type":P=le[2].trim();break;case"content-transfer-encoding":I=le[2].trim();break}}switch(++me,I.toLowerCase()){case"base64":ae=Ln(Un(B.slice(me).join("")));break;case"quoted-printable":ae=af(B.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var oe=Tl(b,F.slice(R.length),ae,{unsafe:!0});P&&(oe.ctype=P)}function Es(b,B){if(Z(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=B&&B.root||"",F=(ft&&Buffer.isBuffer(b)?b.toString("binary"):Z(b)).split(`\r
`),I=0,P="";for(I=0;I<F.length;++I)if(P=F[I],!!/^Content-Location:/i.test(P)&&(P=P.slice(P.indexOf("file")),R||(R=P.slice(0,P.lastIndexOf("/")+1)),P.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),P.slice(0,R.length)!=R););var ae=(F[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var me="--"+(ae[1]||""),ie=[],le=[],oe={FileIndex:ie,FullPaths:le};O(oe);var Ce,Ne=0;for(I=0;I<F.length;++I){var Ue=F[I];Ue!==me&&Ue!==me+"--"||(Ne++&&Vc(oe,F.slice(Ce,I),R),Ce=I)}return oe}function Jh(b,B){var R=B||{},F=R.boundary||"SheetJS";F="------="+F;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],P=b.FullPaths[0],ae=P,me=b.FileIndex[0],ie=1;ie<b.FullPaths.length;++ie)if(ae=b.FullPaths[ie].slice(P.length),me=b.FileIndex[ie],!(!me.size||!me.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ve){return"_x"+Ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ve){return"_u"+Ve.charCodeAt(0).toString(16)+"_"});for(var le=me.content,oe=ft&&Buffer.isBuffer(le)?le.toString("binary"):Z(le),Ce=0,Ne=Math.min(1024,oe.length),Ue=0,Ae=0;Ae<=Ne;++Ae)(Ue=oe.charCodeAt(Ae))>=32&&Ue<128&&++Ce;var Pe=Ce>=Ne*4/5;I.push(F),I.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+ae),I.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),I.push("Content-Type: "+El(me,ae)),I.push(""),I.push(Pe?Zh(oe):ws(oe))}return I.push(F+`--\r
`),I.join(`\r
`)}function sf(b){var B={};return O(B,b),B}function Tl(b,B,R,F){var I=F&&F.unsafe;I||O(b);var P=!I&&Xe.find(b,B);if(!P){var ae=b.FullPaths[0];B.slice(0,ae.length)==ae?ae=B:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+B).replace("//","/")),P={name:i(B),type:2},b.FileIndex.push(P),b.FullPaths.push(ae),I||Xe.utils.cfb_gc(b)}return P.content=R,P.size=R?R.length:0,F&&(F.CLSID&&(P.clsid=F.CLSID),F.mt&&(P.mt=F.mt),F.ct&&(P.ct=F.ct)),P}function lf(b,B){O(b);var R=Xe.find(b,B);if(R){for(var F=0;F<b.FileIndex.length;++F)if(b.FileIndex[F]==R)return b.FileIndex.splice(F,1),b.FullPaths.splice(F,1),!0}return!1}function Gc(b,B,R){O(b);var F=Xe.find(b,B);if(F){for(var I=0;I<b.FileIndex.length;++I)if(b.FileIndex[I]==F)return b.FileIndex[I].name=i(R),b.FullPaths[I]=R,!0}return!1}function Wc(b){W(b,!0)}return e.find=te,e.read=G,e.parse=p,e.write=Oe,e.writeFile=Le,e.utils={cfb_new:sf,cfb_add:Tl,cfb_del:lf,cfb_mov:Gc,cfb_gc:Wc,ReadShift:Zo,CheckField:Rb,prep_blob:Wr,bconcat:Br,use_zlib:k,_deflateRaw:Ye,_inflateRaw:rf,consts:se},e})();let ns;function gO(t){ns=t}function xO(t){return typeof t=="string"?qu(t):Array.isArray(t)?zR(t):t}function Ku(t,e,r){if(typeof ns<"u"&&ns.writeFileSync)return r?ns.writeFileSync(t,e,r):ns.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=qu(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ma(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([xO(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=xs(e)),u.write(e),u.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function vO(t){if(typeof ns<"u")return ns.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function fr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Dw(t,e){for(var r=[],n=fr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function jh(t){for(var e=[],r=fr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Hh(t){for(var e=[],r=fr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function _O(t){for(var e=[],r=fr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var uh=new Date(1899,11,30,0,0,0);function Ar(t,e){var r=t.getTime(),n=uh.getTime()+(t.getTimezoneOffset()-uh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var mb=new Date,yO=uh.getTime()+(mb.getTimezoneOffset()-uh.getTimezoneOffset())*6e4,Rw=mb.getTimezoneOffset();function zh(t){var e=new Date;return e.setTime(t*24*60*60*1e3+yO),e.getTimezoneOffset()!==Rw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Rw)*6e4),e}function wO(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var l=1;l!=i.length;++l)if(i[l]){switch(r=1,l>3&&(n=!0),i[l].slice(i[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[l].slice(i[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[l],10)}return e}var Ow=new Date("2017-02-19T19:06:09.000Z"),pb=isNaN(Ow.getFullYear())?new Date("2/19/17"):Ow,EO=pb.getFullYear()==2017;function er(t,e){var r=new Date(t);if(EO)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(pb.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function sl(t,e){if(ft&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ma(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ma(tb(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ma(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ma(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Gt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Gt(t[r]));return e}function cr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ta(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,l){return r=-r,l}),!isNaN(e=Number(n)))?e/r:e}var TO=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ac(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),l=e.getDate();if(isNaN(l))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&TO.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||l>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var SO=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var l=r.split(n),o=[l[0]],u=1;u<l.length;++u)o.push(i),o.push(l[u]);return o}})();function gb(t){return t?t.content&&t.type?sl(t.content,!0):t.data?fc(t.data):t.asNodeBuffer&&ft?fc(t.asNodeBuffer().toString("binary")):t.asBinary?fc(t.asBinary()):t._data&&t._data.getContent?fc(sl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function xb(t){if(!t)return null;if(t.data)return sh(t.data);if(t.asNodeBuffer&&ft)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?sh(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function bO(t){return t&&t.name.slice(-4)===".bin"?xb(t):gb(t)}function aa(t,e){for(var r=t.FullPaths||fr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[l]]:t.FileIndex[l]}return null}function kg(t,e){var r=aa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Er(t,e,r){if(!r)return bO(kg(t,e));if(!e)return null;try{return Er(t,e)}catch{return null}}function Bn(t,e,r){if(!r)return gb(kg(t,e));if(!e)return null;try{return Bn(t,e)}catch{return null}}function CO(t,e,r){return xb(kg(t,e))}function Fw(t){for(var e=t.FullPaths||fr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ut(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ft?n=wi(r):n=VR(r),Xe.utils.cfb_add(t,e,n)}Xe.utils.cfb_add(t,e,r)}else t.file(e,r)}function Ag(){return Xe.utils.cfb_new()}function vb(t,e){switch(e.type){case"base64":return Xe.read(t,{type:"base64"});case"binary":return Xe.read(t,{type:"binary"});case"buffer":case"array":return Xe.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Go(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var gr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Iw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,AO=/<[^>]*>/g,an=gr.match(Iw)?Iw:AO,NO=/<\w*:/,DO=/<(\/?)\w+:/;function rt(t,e,r){for(var n={},i=0,l=0;i!==t.length&&!((l=t.charCodeAt(i))===32||l===10||l===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(kO),u=0,h="",d=0,p="",x="",v=1;if(o)for(d=0;d!=o.length;++d){for(x=o[d],l=0;l!=x.length&&x.charCodeAt(l)!==61;++l);for(p=x.slice(0,l).trim();x.charCodeAt(l+1)==32;)++l;for(v=(i=x.charCodeAt(l+1))==34||i==39?1:0,h=x.slice(l+1+v,x.length-v),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var _=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[_]&&p.slice(u-3,u)=="ext")continue;n[_]=h,n[_.toLowerCase()]=h}}return n}function za(t){return t.replace(DO,"<$1")}var _b={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ng=jh(_b),bt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",l=i.indexOf("<![CDATA[");if(l==-1)return i.replace(t,function(u,h){return _b[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=i.indexOf("]]>");return r(i.slice(0,l))+i.slice(l+9,o)+r(i.slice(o+3))}})(),Dg=/[&<>'"]/g,RO=/[\u0000-\u0008\u000b-\u001f]/g;function Bt(t){var e=t+"";return e.replace(Dg,function(r){return Ng[r]}).replace(RO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Mw(t){return Bt(t).replace(/ /g,"_x0020_")}var yb=/[\u0000-\u001f]/g;function Rg(t){var e=t+"";return e.replace(Dg,function(r){return Ng[r]}).replace(/\n/g,"<br/>").replace(yb,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function OO(t){var e=t+"";return e.replace(Dg,function(r){return Ng[r]}).replace(yb,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Lw=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function FO(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Zt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Am(t){for(var e="",r=0,n=0,i=0,l=0,o=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(l=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|l&63);continue}o=t.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(l&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function Bw(t){var e=hs(2*t.length),r,n,i=1,l=0,o=0,u;for(n=0;n<t.length;n+=i)i=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[l++]=o&255,e[l++]=o>>>8,o=0),e[l++]=r%256,e[l++]=r>>>8;return e.slice(0,l).toString("ucs2")}function Pw(t){return wi(t,"binary").toString("utf8")}var E0="foo bar baz",zt=ft&&(Pw(E0)==Am(E0)&&Pw||Bw(E0)==Am(E0)&&Bw)||Am,Ma=ft?function(t){return wi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Tu=(function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),wb=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}})(),IO=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),MO=/<\/?(?:vt:)?variant>/g,LO=/<(?:vt:)([^>]*)>([\s\S]*)</;function Uw(t,e){var r=rt(t),n=t.match(IO(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(l){var o=l.replace(MO,"").match(LO);o&&i.push({v:zt(o[2]),t:o[1]})}),i}var Eb=/(^\s|\s$|\n)/;function Xr(t,e){return"<"+t+(e.match(Eb)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Su(t){return fr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function De(t,e,r){return"<"+t+(r!=null?Su(r):"")+(e!=null?(e.match(Eb)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function gp(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function BO(t,e){switch(typeof t){case"string":var r=De("vt:lpwstr",Bt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return De((t|0)==t?"vt:i4":"vt:r8",Bt(String(t)));case"boolean":return De("vt:bool",t?"true":"false")}if(t instanceof Date)return De("vt:filetime",gp(t));throw new Error("Unable to serialize "+t)}function Og(t){if(ft&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return zt(xs(Sg(t)));throw new Error("Bad input format: expected Buffer or string")}var bu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,kr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ml=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Mn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function PO(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,l=5;l>=0;--l)i=i*256+t[e+l];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function UO(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,l=0,o=n?-e:e;isFinite(o)?o==0?i=l=0:(i=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?i=-1022:(l-=Math.pow(2,52),i+=1023)):(i=2047,l=isNaN(e)?26985:0);for(var u=0;u<=5;++u,l/=256)t[r+u]=l&255;t[r+6]=(i&15)<<4|l&15,t[r+7]=i>>4|n}var jw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,l=t[0][n].length;i<l;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Hw=ft?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:wi(e)})):jw(t)}:jw,zw=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(hi(t,i)));return n.join("").replace(tn,"")},Vh=ft?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(tn,""):zw(t,e,r)}:zw,Vw=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Tb=ft?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Vw(t,e,r)}:Vw,Gw=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(cc(t,i)));return n.join("")},jc=ft?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Gw(e,r,n)}:Gw,Sb=function(t,e){var r=Mr(t,e);return r>0?jc(t,e+4,e+4+r-1):""},Fg=Sb,bb=function(t,e){var r=Mr(t,e);return r>0?jc(t,e+4,e+4+r-1):""},Ig=bb,Cb=function(t,e){var r=2*Mr(t,e);return r>0?jc(t,e+4,e+4+r-1):""},Mg=Cb,kb=function(e,r){var n=Mr(e,r);return n>0?Vh(e,r+4,r+4+n):""},Lg=kb,Ab=function(t,e){var r=Mr(t,e);return r>0?jc(t,e+4,e+4+r):""},Bg=Ab,Nb=function(t,e){return PO(t,e)},fh=Nb,Pg=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ft&&(Fg=function(e,r){if(!Buffer.isBuffer(e))return Sb(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Ig=function(e,r){if(!Buffer.isBuffer(e))return bb(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Mg=function(e,r){if(!Buffer.isBuffer(e))return Cb(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Lg=function(e,r){if(!Buffer.isBuffer(e))return kb(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Bg=function(e,r){if(!Buffer.isBuffer(e))return Ab(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},fh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Nb(e,r)},Pg=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function Db(){Vh=function(t,e,r){return Tt.utils.decode(1200,t.slice(e,r)).replace(tn,"")},jc=function(t,e,r){return Tt.utils.decode(65001,t.slice(e,r))},Fg=function(t,e){var r=Mr(t,e);return r>0?Tt.utils.decode(al,t.slice(e+4,e+4+r-1)):""},Ig=function(t,e){var r=Mr(t,e);return r>0?Tt.utils.decode(Pn,t.slice(e+4,e+4+r-1)):""},Mg=function(t,e){var r=2*Mr(t,e);return r>0?Tt.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},Lg=function(t,e){var r=Mr(t,e);return r>0?Tt.utils.decode(1200,t.slice(e+4,e+4+r)):""},Bg=function(t,e){var r=Mr(t,e);return r>0?Tt.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof Tt<"u"&&Db();var cc=function(t,e){return t[e]},hi=function(t,e){return t[e+1]*256+t[e]},jO=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Mr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},zs=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},HO=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Zo(t,e){var r="",n,i,l=[],o,u,h,d;switch(e){case"dbcs":if(d=this.l,ft&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(hi(this,d)),d+=2;t*=2;break;case"utf8":r=jc(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Vh(this,this.l,this.l+t);break;case"wstr":if(typeof Tt<"u")r=Tt.utils.decode(Pn,this.slice(this.l,this.l+2*t));else return Zo.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=Fg(this,this.l),t=4+Mr(this,this.l);break;case"lpstr-cp":r=Ig(this,this.l),t=4+Mr(this,this.l);break;case"lpwstr":r=Mg(this,this.l),t=4+2*Mr(this,this.l);break;case"lpp4":t=4+Mr(this,this.l),r=Lg(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Mr(this,this.l),r=Bg(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=cc(this,this.l+t++))!==0;)l.push(zo(o));r=l.join("");break;case"_wstr":for(t=0,r="";(o=hi(this,this.l+t))!==0;)l.push(zo(o)),t+=2;t+=2,r=l.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=cc(this,d),this.l=d+1,u=Zo.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(zo(hi(this,d))),d+=2}r=l.join(""),t*=2;break;case"cpstr":if(typeof Tt<"u"){r=Tt.utils.decode(Pn,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=cc(this,d),this.l=d+1,u=Zo.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(zo(cc(this,d))),d+=1}r=l.join("");break;default:switch(t){case 1:return n=cc(this,this.l),this.l++,n;case 2:return n=(e==="i"?jO:hi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?zs:HO)(this,this.l),this.l+=4,n):(i=Mr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=fh(this,this.l):i=fh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Tb(this,this.l,t);break}}return this.l+=t,r}var zO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},VO=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},GO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function WO(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)GO(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof Tt<"u"&&al==874)for(i=0;i!=e.length;++i){var l=Tt.utils.encode(al,e.charAt(i));this[this.l+i]=l[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var u=e.charCodeAt(i);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,zO(this,e,this.l);break;case 8:if(n=8,r==="f"){UO(this,e,this.l);break}case 16:break;case-4:n=4,VO(this,e,this.l);break}return this.l+=n,this}function Rb(t,e){var r=Tb(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Wr(t,e){t.l=e,t.read_shift=Zo,t.chk=Rb,t.write_shift=WO}function nn(t,e){t.l+=e}function he(t){var e=hs(t);return Wr(e,0),e}function Ei(t,e,r){if(t){var n,i,l;Wr(t,t.l||0);for(var o=t.length,u=0,h=0;t.l<o;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=Ru[u]||Ru[65535];for(n=t.read_shift(1),l=n&127,i=1;i<4&&n&128;++i)l+=((n=t.read_shift(1))&127)<<7*i;h=t.l+l;var p=d.f&&d.f(t,l,r);if(t.l=h,e(p,d,u))return}}}function Cn(){var t=[],e=ft?256:2048,r=function(d){var p=he(d);return Wr(p,0),p},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},l=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,e)))},o=function(){return i(),Br(t)},u=function(d){i(),n=d,n.l==null&&(n.l=n.length),l(e)};return{next:l,push:u,end:o,_bufs:t}}function ye(t,e,r,n){var i=+e,l;if(!isNaN(i)){n||(n=Ru[i].p||(r||[]).length||0),l=1+(i>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var o=t.next(l);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Pg(r)&&t.push(r)}}function Jo(t,e,r){var n=Gt(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ww(t,e,r){var n=Gt(t);return n.s=Jo(n.s,e.s,r),n.e=Jo(n.e,e.s,r),n}function eu(t,e){if(t.cRel&&t.c<0)for(t=Gt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Gt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Je(t);return!t.cRel&&t.cRel!=null&&(r=YO(r)),!t.rRel&&t.rRel!=null&&(r=XO(r)),r}function Nm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Jt(t.s.c)+":"+(t.e.cRel?"":"$")+Jt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+or(t.s.r)+":"+(t.e.rRel?"":"$")+or(t.e.r):eu(t.s,e.biff)+":"+eu(t.e,e.biff)}function Ug(t){return parseInt(qO(t),10)-1}function or(t){return""+(t+1)}function XO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function qO(t){return t.replace(/\$(\d+)$/,"$1")}function jg(t){for(var e=KO(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Jt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function YO(t){return t.replace(/^([A-Z])/,"$$$1")}function KO(t){return t.replace(/^\$([A-Z])/,"$1")}function $O(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ar(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Je(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function hn(t){var e=t.indexOf(":");return e==-1?{s:ar(t),e:ar(t)}:{s:ar(t.slice(0,e)),e:ar(t.slice(e+1))}}function ct(t,e){return typeof e>"u"||typeof e=="number"?ct(t.s,t.e):(typeof t!="string"&&(t=Je(t)),typeof e!="string"&&(e=Je(e)),t==e?t:t+":"+e)}function wt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,l=t.length;for(r=0;n<l&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<l&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===l||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=l&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=l&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Xw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=jn(t.z,r?Ar(e):e)}catch{}try{return t.w=jn((t.XF||{}).numFmtId||(r?14:0),r?Ar(e):e)}catch{return""+e}}function Ha(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ti[t.v]||t.v:e==null?Xw(t,t.v):Xw(t,e))}function vs(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Ob(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,l=t||(i?[]:{}),o=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?ar(n.origin):n.origin;o=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=wt(l["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),o==-1&&(d.e.r=o=p.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[x].length;++v)if(!(typeof e[x][v]>"u")){var _={v:e[x][v]},E=o+x,w=u+v;if(d.s.r>E&&(d.s.r=E),d.s.c>w&&(d.s.c=w),d.e.r<E&&(d.e.r=E),d.e.c<w&&(d.e.c=w),e[x][v]&&typeof e[x][v]=="object"&&!Array.isArray(e[x][v])&&!(e[x][v]instanceof Date))_=e[x][v];else if(Array.isArray(_.v)&&(_.f=e[x][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||Ke[14],n.cellDates?(_.t="d",_.w=jn(_.z,Ar(_.v))):(_.t="n",_.v=Ar(_.v),_.w=jn(_.z,_.v))):_.t="s";if(i)l[E]||(l[E]=[]),l[E][w]&&l[E][w].z&&(_.z=l[E][w].z),l[E][w]=_;else{var S=Je({c:w,r:E});l[S]&&l[S].z&&(_.z=l[S].z),l[S]=_}}}return d.s.c<1e7&&(l["!ref"]=ct(d)),l}function Hc(t,e){return Ob(null,t,e)}function QO(t){return t.read_shift(4,"i")}function Sa(t,e){return e||(e=he(4)),e.write_shift(4,t),e}function rn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Pr(t,e){var r=!1;return e==null&&(r=!0,e=he(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function ZO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function JO(t,e){return e||(e=he(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Hg(t,e){var r=t.l,n=t.read_shift(1),i=rn(t),l=[],o={t:i,h:i};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)l.push(ZO(t));o.r=l}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function eF(t,e){var r=!1;return e==null&&(r=!0,e=he(15+4*t.t.length)),e.write_shift(1,0),Pr(t.t,e),r?e.slice(0,e.l):e}var tF=Hg;function rF(t,e){var r=!1;return e==null&&(r=!0,e=he(23+4*t.t.length)),e.write_shift(1,1),Pr(t.t,e),e.write_shift(4,1),JO({},e),r?e.slice(0,e.l):e}function ua(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function pl(t,e){return e==null&&(e=he(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function gl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function xl(t,e){return e==null&&(e=he(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var nF=rn,Fb=Pr;function zg(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function hh(t,e){var r=!1;return e==null&&(r=!0,e=he(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var aF=rn,xp=zg,Vg=hh;function Gg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?fh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):zs(e,0)>>2;return r?i/100:i}function Ib(t,e){e==null&&(e=he(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Mb(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function iF(t,e){return e||(e=he(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var vl=Mb,zc=iF;function en(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ll(t,e){return(e||he(8)).write_shift(8,t,"f")}function sF(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),l=t.read_shift(2,"i"),o=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var d=Xs[i];d&&(e.rgb=ku(d));break;case 2:e.rgb=ku([o,u,h]);break;case 3:e.theme=i;break}return l!=0&&(e.tint=l>0?l/32767:l/32768),e}function dh(t,e){if(e||(e=he(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function lF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function cF(t,e){e||(e=he(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function Lb(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function oF(t){return Lb(t,1)}function uF(t){return Lb(t,2)}var Wg=2,yn=3,T0=11,qw=12,mh=19,S0=64,fF=65,hF=71,dF=4108,mF=4126,Or=80,Bb=81,pF=[Or,Bb],vp={1:{n:"CodePage",t:Wg},2:{n:"Category",t:Or},3:{n:"PresentationFormat",t:Or},4:{n:"ByteCount",t:yn},5:{n:"LineCount",t:yn},6:{n:"ParagraphCount",t:yn},7:{n:"SlideCount",t:yn},8:{n:"NoteCount",t:yn},9:{n:"HiddenCount",t:yn},10:{n:"MultimediaClipCount",t:yn},11:{n:"ScaleCrop",t:T0},12:{n:"HeadingPairs",t:dF},13:{n:"TitlesOfParts",t:mF},14:{n:"Manager",t:Or},15:{n:"Company",t:Or},16:{n:"LinksUpToDate",t:T0},17:{n:"CharacterCount",t:yn},19:{n:"SharedDoc",t:T0},22:{n:"HyperlinksChanged",t:T0},23:{n:"AppVersion",t:yn,p:"version"},24:{n:"DigSig",t:fF},26:{n:"ContentType",t:Or},27:{n:"ContentStatus",t:Or},28:{n:"Language",t:Or},29:{n:"Version",t:Or},255:{},2147483648:{n:"Locale",t:mh},2147483651:{n:"Behavior",t:mh},1919054434:{}},_p={1:{n:"CodePage",t:Wg},2:{n:"Title",t:Or},3:{n:"Subject",t:Or},4:{n:"Author",t:Or},5:{n:"Keywords",t:Or},6:{n:"Comments",t:Or},7:{n:"Template",t:Or},8:{n:"LastAuthor",t:Or},9:{n:"RevNumber",t:Or},10:{n:"EditTime",t:S0},11:{n:"LastPrinted",t:S0},12:{n:"CreatedDate",t:S0},13:{n:"ModifiedDate",t:S0},14:{n:"PageCount",t:yn},15:{n:"WordCount",t:yn},16:{n:"CharCount",t:yn},17:{n:"Thumbnail",t:hF},18:{n:"Application",t:Or},19:{n:"DocSecurity",t:yn},255:{},2147483648:{n:"Locale",t:mh},2147483651:{n:"Behavior",t:mh},1919054434:{}},Yw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},gF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function xF(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var vF=xF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xs=Gt(vF),Ti={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Pb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},yp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},b0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Xg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _F(t){var e=Xg();if(!t||!t.match)return e;var r={};if((t.match(an)||[]).forEach(function(n){var i=rt(n);switch(i[0].replace(NO,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[yp[i.ContentType]]!==void 0&&e[yp[i.ContentType]].push(i.PartName);break}}),e.xmlns!==kr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function Ub(t,e){var r=_O(yp),n=[],i;n[n.length]=gr,n[n.length]=De("Types",null,{xmlns:kr.CT,"xmlns:xsd":kr.xsd,"xmlns:xsi":kr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return De("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){t[h]&&t[h].length>0&&(i=t[h][0],n[n.length]=De("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:b0[h][e.bookType]||b0[h].xlsx}))},o=function(h){(t[h]||[]).forEach(function(d){n[n.length]=De("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:b0[h][e.bookType]||b0[h].xlsx})})},u=function(h){(t[h]||[]).forEach(function(d){n[n.length]=De("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return l("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ht={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cu(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function tu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(an)||[]).forEach(function(i){var l=rt(i);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Go(l.Target,e);r[u]=o,n[l.Id]=o}}),r["!id"]=n,r}function yc(t){var e=[gr,De("Relationships",null,{xmlns:kr.RELS})];return fr(t["!id"]).forEach(function(r){e[e.length]=De("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Lt(t,e,r,n,i,l){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[ht.HLINK,ht.XPATH,ht.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var yF="application/vnd.oasis.opendocument.spreadsheet";function wF(t,e){for(var r=Og(t),n,i;n=bu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=rt(n[0],!1),i.path=="/"&&i.type!==yF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function EF(t){var e=[gr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Kw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function TF(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function SF(t){var e=[gr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Kw(t[r][0],t[r][1])),e.push(TF("",t[r][0]));return e.push(Kw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function jb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+yu.version+"</meta:generator></office:meta></office:document-meta>"}var ca=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],bF=(function(){for(var t=new Array(ca.length),e=0;e<ca.length;++e){var r=ca[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function Hb(t){var e={};t=zt(t);for(var r=0;r<ca.length;++r){var n=ca[r],i=t.match(bF[r]);i!=null&&i.length>0&&(e[n[1]]=bt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=er(e[n[1]]))}return e}function Dm(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Bt(e),n[n.length]=r?De(t,e,r):Xr(t,e))}function zb(t,e){var r=e||{},n=[gr,De("cp:coreProperties",null,{"xmlns:cp":kr.CORE_PROPS,"xmlns:dc":kr.dc,"xmlns:dcterms":kr.dcterms,"xmlns:dcmitype":kr.dcmitype,"xmlns:xsi":kr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Dm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:gp(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Dm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:gp(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var l=0;l!=ca.length;++l){var o=ca[l],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Dm(o[0],u,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var qs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Vb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Gb(t,e,r,n){var i=[];if(typeof t=="string")i=Uw(t,n);else for(var l=0;l<t.length;++l)i=i.concat(t[l].map(function(p){return{v:p}}));var o=typeof e=="string"?Uw(e,n).map(function(p){return p.v}):e,u=0,h=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(h=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=o.slice(u,u+h);break}u+=h}}function CF(t,e,r){var n={};return e||(e={}),t=zt(t),qs.forEach(function(i){var l=(t.match(Tu(i[0]))||[])[1];switch(i[2]){case"string":l&&(e[i[1]]=bt(l));break;case"bool":e[i[1]]=l==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Gb(n.HeadingPairs,n.TitlesOfParts,e,r),e}function Wb(t){var e=[],r=De;return t||(t={}),t.Application="SheetJS",e[e.length]=gr,e[e.length]=De("Properties",null,{xmlns:kr.EXT_PROPS,"xmlns:vt":kr.vt}),qs.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Bt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Bt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var kF=/<[^>]+>[^<]*/g;function AF(t,e){var r={},n="",i=t.match(kF);if(i)for(var l=0;l!=i.length;++l){var o=i[l],u=rt(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=bt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),d=h[0].slice(4),p=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=bt(p);break;case"bool":r[n]=Zt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=er(p);break;case"cy":case"error":r[n]=bt(p);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,h)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function Xb(t){var e=[gr,De("Properties",null,{xmlns:kr.CUST_PROPS,"xmlns:vt":kr.vt})];if(!t)return e.join("");var r=1;return fr(t).forEach(function(i){++r,e[e.length]=De("property",BO(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Bt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var wp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Rm;function NF(t,e,r){Rm||(Rm=jh(wp)),e=Rm[e]||e,t[e]=r}function DF(t,e){var r=[];return fr(wp).map(function(n){for(var i=0;i<ca.length;++i)if(ca[i][1]==n)return ca[i];for(i=0;i<qs.length;++i)if(qs[i][1]==n)return qs[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Xr(wp[n[1]]||n[1],i))}}),De("DocumentProperties",r.join(""),{xmlns:Mn.o})}function RF(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&fr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)){for(var o=0;o<ca.length;++o)if(l==ca[o][1])return;for(o=0;o<qs.length;++o)if(l==qs[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var u=t[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),i.push(De(Mw(l),u,{"dt:dt":h}))}}),e&&fr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)&&!(t&&Object.prototype.hasOwnProperty.call(t,l))){var o=e[l],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),i.push(De(Mw(l),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Mn.o+'">'+i.join("")+"</"+n+">"}function qg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function OF(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),i+=l);var o=he(8);return o.write_shift(4,n),o.write_shift(4,i),o}function qb(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function Yb(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function Kb(t,e,r){return e===31?Yb(t):qb(t,e,r)}function Ep(t,e,r){return Kb(t,e,r===!1?0:4)}function FF(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Kb(t,e,0)}function IF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(tn,""),t.l-i&2&&(t.l+=2)}return r}function MF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(tn,"");return r}function LF(t){var e=t.l,r=ph(t,Bb);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ph(t,yn);return[r,n]}function BF(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(LF(t));return r}function $w(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var l=t.read_shift(4),o=t.read_shift(4);n[l]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(tn,"").replace(Vo,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function $b(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function PF(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ph(t,e,r){var n=t.read_shift(2),i,l=r||{};if(t.l+=2,e!==qw&&n!==e&&pF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===qw?n:e){case 2:return i=t.read_shift(2,"i"),l.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return qb(t,n,4).replace(tn,"");case 31:return Yb(t);case 64:return qg(t);case 65:return $b(t);case 71:return PF(t);case 80:return Ep(t,n,!l.raw).replace(tn,"");case 81:return FF(t,n).replace(tn,"");case 4108:return BF(t);case 4126:case 4127:return n==4127?IF(t):MF(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Qw(t,e){var r=he(4),n=he(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=he(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=OF(e);break;case 31:case 80:for(n=he(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Br([r,n])}function Zw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),l=[],o=0,u=0,h=-1,d={};for(o=0;o!=i;++o){var p=t.read_shift(4),x=t.read_shift(4);l[o]=[p,x+r]}l.sort(function(M,C){return M[1]-C[1]});var v={};for(o=0;o!=i;++o){if(t.l!==l[o][1]){var _=!0;if(o>0&&e)switch(e[l[o-1][0]].t){case 2:t.l+2===l[o][1]&&(t.l+=2,_=!1);break;case 80:t.l<=l[o][1]&&(t.l=l[o][1],_=!1);break;case 4108:t.l<=l[o][1]&&(t.l=l[o][1],_=!1);break}if((!e||o==0)&&t.l<=l[o][1]&&(_=!1,t.l=l[o][1]),_)throw new Error("Read Error: Expected address "+l[o][1]+" at "+t.l+" :"+o)}if(e){var E=e[l[o][0]];if(v[E.n]=ph(t,E.t,{raw:!0}),E.p==="version"&&(v[E.n]=String(v[E.n]>>16)+"."+("0000"+String(v[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(v[E.n]){case 0:v[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:la(u=v[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[E.n])}}else if(l[o][0]===1){if(u=v.CodePage=ph(t,Wg),la(u),h!==-1){var w=t.l;t.l=l[h][1],d=$w(t,u),t.l=w}}else if(l[o][0]===0){if(u===0){h=o,t.l=l[o+1][1];continue}d=$w(t,u)}else{var S=d[l[o][0]],N;switch(t[t.l]){case 65:t.l+=4,N=$b(t);break;case 30:t.l+=4,N=Ep(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,N=Ep(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,N=t.read_shift(4,"i");break;case 19:t.l+=4,N=t.read_shift(4);break;case 5:t.l+=4,N=t.read_shift(8,"f");break;case 11:t.l+=4,N=pr(t,4);break;case 64:t.l+=4,N=er(qg(t));break;default:throw new Error("unparsed value: "+t[t.l])}v[S]=N}}return t.l=r+n,v}var Qb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function UF(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Jw(t,e,r){var n=he(8),i=[],l=[],o=8,u=0,h=he(8),d=he(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),l.push(h),i.push(d),o+=8+h.length,!e){d=he(8),d.write_shift(4,0),i.unshift(d);var p=[he(4)];for(p[0].write_shift(4,t.length),u=0;u<t.length;++u){var x=t[u][0];for(h=he(8+2*(x.length+1)+(x.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,x.length+1),h.write_shift(0,x,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=Br(p),l.unshift(h),o+=8+h.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(Qb.indexOf(t[u][0])>-1||Vb.indexOf(t[u][0])>-1)&&t[u][1]!=null){var v=t[u][1],_=0;if(e){_=+e[t[u][0]];var E=r[_];if(E.p=="version"&&typeof v=="string"){var w=v.split(".");v=(+w[0]<<16)+(+w[1]||0)}h=Qw(E.t,v)}else{var S=UF(v);S==-1&&(S=31,v=String(v)),h=Qw(S,v)}l.push(h),d=he(8),d.write_shift(4,e?_:2+u),i.push(d),o+=8+h.length}var N=8*(l.length+1);for(u=0;u<l.length;++u)i[u].write_shift(4,N),N+=l[u].length;return n.write_shift(4,o),n.write_shift(4,l.length),Br([n].concat(i).concat(l))}function eE(t,e,r){var n=t.content;if(!n)return{};Wr(n,0);var i,l,o,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),p=n.read_shift(16);if(p!==Xe.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(l=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(o=n.read_shift(16),h=n.read_shift(4));var x=Zw(n,e),v={SystemIdentifier:d};for(var _ in x)v[_]=x[_];if(v.FMTID=l,i===1)return v;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var E;try{E=Zw(n,null)}catch{}for(_ in E)v[_]=E[_];return v.FMTID=[l,o],v}function tE(t,e,r,n,i,l){var o=he(i?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Xe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var h=Jw(t,r,n);if(u.push(h),i){var d=Jw(i,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+h.length),u.push(d)}return Br(u)}function Ki(t,e){return t.read_shift(e),null}function jF(t,e){e||(e=he(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function HF(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function pr(t,e){return t.read_shift(e)===1}function un(t,e){return e||(e=he(2)),e.write_shift(2,+!!t),e}function Tr(t){return t.read_shift(2,"u")}function ia(t,e){return e||(e=he(2)),e.write_shift(2,t),e}function Zb(t,e){return HF(t,e,Tr)}function zF(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Jb(t,e,r){return r||(r=he(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function $u(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",l=Pn;if(r&&r.biff>=8&&(Pn=1200),!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var u=n?t.read_shift(n,i):"";return Pn=l,u}function VF(t){var e=Pn;Pn=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,l=n&8,o=1+(n&1),u=0,h,d={};l&&(u=t.read_shift(2)),i&&(h=t.read_shift(4));var p=o==2?"dbcs-cont":"sbcs-cont",x=r===0?"":t.read_shift(r,p);return l&&(t.l+=4*u),i&&(t.l+=h),d.t=x,l||(d.raw="<t>"+d.t+"</t>",d.r=d.t),Pn=e,d}function GF(t){var e=t.t||"",r=he(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=he(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Br(i)}function cl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Qu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):cl(t,n,r)}function _l(t,e,r){if(r.biff>5)return Qu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function e4(t,e,r){return r||(r=he(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function WF(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function XF(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(tn,"");return n&&(t.l+=24),i}function qF(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var l=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(l>>1,"utf16le").replace(tn,"");return r+o}function YF(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return XF(t);case"0303000000000000c000000000000046":return qF(t);default:throw new Error("Unsupported Moniker "+r)}}function C0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(tn,""):"";return r}function rE(t,e){e||(e=he(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function KF(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var l,o,u,h,d="",p,x;i&16&&(l=C0(t,r-t.l)),i&128&&(o=C0(t,r-t.l)),(i&257)===257&&(u=C0(t,r-t.l)),(i&257)===1&&(h=YF(t,r-t.l)),i&8&&(d=C0(t,r-t.l)),i&32&&(p=t.read_shift(16)),i&64&&(x=qg(t)),t.l=r;var v=o||u||h||"";v&&d&&(v+="#"+d),v||(v="#"+d),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return p&&(_.guid=p),x&&(_.time=x),l&&(_.Tooltip=l),_}function $F(t){var e=he(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),l=i>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}e.write_shift(4,2),e.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(l==28)n=n.slice(1),rE(n,e);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var u=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),l&8&&rE(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,n.length-3*h+1),r=0;r<n.length-3*h;++r)e.write_shift(1,n.charCodeAt(r+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function t4(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function r4(t,e){var r=t4(t);return r[3]=0,r}function Va(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function ol(t,e,r,n){return n||(n=he(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function QF(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function ZF(t,e,r){return e===0?"":_l(t,e,r)}function JF(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),l=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,l,o]}function n4(t){var e=t.read_shift(2),r=Gg(t);return[e,r]}function eI(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=$u(t,e,r),l=t.read_shift(2);if(n-=t.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return t.l+=l,i}function Gh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function a4(t,e){return e||(e=he(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function i4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var tI=i4;function s4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function rI(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function nI(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Kr(t){t.l+=2,t.l+=t.read_shift(2)}var aI={0:Kr,4:Kr,5:Kr,6:Kr,7:nI,8:Kr,9:Kr,10:Kr,11:Kr,12:Kr,13:rI,14:Kr,15:Kr,16:Kr,17:Kr,18:Kr,19:Kr,20:Kr,21:s4};function iI(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(aI[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function k0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Yg(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=he(i);return l.write_shift(2,n),l.write_shift(2,e),i>4&&l.write_shift(2,29282),i>6&&l.write_shift(2,1997),i>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function sI(t,e){return e===0||t.read_shift(2),1200}function lI(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=_l(t,0,r);return t.read_shift(e+n-t.l),i}function cI(t,e){var r=!e||e.biff==8,n=he(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function oI(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function uI(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,l=t.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=$u(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:l,name:o}}function fI(t,e){var r=!e||e.biff>=8?2:1,n=he(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function hI(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),l=[],o=0;o!=i&&t.l<r;++o)l.push(VF(t));return l.Count=n,l.Unique=i,l}function dI(t,e){var r=he(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=GF(t[i]);var l=Br([r].concat(n));return l.parts=[r.length].concat(n.map(function(o){return o.length})),l}function mI(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function pI(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function gI(t){var e=QF(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function xI(t){return t.read_shift(2),t.read_shift(4)}function nE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,i]}function vI(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:l,CurTab:o,FirstTab:u,Selected:h,TabRatio:d}}function _I(){var t=he(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function yI(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function wI(t){var e=he(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function EI(){}function TI(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=$u(t,0,r),n}function SI(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,l=he(i);return l.write_shift(2,t.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function bI(t){var e=Va(t);return e.isst=t.read_shift(4),e}function CI(t,e,r,n){var i=he(10);return ol(t,e,n,i),i.write_shift(4,r),i}function kI(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Va(t);r.biff==2&&t.l++;var l=Qu(t,n-t.l,r);return i.val=l,i}function AI(t,e,r,n,i){var l=!i||i.biff==8,o=he(8+ +l+(1+l)*r.length);return ol(t,e,n,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function NI(t,e,r){var n=t.read_shift(2),i=_l(t,0,r);return[n,i]}function DI(t,e,r,n){var i=r&&r.biff==5;n||(n=he(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}var RI=_l;function aE(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,l=t.read_shift(i),o=t.read_shift(i),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:l,c:u},e:{r:o,c:h}}}function OI(t,e){var r=e.biff==8||!e.biff?4:2,n=he(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function FI(t){var e=t.read_shift(2),r=t.read_shift(2),n=n4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function II(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),l=[];t.l<r;)l.push(n4(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(l.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:l}}function MI(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),l=[];t.l<r;)l.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(l.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:l}}function LI(t,e,r,n){var i={},l=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return i.patternType=gF[u>>26],n.cellStyles&&(i.alc=l&7,i.fWrap=l>>3&1,i.alcV=l>>4&7,i.fJustLast=l>>7&1,i.trot=l>>8&255,i.cIndent=l>>16&15,i.fShrinkToFit=l>>20&1,i.iReadOrder=l>>22&2,i.fAtrNum=l>>26&1,i.fAtrFnt=l>>27&1,i.fAtrAlc=l>>28&1,i.fAtrBdr=l>>29&1,i.fAtrPat=l>>30&1,i.fAtrProt=l>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function BI(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=LI(t,e,n.fStyle,r),n}function iE(t,e,r,n){var i=r&&r.biff==5;n||(n=he(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var l=0;return t.numFmtId>0&&i&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function PI(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function UI(t){var e=he(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function sE(t,e,r){var n=Va(t);(r.biff==2||e==9)&&++t.l;var i=zF(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function jI(t,e,r,n,i,l){var o=he(8);return ol(t,e,n,o),Jb(r,l,o),o}function HI(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Va(t),i=en(t);return n.val=i,n}function zI(t,e,r,n){var i=he(14);return ol(t,e,n,i),ll(r,i),i}var lE=ZF;function VI(t,e,r){var n=t.l+e,i=t.read_shift(2),l=t.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,i];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=cl(t,l),u=[];n>t.l;)u.push(Qu(t));return[l,i,o,u]}function cE(t,e,r){var n=t.read_shift(2),i,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=eI(t,e-2,r)),l.body=i||t.read_shift(e-2),typeof i=="string"&&(l.Name=i),l}var GI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function oE(t,e,r){var n=t.l+e,i=t.read_shift(2),l=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=cl(t,o,r);i&32&&(d=GI[d.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var x=n==t.l||u===0||!(p>0)?[]:iB(t,p,r,u);return{chKey:l,Name:d,itab:h,rgce:x}}function l4(t,e,r){if(r.biff<8)return WI(t,e,r);for(var n=[],i=t.l+e,l=t.read_shift(r.biff>8?4:2);l--!==0;)n.push(JF(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function WI(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=$u(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function XI(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),l=cl(t,n,r),o=cl(t,i,r);return[l,o]}function qI(t,e,r){var n=i4(t);t.l++;var i=t.read_shift(1);return e-=8,[sB(t,e,r),i,n]}function uE(t,e,r){var n=tI(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,nB(t,e,r)]}function YI(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function KI(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),o=t.read_shift(2),u=_l(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},u,o,l]}}function $I(t,e,r){return KI(t,e,r)}function QI(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Gh(t));return r}function ZI(t){var e=he(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)a4(t[r],e);return e}function JI(t,e,r){if(r&&r.biff<8)return tM(t,e,r);var n=s4(t),i=iI(t,e-22,n[1]);return{cmo:n,ft:i}}var eM={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function tM(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((eM[n]||nn)(t,e,r)),{cmo:[i,n,l],ft:o}}function rM(t,e,r){var n=t.l,i="";try{t.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?t.l+=6:o=WF(t,6,r);var u=t.read_shift(2);t.read_shift(2),Tr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var p=t[t.l],x=cl(t,t.lens[d+1]-t.lens[d]-1);if(i+=x,i.length>=(p?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function nM(t,e){var r=Gh(t);t.l+=16;var n=KF(t,e-24);return[r,n]}function aM(t){var e=he(24),r=ar(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Br([e,$F(t[1])])}function iM(t,e){t.read_shift(2);var r=Gh(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(tn,""),[r,n]}function sM(t){var e=t[1].Tooltip,r=he(10+2*(e.length+1));r.write_shift(2,2048);var n=ar(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function lM(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Yw[r]||r,r=t.read_shift(2),e[1]=Yw[r]||r,e}function cM(t){return t||(t=he(4)),t.write_shift(2,1),t.write_shift(2,1),t}function oM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(r4(t));return r}function uM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(r4(t));return r}function fM(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function c4(t,e,r){if(!r.cellStyles)return nn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),l=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:i,e:l,w:o,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function hM(t,e){var r=he(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function dM(t,e){var r={};return e<32||(t.l+=16,r.header=en(t),r.footer=en(t),t.l+=2),r}function mM(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function pM(t){for(var e=he(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var gM=Va,xM=Zb,vM=Qu;function _M(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function yM(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Va(t);++t.l;var i=_l(t,e-7,r);return n.t="str",n.val=i,n}function wM(t){var e=Va(t);++t.l;var r=en(t);return e.t="n",e.val=r,e}function EM(t,e,r){var n=he(15);return tf(n,t,e),n.write_shift(8,r,"f"),n}function TM(t){var e=Va(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function SM(t,e,r){var n=he(9);return tf(n,t,e),n.write_shift(2,r),n}function bM(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function CM(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function kM(t,e,r){var n=t.l+e,i=Va(t),l=t.read_shift(2),o=cl(t,l,r);return t.l=n,i.t="str",i.val=o,i}var AM=[2,3,48,49,131,139,140,245],Tp=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=jh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],p=hs(1);switch(h.type){case"base64":p=Ln(Un(u));break;case"binary":p=Ln(u);break;case"buffer":case"array":p=u;break}Wr(p,0);var x=p.read_shift(1),v=!!(x&136),_=!1,E=!1;switch(x){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var w=0,S=521;x==2&&(w=p.read_shift(2)),p.l+=3,x!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),x!=2&&(S=p.read_shift(2));var N=p.read_shift(2),M=h.codepage||1252;x!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(M=t[p[p.l]]),p.l+=1,p.l+=2),E&&(p.l+=36);for(var C=[],z={},X=Math.min(p.length,x==2?521:S-10-(_?264:0)),G=E?32:11;p.l<X&&p[p.l]!=13;)switch(z={},z.name=Tt.utils.decode(M,p.slice(p.l,p.l+G)).replace(/[\u0000\r\n].*$/g,""),p.l+=G,z.type=String.fromCharCode(p.read_shift(1)),x!=2&&!E&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),x==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&C.push(z),x!=2&&(p.l+=E?13:14),z.type){case"B":(!_||z.len!=8)&&h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=S-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=S;var O=0,Q=0;for(d[0]=[],Q=0;Q!=C.length;++Q)d[0][Q]=C[Q].name;for(;w-- >0;){if(p[p.l]===42){p.l+=N;continue}for(++p.l,d[++O]=[],Q=0,Q=0;Q!=C.length;++Q){var W=p.slice(p.l,p.l+C[Q].len);p.l+=C[Q].len,Wr(W,0);var fe=Tt.utils.decode(M,W);switch(C[Q].type){case"C":fe.trim().length&&(d[O][Q]=fe.replace(/\s+$/,""));break;case"D":fe.length===8?d[O][Q]=new Date(+fe.slice(0,4),+fe.slice(4,6)-1,+fe.slice(6,8)):d[O][Q]=fe;break;case"F":d[O][Q]=parseFloat(fe.trim());break;case"+":case"I":d[O][Q]=E?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(fe.trim().toUpperCase()){case"Y":case"T":d[O][Q]=!0;break;case"N":case"F":d[O][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+fe+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[O][Q]="##MEMO##"+(E?parseInt(fe.trim(),10):W.read_shift(4));break;case"N":fe=fe.replace(/\u0000/g,"").trim(),fe&&fe!="."&&(d[O][Q]=+fe||0);break;case"@":d[O][Q]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":d[O][Q]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":d[O][Q]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[O][Q]=-W.read_shift(-8,"f");break;case"B":if(_&&C[Q].len==8){d[O][Q]=W.read_shift(8,"f");break}case"G":case"P":W.l+=C[Q].len;break;case"0":if(C[Q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[Q].type)}}}if(x!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=C,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var p=Hc(r(u,d),d);return p["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,p}function i(u,h){try{return vs(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){var d=h||{};if(+d.codepage>=0&&la(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=Cn(),x=vh(u,{header:1,raw:!0,cellDates:!0}),v=x[0],_=x.slice(1),E=u["!cols"]||[],w=0,S=0,N=0,M=1;for(w=0;w<v.length;++w){if(((E[w]||{}).DBF||{}).name){v[w]=E[w].DBF.name,++N;continue}if(v[w]!=null){if(++N,typeof v[w]=="number"&&(v[w]=v[w].toString(10)),typeof v[w]!="string")throw new Error("DBF Invalid column name "+v[w]+" |"+typeof v[w]+"|");if(v.indexOf(v[w])!==w){for(S=0;S<1024;++S)if(v.indexOf(v[w]+"_"+S)==-1){v[w]+="_"+S;break}}}}var C=wt(u["!ref"]),z=[],X=[],G=[];for(w=0;w<=C.e.c-C.s.c;++w){var O="",Q="",W=0,fe=[];for(S=0;S<_.length;++S)_[S][w]!=null&&fe.push(_[S][w]);if(fe.length==0||v[w]==null){z[w]="?";continue}for(S=0;S<fe.length;++S){switch(typeof fe[S]){case"number":Q="B";break;case"string":Q="C";break;case"boolean":Q="L";break;case"object":Q=fe[S]instanceof Date?"D":"C";break;default:Q="C"}W=Math.max(W,String(fe[S]).length),O=O&&O!=Q?"C":Q}W>250&&(W=250),Q=((E[w]||{}).DBF||{}).type,Q=="C"&&E[w].DBF.len>W&&(W=E[w].DBF.len),O=="B"&&Q=="N"&&(O="N",G[w]=E[w].DBF.dec,W=E[w].DBF.len),X[w]=O=="C"||Q=="N"?W:l[O]||0,M+=X[w],z[w]=O}var te=p.next(32);for(te.write_shift(4,318902576),te.write_shift(4,_.length),te.write_shift(2,296+32*N),te.write_shift(2,M),w=0;w<4;++w)te.write_shift(4,0);for(te.write_shift(4,0|(+e[al]||3)<<8),w=0,S=0;w<v.length;++w)if(v[w]!=null){var K=p.next(32),_e=(v[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);K.write_shift(1,_e,"sbcs"),K.write_shift(1,z[w]=="?"?"C":z[w],"sbcs"),K.write_shift(4,S),K.write_shift(1,X[w]||l[z[w]]||0),K.write_shift(1,G[w]||0),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(1,0),K.write_shift(4,0),K.write_shift(4,0),S+=X[w]||l[z[w]]||0}var Me=p.next(264);for(Me.write_shift(4,13),w=0;w<65;++w)Me.write_shift(4,0);for(w=0;w<_.length;++w){var Se=p.next(M);for(Se.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(z[S]){case"L":Se.write_shift(1,_[w][S]==null?63:_[w][S]?84:70);break;case"B":Se.write_shift(8,_[w][S]||0,"f");break;case"N":var Y="0";for(typeof _[w][S]=="number"&&(Y=_[w][S].toFixed(G[S]||0)),N=0;N<X[S]-Y.length;++N)Se.write_shift(1,32);Se.write_shift(1,Y,"sbcs");break;case"D":_[w][S]?(Se.write_shift(4,("0000"+_[w][S].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(_[w][S].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+_[w][S].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var se=String(_[w][S]!=null?_[w][S]:"").slice(0,X[S]);for(Se.write_shift(1,se,"sbcs"),N=0;N<X[S]-se.length;++N)Se.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),o4=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,_){var E=t[_];return typeof E=="number"?pp(E):E},n=function(v,_,E){var w=_.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return w==59?v:pp(w)};t["|"]=254;function i(v,_){switch(_.type){case"base64":return l(Un(v),_);case"binary":return l(v,_);case"buffer":return l(ft&&Buffer.isBuffer(v)?v.toString("binary"):xs(v),_);case"array":return l(sl(v),_)}throw new Error("Unrecognized type "+_.type)}function l(v,_){var E=v.split(/[\n\r]+/),w=-1,S=-1,N=0,M=0,C=[],z=[],X=null,G={},O=[],Q=[],W=[],fe=0,te;for(+_.codepage>=0&&la(+_.codepage);N!==E.length;++N){fe=0;var K=E[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),_e=K.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),Me=_e[0],Se;if(K.length>0)switch(Me){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":_e[1].charAt(0)=="P"&&z.push(K.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,se=!1,Le=!1,Z=!1,Oe=-1,H=-1;for(M=1;M<_e.length;++M)switch(_e[M].charAt(0)){case"A":break;case"X":S=parseInt(_e[M].slice(1))-1,se=!0;break;case"Y":for(w=parseInt(_e[M].slice(1))-1,se||(S=0),te=C.length;te<=w;++te)C[te]=[];break;case"K":Se=_e[M].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(Ta(Se))?isNaN(Ac(Se).getDate())||(Se=er(Se)):(Se=Ta(Se),X!==null&&dl(X)&&(Se=zh(Se))),typeof Tt<"u"&&typeof Se=="string"&&(_||{}).type!="string"&&(_||{}).codepage&&(Se=Tt.utils.decode(_.codepage,Se)),Y=!0;break;case"E":Z=!0;var k=wc(_e[M].slice(1),{r:w,c:S});C[w][S]=[C[w][S],k];break;case"S":Le=!0,C[w][S]=[C[w][S],"S5S"];break;case"G":break;case"R":Oe=parseInt(_e[M].slice(1))-1;break;case"C":H=parseInt(_e[M].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+K)}if(Y&&(C[w][S]&&C[w][S].length==2?C[w][S][0]=Se:C[w][S]=Se,X=null),Le){if(Z)throw new Error("SYLK shared formula cannot have own formula");var j=Oe>-1&&C[Oe][H];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");C[w][S][1]=k4(j[1],{r:w-Oe,c:S-H})}break;case"F":var L=0;for(M=1;M<_e.length;++M)switch(_e[M].charAt(0)){case"X":S=parseInt(_e[M].slice(1))-1,++L;break;case"Y":for(w=parseInt(_e[M].slice(1))-1,te=C.length;te<=w;++te)C[te]=[];break;case"M":fe=parseInt(_e[M].slice(1))/20;break;case"F":break;case"G":break;case"P":X=z[parseInt(_e[M].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=_e[M].slice(1).split(" "),te=parseInt(W[0],10);te<=parseInt(W[1],10);++te)fe=parseInt(W[2],10),Q[te-1]=fe===0?{hidden:!0}:{wch:fe},ds(Q[te-1]);break;case"C":S=parseInt(_e[M].slice(1))-1,Q[S]||(Q[S]={});break;case"R":w=parseInt(_e[M].slice(1))-1,O[w]||(O[w]={}),fe>0?(O[w].hpt=fe,O[w].hpx=Dc(fe)):fe===0&&(O[w].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+K)}L<1&&(X=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+K)}}return O.length>0&&(G["!rows"]=O),Q.length>0&&(G["!cols"]=Q),_&&_.sheetRows&&(C=C.slice(0,_.sheetRows)),[C,G]}function o(v,_){var E=i(v,_),w=E[0],S=E[1],N=Hc(w,_);return fr(S).forEach(function(M){N[M]=S[M]}),N}function u(v,_){return vs(o(v,_),_)}function h(v,_,E,w){var S="C;Y"+(E+1)+";X"+(w+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+ex(v.f,{r:E,c:w}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(v,_){_.forEach(function(E,w){var S="F;W"+(w+1)+" "+(w+1)+" ";E.hidden?S+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Au(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Nu(E.wpx)),typeof E.wch=="number"&&(S+=Math.round(E.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function p(v,_){_.forEach(function(E,w){var S="F;";E.hidden?S+="M0;":E.hpt?S+="M"+20*E.hpt+";":E.hpx&&(S+="M"+20*Du(E.hpx)+";"),S.length>2&&v.push(S+"R"+(w+1))})}function x(v,_){var E=["ID;PWXL;N;E"],w=[],S=wt(v["!ref"]),N,M=Array.isArray(v),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),v["!cols"]&&d(E,v["!cols"]),v["!rows"]&&p(E,v["!rows"]),E.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var z=S.s.r;z<=S.e.r;++z)for(var X=S.s.c;X<=S.e.c;++X){var G=Je({r:z,c:X});N=M?(v[z]||[])[X]:v[G],!(!N||N.v==null&&(!N.f||N.F))&&w.push(h(N,v,z,X))}return E.join(C)+C+w.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:o,from_sheet:x}})(),u4=(function(){function t(l,o){switch(o.type){case"base64":return e(Un(l),o);case"binary":return e(l,o);case"buffer":return e(ft&&Buffer.isBuffer(l)?l.toString("binary"):xs(l),o);case"array":return e(sl(l),o)}throw new Error("Unrecognized type "+o.type)}function e(l,o){for(var u=l.split(`
`),h=-1,d=-1,p=0,x=[];p!==u.length;++p){if(u[p].trim()==="BOT"){x[++h]=[],d=0;continue}if(!(h<0)){var v=u[p].trim().split(","),_=v[0],E=v[1];++p;for(var w=u[p]||"";(w.match(/["]/g)||[]).length&1&&p<u.length-1;)w+=`
`+u[++p];switch(w=w.trim(),+_){case-1:if(w==="BOT"){x[++h]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?x[h][d]=!0:w==="FALSE"?x[h][d]=!1:isNaN(Ta(E))?isNaN(Ac(E).getDate())?x[h][d]=E:x[h][d]=er(E):x[h][d]=Ta(E),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),x[h][d++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(l,o){return Hc(t(l,o),o)}function n(l,o){return vs(r(l,o),o)}var i=(function(){var l=function(h,d,p,x,v){h.push(d),h.push(p+","+x),h.push('"'+v.replace(/"/g,'""')+'"')},o=function(h,d,p,x){h.push(d+","+p),h.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(h){var d=[],p=wt(h["!ref"]),x,v=Array.isArray(h);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,p.e.r-p.s.r+1,""),l(d,"TUPLES",0,p.e.c-p.s.c+1,""),l(d,"DATA",0,0,"");for(var _=p.s.r;_<=p.e.r;++_){o(d,-1,0,"BOT");for(var E=p.s.c;E<=p.e.c;++E){var w=Je({r:_,c:E});if(x=v?(h[_]||[])[E]:h[w],!x){o(d,1,0,"");continue}switch(x.t){case"n":var S=x.w;!S&&x.v!=null&&(S=x.v),S==null?x.f&&!x.F?o(d,1,0,"="+x.f):o(d,1,0,""):o(d,0,S,"V");break;case"b":o(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=jn(x.z||Ke[14],Ar(er(x.v)))),o(d,0,x.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var N=`\r
`,M=d.join(N);return M}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),f4=(function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,v){for(var _=x.split(`
`),E=-1,w=-1,S=0,N=[];S!==_.length;++S){var M=_[S].trim().split(":");if(M[0]==="cell"){var C=ar(M[1]);if(N.length<=C.r)for(E=N.length;E<=C.r;++E)N[E]||(N[E]=[]);switch(E=C.r,w=C.c,M[2]){case"t":N[E][w]=t(M[3]);break;case"v":N[E][w]=+M[3];break;case"vtf":var z=M[M.length-1];case"vtc":switch(M[3]){case"nl":N[E][w]=!!+M[4];break;default:N[E][w]=+M[4];break}M[2]=="vtf"&&(N[E][w]=[N[E][w],z])}}}return v&&v.sheetRows&&(N=N.slice(0,v.sheetRows)),N}function n(x,v){return Hc(r(x,v),v)}function i(x,v){return vs(n(x,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var v=[],_=[],E,w="",S=hn(x["!ref"]),N=Array.isArray(x),M=S.s.r;M<=S.e.r;++M)for(var C=S.s.c;C<=S.e.c;++C)if(w=Je({r:M,c:C}),E=N?(x[M]||[])[C]:x[w],!(!E||E.v==null||E.t==="z")){switch(_=["cell",w,"t"],E.t){case"s":case"str":_.push(e(E.v));break;case"n":E.f?(_[2]="vtf",_[3]="n",_[4]=E.v,_[5]=e(E.f)):(_[2]="v",_[3]=E.v);break;case"b":_[2]="vt"+(E.f?"f":"c"),_[3]="nl",_[4]=E.v?"1":"0",_[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var z=Ar(er(E.v));_[2]="vtc",_[3]="nd",_[4]=""+z,_[5]=E.w||jn(E.z||Ke[14],z);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(x){return[l,o,u,o,d(x),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}})(),Nc=(function(){function t(p,x,v,_,E){E.raw?x[v][_]=p:p===""||(p==="TRUE"?x[v][_]=!0:p==="FALSE"?x[v][_]=!1:isNaN(Ta(p))?isNaN(Ac(p).getDate())?x[v][_]=p:x[v][_]=er(p):x[v][_]=Ta(p))}function e(p,x){var v=x||{},_=[];if(!p||p.length===0)return _;for(var E=p.split(/[\r\n]/),w=E.length-1;w>=0&&E[w].length===0;)--w;for(var S=10,N=0,M=0;M<=w;++M)N=E[M].indexOf(" "),N==-1?N=E[M].length:N++,S=Math.max(S,N);for(M=0;M<=w;++M){_[M]=[];var C=0;for(t(E[M].slice(0,S).trim(),_,M,C,v),C=1;C<=(E[M].length-S)/10+1;++C)t(E[M].slice(S+(C-1)*10,S+C*10).trim(),_,M,C,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var x={},v=!1,_=0,E=0;_<p.length;++_)(E=p.charCodeAt(_))==34?v=!v:!v&&E in r&&(x[E]=(x[E]||0)+1);E=[];for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&E.push([x[_],_]);if(!E.length){x=n;for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&E.push([x[_],_])}return E.sort(function(w,S){return w[0]-S[0]||n[w[1]]-n[S[1]]}),r[E.pop()[1]]||44}function l(p,x){var v=x||{},_="",E=v.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(_=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(_=p.charAt(4),p=p.slice(6)):_=i(p.slice(0,1024)):v&&v.FS?_=v.FS:_=i(p.slice(0,1024));var S=0,N=0,M=0,C=0,z=0,X=_.charCodeAt(0),G=!1,O=0,Q=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var W=v.dateNF!=null?dO(v.dateNF):null;function fe(){var te=p.slice(C,z),K={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)K.t="z";else if(v.raw)K.t="s",K.v=te;else if(te.trim().length===0)K.t="s",K.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(K.t="s",K.v=te.slice(2,-1).replace(/""/g,'"')):V7(te)?(K.t="n",K.f=te.slice(1)):(K.t="s",K.v=te);else if(te=="TRUE")K.t="b",K.v=!0;else if(te=="FALSE")K.t="b",K.v=!1;else if(!isNaN(M=Ta(te)))K.t="n",v.cellText!==!1&&(K.w=te),K.v=M;else if(!isNaN(Ac(te).getDate())||W&&te.match(W)){K.z=v.dateNF||Ke[14];var _e=0;W&&te.match(W)&&(te=mO(te,v.dateNF,te.match(W)||[]),_e=1),v.cellDates?(K.t="d",K.v=er(te,_e)):(K.t="n",K.v=Ar(er(te,_e))),v.cellText!==!1&&(K.w=jn(K.z,K.v instanceof Date?Ar(K.v):K.v)),v.cellNF||delete K.z}else K.t="s",K.v=te;if(K.t=="z"||(v.dense?(E[S]||(E[S]=[]),E[S][N]=K):E[Je({c:N,r:S})]=K),C=z+1,Q=p.charCodeAt(C),w.e.c<N&&(w.e.c=N),w.e.r<S&&(w.e.r=S),O==X)++N;else if(N=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;z<p.length;++z)switch(O=p.charCodeAt(z)){case 34:Q===34&&(G=!G);break;case X:case 10:case 13:if(!G&&fe())break e;break}return z-C>0&&fe(),E["!ref"]=ct(w),E}function o(p,x){return!(x&&x.PRN)||x.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,x):Hc(e(p,x),x)}function u(p,x){var v="",_=x.type=="string"?[0,0,0,0]:ox(p,x);switch(x.type){case"base64":v=Un(p);break;case"binary":v=p;break;case"buffer":x.codepage==65001?v=p.toString("utf8"):x.codepage&&typeof Tt<"u"?v=Tt.utils.decode(x.codepage,p):v=ft&&Buffer.isBuffer(p)?p.toString("binary"):xs(p);break;case"array":v=sl(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+x.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=zt(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=zt(v):x.type=="binary"&&typeof Tt<"u"&&x.codepage&&(v=Tt.utils.decode(x.codepage,Tt.utils.encode(28591,v))),v.slice(0,19)=="socialcalc:version:"?f4.to_sheet(x.type=="string"?v:zt(v),x):o(v,x)}function h(p,x){return vs(u(p,x),x)}function d(p){for(var x=[],v=wt(p["!ref"]),_,E=Array.isArray(p),w=v.s.r;w<=v.e.r;++w){for(var S=[],N=v.s.c;N<=v.e.c;++N){var M=Je({r:w,c:N});if(_=E?(p[w]||[])[N]:p[M],!_||_.v==null){S.push("          ");continue}for(var C=(_.w||(Ha(_),_.w)||"").slice(0,10);C.length<10;)C+=" ";S.push(C+(N===0?" ":""))}x.push(S.join(""))}return x.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function NM(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=o4.to_workbook(t,r);return r.WTF=n,i}catch(l){if(r.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return Nc.to_workbook(t,e)}}var Ys=(function(){function t(k,j,L){if(k){Wr(k,k.l||0);for(var U=L.Enum||Oe;k.l<k.length;){var J=k.read_shift(2),pe=U[J]||U[65535],we=k.read_shift(2),ge=k.l+we,Ee=pe.f&&pe.f(k,we,L);if(k.l=ge,j(Ee,pe,J))return}}}function e(k,j){switch(j.type){case"base64":return r(Ln(Un(k)),j);case"binary":return r(Ln(k),j);case"buffer":case"array":return r(k,j)}throw"Unsupported type "+j.type}function r(k,j){if(!k)return k;var L=j||{},U=L.dense?[]:{},J="Sheet1",pe="",we=0,ge={},Ee=[],be=[],D={s:{r:0,c:0},e:{r:0,c:0}},Te=L.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)L.Enum=Oe,t(k,function(ke,Ct,ir){switch(ir){case 0:L.vers=ke,ke>=4096&&(L.qpro=!0);break;case 6:D=ke;break;case 204:ke&&(pe=ke);break;case 222:pe=ke;break;case 15:case 51:L.qpro||(ke[1].v=ke[1].v.slice(1));case 13:case 14:case 16:ir==14&&(ke[2]&112)==112&&(ke[2]&15)>1&&(ke[2]&15)<15&&(ke[1].z=L.dateNF||Ke[14],L.cellDates&&(ke[1].t="d",ke[1].v=zh(ke[1].v))),L.qpro&&ke[3]>we&&(U["!ref"]=ct(D),ge[J]=U,Ee.push(J),U=L.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},we=ke[3],J=pe||"Sheet"+(we+1),pe="");var Sr=L.dense?(U[ke[0].r]||[])[ke[0].c]:U[Je(ke[0])];if(Sr){Sr.t=ke[1].t,Sr.v=ke[1].v,ke[1].z!=null&&(Sr.z=ke[1].z),ke[1].f!=null&&(Sr.f=ke[1].f);break}L.dense?(U[ke[0].r]||(U[ke[0].r]=[]),U[ke[0].r][ke[0].c]=ke[1]):U[Je(ke[0])]=ke[1];break}},L);else if(k[2]==26||k[2]==14)L.Enum=H,k[2]==14&&(L.qpro=!0,k.l=0),t(k,function(ke,Ct,ir){switch(ir){case 204:J=ke;break;case 22:ke[1].v=ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ke[3]>we&&(U["!ref"]=ct(D),ge[J]=U,Ee.push(J),U=L.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},we=ke[3],J="Sheet"+(we+1)),Te>0&&ke[0].r>=Te)break;L.dense?(U[ke[0].r]||(U[ke[0].r]=[]),U[ke[0].r][ke[0].c]=ke[1]):U[Je(ke[0])]=ke[1],D.e.c<ke[0].c&&(D.e.c=ke[0].c),D.e.r<ke[0].r&&(D.e.r=ke[0].r);break;case 27:ke[14e3]&&(be[ke[14e3][0]]=ke[14e3][1]);break;case 1537:be[ke[0]]=ke[1],ke[0]==we&&(J=ke[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(U["!ref"]=ct(D),ge[pe||J]=U,Ee.push(pe||J),!be.length)return{SheetNames:Ee,Sheets:ge};for(var Be={},je=[],He=0;He<be.length;++He)ge[Ee[He]]?(je.push(be[He]||Ee[He]),Be[be[He]]=ge[be[He]]||ge[Ee[He]]):(je.push(be[He]),Be[be[He]]={"!ref":"A1"});return{SheetNames:je,Sheets:Be}}function n(k,j){var L=j||{};if(+L.codepage>=0&&la(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Cn(),J=wt(k["!ref"]),pe=Array.isArray(k),we=[];Ie(U,0,l(1030)),Ie(U,6,h(J));for(var ge=Math.min(J.e.r,8191),Ee=J.s.r;Ee<=ge;++Ee)for(var be=or(Ee),D=J.s.c;D<=J.e.c;++D){Ee===J.s.r&&(we[D]=Jt(D));var Te=we[D]+be,Be=pe?(k[Ee]||[])[D]:k[Te];if(!(!Be||Be.t=="z"))if(Be.t=="n")(Be.v|0)==Be.v&&Be.v>=-32768&&Be.v<=32767?Ie(U,13,_(Ee,D,Be.v)):Ie(U,14,w(Ee,D,Be.v));else{var je=Ha(Be);Ie(U,15,x(Ee,D,je.slice(0,239)))}}return Ie(U,1),U.end()}function i(k,j){var L=j||{};if(+L.codepage>=0&&la(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Cn();Ie(U,0,o(k));for(var J=0,pe=0;J<k.SheetNames.length;++J)(k.Sheets[k.SheetNames[J]]||{})["!ref"]&&Ie(U,27,Z(k.SheetNames[J],pe++));var we=0;for(J=0;J<k.SheetNames.length;++J){var ge=k.Sheets[k.SheetNames[J]];if(!(!ge||!ge["!ref"])){for(var Ee=wt(ge["!ref"]),be=Array.isArray(ge),D=[],Te=Math.min(Ee.e.r,8191),Be=Ee.s.r;Be<=Te;++Be)for(var je=or(Be),He=Ee.s.c;He<=Ee.e.c;++He){Be===Ee.s.r&&(D[He]=Jt(He));var ke=D[He]+je,Ct=be?(ge[Be]||[])[He]:ge[ke];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")Ie(U,23,fe(Be,He,we,Ct.v));else{var ir=Ha(Ct);Ie(U,22,O(Be,He,we,ir.slice(0,239)))}}++we}}return Ie(U,1),U.end()}function l(k){var j=he(2);return j.write_shift(2,k),j}function o(k){var j=he(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var L=0,U=0,J=0,pe=0;pe<k.SheetNames.length;++pe){var we=k.SheetNames[pe],ge=k.Sheets[we];if(!(!ge||!ge["!ref"])){++J;var Ee=hn(ge["!ref"]);L<Ee.e.r&&(L=Ee.e.r),U<Ee.e.c&&(U=Ee.e.c)}}return L>8191&&(L=8191),j.write_shift(2,L),j.write_shift(1,J),j.write_shift(1,U),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function u(k,j,L){var U={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&L.qpro?(U.s.c=k.read_shift(1),k.l++,U.s.r=k.read_shift(2),U.e.c=k.read_shift(1),k.l++,U.e.r=k.read_shift(2),U):(U.s.c=k.read_shift(2),U.s.r=k.read_shift(2),j==12&&L.qpro&&(k.l+=2),U.e.c=k.read_shift(2),U.e.r=k.read_shift(2),j==12&&L.qpro&&(k.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function h(k){var j=he(8);return j.write_shift(2,k.s.c),j.write_shift(2,k.s.r),j.write_shift(2,k.e.c),j.write_shift(2,k.e.r),j}function d(k,j,L){var U=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(U[0].c=k.read_shift(1),U[3]=k.read_shift(1),U[0].r=k.read_shift(2),k.l+=2):(U[2]=k.read_shift(1),U[0].c=k.read_shift(2),U[0].r=k.read_shift(2)),U}function p(k,j,L){var U=k.l+j,J=d(k,j,L);if(J[1].t="s",L.vers==20768){k.l++;var pe=k.read_shift(1);return J[1].v=k.read_shift(pe,"utf8"),J}return L.qpro&&k.l++,J[1].v=k.read_shift(U-k.l,"cstr"),J}function x(k,j,L){var U=he(7+L.length);U.write_shift(1,255),U.write_shift(2,j),U.write_shift(2,k),U.write_shift(1,39);for(var J=0;J<U.length;++J){var pe=L.charCodeAt(J);U.write_shift(1,pe>=128?95:pe)}return U.write_shift(1,0),U}function v(k,j,L){var U=d(k,j,L);return U[1].v=k.read_shift(2,"i"),U}function _(k,j,L){var U=he(7);return U.write_shift(1,255),U.write_shift(2,j),U.write_shift(2,k),U.write_shift(2,L,"i"),U}function E(k,j,L){var U=d(k,j,L);return U[1].v=k.read_shift(8,"f"),U}function w(k,j,L){var U=he(13);return U.write_shift(1,255),U.write_shift(2,j),U.write_shift(2,k),U.write_shift(8,L,"f"),U}function S(k,j,L){var U=k.l+j,J=d(k,j,L);if(J[1].v=k.read_shift(8,"f"),L.qpro)k.l=U;else{var pe=k.read_shift(2);z(k.slice(k.l,k.l+pe),J),k.l+=pe}return J}function N(k,j,L){var U=j&32768;return j&=-32769,j=(U?k:0)+(j>=8192?j-16384:j),(U?"":"$")+(L?Jt(j):or(j))}var M={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(k,j){Wr(k,0);for(var L=[],U=0,J="",pe="",we="",ge="";k.l<k.length;){var Ee=k[k.l++];switch(Ee){case 0:L.push(k.read_shift(8,"f"));break;case 1:pe=N(j[0].c,k.read_shift(2),!0),J=N(j[0].r,k.read_shift(2),!1),L.push(pe+J);break;case 2:{var be=N(j[0].c,k.read_shift(2),!0),D=N(j[0].r,k.read_shift(2),!1);pe=N(j[0].c,k.read_shift(2),!0),J=N(j[0].r,k.read_shift(2),!1),L.push(be+D+":"+pe+J)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(k.read_shift(2));break;case 6:{for(var Te="";Ee=k[k.l++];)Te+=String.fromCharCode(Ee);L.push('"'+Te.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:ge=L.pop(),we=L.pop(),L.push(["AND","OR"][Ee-20]+"("+we+","+ge+")");break;default:if(Ee<32&&C[Ee])ge=L.pop(),we=L.pop(),L.push(we+C[Ee]+ge);else if(M[Ee]){if(U=M[Ee][1],U==69&&(U=k[k.l++]),U>L.length){console.error("WK1 bad formula parse 0x"+Ee.toString(16)+":|"+L.join("|")+"|");return}var Be=L.slice(-U);L.length-=U,L.push(M[Ee][0]+"("+Be.join(",")+")")}else return Ee<=7?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=24?console.error("WK1 unsupported op "+Ee.toString(16)):Ee<=30?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=115?console.error("WK1 unsupported function opcode "+Ee.toString(16)):console.error("WK1 unrecognized opcode "+Ee.toString(16))}}L.length==1?j[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function X(k){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=k.read_shift(2),j[3]=k[k.l++],j[0].c=k[k.l++],j}function G(k,j){var L=X(k);return L[1].t="s",L[1].v=k.read_shift(j-4,"cstr"),L}function O(k,j,L,U){var J=he(6+U.length);J.write_shift(2,k),J.write_shift(1,L),J.write_shift(1,j),J.write_shift(1,39);for(var pe=0;pe<U.length;++pe){var we=U.charCodeAt(pe);J.write_shift(1,we>=128?95:we)}return J.write_shift(1,0),J}function Q(k,j){var L=X(k);L[1].v=k.read_shift(2);var U=L[1].v>>1;if(L[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return L[1].v=U,L}function W(k,j){var L=X(k),U=k.read_shift(4),J=k.read_shift(4),pe=k.read_shift(2);if(pe==65535)return U===0&&J===3221225472?(L[1].t="e",L[1].v=15):U===0&&J===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var we=pe&32768;return pe=(pe&32767)-16446,L[1].v=(1-we*2)*(J*Math.pow(2,pe+32)+U*Math.pow(2,pe)),L}function fe(k,j,L,U){var J=he(14);if(J.write_shift(2,k),J.write_shift(1,L),J.write_shift(1,j),U==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var pe=0,we=0,ge=0,Ee=0;return U<0&&(pe=1,U=-U),we=Math.log2(U)|0,U/=Math.pow(2,we-31),Ee=U>>>0,(Ee&2147483648)==0&&(U/=2,++we,Ee=U>>>0),U-=Ee,Ee|=2147483648,Ee>>>=0,U*=Math.pow(2,32),ge=U>>>0,J.write_shift(4,ge),J.write_shift(4,Ee),we+=16383+(pe?32768:0),J.write_shift(2,we),J}function te(k,j){var L=W(k);return k.l+=j-14,L}function K(k,j){var L=X(k),U=k.read_shift(4);return L[1].v=U>>6,L}function _e(k,j){var L=X(k),U=k.read_shift(8,"f");return L[1].v=U,L}function Me(k,j){var L=_e(k);return k.l+=j-10,L}function Se(k,j){return k[k.l+j-1]==0?k.read_shift(j,"cstr"):""}function Y(k,j){var L=k[k.l++];L>j-1&&(L=j-1);for(var U="";U.length<L;)U+=String.fromCharCode(k[k.l++]);return U}function se(k,j,L){if(!(!L.qpro||j<21)){var U=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var J=k.read_shift(j-21,"cstr");return[U,J]}}function Le(k,j){for(var L={},U=k.l+j;k.l<U;){var J=k.read_shift(2);if(J==14e3){for(L[J]=[0,""],L[J][0]=k.read_shift(2);k[k.l];)L[J][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return L}function Z(k,j){var L=he(5+k.length);L.write_shift(2,14e3),L.write_shift(2,j);for(var U=0;U<k.length;++U){var J=k.charCodeAt(U);L[L.l++]=J>127?95:J}return L[L.l++]=0,L}var Oe={0:{n:"BOF",f:Tr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},H={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:Q},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:K},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:Me},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}})();function DM(t){var e={},r=t.match(an),n=0,i=!1;if(r)for(;n!=r.length;++n){var l=rt(r[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;e.cp=Tg[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=l.val;break;case"<sz":e.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":l.rgb&&(e.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(l[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+l[0])}}return e}var RM=(function(){var t=Tu("t"),e=Tu("rPr");function r(l){var o=l.match(t);if(!o)return{t:"s",v:""};var u={t:"s",v:bt(o[1])},h=l.match(e);return h&&(u.s=DM(h[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(u){return u.v})}})(),OM=(function(){var e=/(\r\n|\n)/g;function r(i,l,o){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),i.b&&(l.push("<b>"),o.push("</b>")),i.i&&(l.push("<i>"),o.push("</i>")),i.strike&&(l.push("<s>"),o.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),i}function n(i){var l=[[],i.v,[]];return i.v?(i.s&&r(i.s,l[0],l[2]),l[0].join("")+l[1].replace(e,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),FM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,IM=/<(?:\w+:)?r>/,MM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Kg(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=bt(zt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=zt(t),r&&(n.h=Rg(n.t))):t.match(IM)&&(n.r=zt(t),n.t=bt(zt((t.replace(MM,"").match(FM)||[]).join("").replace(an,""))),r&&(n.h=OM(RM(n.r)))),n):{t:""}}var LM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,BM=/<(?:\w+:)?(?:si|sstItem)>/g,PM=/<\/(?:\w+:)?(?:si|sstItem)>/;function UM(t,e){var r=[],n="";if(!t)return r;var i=t.match(LM);if(i){n=i[2].replace(BM,"").split(PM);for(var l=0;l!=n.length;++l){var o=Kg(n[l].trim(),e);o!=null&&(r[r.length]=o)}i=rt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var jM=/^\s|\s$|[\t\n\r]/;function h4(t,e){if(!e.bookSST)return"";var r=[gr];r[r.length]=De("sst",null,{xmlns:ml[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],l="<si>";i.r?l+=i.r:(l+="<t",i.t||(i.t=""),i.t.match(jM)&&(l+=' xml:space="preserve"'),l+=">"+Bt(i.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function HM(t){return[t.read_shift(4),t.read_shift(4)]}function zM(t,e){var r=[],n=!1;return Ei(t,function(l,o,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function VM(t,e){return e||(e=he(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var GM=eF;function WM(t){var e=Cn();ye(e,159,VM(t));for(var r=0;r<t.length;++r)ye(e,19,GM(t[r]));return ye(e,160),e.end()}function d4(t){if(typeof Tt<"u")return Tt.utils.encode(al,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function pi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function XM(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=pi(t,4),e.U=pi(t,4),e.W=pi(t,4),e}function qM(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),l=[];i-- >0;)l.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=l,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function YM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(qM(t));return e}function KM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function $M(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=pi(t,4),e.U=pi(t,4),e.W=pi(t,4),e}function QM(t){var e=$M(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function m4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function p4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function ZM(t){var e=pi(t);switch(e.Minor){case 2:return[e.Minor,JM(t)];case 3:return[e.Minor,eL()];case 4:return[e.Minor,tL(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function JM(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=m4(t,r),i=p4(t,t.length-t.l);return{t:"Std",h:n,v:i}}function eL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function tL(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(an,function(l){var o=rt(l);switch(za(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function rL(t,e){var r={},n=r.EncryptionVersionInfo=pi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=m4(t,i),e-=i,r.EncryptionVerifier=p4(t,e),r}function nL(t){var e={},r=e.EncryptionVersionInfo=pi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function $g(t){var e=0,r,n=d4(t),i=n.length+1,l,o,u,h,d;for(r=hs(i),r[0]=n.length,l=1;l!=i;++l)r[l]=n[l-1];for(l=i-1;l>=0;--l)o=r[l],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^o;return e^52811}var g4=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,u){return n(o^u)},l=function(o){for(var u=e[o.length-1],h=104,d=o.length-1;d>=0;--d)for(var p=o[d],x=0;x!=7;++x)p&64&&(u^=r[h]),p*=2,--h;return u};return function(o){for(var u=d4(o),h=l(u),d=u.length,p=hs(16),x=0;x!=16;++x)p[x]=0;var v,_,E;for((d&1)===1&&(v=h>>8,p[d]=i(t[0],v),--d,v=h&255,_=u[u.length-1],p[d]=i(_,v));d>0;)--d,v=h>>8,p[d]=i(u[d],v),--d,v=h&255,p[d]=i(u[d],v);for(d=15,E=15-u.length;E>0;)v=h>>8,p[d]=i(t[E],v),--d,--E,v=h&255,p[d]=i(u[d],v),--d,--E;return p}})(),aL=function(t,e,r,n,i){i||(i=e),n||(n=g4(t));var l,o;for(l=0;l!=e.length;++l)o=e[l],o^=n[r],o=(o>>5|o<<3)&255,i[l]=o,++r;return[i,r,n]},iL=function(t){var e=0,r=g4(t);return function(n){var i=aL("",n,e,r);return e=i[1],i[0]}};function sL(t,e,r,n){var i={key:Tr(t),verificationBytes:Tr(t)};return r.password&&(i.verifier=$g(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=iL(r.password)),i}function lL(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=nL(t):n.Data=rL(t,e),n}function cL(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?lL(t,e-2,n):sL(t,r.biff>=8?e:e-2,r,n),n}var x4=(function(){function t(i,l){switch(l.type){case"base64":return e(Un(i),l);case"binary":return e(i,l);case"buffer":return e(ft&&Buffer.isBuffer(i)?i.toString("binary"):xs(i),l);case"array":return e(sl(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){var o=l||{},u=o.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,x){Array.isArray(u)&&(u[x]=[]);for(var v=/\\\w+\b/g,_=0,E,w=-1;E=v.exec(p);){switch(E[0]){case"\\cell":var S=p.slice(_,v.lastIndex-E[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var N={v:S,t:"s"};Array.isArray(u)?u[x][w]=N:u[Je({r:x,c:w})]=N}break}_=v.lastIndex}w>d.e.c&&(d.e.c=w)}),u["!ref"]=ct(d),u}function r(i,l){return vs(t(i,l),l)}function n(i){for(var l=["{\\rtf1\\ansi"],o=wt(i["!ref"]),u,h=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){l.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var x=Je({r:d,c:p});u=h?(i[d]||[])[p]:i[x],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Ha(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function oL(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function ku(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function uL(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),l=Math.min(e,r,n),o=i-l;if(o===0)return[0,0,e];var u=0,h=0,d=i+l;switch(h=o/(d>1?2-d:d),i){case e:u=((r-n)/o+6)%6;break;case r:u=(n-e)/o+2;break;case n:u=(e-r)/o+4;break}return[u/6,h,d/2]}function fL(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),l=n-i/2,o=[l,l,l],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=i*u,o[0]+=i,o[1]+=h;break;case 1:h=i*(2-u),o[0]+=h,o[1]+=i;break;case 2:h=i*(u-2),o[1]+=i,o[2]+=h;break;case 3:h=i*(4-u),o[1]+=h,o[2]+=i;break;case 4:h=i*(u-4),o[2]+=i,o[0]+=h;break;case 5:h=i*(6-u),o[2]+=h,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function gh(t,e){if(e===0)return t;var r=uL(oL(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),ku(fL(r))}var v4=6,hL=15,dL=1,Jr=v4;function Au(t){return Math.floor((t+Math.round(128/Jr)/256)*Jr)}function Nu(t){return Math.floor((t-5)/Jr*100+.5)/100}function xh(t){return Math.round((t*Jr+5)/Jr*256)/256}function Om(t){return xh(Nu(Au(t)))}function Qg(t){var e=Math.abs(t-Om(t)),r=Jr;if(e>.005)for(Jr=dL;Jr<hL;++Jr)Math.abs(t-Om(t))<=e&&(e=Math.abs(t-Om(t)),r=Jr);Jr=r}function ds(t){t.width?(t.wpx=Au(t.width),t.wch=Nu(t.wpx),t.MDW=Jr):t.wpx?(t.wch=Nu(t.wpx),t.width=xh(t.wch),t.MDW=Jr):typeof t.wch=="number"&&(t.width=xh(t.wch),t.wpx=Au(t.width),t.MDW=Jr),t.customWidth&&delete t.customWidth}var mL=96,_4=mL;function Du(t){return t*96/_4}function Dc(t){return t*_4/96}var pL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function gL(t,e,r,n){e.Borders=[];var i={},l=!1;(t[0].match(an)||[]).forEach(function(o){var u=rt(o);switch(za(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=Zt(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=Zt(u.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function xL(t,e,r,n){e.Fills=[];var i={},l=!1;(t[0].match(an)||[]).forEach(function(o){var u=rt(o);switch(za(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function vL(t,e,r,n){e.Fonts=[];var i={},l=!1;(t[0].match(an)||[]).forEach(function(o){var u=rt(o);switch(za(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=zt(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?Zt(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?Zt(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?Zt(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?Zt(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?Zt(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?Zt(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?Zt(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Tg[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=Zt(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var h=Xs[i.color.index];i.color.index==81&&(h=Xs[1]),h||(h=Xs[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=gh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function _L(t,e,r){e.NumberFmt=[];for(var n=fr(Ke),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Ke[n[i]];var l=t[0].match(an);if(l)for(i=0;i<l.length;++i){var o=rt(l[i]);switch(za(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=bt(zt(o.formatCode)),h=parseInt(o.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}Pa(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function yL(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=De("numFmt",null,{numFmtId:n,formatCode:Bt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=De("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var A0=["numFmtId","fillId","fontId","borderId","xfId"],N0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function wL(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(an)||[]).forEach(function(l){var o=rt(l),u=0;switch(za(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<A0.length;++u)n[A0[u]]&&(n[A0[u]]=parseInt(n[A0[u]],10));for(u=0;u<N0.length;++u)n[N0[u]]&&(n[N0[u]]=Zt(n[N0[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=Zt(o.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function EL(t){var e=[];return e[e.length]=De("cellXfs",null),t.forEach(function(r){e[e.length]=De("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=De("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var TL=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&_L(x,p,d),(x=u.match(i))&&vL(x,p,h,d),(x=u.match(n))&&xL(x,p,h,d),(x=u.match(l))&&gL(x,p,h,d),(x=u.match(r))&&wL(x,p,d),p}})();function y4(t,e){var r=[gr,De("styleSheet",null,{xmlns:ml[0],"xmlns:vt":kr.vt})],n;return t.SSF&&(n=yL(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=EL(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function SL(t,e){var r=t.read_shift(2),n=rn(t);return[r,n]}function bL(t,e,r){r||(r=he(6+4*e.length)),r.write_shift(2,t),Pr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function CL(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=lF(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var l=t.read_shift(2);switch(l===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=sF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=rn(t),n}function kL(t,e){e||(e=he(153)),e.write_shift(2,t.sz*20),cF(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),dh(t.color,e);var n=0;return n=2,e.write_shift(1,n),Pr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var AL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Fm,NL=nn;function fE(t,e){e||(e=he(84)),Fm||(Fm=jh(AL));var r=Fm[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(dh({auto:1},e),dh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function DL(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function w4(t,e,r){r||(r=he(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ho(t,e){return e||(e=he(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var RL=nn;function OL(t,e){return e||(e=he(51)),e.write_shift(1,0),Ho(null,e),Ho(null,e),Ho(null,e),Ho(null,e),Ho(null,e),e.length>e.l?e.slice(0,e.l):e}function FL(t,e){return e||(e=he(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),hh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function IL(t,e,r){var n=he(2052);return n.write_shift(4,t),hh(e,n),hh(r,n),n.length>n.l?n.slice(0,n.l):n}function ML(t,e,r){var n={};n.NumberFmt=[];for(var i in Ke)n.NumberFmt[i]=Ke[i];n.CellXf=[],n.Fonts=[];var l=[],o=!1;return Ei(t,function(h,d,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],Pa(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=gh(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(p),o=!0;break;case 38:l.pop(),o=!1;break;default:if(d.T>0)l.push(p);else if(d.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function LL(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ye(t,615,Sa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ye(t,44,bL(i,e[i]))}),ye(t,616))}}function BL(t){var e=1;ye(t,611,Sa(e)),ye(t,43,kL({sz:12,color:{theme:1},name:"Calibri",family:2})),ye(t,612)}function PL(t){var e=2;ye(t,603,Sa(e)),ye(t,45,fE({patternType:"none"})),ye(t,45,fE({patternType:"gray125"})),ye(t,604)}function UL(t){var e=1;ye(t,613,Sa(e)),ye(t,46,OL()),ye(t,614)}function jL(t){var e=1;ye(t,626,Sa(e)),ye(t,47,w4({numFmtId:0},65535)),ye(t,627)}function HL(t,e){ye(t,617,Sa(e.length)),e.forEach(function(r){ye(t,47,w4(r,0))}),ye(t,618)}function zL(t){var e=1;ye(t,619,Sa(e)),ye(t,48,FL({xfId:0,name:"Normal"})),ye(t,620)}function VL(t){var e=0;ye(t,505,Sa(e)),ye(t,506)}function GL(t){var e=0;ye(t,508,IL(e,"TableStyleMedium9","PivotStyleMedium4")),ye(t,509)}function WL(t,e){var r=Cn();return ye(r,278),LL(r,t.SSF),BL(r),PL(r),UL(r),jL(r),HL(r,e.cellXfs),zL(r),VL(r),GL(r),ye(r,279),r.end()}var XL=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function qL(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(an)||[]).forEach(function(i){var l=rt(i);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(e.themeElements.clrScheme[XL.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function YL(){}function KL(){}var $L=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,QL=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ZL=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function JL(t,e,r){e.themeElements={};var n;[["clrScheme",$L,qL],["fontScheme",QL,YL],["fmtScheme",ZL,KL]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var e7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function E4(t,e){(!t||t.length===0)&&(t=Zg());var r,n={};if(!(r=t.match(e7)))throw new Error("themeElements not found in theme");return JL(r[0],n,e),n.raw=t,n}function Zg(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[gr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function t7(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var l=t.slice(t.l);t.l=n;var o;try{o=vb(l,{type:"array"})}catch{return}var u=Bn(o,"theme/theme/theme1.xml",!0);if(u)return E4(u,r)}}function r7(t){return t.read_shift(4)}function n7(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=a7(t,4);break;case 2:e.xclrValue=t4(t);break;case 3:e.xclrValue=r7(t);break;case 4:t.l+=4;break}return t.l+=8,e}function a7(t,e){return nn(t,e)}function i7(t,e){return nn(t,e)}function s7(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=n7(t);break;case 6:n[1]=i7(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function l7(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),l=[];i-- >0;)l.push(s7(t,r-t.l));return{ixfe:n,ext:l}}function c7(t,e){e.forEach(function(r){r[0]})}function o7(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:rn(t)}}function u7(t){var e=he(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Pr(t.name,e),e.slice(0,e.l)}function f7(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function h7(t){var e=he(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function d7(t,e){var r=he(8+2*e.length);return r.write_shift(4,t),Pr(e,r),r.slice(0,r.l)}function m7(t){return t.l+=4,t.read_shift(4)!=0}function p7(t,e){var r=he(8);return r.write_shift(4,t),r.write_shift(4,1),r}function g7(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},l=[],o=!1,u=2;return Ei(t,function(h,d,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(p),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function x7(){var t=Cn();return ye(t,332),ye(t,334,Sa(1)),ye(t,335,u7({name:"XLDAPR",version:12e4,flags:3496657072})),ye(t,336),ye(t,339,d7(1,"XLDAPR")),ye(t,52),ye(t,35,Sa(514)),ye(t,4096,Sa(0)),ye(t,4097,ia(1)),ye(t,36),ye(t,53),ye(t,340),ye(t,337,p7(1)),ye(t,51,h7([[1,0]])),ye(t,338),ye(t,333),t.end()}function v7(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,l=2,o;return t.replace(an,function(u){var h=rt(u);switch(za(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):l==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function T4(){var t=[gr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function _7(t){var e=[];if(!t)return e;var r=1;return(t.match(an)||[]).forEach(function(n){var i=rt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function y7(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Je(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function w7(t,e,r){var n=[];return Ei(t,function(l,o,u){switch(u){case 63:n.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function E7(t,e,r,n){if(!t)return t;var i=n||{},l=!1;Ei(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function T7(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var hc=1024;function S4(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[De("xml",null,{"xmlns:v":Mn.v,"xmlns:o":Mn.o,"xmlns:x":Mn.x,"xmlns:mv":Mn.mv}).replace(/\/>/,">"),De("o:shapelayout",De("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),De("v:shapetype",[De("v:stroke",null,{joinstyle:"miter"}),De("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];hc<t*1e3;)hc+=1e3;return e.forEach(function(l){var o=ar(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?De("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=De("v:fill",h,u),p={on:"t",obscured:"t"};++hc,i=i.concat(["<v:shape"+Su({id:"_x0000_s"+hc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,De("v:shadow",null,p),De("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Xr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Xr("x:AutoFill","False"),Xr("x:Row",String(o.r)),Xr("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function hE(t,e,r,n){var i=Array.isArray(t),l;e.forEach(function(o){var u=ar(o.ref);if(i?(t[u.r]||(t[u.r]=[]),l=t[u.r][u.c]):l=t[o.ref],!l){l={t:"z"},i?t[u.r][u.c]=l:t[o.ref]=l;var h=wt(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=ct(h);d!==t["!ref"]&&(t["!ref"]=d)}l.c||(l.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var x=l.c.length-1;x>=0;--x){if(!r&&l.c[x].T)return;r&&!l.c[x].T&&l.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(p.a==n[x].id){p.a=n[x].name||p.a;break}}l.c.push(p)})}function S7(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=rt(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=ar(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&Kg(x[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=v.h),n.push(d)}}}}),n}function b4(t){var e=[gr,De("comments",null,{xmlns:ml[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var l=Bt(i.a);r.indexOf(l)==-1&&(r.push(l),e.push("<author>"+l+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(i=r.indexOf(Bt(h.a))),l.push(h.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),l.length<=1)e.push(Xr("t",Bt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)o+=`Reply:
    `+l[u]+`
`;e.push(Xr("t",Bt(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function b7(t,e){var r=[],n=!1,i={},l=0;return t.replace(an,function(u,h){var d=rt(u);switch(za(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":i.t=t.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function C7(t,e,r){var n=[gr,De("ThreadedComments",null,{xmlns:kr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var l="";(i[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var h={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(De("threadedComment",Xr("text",o.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function k7(t,e){var r=[],n=!1;return t.replace(an,function(l){var o=rt(l);switch(za(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function A7(t){var e=[gr,De("personList",null,{xmlns:kr.TCMNT,"xmlns:x":ml[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(De("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function N7(t){var e={};e.iauthor=t.read_shift(4);var r=vl(t);return e.rfx=r.s,e.ref=Je(r.s),t.l+=16,e}function D7(t,e){return e==null&&(e=he(36)),e.write_shift(4,t[1].iauthor),zc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var R7=rn;function O7(t){return Pr(t.slice(0,54))}function F7(t,e){var r=[],n=[],i={},l=!1;return Ei(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function I7(t){var e=Cn(),r=[];return ye(e,628),ye(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ye(e,632,O7(i.a)))})}),ye(e,631),ye(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var l={s:ar(n[0]),e:ar(n[0])};ye(e,635,D7([l,i])),i.t&&i.t.length>0&&ye(e,637,rF(i)),ye(e,636),delete i.iauthor})}),ye(e,634),ye(e,629),e.end()}var M7="application/vnd.ms-office.vbaProject";function L7(t){var e=Xe.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Xe.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Xe.write(e)}function B7(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Xe.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var C4=["xlsb","xlsm","xlam","biff8","xla"];function P7(){return{"!type":"dialog"}}function U7(){return{"!type":"dialog"}}function j7(){return{"!type":"macro"}}function H7(){return{"!type":"macro"}}var wc=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,l,o){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=e.c:--p,h?d+=e.r:--d,i+(u?"":"$")+Jt(p)+(h?"":"$")+or(d)}return function(i,l){return e=l,i.replace(t,r)}})(),Jg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ex=(function(){return function(e,r){return e.replace(Jg,function(n,i,l,o,u,h){var d=jg(o)-(l?0:r.c),p=Ug(h)-(u?0:r.r),x=p==0?"":u?p+1:"["+p+"]",v=d==0?"":l?d+1:"["+d+"]";return i+"R"+x+"C"+v})}})();function k4(t,e){return t.replace(Jg,function(r,n,i,l,o,u){return n+(i=="$"?i+l:Jt(jg(l)+e.c))+(o=="$"?o+u:or(Ug(u)+e.r))})}function z7(t,e,r){var n=hn(e),i=n.s,l=ar(r),o={r:l.r-i.r,c:l.c-i.c};return k4(t,o)}function V7(t){return t.length!=1}function dE(t){return t.replace(/_xlfn\./g,"")}function wr(t){t.l+=1}function ms(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function A4(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return N4(t);r.biff==12&&(n=4)}var i=t.read_shift(n),l=t.read_shift(n),o=ms(t),u=ms(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function N4(t){var e=ms(t),r=ms(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function G7(t,e,r){if(r.biff<8)return N4(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),l=ms(t),o=ms(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function D4(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return W7(t);var n=t.read_shift(r&&r.biff==12?4:2),i=ms(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function W7(t){var e=ms(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function X7(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function q7(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Y7(t);var i=t.read_shift(n>=12?4:2),l=t.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;i>524287;)i-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:i,c:l,cRel:o,rRel:u}}function Y7(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function K7(t,e,r){var n=(t[t.l++]&96)>>5,i=A4(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function $7(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}var o=A4(t,l,r);return[n,i,o]}function Q7(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Z7(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}return t.l+=l,[n,i]}function J7(t,e,r){var n=(t[t.l++]&96)>>5,i=G7(t,e-1,r);return[n,i]}function e9(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function mE(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function t9(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],l=0;l<=n;++l)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function r9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function n9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function a9(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function i9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function R4(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function s9(t){return t.read_shift(2),R4(t)}function l9(t){return t.read_shift(2),R4(t)}function c9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=D4(t,0,r);return[n,i]}function o9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=q7(t,0,r);return[n,i]}function u9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var l=D4(t,0,r);return[n,i,l]}function f9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[mB[i],I4[i],n]}function h9(t,e,r){var n=t[t.l++],i=t.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:d9(t);return[i,(l[0]===0?I4:dB)[l[1]]]}function d9(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function m9(t,e,r){t.l+=r&&r.biff==2?3:4}function p9(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function g9(t){return t.l++,Ti[t.read_shift(1)]}function x9(t){return t.l++,t.read_shift(2)}function v9(t){return t.l++,t.read_shift(1)!==0}function _9(t){return t.l++,en(t)}function y9(t,e,r){return t.l++,$u(t,e-1,r)}function w9(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=pr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ti[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=en(t);break;case 2:r[1]=_l(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function E9(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],l=0;l!=n;++l)i.push((r.biff==12?vl:Gh)(t));return i}function T9(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var l=0,o=[];l!=n&&(o[l]=[]);++l)for(var u=0;u!=i;++u)o[l][u]=w9(t,r.biff);return o}function S9(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,l=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,l]}function b9(t,e,r){if(r.biff==5)return C9(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),l=t.read_shift(4);return[n,i,l]}function C9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function k9(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function A9(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function N9(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function D9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return t.l+=l,[n,i]}var R9=nn,O9=nn,F9=nn;function Zu(t,e,r){return t.l+=2,[X7(t)]}function tx(t){return t.l+=6,[]}var I9=Zu,M9=tx,L9=tx,B9=Zu;function O4(t){return t.l+=2,[Tr(t),t.read_shift(2)&1]}var P9=Zu,U9=O4,j9=tx,H9=Zu,z9=Zu,V9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function G9(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),l=t.read_shift(2),o=V9[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:l}}function W9(t){return t.l+=2,[t.read_shift(4)]}function X9(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function q9(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Y9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function K9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function $9(t){return t.l+=4,[0,0]}var pE={1:{n:"PtgExp",f:p9},2:{n:"PtgTbl",f:F9},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:y9},26:{n:"PtgSheet",f:X9},27:{n:"PtgEndSheet",f:q9},28:{n:"PtgErr",f:g9},29:{n:"PtgBool",f:v9},30:{n:"PtgInt",f:x9},31:{n:"PtgNum",f:_9},32:{n:"PtgArray",f:e9},33:{n:"PtgFunc",f:f9},34:{n:"PtgFuncVar",f:h9},35:{n:"PtgName",f:S9},36:{n:"PtgRef",f:c9},37:{n:"PtgArea",f:K7},38:{n:"PtgMemArea",f:k9},39:{n:"PtgMemErr",f:R9},40:{n:"PtgMemNoMem",f:O9},41:{n:"PtgMemFunc",f:A9},42:{n:"PtgRefErr",f:N9},43:{n:"PtgAreaErr",f:Q7},44:{n:"PtgRefN",f:o9},45:{n:"PtgAreaN",f:J7},46:{n:"PtgMemAreaN",f:Y9},47:{n:"PtgMemNoMemN",f:K9},57:{n:"PtgNameX",f:b9},58:{n:"PtgRef3d",f:u9},59:{n:"PtgArea3d",f:$7},60:{n:"PtgRefErr3d",f:D9},61:{n:"PtgAreaErr3d",f:Z7},255:{}},Q9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Z9={1:{n:"PtgElfLel",f:O4},2:{n:"PtgElfRw",f:H9},3:{n:"PtgElfCol",f:I9},6:{n:"PtgElfRwV",f:z9},7:{n:"PtgElfColV",f:B9},10:{n:"PtgElfRadical",f:P9},11:{n:"PtgElfRadicalS",f:j9},13:{n:"PtgElfColS",f:M9},15:{n:"PtgElfColSV",f:L9},16:{n:"PtgElfRadicalLel",f:U9},25:{n:"PtgList",f:G9},29:{n:"PtgSxName",f:W9},255:{}},J9={0:{n:"PtgAttrNoop",f:$9},1:{n:"PtgAttrSemi",f:i9},2:{n:"PtgAttrIf",f:n9},4:{n:"PtgAttrChoose",f:t9},8:{n:"PtgAttrGoto",f:r9},16:{n:"PtgAttrSum",f:m9},32:{n:"PtgAttrBaxcel",f:mE},33:{n:"PtgAttrBaxcel",f:mE},64:{n:"PtgAttrSpace",f:s9},65:{n:"PtgAttrSpaceSemi",f:l9},128:{n:"PtgAttrIfError",f:a9},255:{}};function Ju(t,e,r,n){if(n.biff<8)return nn(t,e);for(var i=t.l+e,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=T9(t,0,n),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=E9(t,r[o][1],n),l.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&l.push(nn(t,e)),l}function ef(t,e,r){for(var n=t.l+e,i,l,o=[];n!=t.l;)e=n-t.l,l=t[t.l],i=pE[l]||pE[Q9[l]],(l===24||l===25)&&(i=(l===24?Z9:J9)[t[t.l+1]]),!i||!i.f?nn(t,e):o.push([i.n,i.f(t,e,r)]);return o}function eB(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],l=0;l<n.length;++l){var o=n[l];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var tB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function rB(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function F4(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function gE(t,e,r){var n=F4(t,e,r);return n=="#REF"?n:rB(n,r)}function Qr(t,e,r,n,i){var l=i&&i.biff||8,o={s:{c:0,r:0}},u=[],h,d,p,x=0,v=0,_,E="";if(!t[0]||!t[0][0])return"";for(var w=-1,S="",N=0,M=t[0].length;N<M;++N){var C=t[0][N];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),w>=0){switch(t[0][w][1][0]){case 0:S=cr(" ",t[0][w][1][1]);break;case 1:S=cr("\r",t[0][w][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}d=d+S,w=-1}u.push(d+tB[C[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Jo(C[1][1],o,i),u.push(eu(p,l));break;case"PtgRefN":p=r?Jo(C[1][1],r,i):C[1][1],u.push(eu(p,l));break;case"PtgRef3d":x=C[1][1],p=Jo(C[1][2],o,i),E=gE(n,x,i),u.push(E+"!"+eu(p,l));break;case"PtgFunc":case"PtgFuncVar":var z=C[1][0],X=C[1][1];z||(z=0),z&=127;var G=z==0?[]:u.slice(-z);u.length-=z,X==="User"&&(X=G.shift()),u.push(X+"("+G.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":_=Ww(C[1][1],r?{s:r}:o,i),u.push(Nm(_,i));break;case"PtgArea":_=Ww(C[1][1],o,i),u.push(Nm(_,i));break;case"PtgArea3d":x=C[1][1],_=C[1][2],E=gE(n,x,i),u.push(E+"!"+Nm(_,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var O=(n.names||[])[v-1]||(n[0]||[])[v],Q=O?O.Name:"SH33TJSNAME"+String(v);Q&&Q.slice(0,6)=="_xlfn."&&!i.xlfn&&(Q=Q.slice(6)),u.push(Q);break;case"PtgNameX":var W=C[1][1];v=C[1][2];var fe;if(i.biff<=5)W<0&&(W=-W),n[W]&&(fe=n[W][v]);else{var te="";if(((n[W]||[])[0]||[])[0]==14849||(((n[W]||[])[0]||[])[0]==1025?n[W][v]&&n[W][v].itab>0&&(te=n.SheetNames[n[W][v].itab-1]+"!"):te=n.SheetNames[v-1]+"!"),n[W]&&n[W][v])te+=n[W][v].Name;else if(n[0]&&n[0][v])te+=n[0][v].Name;else{var K=(F4(n,W,i)||"").split(";;");K[v-1]?te=K[v-1]:te+="SH33TJSERRX"}u.push(te);break}fe||(fe={Name:"SH33TJSERRY"}),u.push(fe.Name);break;case"PtgParen":var _e="(",Me=")";if(w>=0){switch(S="",t[0][w][1][0]){case 2:_e=cr(" ",t[0][w][1][1])+_e;break;case 3:_e=cr("\r",t[0][w][1][1])+_e;break;case 4:Me=cr(" ",t[0][w][1][1])+Me;break;case 5:Me=cr("\r",t[0][w][1][1])+Me;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}u.push(_e+u.pop()+Me);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var Se={c:r.c,r:r.r};if(n.sharedf[Je(p)]){var Y=n.sharedf[Je(p)];u.push(Qr(Y,o,Se,n,i))}else{var se=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Qr(d[1],o,Se,n,i)),se=!0;break}se||u.push(C[1])}break;case"PtgArray":u.push("{"+eB(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&w>=0&&Le.indexOf(t[0][N][0])==-1){C=t[0][w];var Z=!0;switch(C[1][0]){case 4:Z=!1;case 0:S=cr(" ",C[1][1]);break;case 5:Z=!1;case 1:S=cr("\r",C[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((Z?S:"")+u.pop()+(Z?"":S)),w=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function nB(t,e,r){var n=t.l+e,i=r.biff==2?1:2,l,o=t.read_shift(i);if(o==65535)return[[],nn(t,e-2)];var u=ef(t,o,r);return e!==o+i&&(l=Ju(t,e-o-i,u,r)),t.l=n,[u,l]}function aB(t,e,r){var n=t.l+e,i=r.biff==2?1:2,l,o=t.read_shift(i);if(o==65535)return[[],nn(t,e-2)];var u=ef(t,o,r);return e!==o+i&&(l=Ju(t,e-o-i,u,r)),t.l=n,[u,l]}function iB(t,e,r,n){var i=t.l+e,l=ef(t,n,r),o;return i!==t.l&&(o=Ju(t,i-t.l,l,r)),[l,o]}function sB(t,e,r){var n=t.l+e,i,l=t.read_shift(2),o=ef(t,l,r);return l==65535?[[],nn(t,e-2)]:(e!==l+2&&(i=Ju(t,n-l-2,o,r)),[o,i])}function lB(t){var e;if(hi(t,t.l+6)!==65535)return[en(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function cB(t){if(t==null){var e=he(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return ll(t);return ll(0)}function Im(t,e,r){var n=t.l+e,i=Va(t);r.biff==2&&++t.l;var l=lB(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=aB(t,n-t.l,r);return{cell:i,val:l[0],formula:u,shared:o>>3&1,tt:l[1]}}function oB(t,e,r,n,i){var l=ol(e,r,i),o=cB(t.v),u=he(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=he(t.bf.length),p=0;p<t.bf.length;++p)d[p]=t.bf[p];var x=Br([l,o,u,d]);return x}function Wh(t,e,r){var n=t.read_shift(4),i=ef(t,n,r),l=t.read_shift(4),o=l>0?Ju(t,l,i,r):null;return[i,o]}var uB=Wh,Xh=Wh,fB=Wh,hB=Wh,dB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},I4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function pB(t){var e="of:="+t.replace(Jg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Mm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function gB(t){return t.replace(/\./,"!")}var ru={},Ec={},nu=typeof Map<"u";function rx(t,e,r){var n=0,i=t.length;if(r){if(nu?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var l=nu?r.get(e):r[e];n<l.length;++n)if(t[l[n]].t===e)return t.Count++,l[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(nu?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function qh(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Jr=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Nu(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=xh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Ks(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function _s(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,l=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Pa(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=l;++i)if(t[i].numFmtId===n)return i;return t[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function M4(t,e,r,n,i,l){try{n.cellNF&&(t.z=Ke[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=er(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Ke[e]==null&&Pa(hO[e]||"General",e),t.t==="e")t.w=t.w||Ti[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Eu(t.v);else if(t.t==="d"){var o=Ar(t.v);(o|0)===o?t.w=o.toString(10):t.w=Eu(o)}else{if(t.v===void 0)return"";t.w=il(t.v,Ec)}else t.t==="d"?t.w=jn(e,Ar(t.v),Ec):t.w=jn(e,t.v,Ec)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=l.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=gh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=gh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&l.Fills)throw u}}}function xB(t,e,r){if(t&&t["!ref"]){var n=wt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function vB(t,e){var r=wt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=ct(r))}var _B=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,yB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,wB=/<(?:\w:)?hyperlink [^>]*>/mg,EB=/"(\w*:\w*)"/,TB=/<(?:\w:)?col\b[^>]*[\/]?>/g,SB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bB=/<(?:\w:)?pageMargins[^>]*\/>/g,L4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,CB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,kB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function AB(t,e,r,n,i,l,o){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",x=t.match(yB);x?(d=t.slice(0,x.index),p=t.slice(x.index+x[0].length)):d=p=t;var v=d.match(L4);v?nx(v[0],u,i,r):(v=d.match(CB))&&DB(v[0],v[1]||"",u,i,r);var _=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var E=d.slice(_,_+50).match(EB);E&&vB(u,E[1])}var w=d.match(kB);w&&w[1]&&VB(w[1],i);var S=[];if(e.cellStyles){var N=d.match(TB);N&&PB(S,N)}x&&XB(x[1],u,e,h,l,o);var M=p.match(SB);M&&(u["!autofilter"]=jB(M[0]));var C=[],z=p.match(_B);if(z)for(_=0;_!=z.length;++_)C[_]=wt(z[_].slice(z[_].indexOf('"')+1));var X=p.match(wB);X&&MB(u,X,n);var G=p.match(bB);if(G&&(u["!margins"]=LB(rt(G[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=ct(h)),e.sheetRows>0&&u["!ref"]){var O=wt(u["!ref"]);e.sheetRows<=+O.e.r&&(O.e.r=e.sheetRows-1,O.e.r>h.e.r&&(O.e.r=h.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>h.e.c&&(O.e.c=h.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),u["!fullref"]=u["!ref"],u["!ref"]=ct(O))}return S.length>0&&(u["!cols"]=S),C.length>0&&(u["!merges"]=C),u}function NB(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+ct(t[r])+'"/>';return e+"</mergeCells>"}function nx(t,e,r,n){var i=rt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=bt(zt(i.codeName)))}function DB(t,e,r,n,i){nx(t.slice(0,t.indexOf(">")),r,n,i)}function RB(t,e,r,n,i){var l=!1,o={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[r];try{e.Workbook&&(h=e.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,o.codeName=Ma(Bt(h))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+De("outlinePr",null,d)}!l&&!u||(i[i.length]=De("sheetPr",u,o))}var OB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],FB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function IB(t){var e={sheet:1};return OB.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),FB.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=$g(t.password).toString(16).toUpperCase()),De("sheetProtection",null,e)}function MB(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var l=rt(zt(e[i]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+bt(l.location))):(l.Target="#"+bt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=wt(l.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var p=Je({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=l):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=l)}}}function LB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function BB(t){return Ks(t),De("pageMargins",null,t)}function PB(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=rt(e[n],!0);i.hidden&&(i.hidden=Zt(i.hidden));var l=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Qg(i.width)),ds(i);l<=o;)t[l++]=Gt(i)}}function UB(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=De("col",null,qh(i,n)));return r[r.length]="</cols>",r.join("")}function jB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function HB(t,e,r,n){var i=typeof t.ref=="string"?t.ref:ct(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=hn(i);o.s.r==o.e.r&&(o.e.r=hn(e["!ref"]).e.r,i=ct(o));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),De("autoFilter",null,{ref:i})}var zB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function VB(t,e){e.Views||(e.Views=[{}]),(t.match(zB)||[]).forEach(function(r,n){var i=rt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Zt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function GB(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),De("sheetViews",De("sheetView",null,i),{})}function WB(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",l=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Ti[t.v];break;case"d":n&&n.cellDates?i=er(t.v,-1).toISOString():(t=Gt(t),t.t="n",i=""+(t.v=Ar(er(t.v)))),typeof t.z>"u"&&(t.z=Ke[14]);break;default:i=t.v;break}var u=Xr("v",Bt(i)),h={r:e},d=_s(n.cellXfs,t,n);switch(d!==0&&(h.s=d),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Xr("v",""+rx(n.Strings,t.v,n.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=l&&(t.t=l,t.v=o),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=De("f",Bt(t.f),p)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(h.cm=1),De("c",u,h)}var XB=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,l=Tu("v"),o=Tu("f");return function(h,d,p,x,v,_){for(var E=0,w="",S=[],N=[],M=0,C=0,z=0,X="",G,O,Q=0,W=0,fe,te,K=0,_e=0,Me=Array.isArray(_.CellXf),Se,Y=[],se=[],Le=Array.isArray(d),Z=[],Oe={},H=!1,k=!!p.sheetStubs,j=h.split(e),L=0,U=j.length;L!=U;++L){w=j[L].trim();var J=w.length;if(J!==0){var pe=0;e:for(E=0;E<J;++E)switch(w[E]){case">":if(w[E-1]!="/"){++E;break e}if(p&&p.cellStyles){if(O=rt(w.slice(pe,E),!0),Q=O.r!=null?parseInt(O.r,10):Q+1,W=-1,p.sheetRows&&p.sheetRows<Q)continue;Oe={},H=!1,O.ht&&(H=!0,Oe.hpt=parseFloat(O.ht),Oe.hpx=Dc(Oe.hpt)),O.hidden=="1"&&(H=!0,Oe.hidden=!0),O.outlineLevel!=null&&(H=!0,Oe.level=+O.outlineLevel),H&&(Z[Q-1]=Oe)}break;case"<":pe=E;break}if(pe>=E)break;if(O=rt(w.slice(pe,E),!0),Q=O.r!=null?parseInt(O.r,10):Q+1,W=-1,!(p.sheetRows&&p.sheetRows<Q)){x.s.r>Q-1&&(x.s.r=Q-1),x.e.r<Q-1&&(x.e.r=Q-1),p&&p.cellStyles&&(Oe={},H=!1,O.ht&&(H=!0,Oe.hpt=parseFloat(O.ht),Oe.hpx=Dc(Oe.hpt)),O.hidden=="1"&&(H=!0,Oe.hidden=!0),O.outlineLevel!=null&&(H=!0,Oe.level=+O.outlineLevel),H&&(Z[Q-1]=Oe)),S=w.slice(E).split(t);for(var we=0;we!=S.length&&S[we].trim().charAt(0)=="<";++we);for(S=S.slice(we),E=0;E!=S.length;++E)if(w=S[E].trim(),w.length!==0){if(N=w.match(r),M=E,C=0,z=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,N!=null&&N.length===2){for(M=0,X=N[1],C=0;C!=X.length&&!((z=X.charCodeAt(C)-64)<1||z>26);++C)M=26*M+z;--M,W=M}else++W;for(C=0;C!=w.length&&w.charCodeAt(C)!==62;++C);if(++C,O=rt(w.slice(0,C),!0),O.r||(O.r=Je({r:Q-1,c:W})),X=w.slice(C),G={t:""},(N=X.match(l))!=null&&N[1]!==""&&(G.v=bt(N[1])),p.cellFormula){if((N=X.match(o))!=null&&N[1]!==""){if(G.f=bt(zt(N[1])).replace(/\r\n/g,`
`),p.xlfn||(G.f=dE(G.f)),N[0].indexOf('t="array"')>-1)G.F=(X.match(i)||[])[1],G.F.indexOf(":")>-1&&Y.push([wt(G.F),G.F]);else if(N[0].indexOf('t="shared"')>-1){te=rt(N[0]);var ge=bt(zt(N[1]));p.xlfn||(ge=dE(ge)),se[parseInt(te.si,10)]=[te,ge,O.r]}}else(N=X.match(/<f[^>]*\/>/))&&(te=rt(N[0]),se[te.si]&&(G.f=z7(se[te.si][1],se[te.si][2],O.r)));var Ee=ar(O.r);for(C=0;C<Y.length;++C)Ee.r>=Y[C][0].s.r&&Ee.r<=Y[C][0].e.r&&Ee.c>=Y[C][0].s.c&&Ee.c<=Y[C][0].e.c&&(G.F=Y[C][1])}if(O.t==null&&G.v===void 0)if(G.f||G.F)G.v=0,G.t="n";else if(k)G.t="z";else continue;else G.t=O.t||"n";switch(x.s.c>W&&(x.s.c=W),x.e.c<W&&(x.e.c=W),G.t){case"n":if(G.v==""||G.v==null){if(!k)continue;G.t="z"}else G.v=parseFloat(G.v);break;case"s":if(typeof G.v>"u"){if(!k)continue;G.t="z"}else fe=ru[parseInt(G.v,10)],G.v=fe.t,G.r=fe.r,p.cellHTML&&(G.h=fe.h);break;case"str":G.t="s",G.v=G.v!=null?zt(G.v):"",p.cellHTML&&(G.h=Rg(G.v));break;case"inlineStr":N=X.match(n),G.t="s",N!=null&&(fe=Kg(N[1]))?(G.v=fe.t,p.cellHTML&&(G.h=fe.h)):G.v="";break;case"b":G.v=Zt(G.v);break;case"d":p.cellDates?G.v=er(G.v,1):(G.v=Ar(er(G.v,1)),G.t="n");break;case"e":(!p||p.cellText!==!1)&&(G.w=G.v),G.v=Pb[G.v];break}if(K=_e=0,Se=null,Me&&O.s!==void 0&&(Se=_.CellXf[O.s],Se!=null&&(Se.numFmtId!=null&&(K=Se.numFmtId),p.cellStyles&&Se.fillId!=null&&(_e=Se.fillId))),M4(G,K,_e,p,v,_),p.cellDates&&Me&&G.t=="n"&&dl(Ke[K])&&(G.t="d",G.v=zh(G.v)),O.cm&&p.xlmeta){var be=(p.xlmeta.Cell||[])[+O.cm-1];be&&be.type=="XLDAPR"&&(G.D=!0)}if(Le){var D=ar(O.r);d[D.r]||(d[D.r]=[]),d[D.r][D.c]=G}else d[O.r]=G}}}}Z.length>0&&(d["!rows"]=Z)}})();function qB(t,e,r,n){var i=[],l=[],o=wt(t["!ref"]),u="",h,d="",p=[],x=0,v=0,_=t["!rows"],E=Array.isArray(t),w={r:d},S,N=-1;for(v=o.s.c;v<=o.e.c;++v)p[v]=Jt(v);for(x=o.s.r;x<=o.e.r;++x){for(l=[],d=or(x),v=o.s.c;v<=o.e.c;++v){h=p[v]+d;var M=E?(t[x]||[])[v]:t[h];M!==void 0&&(u=WB(M,h,t,e))!=null&&l.push(u)}(l.length>0||_&&_[x])&&(w={r:d},_&&_[x]&&(S=_[x],S.hidden&&(w.hidden=1),N=-1,S.hpx?N=Du(S.hpx):S.hpt&&(N=S.hpt),N>-1&&(w.ht=N,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),i[i.length]=De("row",l.join(""),w))}if(_)for(;x<_.length;++x)_&&_[x]&&(w={r:x+1},S=_[x],S.hidden&&(w.hidden=1),N=-1,S.hpx?N=Du(S.hpx):S.hpt&&(N=S.hpt),N>-1&&(w.ht=N,w.customHeight=1),S.level&&(w.outlineLevel=S.level),i[i.length]=De("row","",w));return i.join("")}function B4(t,e,r,n){var i=[gr,De("worksheet",null,{xmlns:ml[0],"xmlns:r":kr.r})],l=r.SheetNames[t],o=0,u="",h=r.Sheets[l];h==null&&(h={});var d=h["!ref"]||"A1",p=wt(d);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=ct(p)}n||(n={}),h["!comments"]=[];var x=[];RB(h,r,t,e,i),i[i.length]=De("dimension",null,{ref:d}),i[i.length]=GB(h,e,t,r),e.sheetFormat&&(i[i.length]=De("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(i[i.length]=UB(h,h["!cols"])),i[o=i.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=qB(h,e),u.length>0&&(i[i.length]=u)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),h["!protect"]&&(i[i.length]=IB(h["!protect"])),h["!autofilter"]!=null&&(i[i.length]=HB(h["!autofilter"],h,r,t)),h["!merges"]!=null&&h["!merges"].length>0&&(i[i.length]=NB(h["!merges"]));var v=-1,_,E=-1;return h["!links"].length>0&&(i[i.length]="<hyperlinks>",h["!links"].forEach(function(w){w[1].Target&&(_={ref:w[0]},w[1].Target.charAt(0)!="#"&&(E=Lt(n,-1,Bt(w[1].Target).replace(/#.*$/,""),ht.HLINK),_["r:id"]="rId"+E),(v=w[1].Target.indexOf("#"))>-1&&(_.location=Bt(w[1].Target.slice(v+1))),w[1].Tooltip&&(_.tooltip=Bt(w[1].Tooltip)),i[i.length]=De("hyperlink",null,_))}),i[i.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(i[i.length]=BB(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Xr("ignoredErrors",De("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(E=Lt(n,-1,"../drawings/drawing"+(t+1)+".xml",ht.DRAW),i[i.length]=De("drawing",null,{"r:id":"rId"+E}),h["!drawing"]=x),h["!comments"].length>0&&(E=Lt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ht.VML),i[i.length]=De("legacyDrawing",null,{"r:id":"rId"+E}),h["!legacy"]=E),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function YB(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var l=t.read_shift(1);return t.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=i/20),r}function KB(t,e,r){var n=he(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var l=320;i.hpx?l=Du(i.hpx)*20:i.hpt&&(l=i.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,h=n.l;n.l+=4;for(var d={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var x=-1,v=-1,_=p<<10;_<p+1<<10;++_){d.c=_;var E=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Je(d)];E&&(x<0&&(x=_),v=_)}x<0||(++u,n.write_shift(4,x),n.write_shift(4,v))}var w=n.l;return n.l=h,n.write_shift(4,u),n.l=w,n.length>n.l?n.slice(0,n.l):n}function $B(t,e,r,n){var i=KB(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ye(t,0,i)}var QB=vl,ZB=zc;function JB(){}function eP(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=nF(t),r}function tP(t,e,r){r==null&&(r=he(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return dh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Fb(t,r),r.slice(0,r.l)}function rP(t){var e=ua(t);return[e]}function nP(t,e,r){return r==null&&(r=he(8)),pl(e,r)}function aP(t){var e=gl(t);return[e]}function iP(t,e,r){return r==null&&(r=he(4)),xl(e,r)}function sP(t){var e=ua(t),r=t.read_shift(1);return[e,r,"b"]}function lP(t,e,r){return r==null&&(r=he(9)),pl(e,r),r.write_shift(1,t.v?1:0),r}function cP(t){var e=gl(t),r=t.read_shift(1);return[e,r,"b"]}function oP(t,e,r){return r==null&&(r=he(5)),xl(e,r),r.write_shift(1,t.v?1:0),r}function uP(t){var e=ua(t),r=t.read_shift(1);return[e,r,"e"]}function fP(t,e,r){return r==null&&(r=he(9)),pl(e,r),r.write_shift(1,t.v),r}function hP(t){var e=gl(t),r=t.read_shift(1);return[e,r,"e"]}function dP(t,e,r){return r==null&&(r=he(8)),xl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function mP(t){var e=ua(t),r=t.read_shift(4);return[e,r,"s"]}function pP(t,e,r){return r==null&&(r=he(12)),pl(e,r),r.write_shift(4,e.v),r}function gP(t){var e=gl(t),r=t.read_shift(4);return[e,r,"s"]}function xP(t,e,r){return r==null&&(r=he(8)),xl(e,r),r.write_shift(4,e.v),r}function vP(t){var e=ua(t),r=en(t);return[e,r,"n"]}function _P(t,e,r){return r==null&&(r=he(16)),pl(e,r),ll(t.v,r),r}function P4(t){var e=gl(t),r=en(t);return[e,r,"n"]}function yP(t,e,r){return r==null&&(r=he(12)),xl(e,r),ll(t.v,r),r}function wP(t){var e=ua(t),r=Gg(t);return[e,r,"n"]}function EP(t,e,r){return r==null&&(r=he(12)),pl(e,r),Ib(t.v,r),r}function TP(t){var e=gl(t),r=Gg(t);return[e,r,"n"]}function SP(t,e,r){return r==null&&(r=he(8)),xl(e,r),Ib(t.v,r),r}function bP(t){var e=ua(t),r=Hg(t);return[e,r,"is"]}function CP(t){var e=ua(t),r=rn(t);return[e,r,"str"]}function kP(t,e,r){return r==null&&(r=he(12+4*t.v.length)),pl(e,r),Pr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function AP(t){var e=gl(t),r=rn(t);return[e,r,"str"]}function NP(t,e,r){return r==null&&(r=he(8+4*t.v.length)),xl(e,r),Pr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function DP(t,e,r){var n=t.l+e,i=ua(t);i.r=r["!row"];var l=t.read_shift(1),o=[i,l,"b"];if(r.cellFormula){t.l+=2;var u=Xh(t,n-t.l,r);o[3]=Qr(u,null,i,r.supbooks,r)}else t.l=n;return o}function RP(t,e,r){var n=t.l+e,i=ua(t);i.r=r["!row"];var l=t.read_shift(1),o=[i,l,"e"];if(r.cellFormula){t.l+=2;var u=Xh(t,n-t.l,r);o[3]=Qr(u,null,i,r.supbooks,r)}else t.l=n;return o}function OP(t,e,r){var n=t.l+e,i=ua(t);i.r=r["!row"];var l=en(t),o=[i,l,"n"];if(r.cellFormula){t.l+=2;var u=Xh(t,n-t.l,r);o[3]=Qr(u,null,i,r.supbooks,r)}else t.l=n;return o}function FP(t,e,r){var n=t.l+e,i=ua(t);i.r=r["!row"];var l=rn(t),o=[i,l,"str"];if(r.cellFormula){t.l+=2;var u=Xh(t,n-t.l,r);o[3]=Qr(u,null,i,r.supbooks,r)}else t.l=n;return o}var IP=vl,MP=zc;function LP(t,e){return e==null&&(e=he(4)),e.write_shift(4,t),e}function BP(t,e){var r=t.l+e,n=vl(t),i=zg(t),l=rn(t),o=rn(t),u=rn(t);t.l=r;var h={rfx:n,relId:i,loc:l,display:u};return o&&(h.Tooltip=o),h}function PP(t,e){var r=he(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));zc({s:ar(t[0]),e:ar(t[0])},r),Vg("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Pr(i||"",r),Pr(t[1].Tooltip||"",r),Pr("",r),r.slice(0,r.l)}function UP(){}function jP(t,e,r){var n=t.l+e,i=Mb(t),l=t.read_shift(1),o=[i];if(o[2]=l,r.cellFormula){var u=uB(t,n-t.l,r);o[1]=u}else t.l=n;return o}function HP(t,e,r){var n=t.l+e,i=vl(t),l=[i];if(r.cellFormula){var o=hB(t,n-t.l,r);l[1]=o,t.l=n}else t.l=n;return l}function zP(t,e,r){r==null&&(r=he(18));var n=qh(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var U4=["left","right","top","bottom","header","footer"];function VP(t){var e={};return U4.forEach(function(r){e[r]=en(t)}),e}function GP(t,e){return e==null&&(e=he(48)),Ks(t),U4.forEach(function(r){ll(t[r],e)}),e}function WP(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function XP(t,e,r){r==null&&(r=he(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function qP(t){var e=he(24);return e.write_shift(4,4),e.write_shift(4,1),zc(t,e),e}function YP(t,e){return e==null&&(e=he(66)),e.write_shift(2,t.password?$g(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function KP(){}function $P(){}function QP(t,e,r,n,i,l,o){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,_,E,w,S,N,M,C,z,X,G=[];u.biff=12,u["!row"]=0;var O=0,Q=!1,W=[],fe={},te=u.supbooks||i.supbooks||[[]];if(te.sharedf=fe,te.arrayf=W,te.SheetNames=i.SheetNames||i.Sheets.map(function(Le){return Le.name}),!u.supbooks&&(u.supbooks=te,i.Names))for(var K=0;K<i.Names.length;++K)te[0][K+1]=i.Names[K];var _e=[],Me=[],Se=!1;Ru[16]={n:"BrtShortReal",f:P4};var Y;if(Ei(t,function(Z,Oe,H){if(!v)switch(H){case 148:d=Z;break;case 0:_=Z,u.sheetRows&&u.sheetRows<=_.r&&(v=!0),z=or(S=_.r),u["!row"]=_.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=Dc(Z.hpt)),Me[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:Z[2]},Z[2]){case"n":E.v=Z[1];break;case"s":C=ru[Z[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!Z[1];break;case"e":E.v=Z[1],u.cellText!==!1&&(E.w=Ti[E.v]);break;case"str":E.t="s",E.v=Z[1];break;case"is":E.t="s",E.v=Z[1].t;break}if((w=o.CellXf[Z[0].iStyleRef])&&M4(E,w.numFmtId,null,u,l,o),N=Z[0].c==-1?N+1:Z[0].c,u.dense?(h[S]||(h[S]=[]),h[S][N]=E):h[Jt(N)+z]=E,u.cellFormula){for(Q=!1,O=0;O<W.length;++O){var k=W[O];_.r>=k[0].s.r&&_.r<=k[0].e.r&&N>=k[0].s.c&&N<=k[0].e.c&&(E.F=ct(k[0]),Q=!0)}!Q&&Z.length>3&&(E.f=Z[3])}if(p.s.r>_.r&&(p.s.r=_.r),p.s.c>N&&(p.s.c=N),p.e.r<_.r&&(p.e.r=_.r),p.e.c<N&&(p.e.c=N),u.cellDates&&w&&E.t=="n"&&dl(Ke[w.numFmtId])){var j=ts(E.v);j&&(E.t="d",E.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}Y&&(Y.type=="XLDAPR"&&(E.D=!0),Y=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;E={t:"z",v:void 0},N=Z[0].c==-1?N+1:Z[0].c,u.dense?(h[S]||(h[S]=[]),h[S][N]=E):h[Jt(N)+z]=E,p.s.r>_.r&&(p.s.r=_.r),p.s.c>N&&(p.s.c=N),p.e.r<_.r&&(p.e.r=_.r),p.e.c<N&&(p.e.c=N),Y&&(Y.type=="XLDAPR"&&(E.D=!0),Y=void 0);break;case 176:G.push(Z);break;case 49:Y=((u.xlmeta||{}).Cell||[])[Z-1];break;case 494:var L=n["!id"][Z.relId];for(L?(Z.Target=L.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=L):Z.relId==""&&(Z.Target="#"+Z.loc),S=Z.rfx.s.r;S<=Z.rfx.e.r;++S)for(N=Z.rfx.s.c;N<=Z.rfx.e.c;++N)u.dense?(h[S]||(h[S]=[]),h[S][N]||(h[S][N]={t:"z",v:void 0}),h[S][N].l=Z):(M=Je({c:N,r:S}),h[M]||(h[M]={t:"z",v:void 0}),h[M].l=Z);break;case 426:if(!u.cellFormula)break;W.push(Z),X=u.dense?h[S][N]:h[Jt(N)+z],X.f=Qr(Z[1],p,{r:_.r,c:N},te,u),X.F=ct(Z[0]);break;case 427:if(!u.cellFormula)break;fe[Je(Z[0].s)]=Z[1],X=u.dense?h[S][N]:h[Jt(N)+z],X.f=Qr(Z[1],p,{r:_.r,c:N},te,u);break;case 60:if(!u.cellStyles)break;for(;Z.e>=Z.s;)_e[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},Se||(Se=!0,Qg(Z.w/256)),ds(_e[Z.e+1]);break;case 161:h["!autofilter"]={ref:ct(Z)};break;case 476:h["!margins"]=Z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Z.name&&(i.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(h["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Oe.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+H.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=ct(d||p)),u.sheetRows&&h["!ref"]){var se=wt(h["!ref"]);u.sheetRows<=+se.e.r&&(se.e.r=u.sheetRows-1,se.e.r>p.e.r&&(se.e.r=p.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>p.e.c&&(se.e.c=p.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),h["!fullref"]=h["!ref"],h["!ref"]=ct(se))}return G.length>0&&(h["!merges"]=G),_e.length>0&&(h["!cols"]=_e),Me.length>0&&(h["!rows"]=Me),h}function ZP(t,e,r,n,i,l,o){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=Gt(e),e.z=e.z||Ke[14],e.v=Ar(er(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var h={r,c:n};switch(h.s=_s(i.cellXfs,e,i),e.l&&l["!links"].push([Je(h),e.l]),e.c&&l["!comments"].push([Je(h),e.c]),e.t){case"s":case"str":return i.bookSST?(u=rx(i.Strings,e.v,i.revStrings),h.t="s",h.v=u,o?ye(t,18,xP(e,h)):ye(t,7,pP(e,h))):(h.t="str",o?ye(t,17,NP(e,h)):ye(t,6,kP(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?ye(t,13,SP(e,h)):ye(t,2,EP(e,h)):o?ye(t,16,yP(e,h)):ye(t,5,_P(e,h)),!0;case"b":return h.t="b",o?ye(t,15,oP(e,h)):ye(t,4,lP(e,h)),!0;case"e":return h.t="e",o?ye(t,14,dP(e,h)):ye(t,3,fP(e,h)),!0}return o?ye(t,12,iP(e,h)):ye(t,1,nP(e,h)),!0}function JP(t,e,r,n){var i=wt(e["!ref"]||"A1"),l,o="",u=[];ye(t,145);var h=Array.isArray(e),d=i.e.r;e["!rows"]&&(d=Math.max(i.e.r,e["!rows"].length-1));for(var p=i.s.r;p<=d;++p){o=or(p),$B(t,e,i,p);var x=!1;if(p<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){p===i.s.r&&(u[v]=Jt(v)),l=u[v]+o;var _=h?(e[p]||[])[v]:e[l];if(!_){x=!1;continue}x=ZP(t,_,p,v,n,e,x)}}ye(t,146)}function eU(t,e){!e||!e["!merges"]||(ye(t,177,LP(e["!merges"].length)),e["!merges"].forEach(function(r){ye(t,176,MP(r))}),ye(t,178))}function tU(t,e){!e||!e["!cols"]||(ye(t,390),e["!cols"].forEach(function(r,n){r&&ye(t,60,zP(n,r))}),ye(t,391))}function rU(t,e){!e||!e["!ref"]||(ye(t,648),ye(t,649,qP(wt(e["!ref"]))),ye(t,650))}function nU(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Lt(r,-1,n[1].Target.replace(/#.*$/,""),ht.HLINK);ye(t,494,PP(n,i))}}),delete e["!links"]}function aU(t,e,r,n){if(e["!comments"].length>0){var i=Lt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ht.VML);ye(t,551,Vg("rId"+i)),e["!legacy"]=i}}function iU(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],l=typeof i.ref=="string"?i.ref:ct(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=hn(l);u.s.r==u.e.r&&(u.e.r=hn(e["!ref"]).e.r,l=ct(u));for(var h=0;h<o.length;++h){var d=o[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+l;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),ye(t,161,zc(wt(l))),ye(t,162)}}function sU(t,e,r){ye(t,133),ye(t,137,XP(e,r)),ye(t,138),ye(t,134)}function lU(t,e){e["!protect"]&&ye(t,535,YP(e["!protect"]))}function cU(t,e,r,n){var i=Cn(),l=r.SheetNames[t],o=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var h=wt(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ye(i,129),(r.vbaraw||o["!outline"])&&ye(i,147,tP(u,o["!outline"])),ye(i,148,ZB(h)),sU(i,o,r.Workbook),tU(i,o),JP(i,o,t,e),lU(i,o),iU(i,o,r,t),eU(i,o),nU(i,o,n),o["!margins"]&&ye(i,476,GP(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&rU(i,o),aU(i,o,t,n),ye(i,130),i.end()}function oU(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=bt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[e,i,n]}function uU(t,e,r,n,i,l){var o=l||{"!type":"chart"};if(!t)return l;var u=0,h=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=oU(x);p.s.r=p.s.c=0,p.e.c=u,d=Jt(u),v[0].forEach(function(_,E){o[d+or(E)]={t:"n",v:_,z:v[1]},h=E}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(o["!ref"]=ct(p)),o}function fU(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,u=t.match(L4);return u&&nx(u[0],l,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function hU(t,e){t.l+=10;var r=rn(t);return{name:r}}function dU(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ei(t,function(h,d,p){switch(p){case 550:l["!rel"]=h;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),h.name&&(i.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var ax=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],pU=[],gU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vE(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var l=e[i];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=Zt(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function _E(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Zt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function j4(t){_E(t.WBProps,ax),_E(t.CalcPr,gU),vE(t.WBView,mU),vE(t.Sheets,pU),Ec.date1904=Zt(t.WBProps.date1904)}function xU(t){return!t.Workbook||!t.Workbook.WBProps?"false":Zt(t.Workbook.WBProps.date1904)?"true":"false"}var vU="][*?/\\".split("");function H4(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return vU.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function _U(t,e,r){t.forEach(function(n,i){H4(n);for(var l=0;l<i;++l)if(n==t[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function z4(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];_U(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)xB(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var yU=/<\w+:workbook/;function wU(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",l={},o=0;if(t.replace(an,function(h,d){var p=rt(h);switch(za(p[0])){case"<?xml":break;case"<workbook":h.match(yU)&&(i="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[i];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ax.forEach(function(x){if(p[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=Zt(p[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(p[x[0]],10);break;default:r.WBProps[x[0]]=p[x[0]]}}),p.codeName&&(r.WBProps.CodeName=zt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=bt(zt(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=zt(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),Zt(p.hidden||"0")&&(l.Hidden=!0),o=d+h.length;break;case"</definedName>":l.Ref=bt(zt(t.slice(o,d))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),ml.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return j4(r),r}function V4(t){var e=[gr];e[e.length]=De("workbook",null,{xmlns:ml[0],"xmlns:r":kr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(ax.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=De("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],l=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",l=0;l!=t.SheetNames.length&&!(!i[l]||!i[l].Hidden);++l);l==t.SheetNames.length&&(l=0),e[e.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",l=0;l!=t.SheetNames.length;++l){var o={name:Bt(t.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),i[l])switch(i[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=De("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(e[e.length]=De("definedName",Bt(u.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function EU(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=xp(t),r.name=rn(t),r}function TU(t,e){return e||(e=he(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Vg(t.strRelID,e),Pr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function SU(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?rn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function bU(t,e){e||(e=he(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Fb(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function CU(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function kU(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),l=aF(t),o=fB(t,0,r),u=zg(t);t.l=n;var h={Name:l,Ptg:o};return i<268435455&&(h.Sheet=i),u&&(h.Comment=u),h}function AU(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],Ru[16]={n:"BrtFRTArchID$",f:CU},Ei(t,function(h,d,p){switch(p){case 156:o.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=Qr(h.Ptg,null,null,o,e),delete e.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,h]):o[0]=[p,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(p),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),j4(r),r.Names=l,r.supbooks=o,r}function NU(t,e){ye(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ye(t,156,TU(i))}ye(t,144)}function DU(t,e){e||(e=he(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Pr("SheetJS",e),Pr(yu.version,e),Pr(yu.version,e),Pr("7262",e),e.length>e.l?e.slice(0,e.l):e}function RU(t,e){e||(e=he(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function OU(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&l==-1&&(l=n);l>i||(ye(t,135),ye(t,158,RU(i)),ye(t,136))}}function FU(t,e){var r=Cn();return ye(r,131),ye(r,128,DU()),ye(r,153,bU(t.Workbook&&t.Workbook.WBProps||null)),OU(r,t),NU(r,t),ye(r,132),r.end()}function IU(t,e,r){return e.slice(-4)===".bin"?AU(t,r):wU(t,r)}function MU(t,e,r,n,i,l,o,u){return e.slice(-4)===".bin"?QP(t,n,r,i,l,o,u):AB(t,n,r,i,l,o,u)}function LU(t,e,r,n,i,l,o,u){return e.slice(-4)===".bin"?dU(t,n,r,i,l):fU(t,n,r,i,l)}function BU(t,e,r,n,i,l,o,u){return e.slice(-4)===".bin"?j7():H7()}function PU(t,e,r,n,i,l,o,u){return e.slice(-4)===".bin"?P7():U7()}function UU(t,e,r,n){return e.slice(-4)===".bin"?ML(t,r,n):TL(t,r,n)}function jU(t,e,r){return E4(t,r)}function HU(t,e,r){return e.slice(-4)===".bin"?zM(t,r):UM(t,r)}function zU(t,e,r){return e.slice(-4)===".bin"?F7(t,r):S7(t,r)}function VU(t,e,r){return e.slice(-4)===".bin"?w7(t):_7(t)}function GU(t,e,r,n){return r.slice(-4)===".bin"?E7(t,e,r,n):void 0}function WU(t,e,r){return e.slice(-4)===".bin"?g7(t,e,r):v7(t,e,r)}function XU(t,e,r){return(e.slice(-4)===".bin"?FU:V4)(t)}function qU(t,e,r,n,i){return(e.slice(-4)===".bin"?cU:B4)(t,r,n,i)}function YU(t,e,r){return(e.slice(-4)===".bin"?WL:y4)(t,r)}function KU(t,e,r){return(e.slice(-4)===".bin"?WM:h4)(t,r)}function $U(t,e,r){return(e.slice(-4)===".bin"?I7:b4)(t)}function QU(t){return(t.slice(-4)===".bin"?x7:T4)()}var G4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,W4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pa(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(G4),l,o,u,h;if(i)for(h=0;h!=i.length;++h)l=i[h].match(W4),(o=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(o+1),n[u]=l[2].slice(1,l[2].length-1));return n}function ZU(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(G4),i,l,o,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(W4),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),r[o]=i[2].slice(1,i[2].length-1));return r}var au;function JU(t,e){var r=au[t]||bt(t);return r==="General"?il(e):jn(r,e)}function ej(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Zt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=er(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[bt(e)]=i}function tj(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ti[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Eu(t.v):t.w=il(t.v):t.w=JU(e||"General",t.v)}catch(l){if(r.WTF)throw l}try{var n=au[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&dl(n)){var i=ts(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(l){if(r.WTF)throw l}}}function rj(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=pL[n.Pattern]||n.Pattern)}t[e.ID]=e}function nj(t,e,r,n,i,l,o,u,h,d){var p="General",x=n.StyleID,v={};d=d||{};var _=[],E=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);l[x]!==void 0&&(l[x].nf&&(p=l[x].nf),l[x].Interior&&_.push(l[x].Interior),!!l[x].Parent);)x=l[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Zt(t);break;case"String":n.t="s",n.r=Lw(bt(t)),n.v=t.indexOf("<")>-1?bt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(er(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=bt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Pb[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Lw(e||t));break}if(tj(n,p,d),d.cellFormula!==!1)if(n.Formula){var w=bt(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=wc(w,i),delete n.Formula,n.ArrayRange=="RC"?n.F=wc("RC:RC",i):n.ArrayRange&&(n.F=wc(n.ArrayRange,i),h.push([wt(n.F),n.F]))}else for(E=0;E<h.length;++E)i.r>=h[E][0].s.r&&i.r<=h[E][0].e.r&&i.c>=h[E][0].s.c&&i.c<=h[E][0].e.c&&(n.F=h[E][1]);d.cellStyles&&(_.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function aj(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Lm(t,e){var r=e||{};Uc();var n=fc(Og(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Tt<"u"?n=Tt.utils.decode(65001,sh(n)):n=zt(n));var i=n.slice(0,1024).toLowerCase(),l=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Gt(r);return o.type="string",Nc.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ct){i.indexOf("<"+Ct)>=0&&(l=!0)}),l)return jj(n,r);au={"General Number":"General","General Date":Ke[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ke[15],"Short Date":Ke[14],"Long Time":Ke[19],"Medium Time":Ke[18],"Short Time":Ke[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ke[2],Standard:Ke[4],Percent:Ke[10],Scientific:Ke[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,p={},x=[],v=r.dense?[]:{},_="",E={},w={},S=pa('<Data ss:Type="String">'),N=0,M=0,C=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},G={},O="",Q=0,W=[],fe={},te={},K=0,_e=[],Me=[],Se={},Y=[],se,Le=!1,Z=[],Oe=[],H={},k=0,j=0,L={Sheets:[],WBProps:{date1904:!1}},U={};bu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";u=bu.exec(n);)switch(u[3]=(J=u[3]).toLowerCase()){case"data":if(J=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?nj(n.slice(N,u.index),O,S,h[h.length-1][0]=="comment"?Se:E,{c:M,r:C},X,Y[M],w,Z,r):(O="",S=pa(u[0]),N=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Me.length>0&&(E.c=Me),(!r.sheetRows||r.sheetRows>C)&&E.v!==void 0&&(r.dense?(v[C]||(v[C]=[]),v[C][M]=E):v[Jt(M)+or(C)]=E),E.HRef&&(E.l={Target:bt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(k=M+(parseInt(E.MergeAcross,10)|0),j=C+(parseInt(E.MergeDown,10)|0),W.push({s:{c:M,r:C},e:{c:k,r:j}})),!r.sheetStubs)E.MergeAcross?M=k+1:++M;else if(E.MergeAcross||E.MergeDown){for(var pe=M;pe<=k;++pe)for(var we=C;we<=j;++we)(pe>M||we>C)&&(r.dense?(v[we]||(v[we]=[]),v[we][pe]={t:"z"}):v[Jt(pe)+or(we)]={t:"z"});M=k+1}else++M;else E=ZU(u[0]),E.Index&&(M=+E.Index-1),M<z.s.c&&(z.s.c=M),M>z.e.c&&(z.e.c=M),u[0].slice(-2)==="/>"&&++M,Me=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<z.s.r&&(z.s.r=C),C>z.e.r&&(z.e.r=C),u[0].slice(-2)==="/>"&&(w=pa(u[0]),w.Index&&(C=+w.Index-1)),M=0,++C):(w=pa(u[0]),w.Index&&(C=+w.Index-1),H={},(w.AutoFitHeight=="0"||w.Height)&&(H.hpx=parseInt(w.Height,10),H.hpt=Du(H.hpx),Oe[C]=H),w.Hidden=="1"&&(H.hidden=!0,Oe[C]=H));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(_),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(v["!ref"]=ct(z),r.sheetRows&&r.sheetRows<=z.e.r&&(v["!fullref"]=v["!ref"],z.e.r=r.sheetRows-1,v["!ref"]=ct(z))),W.length&&(v["!merges"]=W),Y.length>0&&(v["!cols"]=Y),Oe.length>0&&(v["!rows"]=Oe),p[_]=v}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=M=0,h.push([u[3],!1]),d=pa(u[0]),_=bt(d.Name),v=r.dense?[]:{},W=[],Z=[],Oe=[],U={name:_,Hidden:0},L.Sheets.push(U);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),Y=[],Le=!1}break;case"style":u[1]==="/"?rj(X,G,r):G=pa(u[0]);break;case"numberformat":G.nf=bt(pa(u[0]).Format||"General"),au[G.nf]&&(G.nf=au[G.nf]);for(var ge=0;ge!=392&&Ke[ge]!=G.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(Ke[ge]==null){Pa(G.nf,ge);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(se=pa(u[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!Le&&se.wpx>10){Le=!0,Jr=v4;for(var Ee=0;Ee<Y.length;++Ee)Y[Ee]&&ds(Y[Ee])}Le&&ds(se),Y[se.Index-1||Y.length]=se;for(var be=0;be<+se.Span;++be)Y[Y.length]=Gt(se);break;case"namedrange":if(u[1]==="/")break;L.Names||(L.Names=[]);var D=rt(u[0]),Te={Name:D.Name,Ref:wc(D.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Te.Sheet=L.Sheets.length-1),L.Names.push(Te);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?O+=n.slice(Q,u.index):Q=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;G.Interior=pa(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?NF(fe,J,n.slice(K,u.index)):K=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));aj(Se),Me.push(Se)}else h.push([u[3],!1]),d=pa(u[0]),Se={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Be=pa(u[0]);v["!autofilter"]={ref:wc(Be.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return SE(n,r);var je=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:je=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:je=!1}break;case"excelworkbook":switch(u[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:je=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:je=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(K,u.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else K=u.index+u[0].length;break;case"header":v["!margins"]||Ks(v["!margins"]={},"xlml"),isNaN(+rt(u[0]).Margin)||(v["!margins"].header=+rt(u[0]).Margin);break;case"footer":v["!margins"]||Ks(v["!margins"]={},"xlml"),isNaN(+rt(u[0]).Margin)||(v["!margins"].footer=+rt(u[0]).Margin);break;case"pagemargins":var He=rt(u[0]);v["!margins"]||Ks(v["!margins"]={},"xlml"),isNaN(+He.Top)||(v["!margins"].top=+He.Top),isNaN(+He.Left)||(v["!margins"].left=+He.Left),isNaN(+He.Right)||(v["!margins"].right=+He.Right),isNaN(+He.Bottom)||(v["!margins"].bottom=+He.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:je=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:je=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:je=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:je=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:je=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:je=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:je=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:je=!1}break;case"smarttags":break;default:je=!1;break}if(je||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?ej(te,J,_e,n.slice(K,u.index)):(_e=u,K=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var ke={};return!r.bookSheets&&!r.bookProps&&(ke.Sheets=p),ke.SheetNames=x,ke.Workbook=L,ke.SSF=Gt(Ke),ke.Props=fe,ke.Custprops=te,ke}function Sp(t,e){switch(lx(e=e||{}),e.type||"base64"){case"base64":return Lm(Un(t),e);case"binary":case"buffer":case"file":return Lm(t,e);case"array":return Lm(xs(t),e)}}function ij(t,e){var r=[];return t.Props&&r.push(DF(t.Props,e)),t.Custprops&&r.push(RF(t.Props,t.Custprops)),r.join("")}function sj(){return""}function lj(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var l=[];l.push(De("NumberFormat",null,{"ss:Format":Bt(Ke[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(De("Style",l.join(""),o))}),De("Styles",r.join(""))}function X4(t){return De("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ex(t.Ref,{r:0,c:0})})}function cj(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(X4(i)))}return De("Names",r.join(""))}function oj(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,l=[],o=0;o<i.length;++o){var u=i[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(X4(u)))}return l.join("")}function uj(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(De("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(De("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(De("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(De("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Xr("ProtectContents","True")),t["!protect"].objects&&i.push(Xr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Xr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Xr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Xr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":De("WorksheetOptions",i.join(""),{xmlns:Mn.x})}function fj(t){return t.map(function(e){var r=FO(e.t||""),n=De("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return De("Comment",n,{"ss:Author":e.a})}).join("")}function hj(t,e,r,n,i,l,o){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+Bt(ex(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var h=ar(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=Bt(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=Bt(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],p=0;p!=d.length;++p)d[p].s.c!=o.c||d[p].s.r!=o.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var x="",v="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":x="Number",v=String(t.v);break;case"b":x="Boolean",v=t.v?"1":"0";break;case"e":x="Error",v=Ti[t.v];break;case"d":x="DateTime",v=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ke[14]);break;case"s":x="String",v=OO(t.v||"");break}var _=_s(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=o.c+1;var E=t.v!=null?v:"",w=t.t=="z"?"":'<Data ss:Type="'+x+'">'+E+"</Data>";return(t.c||[]).length>0&&(w+=fj(t.c)),De("Cell",w,u)}function dj(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Dc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function mj(t,e,r,n){if(!t["!ref"])return"";var i=wt(t["!ref"]),l=t["!merges"]||[],o=0,u=[];t["!cols"]&&t["!cols"].forEach(function(S,N){ds(S);var M=!!S.width,C=qh(N,S),z={"ss:Index":N+1};M&&(z["ss:Width"]=Au(C.width)),S.hidden&&(z["ss:Hidden"]="1"),u.push(De("Column",null,z))});for(var h=Array.isArray(t),d=i.s.r;d<=i.e.r;++d){for(var p=[dj(d,(t["!rows"]||[])[d])],x=i.s.c;x<=i.e.c;++x){var v=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>x)&&!(l[o].s.r>d)&&!(l[o].e.c<x)&&!(l[o].e.r<d)){(l[o].s.c!=x||l[o].s.r!=d)&&(v=!0);break}if(!v){var _={r:d,c:x},E=Je(_),w=h?(t[d]||[])[x]:t[E];p.push(hj(w,E,t,e,r,n,_))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function pj(t,e,r){var n=[],i=r.SheetNames[t],l=r.Sheets[i],o=l?oj(l,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=l?mj(l,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(uj(l,e,t,r)),n.join("")}function gj(t,e){e||(e={}),t.SSF||(t.SSF=Gt(Ke)),t.SSF&&(Uc(),Yu(t.SSF),e.revssf=Hh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],_s(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(ij(t,e)),r.push(sj()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(De("Worksheet",pj(n,e,t),{"ss:Name":Bt(t.SheetNames[n])}));return r[2]=lj(t,e),r[3]=cj(t),gr+De("Workbook",r.join(""),{xmlns:Mn.ss,"xmlns:o":Mn.o,"xmlns:x":Mn.x,"xmlns:ss":Mn.ss,"xmlns:dt":Mn.dt,"xmlns:html":Mn.html})}function xj(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=oF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=uF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var vj=[60,1084,2066,2165,2175];function _j(t,e,r,n,i){var l=n,o=[],u=r.slice(r.l,r.l+l);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}o.push(u),r.l+=l;for(var h=hi(r,r.l),d=bp[h],p=0;d!=null&&vj.indexOf(h)>-1;)l=hi(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+l),o.push(u),r.l+=4+l,d=bp[h=hi(r,r.l)];var x=Br(o);Wr(x,0);var v=0;x.lens=[];for(var _=0;_<o.length;++_)x.lens.push(v),v+=o[_].length;if(x.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,i)}function Ra(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ke[n])}catch(l){if(e.WTF)throw l}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ti[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Eu(t.v):t.w=il(t.v):t.w=jn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(l){if(e.WTF)throw l}if(e.cellDates&&n&&t.t=="n"&&dl(Ke[n]||String(n))){var i=ts(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function D0(t,e,r){return{v:t,ixfe:e,t:r}}function yj(t,e){var r={opts:{}},n={},i=e.dense?[]:{},l={},o={},u=null,h=[],d="",p={},x,v="",_,E,w,S,N={},M=[],C,z,X=[],G=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Q={},W=function(Ye){return Ye<8?Xs[Ye]:Ye<64&&G[Ye-8]||Xs[Ye]},fe=function(Ye,St,Nr){var pt=St.XF.data;if(!(!pt||!pt.patternType||!Nr||!Nr.cellStyles)){St.s={},St.s.patternType=pt.patternType;var hr;(hr=ku(W(pt.icvFore)))&&(St.s.fgColor={rgb:hr}),(hr=ku(W(pt.icvBack)))&&(St.s.bgColor={rgb:hr})}},te=function(Ye,St,Nr){if(!(H>1)&&!(Nr.sheetRows&&Ye.r>=Nr.sheetRows)){if(Nr.cellStyles&&St.XF&&St.XF.data&&fe(Ye,St,Nr),delete St.ixfe,delete St.XF,x=Ye,v=Je(Ye),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ye.r<o.s.r&&(o.s.r=Ye.r),Ye.c<o.s.c&&(o.s.c=Ye.c),Ye.r+1>o.e.r&&(o.e.r=Ye.r+1),Ye.c+1>o.e.c&&(o.e.c=Ye.c+1),Nr.cellFormula&&St.f){for(var pt=0;pt<M.length;++pt)if(!(M[pt][0].s.c>Ye.c||M[pt][0].s.r>Ye.r)&&!(M[pt][0].e.c<Ye.c||M[pt][0].e.r<Ye.r)){St.F=ct(M[pt][0]),(M[pt][0].s.c!=Ye.c||M[pt][0].s.r!=Ye.r)&&delete St.f,St.f&&(St.f=""+Qr(M[pt][1],o,Ye,Z,K));break}}Nr.dense?(i[Ye.r]||(i[Ye.r]=[]),i[Ye.r][Ye.c]=St):i[v]=St}},K={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:M,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(K.password=e.password);var _e,Me=[],Se=[],Y=[],se=[],Le=!1,Z=[];Z.SheetNames=K.snames,Z.sharedf=K.sharedf,Z.arrayf=K.arrayf,Z.names=[],Z.XTI=[];var Oe=0,H=0,k=0,j=[],L=[],U;K.codepage=1200,la(1200);for(var J=!1;t.l<t.length-1;){var pe=t.l,we=t.read_shift(2);if(we===0&&Oe===10)break;var ge=t.l===t.length?0:t.read_shift(2),Ee=bp[we];if(Ee&&Ee.f){if(e.bookSheets&&Oe===133&&we!==133)break;if(Oe=we,Ee.r===2||Ee.r==12){var be=t.read_shift(2);if(ge-=2,!K.enc&&be!==we&&((be&255)<<8|be>>8)!==we)throw new Error("rt mismatch: "+be+"!="+we);Ee.r==12&&(t.l+=10,ge-=10)}var D={};if(we===10?D=Ee.f(t,ge,K):D=_j(we,Ee,t,ge,K),H==0&&[9,521,1033,2057].indexOf(Oe)===-1)continue;switch(we){case 34:r.opts.Date1904=O.WBProps.date1904=D;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(K.enc||(t.l=0),K.enc=D,!e.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:K.lastuser=D;break;case 66:var Te=Number(D);switch(Te){case 21010:Te=1200;break;case 32768:Te=1e4;break;case 32769:Te=1252;break}la(K.codepage=Te),J=!0;break;case 317:K.rrtabid=D;break;case 25:K.winlocked=D;break;case 439:r.opts.RefreshAll=D;break;case 12:r.opts.CalcCount=D;break;case 16:r.opts.CalcDelta=D;break;case 17:r.opts.CalcIter=D;break;case 13:r.opts.CalcMode=D;break;case 14:r.opts.CalcPrecision=D;break;case 95:r.opts.CalcSaveRecalc=D;break;case 15:K.CalcRefMode=D;break;case 2211:r.opts.FullCalc=D;break;case 129:D.fDialog&&(i["!type"]="dialog"),D.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),D.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:X.push(D);break;case 430:Z.push([D]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(D);break;case 24:case 536:U={Name:D.Name,Ref:Qr(D.rgce,o,null,Z,K)},D.itab>0&&(U.Sheet=D.itab-1),Z.names.push(U),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(L[D.itab-1]={ref:ct(D.rgce[0][0][1][2])});break;case 22:K.ExternCount=D;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(D),Z.XTI=Z.XTI.concat(D);break;case 2196:if(K.biff<8)break;U!=null&&(U.Comment=D[1]);break;case 18:i["!protect"]=D;break;case 19:D!==0&&K.WTF&&console.error("Password verifier: "+D);break;case 133:l[D.pos]=D,K.snames.push(D.name);break;case 10:{if(--H)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=ct(o),e.sheetRows&&e.sheetRows<=o.e.r){var Be=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=ct(o),o.e.r=Be}o.e.r++,o.e.c++}Me.length>0&&(i["!merges"]=Me),Se.length>0&&(i["!objects"]=Se),Y.length>0&&(i["!cols"]=Y),se.length>0&&(i["!rows"]=se),O.Sheets.push(Q)}d===""?p=i:n[d]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(K.biff===8&&(K.biff={9:2,521:3,1033:4}[we]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),K.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(K.biff=5,J=!0,la(K.codepage=28591)),K.biff==8&&D.BIFFVer==0&&D.dt==16&&(K.biff=2),H++)break;if(i=e.dense?[]:{},K.biff<8&&!J&&(J=!0,la(K.codepage=e.codepage||1252)),K.biff<5||D.BIFFVer==0&&D.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var je={pos:t.l-ge,name:d};l[je.pos]=je,K.snames.push(d)}else d=(l[pe]||{name:""}).name;D.dt==32&&(i["!type"]="chart"),D.dt==64&&(i["!type"]="macro"),Me=[],Se=[],K.arrayf=M=[],Y=[],se=[],Le=!1,Q={Hidden:(l[pe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[D.r]||[])[D.c]:i[Je({c:D.c,r:D.r})])&&++D.c,C={ixfe:D.ixfe,XF:X[D.ixfe]||{},v:D.val,t:"n"},k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te({c:D.c,r:D.r},C,e);break;case 5:case 517:C={ixfe:D.ixfe,XF:X[D.ixfe],v:D.val,t:D.t},k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te({c:D.c,r:D.r},C,e);break;case 638:C={ixfe:D.ixfe,XF:X[D.ixfe],v:D.rknum,t:"n"},k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te({c:D.c,r:D.r},C,e);break;case 189:for(var He=D.c;He<=D.C;++He){var ke=D.rkrec[He-D.c][0];C={ixfe:ke,XF:X[ke],v:D.rkrec[He-D.c][1],t:"n"},k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te({c:He,r:D.r},C,e)}break;case 6:case 518:case 1030:{if(D.val=="String"){u=D;break}if(C=D0(D.val,D.cell.ixfe,D.tt),C.XF=X[C.ixfe],e.cellFormula){var Ct=D.formula;if(Ct&&Ct[0]&&Ct[0][0]&&Ct[0][0][0]=="PtgExp"){var ir=Ct[0][0][1][0],Sr=Ct[0][0][1][1],qr=Je({r:ir,c:Sr});N[qr]?C.f=""+Qr(D.formula,o,D.cell,Z,K):C.F=((e.dense?(i[ir]||[])[Sr]:i[qr])||{}).F}else C.f=""+Qr(D.formula,o,D.cell,Z,K)}k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te(D.cell,C,e),u=D}break;case 7:case 519:if(u)u.val=D,C=D0(D,u.cell.ixfe,"s"),C.XF=X[C.ixfe],e.cellFormula&&(C.f=""+Qr(u.formula,o,u.cell,Z,K)),k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te(u.cell,C,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{M.push(D);var Ga=Je(D[0].s);if(_=e.dense?(i[D[0].s.r]||[])[D[0].s.c]:i[Ga],e.cellFormula&&_){if(!u||!Ga||!_)break;_.f=""+Qr(D[1],o,D[0],Z,K),_.F=ct(D[0])}}break;case 1212:{if(!e.cellFormula)break;if(v){if(!u)break;N[Je(u.cell)]=D[0],_=e.dense?(i[u.cell.r]||[])[u.cell.c]:i[Je(u.cell)],(_||{}).f=""+Qr(D[0],o,x,Z,K)}}break;case 253:C=D0(h[D.isst].t,D.ixfe,"s"),h[D.isst].h&&(C.h=h[D.isst].h),C.XF=X[C.ixfe],k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te({c:D.c,r:D.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:D.ixfe,XF:X[D.ixfe],t:"z"},k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te({c:D.c,r:D.r},C,e));break;case 190:if(e.sheetStubs)for(var Hn=D.c;Hn<=D.C;++Hn){var Ot=D.ixfe[Hn-D.c];C={ixfe:Ot,XF:X[Ot],t:"z"},k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te({c:Hn,r:D.r},C,e)}break;case 214:case 516:case 4:C=D0(D.val,D.ixfe,"s"),C.XF=X[C.ixfe],k>0&&(C.z=j[C.ixfe>>8&63]),Ra(C,e,r.opts.Date1904),te({c:D.c,r:D.r},C,e);break;case 0:case 512:H===1&&(o=D);break;case 252:h=D;break;case 1054:if(K.biff==4){j[k++]=D[1];for(var Fe=0;Fe<k+163&&Ke[Fe]!=D[1];++Fe);Fe>=163&&Pa(D[1],k+163)}else Pa(D[1],D[0]);break;case 30:{j[k++]=D;for(var We=0;We<k+163&&Ke[We]!=D;++We);We>=163&&Pa(D,k+163)}break;case 229:Me=Me.concat(D);break;case 93:Se[D.cmo[0]]=K.lastobj=D;break;case 438:K.lastobj.TxO=D;break;case 127:K.lastobj.ImData=D;break;case 440:for(S=D[0].s.r;S<=D[0].e.r;++S)for(w=D[0].s.c;w<=D[0].e.c;++w)_=e.dense?(i[S]||[])[w]:i[Je({c:w,r:S})],_&&(_.l=D[1]);break;case 2048:for(S=D[0].s.r;S<=D[0].e.r;++S)for(w=D[0].s.c;w<=D[0].e.c;++w)_=e.dense?(i[S]||[])[w]:i[Je({c:w,r:S})],_&&_.l&&(_.l.Tooltip=D[1]);break;case 28:{if(K.biff<=5&&K.biff>=2)break;_=e.dense?(i[D[0].r]||[])[D[0].c]:i[Je(D[0])];var Qe=Se[D[2]];_||(e.dense?(i[D[0].r]||(i[D[0].r]=[]),_=i[D[0].r][D[0].c]={t:"z"}):_=i[Je(D[0])]={t:"z"},o.e.r=Math.max(o.e.r,D[0].r),o.s.r=Math.min(o.s.r,D[0].r),o.e.c=Math.max(o.e.c,D[0].c),o.s.c=Math.min(o.s.c,D[0].c)),_.c||(_.c=[]),E={a:D[1],t:Qe.TxO.t},_.c.push(E)}break;case 2173:c7(X[D.ixfe],D.ext);break;case 125:{if(!K.cellStyles)break;for(;D.e>=D.s;)Y[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},Le||(Le=!0,Qg(D.w/256)),ds(Y[D.e+1])}break;case 520:{var tt={};D.level!=null&&(se[D.r]=tt,tt.level=D.level),D.hidden&&(se[D.r]=tt,tt.hidden=!0),D.hpt&&(se[D.r]=tt,tt.hpt=D.hpt,tt.hpx=Dc(D.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ks(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[we]]=D;break;case 161:i["!margins"]||Ks(i["!margins"]={}),i["!margins"].header=D.header,i["!margins"].footer=D.footer;break;case 574:D.RTL&&(O.Views[0].RTL=!0);break;case 146:G=D;break;case 2198:_e=D;break;case 140:z=D;break;case 442:d?Q.CodeName=D||Q.name:O.WBProps.CodeName=D||"ThisWorkbook";break}}else Ee||console.error("Missing Info for XLS Record 0x"+we.toString(16)),t.l+=ge}return r.SheetNames=fr(l).sort(function(Ze,Ye){return Number(Ze)-Number(Ye)}).map(function(Ze){return l[Ze].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&L.forEach(function(Ze,Ye){r.Sheets[r.SheetNames[Ye]]["!autofilter"]=Ze}),r.Strings=h,r.SSF=Gt(Ke),K.enc&&(r.Encryption=K.enc),_e&&(r.Themes=_e),r.Metadata={},z!==void 0&&(r.Metadata.Country=z),Z.names.length>0&&(O.Names=Z.names),r.Workbook=O,r}var iu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function wj(t,e,r){var n=Xe.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=eE(n,vp,iu.DSI);for(var l in i)e[l]=i[l]}catch(d){if(r.WTF)throw d}var o=Xe.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var u=eE(o,_p,iu.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(Gb(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Ej(t,e){var r=[],n=[],i=[],l=0,o,u=Dw(vp,"n"),h=Dw(_p,"n");if(t.Props)for(o=fr(t.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?n:i).push([o[l],t.Props[o[l]]]);if(t.Custprops)for(o=fr(t.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(t.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?n:i).push([o[l],t.Custprops[o[l]]]);var d=[];for(l=0;l<i.length;++l)Qb.indexOf(i[l][0])>-1||Vb.indexOf(i[l][0])>-1||i[l][1]!=null&&d.push(i[l]);n.length&&Xe.utils.cfb_add(e,"/SummaryInformation",tE(n,iu.SI,h,_p)),(r.length||d.length)&&Xe.utils.cfb_add(e,"/DocumentSummaryInformation",tE(r,iu.DSI,u,vp,d.length?d:null,iu.UDI))}function ix(t,e){e||(e={}),lx(e),Uh(),e.codepage&&Ph(e.codepage);var r,n;if(t.FullPaths){if(Xe.find(t,"/encryption"))throw new Error("File is password-protected");r=Xe.find(t,"!CompObj"),n=Xe.find(t,"/Workbook")||Xe.find(t,"/Book")}else{switch(e.type){case"base64":t=Ln(Un(t));break;case"binary":t=Ln(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Wr(t,0),n={content:t}}var i,l;if(r&&xj(r),e.bookProps&&!e.bookSheets)i={};else{var o=ft?"buffer":"array";if(n&&n.content)i=yj(n.content,e);else if((l=Xe.find(t,"PerfectOffice_MAIN"))&&l.content)i=Ys.to_workbook(l.content,(e.type=o,e));else if((l=Xe.find(t,"NativeContent_MAIN"))&&l.content)i=Ys.to_workbook(l.content,(e.type=o,e));else throw(l=Xe.find(t,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Xe.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=L7(t))}var u={};return t.FullPaths&&wj(t,u,e),i.Props=i.Custprops=u,e.bookFiles&&(i.cfb=t),i}function Tj(t,e){var r=e||{},n=Xe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Xe.utils.cfb_add(n,i,q4(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Ej(t,n),r.biff==8&&t.vbaraw&&B7(n,Xe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Ru={0:{f:YB},1:{f:rP},2:{f:wP},3:{f:uP},4:{f:sP},5:{f:vP},6:{f:CP},7:{f:mP},8:{f:FP},9:{f:OP},10:{f:DP},11:{f:RP},12:{f:aP},13:{f:TP},14:{f:hP},15:{f:cP},16:{f:P4},17:{f:AP},18:{f:gP},19:{f:Hg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:kU},40:{},42:{},43:{f:CL},44:{f:SL},45:{f:NL},46:{f:RL},47:{f:DL},48:{},49:{f:QO},50:{},51:{f:f7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:c4},62:{f:bP},63:{f:y7},64:{f:KP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:nn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:WP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:eP},148:{f:QB,p:16},151:{f:UP},152:{},153:{f:SU},154:{},155:{},156:{f:EU},157:{},158:{},159:{T:1,f:HM},160:{T:-1},161:{T:1,f:vl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:IP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:o7},336:{T:-1},337:{f:m7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:xp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:l4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jP},427:{f:HP},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:VP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:JB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:BP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:xp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:R7},633:{T:1},634:{T:-1},635:{T:1,f:N7},636:{T:-1},637:{f:tF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$P},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},bp={6:{f:Im},10:{f:Ki},12:{f:Tr},13:{f:Tr},14:{f:pr},15:{f:pr},16:{f:en},17:{f:pr},18:{f:pr},19:{f:Tr},20:{f:lE},21:{f:lE},23:{f:l4},24:{f:oE},25:{f:pr},26:{},27:{},28:{f:$I},29:{},34:{f:pr},35:{f:cE},38:{f:en},39:{f:en},40:{f:en},41:{f:en},42:{f:pr},43:{f:pr},47:{f:cL},49:{f:TI},51:{f:Tr},60:{},61:{f:vI},64:{f:pr},65:{f:EI},66:{f:Tr},77:{},80:{},81:{},82:{},85:{f:Tr},89:{},90:{},91:{},92:{f:lI},93:{f:JI},94:{},95:{f:pr},96:{},97:{},99:{f:pr},125:{f:c4},128:{f:PI},129:{f:oI},130:{f:Tr},131:{f:pr},132:{f:pr},133:{f:uI},134:{},140:{f:lM},141:{f:Tr},144:{},146:{f:uM},151:{},152:{},153:{},154:{},155:{},156:{f:Tr},157:{},158:{},160:{f:xM},161:{f:dM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:II},190:{f:MI},193:{f:Ki},197:{},198:{},199:{},200:{},201:{},202:{f:pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Tr},220:{},221:{f:pr},222:{},224:{f:BI},225:{f:sI},226:{f:Ki},227:{},229:{f:QI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:hI},253:{f:bI},255:{f:mI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Zb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pr},353:{f:Ki},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:VI},431:{f:pr},432:{},433:{},434:{},437:{},438:{f:rM},439:{f:pr},440:{f:nM},441:{},442:{f:Qu},443:{},444:{f:Tr},445:{},446:{},448:{f:Ki},449:{f:xI,r:2},450:{f:Ki},512:{f:aE},513:{f:gM},515:{f:HI},516:{f:kI},517:{f:sE},519:{f:vM},520:{f:pI},523:{},545:{f:uE},549:{f:nE},566:{},574:{f:yI},638:{f:FI},659:{},1048:{},1054:{f:NI},1084:{},1212:{f:qI},2048:{f:iM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:k0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ki},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:fM,r:12},2173:{f:l7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:XI,r:12},2197:{},2198:{f:t7,r:12},2199:{},2200:{},2201:{},2202:{f:YI,r:12},2203:{f:Ki},2204:{},2205:{},2206:{},2207:{},2211:{f:gI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Tr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:oM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:aE},1:{},2:{f:TM},3:{f:wM},4:{f:yM},5:{f:sE},7:{f:bM},8:{},9:{f:k0},11:{},22:{f:Tr},30:{f:RI},31:{},32:{},33:{f:uE},36:{},37:{f:nE},50:{f:CM},62:{},52:{},67:{},68:{f:Tr},69:{},86:{},126:{},127:{f:_M},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:kM},223:{},234:{},354:{},421:{},518:{f:Im},521:{f:k0},536:{f:oE},547:{f:cE},561:{},579:{},1030:{f:Im},1033:{f:k0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ie(t,e,r,n){var i=e;if(!isNaN(i)){var l=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,l),l>0&&Pg(r)&&t.push(r)}}function Sj(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ie(t,e,r,i);var l=e;if(!isNaN(l)){for(var o=r.parts||[],u=0,h=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var p=t.next(4);for(p.write_shift(2,l),p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d;h<i;){for(p=t.next(4),p.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d}}}function tf(t,e,r){return t||(t=he(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function bj(t,e,r,n){var i=he(9);return tf(i,t,e),Jb(r,n||"b",i),i}function Cj(t,e,r){var n=he(8+2*r.length);return tf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function kj(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ar(er(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ie(t,2,SM(r,n,i)):Ie(t,3,EM(r,n,i));return;case"b":case"e":Ie(t,5,bj(r,n,e.v,e.t));return;case"s":case"str":Ie(t,4,Cj(r,n,(e.v||"").slice(0,255)));return}Ie(t,1,tf(null,r,n))}function Aj(t,e,r,n){var i=Array.isArray(e),l=wt(e["!ref"]||"A1"),o,u="",h=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=ct(l)}for(var d=l.s.r;d<=l.e.r;++d){u=or(d);for(var p=l.s.c;p<=l.e.c;++p){d===l.s.r&&(h[p]=Jt(p)),o=h[p]+u;var x=i?(e[d]||[])[p]:e[o];x&&kj(t,x,d,p)}}}function Nj(t,e){for(var r=e||{},n=Cn(),i=0,l=0;l<t.SheetNames.length;++l)t.SheetNames[l]==r.sheet&&(i=l);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ie(n,r.biff==4?1033:r.biff==3?521:9,Yg(t,16,r)),Aj(n,t.Sheets[t.SheetNames[i]],i,r),Ie(n,10),n.end()}function Dj(t,e,r){Ie(t,49,SI({sz:12,name:"Arial"},r))}function Rj(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ie(t,1054,DI(i,e[i],r))})}function Oj(t,e){var r=he(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ie(t,2151,r),r=he(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),a4(wt(e["!ref"]||"A1"),r),r.write_shift(4,4),Ie(t,2152,r)}function Fj(t,e){for(var r=0;r<16;++r)Ie(t,224,iE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ie(t,224,iE(n,0,e))})}function Ij(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ie(t,440,aM(n)),n[1].Tooltip&&Ie(t,2048,sM(n))}delete e["!links"]}function Mj(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ie(t,125,hM(qh(i,n),i))})}}function Lj(t,e,r,n,i){var l=16+_s(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ie(t,513,ol(r,n,l));return}if(e.bf)Ie(t,6,oB(e,r,n,i,l));else switch(e.t){case"d":case"n":var o=e.t=="d"?Ar(er(e.v)):e.v;Ie(t,515,zI(r,n,o,l));break;case"b":case"e":Ie(t,517,jI(r,n,e.v,l,i,e.t));break;case"s":case"str":if(i.bookSST){var u=rx(i.Strings,e.v,i.revStrings);Ie(t,253,CI(r,n,u,l))}else Ie(t,516,AI(r,n,(e.v||"").slice(0,255),l,i));break;default:Ie(t,513,ol(r,n,l))}}function Bj(t,e,r){var n=Cn(),i=r.SheetNames[t],l=r.Sheets[i]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[t]||{},h=Array.isArray(l),d=e.biff==8,p,x="",v=[],_=wt(l["!ref"]||"A1"),E=d?65536:16384;if(_.e.c>255||_.e.r>=E){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,E-1)}Ie(n,2057,Yg(r,16,e)),Ie(n,13,ia(1)),Ie(n,12,ia(100)),Ie(n,15,un(!0)),Ie(n,17,un(!1)),Ie(n,16,ll(.001)),Ie(n,95,un(!0)),Ie(n,42,un(!1)),Ie(n,43,un(!1)),Ie(n,130,ia(1)),Ie(n,128,UI()),Ie(n,131,un(!1)),Ie(n,132,un(!1)),d&&Mj(n,l["!cols"]),Ie(n,512,OI(_,e)),d&&(l["!links"]=[]);for(var w=_.s.r;w<=_.e.r;++w){x=or(w);for(var S=_.s.c;S<=_.e.c;++S){w===_.s.r&&(v[S]=Jt(S)),p=v[S]+x;var N=h?(l[w]||[])[S]:l[p];N&&(Lj(n,N,w,S,e),d&&N.l&&l["!links"].push([p,N.l]))}}var M=u.CodeName||u.name||i;return d&&Ie(n,574,wI((o.Views||[])[0])),d&&(l["!merges"]||[]).length&&Ie(n,229,ZI(l["!merges"])),d&&Ij(n,l),Ie(n,442,e4(M)),d&&Oj(n,l),Ie(n,10),n.end()}function Pj(t,e,r){var n=Cn(),i=(t||{}).Workbook||{},l=i.Sheets||[],o=i.WBProps||{},u=r.biff==8,h=r.biff==5;if(Ie(n,2057,Yg(t,5,r)),r.bookType=="xla"&&Ie(n,135),Ie(n,225,u?ia(1200):null),Ie(n,193,jF(2)),h&&Ie(n,191),h&&Ie(n,192),Ie(n,226),Ie(n,92,cI("SheetJS",r)),Ie(n,66,ia(u?1200:1252)),u&&Ie(n,353,ia(0)),u&&Ie(n,448),Ie(n,317,pM(t.SheetNames.length)),u&&t.vbaraw&&Ie(n,211),u&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";Ie(n,442,e4(d))}Ie(n,156,ia(17)),Ie(n,25,un(!1)),Ie(n,18,un(!1)),Ie(n,19,ia(0)),u&&Ie(n,431,un(!1)),u&&Ie(n,444,ia(0)),Ie(n,61,_I()),Ie(n,64,un(!1)),Ie(n,141,ia(0)),Ie(n,34,un(xU(t)=="true")),Ie(n,14,un(!0)),u&&Ie(n,439,un(!1)),Ie(n,218,ia(0)),Dj(n,t,r),Rj(n,t.SSF,r),Fj(n,r),u&&Ie(n,352,un(!1));var p=n.end(),x=Cn();u&&Ie(x,140,cM()),u&&r.Strings&&Sj(x,252,dI(r.Strings)),Ie(x,10);var v=x.end(),_=Cn(),E=0,w=0;for(w=0;w<t.SheetNames.length;++w)E+=(u?12:11)+(u?2:1)*t.SheetNames[w].length;var S=p.length+E+v.length;for(w=0;w<t.SheetNames.length;++w){var N=l[w]||{};Ie(_,133,fI({pos:S,hs:N.Hidden||0,dt:0,name:t.SheetNames[w]},r)),S+=e[w].length}var M=_.end();if(E!=M.length)throw new Error("BS8 "+E+" != "+M.length);var C=[];return p.length&&C.push(p),M.length&&C.push(M),v.length&&C.push(v),Br(C)}function Uj(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Gt(Ke)),t&&t.SSF&&(Uc(),Yu(t.SSF),r.revssf=Hh(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,cx(r),r.cellXfs=[],_s(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Bj(i,r,t);return n.unshift(Pj(t,n,r)),Br(n)}function q4(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=hn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=e||{};switch(l.biff||2){case 8:case 5:return Uj(t,e);case 4:case 3:case 2:return Nj(t,e)}throw new Error("invalid type "+l.bookType+" for BIFF")}function yE(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var l=t.match(/<\/table/i),o=i.index,u=l&&l.index||t.length,h=SO(t.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,p=0,x=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<h.length;++o){var w=h[o].trim(),S=w.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}p=0;continue}if(!(S!="<td"&&S!="<th")){var N=w.split(/<\/t[dh]>/i);for(u=0;u<N.length;++u){var M=N[u].trim();if(M.match(/<t[dh]/i)){for(var C=M,z=0;C.charAt(0)=="<"&&(z=C.indexOf(">"))>-1;)C=C.slice(z+1);for(var X=0;X<E.length;++X){var G=E[X];G.s.c==p&&G.s.r<d&&d<=G.e.r&&(p=G.e.c+1,X=-1)}var O=rt(M.slice(0,M.indexOf(">")));v=O.colspan?+O.colspan:1,((x=+O.rowspan)>1||v>1)&&E.push({s:{r:d,c:p},e:{r:d+(x||1)-1,c:p+v-1}});var Q=O.t||O["data-t"]||"";if(!C.length){p+=v;continue}if(C=wb(C),_.s.r>d&&(_.s.r=d),_.e.r<d&&(_.e.r=d),_.s.c>p&&(_.s.c=p),_.e.c<p&&(_.e.c=p),!C.length){p+=v;continue}var W={t:"s",v:C};r.raw||!C.trim().length||Q=="s"||(C==="TRUE"?W={t:"b",v:!0}:C==="FALSE"?W={t:"b",v:!1}:isNaN(Ta(C))?isNaN(Ac(C).getDate())||(W={t:"d",v:er(C)},r.cellDates||(W={t:"n",v:Ar(W.v)}),W.z=r.dateNF||Ke[14]):W={t:"n",v:Ta(C)}),r.dense?(n[d]||(n[d]=[]),n[d][p]=W):n[Je({r:d,c:p})]=W,p+=v}}}}return n["!ref"]=ct(_),E.length&&(n["!merges"]=E),n}function Y4(t,e,r,n){for(var i=t["!merges"]||[],l=[],o=e.s.c;o<=e.e.c;++o){for(var u=0,h=0,d=0;d<i.length;++d)if(!(i[d].s.r>r||i[d].s.c>o)&&!(i[d].e.r<r||i[d].e.c<o)){if(i[d].s.r<r||i[d].s.c<o){u=-1;break}u=i[d].e.r-i[d].s.r+1,h=i[d].e.c-i[d].s.c+1;break}if(!(u<0)){var p=Je({r,c:o}),x=n.dense?(t[r]||[])[o]:t[p],v=x&&x.v!=null&&(x.h||Rg(x.w||(Ha(x),x.w)||""))||"",_={};u>1&&(_.rowspan=u),h>1&&(_.colspan=h),n.editable?v='<span contenteditable="true">'+v+"</span>":x&&(_["data-t"]=x&&x.t||"z",x.v!=null&&(_["data-v"]=x.v),x.z!=null&&(_["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),_.id=(n.id||"sjs")+"-"+p,l.push(De("td",v,_))}}var E="<tr>";return E+l.join("")+"</tr>"}var K4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$4="</body></html>";function jj(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return vs(yE(r[0],e),e);var n=dx();return r.forEach(function(i,l){mx(n,yE(i,e),"Sheet"+(l+1))}),n}function Q4(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Z4(t,e){var r=e||{},n=r.header!=null?r.header:K4,i=r.footer!=null?r.footer:$4,l=[n],o=hn(t["!ref"]);r.dense=Array.isArray(t),l.push(Q4(t,o,r));for(var u=o.s.r;u<=o.e.r;++u)l.push(Y4(t,o,u,r));return l.push("</table>"+i),l.join("")}function J4(t,e,r){var n=r||{},i=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?ar(n.origin):n.origin;i=o.r,l=o.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:i,c:l}};if(t["!ref"]){var p=hn(t["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),i==-1&&(d.e.r=i=p.e.r+1)}var x=[],v=0,_=t["!rows"]||(t["!rows"]=[]),E=0,w=0,S=0,N=0,M=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<u.length&&w<h;++E){var z=u[E];if(wE(z)){if(n.display)continue;_[w]={hidden:!0}}var X=z.children;for(S=N=0;S<X.length;++S){var G=X[S];if(!(n.display&&wE(G))){var O=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):wb(G.innerHTML),Q=G.getAttribute("data-z")||G.getAttribute("z");for(v=0;v<x.length;++v){var W=x[v];W.s.c==N+l&&W.s.r<w+i&&w+i<=W.e.r&&(N=W.e.c+1-l,v=-1)}C=+G.getAttribute("colspan")||1,((M=+G.getAttribute("rowspan")||1)>1||C>1)&&x.push({s:{r:w+i,c:N+l},e:{r:w+i+(M||1)-1,c:N+l+(C||1)-1}});var fe={t:"s",v:O},te=G.getAttribute("data-t")||G.getAttribute("t")||"";O!=null&&(O.length==0?fe.t=te||"z":n.raw||O.trim().length==0||te=="s"||(O==="TRUE"?fe={t:"b",v:!0}:O==="FALSE"?fe={t:"b",v:!1}:isNaN(Ta(O))?isNaN(Ac(O).getDate())||(fe={t:"d",v:er(O)},n.cellDates||(fe={t:"n",v:Ar(fe.v)}),fe.z=n.dateNF||Ke[14]):fe={t:"n",v:Ta(O)})),fe.z===void 0&&Q!=null&&(fe.z=Q);var K="",_e=G.getElementsByTagName("A");if(_e&&_e.length)for(var Me=0;Me<_e.length&&!(_e[Me].hasAttribute("href")&&(K=_e[Me].getAttribute("href"),K.charAt(0)!="#"));++Me);K&&K.charAt(0)!="#"&&(fe.l={Target:K}),n.dense?(t[w+i]||(t[w+i]=[]),t[w+i][N+l]=fe):t[Je({c:N+l,r:w+i})]=fe,d.e.c<N+l&&(d.e.c=N+l),N+=C}}++w}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,w-1+i),t["!ref"]=ct(d),w>=h&&(t["!fullref"]=ct((d.e.r=u.length-E+w-1+i,d))),t}function eC(t,e){var r=e||{},n=r.dense?[]:{};return J4(n,t,e)}function Hj(t,e){return vs(eC(t,e),e)}function wE(t){var e="",r=zj(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function zj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Vj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=bt(e.replace(/<[^>]*>/g,""));return[r]}var EE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function tC(t,e){var r=e||{},n=Og(t),i=[],l,o,u={name:""},h="",d=0,p,x,v={},_=[],E=r.dense?[]:{},w,S,N={value:""},M="",C=0,z=[],X=-1,G=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},Q=0,W={},fe=[],te={},K=0,_e=0,Me=[],Se=1,Y=1,se=[],Le={Names:[]},Z={},Oe=["",""],H=[],k={},j="",L=0,U=!1,J=!1,pe=0;for(bu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=bu.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?E["!ref"]=ct(O):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=O.e.r&&(E["!fullref"]=E["!ref"],O.e.r=r.sheetRows-1,E["!ref"]=ct(O)),fe.length&&(E["!merges"]=fe),Me.length&&(E["!rows"]=Me),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),_.push(p.name),v[p.name]=E,J=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=rt(w[0],!1),X=G=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,E=r.dense?[]:{},fe=[],Me=[],J=!0);break;case"table-row-group":w[1]==="/"?--Q:++Q;break;case"table-row":case"":if(w[1]==="/"){X+=Se,Se=1;break}if(x=rt(w[0],!1),x.?X=x.-1:X==-1&&(X=0),Se=+x["number-rows-repeated"]||1,Se<10)for(pe=0;pe<Se;++pe)Q>0&&(Me[X+pe]={level:Q});G=-1;break;case"covered-table-cell":w[1]!=="/"&&++G,r.sheetStubs&&(r.dense?(E[X]||(E[X]=[]),E[X][G]={t:"z"}):E[Je({r:X,c:G})]={t:"z"}),M="",z=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++G,N=rt(w[0],!1),Y=parseInt(N["number-columns-repeated"]||"1",10),S={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(S.f=xE(bt(N.formula))),(N.||N["value-type"])=="string"&&(S.t="s",S.v=bt(N["string-value"]||""),r.dense?(E[X]||(E[X]=[]),E[X][G]=S):E[Je({r:X,c:G})]=S),G+=Y-1;else if(w[1]!=="/"){++G,M="",C=0,z=[],Y=1;var we=Se?X+Se-1:X;if(G>O.e.c&&(O.e.c=G),G<O.s.c&&(O.s.c=G),X<O.s.r&&(O.s.r=X),we>O.e.r&&(O.e.r=we),N=rt(w[0],!1),H=[],k={},S={t:N.||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=bt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(K=parseInt(N["number-matrix-rows-spanned"],10)||0,_e=parseInt(N["number-matrix-columns-spanned"],10)||0,te={s:{r:X,c:G},e:{r:X+K-1,c:G+_e-1}},S.F=ct(te),se.push([te,S.F])),N.formula)S.f=xE(N.formula);else for(pe=0;pe<se.length;++pe)X>=se[pe][0].s.r&&X<=se[pe][0].e.r&&G>=se[pe][0].s.c&&G<=se[pe][0].e.c&&(S.F=se[pe][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(K=parseInt(N["number-rows-spanned"],10)||0,_e=parseInt(N["number-columns-spanned"],10)||0,te={s:{r:X,c:G},e:{r:X+K-1,c:G+_e-1}},fe.push(te)),N["number-columns-repeated"]&&(Y=parseInt(N["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Zt(N["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(N.value);break;case"percentage":S.t="n",S.v=parseFloat(N.value);break;case"currency":S.t="n",S.v=parseFloat(N.value);break;case"date":S.t="d",S.v=er(N["date-value"]),r.cellDates||(S.t="n",S.v=Ar(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=wO(N["time-value"])/86400,r.cellDates&&(S.t="d",S.v=zh(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(N.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",N["string-value"]!=null&&(M=bt(N["string-value"]),z=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(U=!1,S.t==="s"&&(S.v=M||"",z.length&&(S.R=z),U=C==0),Z.Target&&(S.l=Z),H.length>0&&(S.c=H,H=[]),M&&r.cellText!==!1&&(S.w=M),U&&(S.t="z",delete S.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var ge=0;ge<Se;++ge){if(Y=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(E[X+ge]||(E[X+ge]=[]),E[X+ge][G]=ge==0?S:Gt(S);--Y>0;)E[X+ge][G+Y]=Gt(S);else for(E[Je({r:X+ge,c:G})]=S;--Y>0;)E[Je({r:X+ge,c:G+Y})]=Gt(S);O.e.c<=G&&(O.e.c=G)}Y=parseInt(N["number-columns-repeated"]||"1",10),G+=Y-1,Y=0,S={},M="",z=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=i.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=i.pop())[0]!==w[3])throw"Bad state: "+l;k.t=M,z.length&&(k.R=z),k.a=j,H.push(k)}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!1]);j="",L=0,M="",C=0,z=[];break;case"creator":w[1]==="/"?j=n.slice(L,w.index):L=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=i.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!1]);M="",C=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(W[u.name]=h,(l=i.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(h="",u=rt(w[0],!1),i.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=rt(w[0],!1),h+=EE[w[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=rt(w[0],!1),h+=EE[w[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":o=rt(w[0],!1),Oe=Mm(o["cell-range-address"]);var Ee={Name:o.name,Ref:Oe[0]+"!"+Oe[1]};J&&(Ee.Sheet=_.length),Le.Names.push(Ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(w[1]==="/"&&(!N||!N["string-value"])){var be=Vj(n.slice(C,w.index));M=(M.length>0?M+`
`:"")+be[0]}else rt(w[0],!1),C=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Oe=Mm(rt(w[0])["target-range-address"]),v[Oe[0]]["!autofilter"]={ref:Oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(Z=rt(w[0],!1),!Z.href)break;Z.Target=bt(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(Oe=Mm(Z.Target.slice(1)),Z.Target="#"+Oe[0]+"!"+Oe[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var D={Sheets:v,SheetNames:_,Workbook:Le};return r.bookSheets&&delete D.Sheets,D}function TE(t,e){e=e||{},aa(t,"META-INF/manifest.xml")&&wF(Er(t,"META-INF/manifest.xml"),e);var r=Bn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=tC(zt(r),e);return aa(t,"meta.xml")&&(n.Props=Hb(Er(t,"meta.xml"))),n}function SE(t,e){return tC(t,e)}var Gj=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Su({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return gr+e}})(),bE=(function(){var t=function(l){return Bt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,o,u){var h=[];h.push('      <table:table table:name="'+Bt(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,x=hn(l["!ref"]||"A1"),v=l["!merges"]||[],_=0,E=Array.isArray(l);if(l["!cols"])for(p=0;p<=x.e.c;++p)h.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var w="",S=l["!rows"]||[];for(d=0;d<x.s.r;++d)w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=x.e.r;++d){for(w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+w+`>
`),p=0;p<x.s.c;++p)h.push(e);for(;p<=x.e.c;++p){var N=!1,M={},C="";for(_=0;_!=v.length;++_)if(!(v[_].s.c>p)&&!(v[_].s.r>d)&&!(v[_].e.c<p)&&!(v[_].e.r<d)){(v[_].s.c!=p||v[_].s.r!=d)&&(N=!0),M["table:number-columns-spanned"]=v[_].e.c-v[_].s.c+1,M["table:number-rows-spanned"]=v[_].e.r-v[_].s.r+1;break}if(N){h.push(r);continue}var z=Je({r:d,c:p}),X=E?(l[d]||[])[p]:l[z];if(X&&X.f&&(M["table:formula"]=Bt(pB(X.f)),X.F&&X.F.slice(0,z.length)==z)){var G=hn(X.F);M["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,M["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!X){h.push(e);continue}switch(X.t){case"b":C=X.v?"TRUE":"FALSE",M["office:value-type"]="boolean",M["office:boolean-value"]=X.v?"true":"false";break;case"n":C=X.w||String(X.v||0),M["office:value-type"]="float",M["office:value"]=X.v||0;break;case"s":case"str":C=X.v==null?"":X.v,M["office:value-type"]="string";break;case"d":C=X.w||er(X.v).toISOString(),M["office:value-type"]="date",M["office:date-value"]=er(X.v).toISOString(),M["table:style-name"]="ce1";break;default:h.push(e);continue}var O=t(C);if(X.l&&X.l.Target){var Q=X.l.Target;Q=Q.charAt(0)=="#"?"#"+gB(Q.slice(1)):Q,Q.charAt(0)!="#"&&!Q.match(/^\w+:/)&&(Q="../"+Q),O=De("text:a",O,{"xlink:href":Q.replace(/&/g,"&amp;")})}h.push("          "+De("table:table-cell",De("text:p",O,{}),M)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},i=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var x=d["!cols"][p];if(x.width==null&&x.wpx==null&&x.wch==null)continue;ds(x),x.ods=u;var v=d["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=h;var x=d["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,u){var h=[gr],d=Su({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Su({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+p+`>
`),h.push(jb().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),i(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)h.push(n(o.Sheets[o.SheetNames[x]],o,x));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function rC(t,e){if(e.bookType=="fods")return bE(t,e);var r=Ag(),n="",i=[],l=[];return n="mimetype",ut(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ut(r,n,bE(t,e)),i.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",ut(r,n,Gj(t,e)),i.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",ut(r,n,gr+jb()),i.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",ut(r,n,SF(l)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ut(r,n,EF(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ul(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Cp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):zt(xs(t))}function Wj(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ln(Ma(t))}function Xj(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function ps(t){var e=t.reduce(function(i,l){return i+l.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function CE(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function qj(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Yj(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var l=0;i>=1;++l,i/=256)t[e+l]=i&255;t[e+15]|=r>=0?0:128}function Ou(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Mt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function ur(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Nt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Ou(t,r),l=i&7;i=Math.floor(i/8);var o=0,u;if(i==0)break;switch(l){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:o=4,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ou(t,r),u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(i," at offset ").concat(n))}var d={data:u,type:l};e[i]==null?e[i]=[d]:e[i].push(d)}return e}function Vr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Mt(n*8+i.type)),i.type==2&&e.push(Mt(i.data.length)),e.push(i.data))})}),ps(e)}function sx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ra(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Ou(t,n),l=Nt(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:ur(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Nt(u.data),d=ur(h[3][0].data);o.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=l[3])!=null&&e[0]&&(o.merge=ur(l[3][0].data)>>>0>0),r.push(o)}return r}function ic(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Mt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Mt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Mt(o.data.length)}],n[2].push({data:Vr(o.meta),type:2})});var l=Vr(n);e.push(Mt(l.length)),e.push(l),i.forEach(function(o){return e.push(o)})}),ps(e)}function Kj(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Ou(e,r),i=[];r[0]<e.length;){var l=e[r[0]]&3;if(l==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=e[r[0]],u>1&&(o|=e[r[0]+1]<<8),u>2&&(o|=e[r[0]+2]<<16),u>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,d=0;if(l==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,l==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ps(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(i.push(i[0].slice(-h)),d-=h;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-h,-h+d))}}var p=ps(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function na(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Kj(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return ps(e)}function sc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var l=Mt(n),o=l.length;e.push(l),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return ps(e)}function $j(t,e,r,n){var i=ul(t),l=i.getUint32(4,!0),o=(n>1?12:8)+CE(l&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,p=new Date(2001,0,1);l&512&&(u=i.getUint32(o,!0),o+=4),o+=CE(l&(n>1?12288:4096))*4,l&16&&(h=i.getUint32(o,!0),o+=4),l&32&&(d=i.getFloat64(o,!0),o+=8),l&64&&(p.setTime(p.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:e[h]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(h>-1)x={t:"s",v:e[h]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function Qj(t,e,r){var n=ul(t),i=n.getUint32(8,!0),l=12,o=-1,u=-1,h=NaN,d=NaN,p=new Date(2001,0,1);i&1&&(h=qj(t,l),l+=16),i&2&&(d=n.getFloat64(l,!0),l+=8),i&4&&(p.setTime(p.getTime()+n.getFloat64(l,!0)*1e3),l+=8),i&8&&(u=n.getUint32(l,!0),l+=4),i&16&&(o=n.getUint32(l,!0),l+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return x}function Bm(t,e){var r=new Uint8Array(32),n=ul(r),i=12,l=0;switch(r[0]=5,t.t){case"n":r[1]=2,Yj(r,i,t.v),l|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),l|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),l|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,l,!0),r.slice(0,i)}function Pm(t,e){var r=new Uint8Array(32),n=ul(r),i=12,l=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),l|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),l|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),l|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,l,!0),r.slice(0,i)}function Zj(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return $j(t,e,r,t[0]);case 5:return Qj(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function $r(t){var e=Nt(t);return Ou(e[1][0].data)}function kE(t,e){var r=Nt(e.data),n=ur(r[1][0].data),i=r[3],l=[];return(i||[]).forEach(function(o){var u=Nt(o.data),h=ur(u[1][0].data)>>>0;switch(n){case 1:l[h]=Cp(u[3][0].data);break;case 8:{var d=t[$r(u[9][0].data)][0],p=Nt(d.data),x=t[$r(p[1][0].data)][0],v=ur(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=Nt(x.data);l[h]=_[3].map(function(E){return Cp(E.data)}).join("")}break}}),l}function Jj(t,e){var r,n,i,l,o,u,h,d,p,x,v,_,E,w,S=Nt(t),N=ur(S[1][0].data)>>>0,M=ur(S[2][0].data)>>>0,C=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&ur(S[8][0].data)>0||!1,z,X;if((l=(i=S[7])==null?void 0:i[0])!=null&&l.data&&e!=0)z=(u=(o=S[7])==null?void 0:o[0])==null?void 0:u.data,X=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((x=(p=S[4])==null?void 0:p[0])!=null&&x.data&&e!=1)z=(_=(v=S[4])==null?void 0:v[0])==null?void 0:_.data,X=(w=(E=S[3])==null?void 0:E[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var G=C?4:1,O=ul(z),Q=[],W=0;W<z.length/2;++W){var fe=O.getUint16(W*2,!0);fe<65535&&Q.push([W,fe])}if(Q.length!=M)throw"Expected ".concat(M," cells, found ").concat(Q.length);var te=[];for(W=0;W<Q.length-1;++W)te[Q[W][0]]=X.subarray(Q[W][1]*G,Q[W+1][1]*G);return Q.length>=1&&(te[Q[Q.length-1][0]]=X.subarray(Q[Q.length-1][1]*G)),{R:N,cells:te}}function eH(t,e){var r,n=Nt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?ur(n[7][0].data)>>>0>0?1:0:-1,l=sx(n[5],function(o){return Jj(o,i)});return{nrows:ur(n[4][0].data)>>>0,data:l.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=h}),o},[])}}function tH(t,e,r){var n,i=Nt(e.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(ur(i[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(l.e.c=(ur(i[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=ct(l);var o=Nt(i[4][0].data),u=kE(t,t[$r(o[4][0].data)][0]),h=(n=o[17])!=null&&n[0]?kE(t,t[$r(o[17][0].data)][0]):[],d=Nt(o[3][0].data),p=0;d[1].forEach(function(x){var v=Nt(x.data),_=t[$r(v[2][0].data)][0],E=ur(_.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var w=eH(t,_);w.data.forEach(function(S,N){S.forEach(function(M,C){var z=Je({r:p+N,c:C}),X=Zj(M,u,h);X&&(r[z]=X)})}),p+=w.nrows})}function rH(t,e){var r=Nt(e.data),n={"!ref":"A1"},i=t[$r(r[2][0].data)],l=ur(i[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return tH(t,i[0],n),n}function nH(t,e){var r,n=Nt(e.data),i={name:(r=n[1])!=null&&r[0]?Cp(n[1][0].data):"",sheets:[]},l=sx(n[2],$r);return l.forEach(function(o){t[o].forEach(function(u){var h=ur(u.meta[1][0].data);h==6e3&&i.sheets.push(rH(t,u))})}),i}function aH(t,e){var r=dx(),n=Nt(e.data),i=sx(n[1],$r);if(i.forEach(function(l){t[l].forEach(function(o){var u=ur(o.meta[1][0].data);if(u==2){var h=nH(t,o);h.sheets.forEach(function(d,p){mx(r,d,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Um(t){var e,r,n,i,l={},o=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=na(h.content)}catch(x){return console.log("?? "+h.content.length+" "+(x.message||x))}var p;try{p=ra(d)}catch(x){return console.log("## "+(x.message||x))}p.forEach(function(x){l[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((i=(n=(r=(e=l==null?void 0:l[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&ur(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||o.forEach(function(h){l[h].forEach(function(d){var p=ur(d.meta[1][0].data)>>>0;if(p==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return aH(l,u)}function iH(t,e,r){var n,i,l,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(l=t[8])==null?void 0:l[0])==null?void 0:o.data)&&ur(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=ul(t[7][0].data),p=0,x=[],v=ul(t[4][0].data),_=0,E=[],w=0;w<e.length;++w){if(e[w]==null){d.setUint16(w*2,65535,!0),v.setUint16(w*2,65535);continue}d.setUint16(w*2,p,!0),v.setUint16(w*2,_,!0);var S,N;switch(typeof e[w]){case"string":S=Bm({t:"s",v:e[w]},r),N=Pm({t:"s",v:e[w]},r);break;case"number":S=Bm({t:"n",v:e[w]},r),N=Pm({t:"n",v:e[w]},r);break;case"boolean":S=Bm({t:"b",v:e[w]},r),N=Pm({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}x.push(S),p+=S.length,E.push(N),_+=N.length,++h}for(t[2][0].data=Mt(h);w<t[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),v.setUint16(w*2,65535,!0);return t[6][0].data=ps(x),t[3][0].data=ps(E),h}function sH(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=hn(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ct(n)));var l=vh(r,{range:n,header:1}),o=["~Sh33tJ5~"];l.forEach(function(j){return j.forEach(function(L){typeof L=="string"&&o.push(L)})});var u={},h=[],d=Xe.read(e.numbers,{type:"base64"});d.FileIndex.map(function(j,L){return[j,d.FullPaths[L]]}).forEach(function(j){var L=j[0],U=j[1];if(L.type==2&&L.name.match(/\.iwa/)){var J=L.content,pe=na(J),we=ra(pe);we.forEach(function(ge){h.push(ge.id),u[ge.id]={deps:[],location:U,type:ur(ge.messages[0].meta[1][0].data)}})}}),h.sort(function(j,L){return j-L});var p=h.filter(function(j){return j>1}).map(function(j){return[j,Mt(j)]});d.FileIndex.map(function(j,L){return[j,d.FullPaths[L]]}).forEach(function(j){var L=j[0];if(j[1],!!L.name.match(/\.iwa/)){var U=ra(na(L.content));U.forEach(function(J){J.messages.forEach(function(pe){p.forEach(function(we){J.messages.some(function(ge){return ur(ge.meta[1][0].data)!=11006&&Xj(ge.data,we[1])})&&u[we[0]].deps.push(J.id)})})})}});for(var x=Xe.find(d,u[1].location),v=ra(na(x.content)),_,E=0;E<v.length;++E){var w=v[E];w.id==1&&(_=w)}var S=$r(Nt(_.messages[0].data)[1][0].data);for(x=Xe.find(d,u[S].location),v=ra(na(x.content)),E=0;E<v.length;++E)w=v[E],w.id==S&&(_=w);for(S=$r(Nt(_.messages[0].data)[2][0].data),x=Xe.find(d,u[S].location),v=ra(na(x.content)),E=0;E<v.length;++E)w=v[E],w.id==S&&(_=w);for(S=$r(Nt(_.messages[0].data)[2][0].data),x=Xe.find(d,u[S].location),v=ra(na(x.content)),E=0;E<v.length;++E)w=v[E],w.id==S&&(_=w);var N=Nt(_.messages[0].data);{N[6][0].data=Mt(n.e.r+1),N[7][0].data=Mt(n.e.c+1);var M=$r(N[46][0].data),C=Xe.find(d,u[M].location),z=ra(na(C.content));{for(var X=0;X<z.length&&z[X].id!=M;++X);if(z[X].id!=M)throw"Bad ColumnRowUIDMapArchive";var G=Nt(z[X].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var O=0;O<=n.e.c;++O){var Q=[];Q[1]=Q[2]=[{type:0,data:Mt(O+420690)}],G[1].push({type:2,data:Vr(Q)}),G[2].push({type:0,data:Mt(O)}),G[3].push({type:0,data:Mt(O)})}G[4]=[],G[5]=[],G[6]=[];for(var W=0;W<=n.e.r;++W)Q=[],Q[1]=Q[2]=[{type:0,data:Mt(W+726270)}],G[4].push({type:2,data:Vr(Q)}),G[5].push({type:0,data:Mt(W)}),G[6].push({type:0,data:Mt(W)});z[X].messages[0].data=Vr(G)}C.content=sc(ic(z)),C.size=C.content.length,delete N[46];var fe=Nt(N[4][0].data);{fe[7][0].data=Mt(n.e.r+1);var te=Nt(fe[1][0].data),K=$r(te[2][0].data);C=Xe.find(d,u[K].location),z=ra(na(C.content));{if(z[0].id!=K)throw"Bad HeaderStorageBucket";var _e=Nt(z[0].messages[0].data);for(W=0;W<l.length;++W){var Me=Nt(_e[2][0].data);Me[1][0].data=Mt(W),Me[4][0].data=Mt(l[W].length),_e[2][W]={type:_e[2][0].type,data:Vr(Me)}}z[0].messages[0].data=Vr(_e)}C.content=sc(ic(z)),C.size=C.content.length;var Se=$r(fe[2][0].data);C=Xe.find(d,u[Se].location),z=ra(na(C.content));{if(z[0].id!=Se)throw"Bad HeaderStorageBucket";for(_e=Nt(z[0].messages[0].data),O=0;O<=n.e.c;++O)Me=Nt(_e[2][0].data),Me[1][0].data=Mt(O),Me[4][0].data=Mt(n.e.r+1),_e[2][O]={type:_e[2][0].type,data:Vr(Me)};z[0].messages[0].data=Vr(_e)}C.content=sc(ic(z)),C.size=C.content.length;var Y=$r(fe[4][0].data);(function(){for(var j=Xe.find(d,u[Y].location),L=ra(na(j.content)),U,J=0;J<L.length;++J){var pe=L[J];pe.id==Y&&(U=pe)}var we=Nt(U.messages[0].data);{we[3]=[];var ge=[];o.forEach(function(D,Te){ge[1]=[{type:0,data:Mt(Te)}],ge[2]=[{type:0,data:Mt(1)}],ge[3]=[{type:2,data:Wj(D)}],we[3].push({type:2,data:Vr(ge)})})}U.messages[0].data=Vr(we);var Ee=ic(L),be=sc(Ee);j.content=be,j.size=j.content.length})();var se=Nt(fe[3][0].data);{var Le=se[1][0];delete se[2];var Z=Nt(Le.data);{var Oe=$r(Z[2][0].data);(function(){for(var j=Xe.find(d,u[Oe].location),L=ra(na(j.content)),U,J=0;J<L.length;++J){var pe=L[J];pe.id==Oe&&(U=pe)}var we=Nt(U.messages[0].data);{delete we[6],delete se[7];var ge=new Uint8Array(we[5][0].data);we[5]=[];for(var Ee=0,be=0;be<=n.e.r;++be){var D=Nt(ge);Ee+=iH(D,l[be],o),D[1][0].data=Mt(be),we[5].push({data:Vr(D),type:2})}we[1]=[{type:0,data:Mt(n.e.c+1)}],we[2]=[{type:0,data:Mt(n.e.r+1)}],we[3]=[{type:0,data:Mt(Ee)}],we[4]=[{type:0,data:Mt(n.e.r+1)}]}U.messages[0].data=Vr(we);var Te=ic(L),Be=sc(Te);j.content=Be,j.size=j.content.length})()}Le.data=Vr(Z)}fe[3][0].data=Vr(se)}N[4][0].data=Vr(fe)}_.messages[0].data=Vr(N);var H=ic(v),k=sc(H);return x.content=k,x.size=x.content.length,d}function nC(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function lx(t){nC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function cx(t){nC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function lH(t){return ht.WS.indexOf(t)>-1?"sheet":t==ht.CS?"chart":t==ht.DS?"dialog":t==ht.MS?"macro":t&&t.length?t:"sheet"}function cH(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,lH(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function oH(t,e,r,n,i,l,o,u,h,d,p,x){try{l[n]=tu(Bn(t,r,!0),e);var v=Er(t,e),_;switch(u){case"sheet":_=MU(v,e,i,h,l[n],d,p,x);break;case"chart":if(_=LU(v,e,i,h,l[n],d,p,x),!_||!_["!drawel"])break;var E=Go(_["!drawel"].Target,e),w=Cu(E),S=T7(Bn(t,E,!0),tu(Bn(t,w,!0),E)),N=Go(S,E),M=Cu(N);_=uU(Bn(t,N,!0),N,h,tu(Bn(t,M,!0),N),d,_);break;case"macro":_=BU(v,e,i,h,l[n],d,p,x);break;case"dialog":_=PU(v,e,i,h,l[n],d,p,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=_;var C=[];l&&l[n]&&fr(l[n]).forEach(function(z){var X="";if(l[n][z].Type==ht.CMNT){X=Go(l[n][z].Target,e);var G=zU(Er(t,X,!0),X,h);if(!G||!G.length)return;hE(_,G,!1)}l[n][z].Type==ht.TCMNT&&(X=Go(l[n][z].Target,e),C=C.concat(b7(Er(t,X,!0),h)))}),C&&C.length&&hE(_,C,!0,h.people||[])}catch(z){if(h.WTF)throw z}}function ea(t){return t.charAt(0)=="/"?t.slice(1):t}function aC(t,e){if(Uc(),e=e||{},lx(e),aa(t,"META-INF/manifest.xml")||aa(t,"objectdata.xml"))return TE(t,e);if(aa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Um<"u"){if(t.FileIndex)return Um(t);var r=Xe.utils.cfb_new();return Fw(t).forEach(function(Me){ut(r,Me,CO(t,Me))}),Um(r)}throw new Error("Unsupported NUMBERS file")}if(!aa(t,"[Content_Types].xml"))throw aa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):aa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Fw(t),i=_F(Bn(t,"[Content_Types].xml")),l=!1,o,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",Er(t,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!Er(t,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),l=!0}i.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(ru=[],i.sst)try{ru=HU(Er(t,ea(i.sst)),i.sst,e)}catch(Me){if(e.WTF)throw Me}e.cellStyles&&i.themes.length&&(h=jU(Bn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(d=UU(Er(t,ea(i.style)),i.style,h,e))}i.links.map(function(Me){try{var Se=tu(Bn(t,Cu(ea(Me))),Me);return GU(Er(t,ea(Me)),Se,Me,e)}catch{}});var p=IU(Er(t,ea(i.workbooks[0])),i.workbooks[0],e),x={},v="";i.coreprops.length&&(v=Er(t,ea(i.coreprops[0]),!0),v&&(x=Hb(v)),i.extprops.length!==0&&(v=Er(t,ea(i.extprops[0]),!0),v&&CF(v,x,e)));var _={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(v=Bn(t,ea(i.custprops[0]),!0),v&&(_=AF(v,e)));var E={};if((e.bookSheets||e.bookProps)&&(p.Sheets?o=p.Sheets.map(function(Se){return Se.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),e.bookProps&&(E.Props=x,E.Custprops=_),e.bookSheets&&typeof o<"u"&&(E.SheetNames=o),e.bookSheets?E.SheetNames:e.bookProps))return E;o={};var w={};e.bookDeps&&i.calcchain&&(w=VU(Er(t,ea(i.calcchain)),i.calcchain));var S=0,N={},M,C;{var z=p.Sheets;x.Worksheets=z.length,x.SheetNames=[];for(var X=0;X!=z.length;++X)x.SheetNames[X]=z[X].name}var G=l?"bin":"xml",O=i.workbooks[0].lastIndexOf("/"),Q=(i.workbooks[0].slice(0,O+1)+"_rels/"+i.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");aa(t,Q)||(Q="xl/_rels/workbook."+G+".rels");var W=tu(Bn(t,Q,!0),Q.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=WU(Er(t,ea(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=k7(Er(t,ea(i.people[0])),e)),W&&(W=cH(W,p.Sheets));var fe=Er(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=x.Worksheets;++S){var te="sheet";if(W&&W[S]?(M="xl/"+W[S][1].replace(/[\/]?xl\//,""),aa(t,M)||(M=W[S][1]),aa(t,M)||(M=Q.replace(/_rels\/.*$/,"")+W[S][1]),te=W[S][2]):(M="xl/worksheets/sheet"+(S+1-fe)+"."+G,M=M.replace(/sheet0\./,"sheet.")),C=M.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(x.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var K=!1,_e=0;_e!=e.sheets.length;++_e)typeof e.sheets[_e]=="number"&&e.sheets[_e]==S&&(K=1),typeof e.sheets[_e]=="string"&&e.sheets[_e].toLowerCase()==x.SheetNames[S].toLowerCase()&&(K=1);if(!K)continue e}}oH(t,M,C,x.SheetNames[S],S,N,o,te,e,p,h,d)}return E={Directory:i,Workbook:p,Props:x,Custprops:_,Deps:w,Sheets:o,SheetNames:x.SheetNames,Strings:ru,Styles:d,Themes:h,SSF:Gt(Ke)},e&&e.bookFiles&&(t.files?(E.keys=n,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Me,Se){Me=Me.replace(/^Root Entry[\/]/,""),E.keys.push(Me),E.files[Me]=t.FileIndex[Se]}))),e&&e.bookVBA&&(i.vba.length>0?E.vbaraw=Er(t,ea(i.vba[0]),!0):i.defaults&&i.defaults.bin===M7&&(E.vbaraw=Er(t,"xl/vbaProject.bin",!0))),E}function uH(t,e){var r=e||{},n="Workbook",i=Xe.find(t,n);try{if(n="/!DataSpaces/Version",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(XM(i.content),n="/!DataSpaces/DataSpaceMap",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=YM(i.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=KM(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);QM(i.content)}catch{}if(n="/EncryptionInfo",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=ZM(i.content);if(n="/EncryptedPackage",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function fH(t,e){return e.bookType=="ods"?rC(t,e):e.bookType=="numbers"?sH(t,e):e.bookType=="xlsb"?hH(t,e):iC(t,e)}function hH(t,e){hc=1024,t&&!t.SSF&&(t.SSF=Gt(Ke)),t&&t.SSF&&(Uc(),Yu(t.SSF),e.revssf=Hh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,nu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=C4.indexOf(e.bookType)>-1,i=Xg();cx(e=e||{});var l=Ag(),o="",u=0;if(e.cellXfs=[],_s(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",ut(l,o,zb(t.Props,e)),i.coreprops.push(o),Lt(e.rels,2,o,ht.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,ut(l,o,Wb(t.Props)),i.extprops.push(o),Lt(e.rels,3,o,ht.EXT_PROPS),t.Custprops!==t.Props&&fr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",ut(l,o,Xb(t.Custprops)),i.custprops.push(o),Lt(e.rels,4,o,ht.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var p={"!id":{}},x=t.Sheets[t.SheetNames[u-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,ut(l,o,qU(u-1,o,e,t,p)),i.sheets.push(o),Lt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,ht.WS[0])}if(x){var _=x["!comments"],E=!1,w="";_&&_.length>0&&(w="xl/comments"+u+"."+r,ut(l,w,$U(_,w)),i.comments.push(w),Lt(p,-1,"../comments"+u+"."+r,ht.CMNT),E=!0),x["!legacy"]&&E&&ut(l,"xl/drawings/vmlDrawing"+u+".vml",S4(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&ut(l,Cu(o),yc(p))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,ut(l,o,KU(e.Strings,o,e)),i.strs.push(o),Lt(e.wbrels,-1,"sharedStrings."+r,ht.SST)),o="xl/workbook."+r,ut(l,o,XU(t,o)),i.workbooks.push(o),Lt(e.rels,1,o,ht.WB),o="xl/theme/theme1.xml",ut(l,o,Zg(t.Themes,e)),i.themes.push(o),Lt(e.wbrels,-1,"theme/theme1.xml",ht.THEME),o="xl/styles."+r,ut(l,o,YU(t,o,e)),i.styles.push(o),Lt(e.wbrels,-1,"styles."+r,ht.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",ut(l,o,t.vbaraw),i.vba.push(o),Lt(e.wbrels,-1,"vbaProject.bin",ht.VBA)),o="xl/metadata."+r,ut(l,o,QU(o)),i.metadata.push(o),Lt(e.wbrels,-1,"metadata."+r,ht.XLMETA),ut(l,"[Content_Types].xml",Ub(i,e)),ut(l,"_rels/.rels",yc(e.rels)),ut(l,"xl/_rels/workbook."+r+".rels",yc(e.wbrels)),delete e.revssf,delete e.ssf,l}function iC(t,e){hc=1024,t&&!t.SSF&&(t.SSF=Gt(Ke)),t&&t.SSF&&(Uc(),Yu(t.SSF),e.revssf=Hh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,nu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=C4.indexOf(e.bookType)>-1,i=Xg();cx(e=e||{});var l=Ag(),o="",u=0;if(e.cellXfs=[],_s(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",ut(l,o,zb(t.Props,e)),i.coreprops.push(o),Lt(e.rels,2,o,ht.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,ut(l,o,Wb(t.Props)),i.extprops.push(o),Lt(e.rels,3,o,ht.EXT_PROPS),t.Custprops!==t.Props&&fr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",ut(l,o,Xb(t.Custprops)),i.custprops.push(o),Lt(e.rels,4,o,ht.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var x={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,ut(l,o,B4(u-1,e,t,x)),i.sheets.push(o),Lt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,ht.WS[0])}if(v){var E=v["!comments"],w=!1,S="";if(E&&E.length>0){var N=!1;E.forEach(function(M){M[1].forEach(function(C){C.T==!0&&(N=!0)})}),N&&(S="xl/threadedComments/threadedComment"+u+"."+r,ut(l,S,C7(E,p,e)),i.threadedcomments.push(S),Lt(x,-1,"../threadedComments/threadedComment"+u+"."+r,ht.TCMNT)),S="xl/comments"+u+"."+r,ut(l,S,b4(E)),i.comments.push(S),Lt(x,-1,"../comments"+u+"."+r,ht.CMNT),w=!0}v["!legacy"]&&w&&ut(l,"xl/drawings/vmlDrawing"+u+".vml",S4(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&ut(l,Cu(o),yc(x))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,ut(l,o,h4(e.Strings,e)),i.strs.push(o),Lt(e.wbrels,-1,"sharedStrings."+r,ht.SST)),o="xl/workbook."+r,ut(l,o,V4(t)),i.workbooks.push(o),Lt(e.rels,1,o,ht.WB),o="xl/theme/theme1.xml",ut(l,o,Zg(t.Themes,e)),i.themes.push(o),Lt(e.wbrels,-1,"theme/theme1.xml",ht.THEME),o="xl/styles."+r,ut(l,o,y4(t,e)),i.styles.push(o),Lt(e.wbrels,-1,"styles."+r,ht.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",ut(l,o,t.vbaraw),i.vba.push(o),Lt(e.wbrels,-1,"vbaProject.bin",ht.VBA)),o="xl/metadata."+r,ut(l,o,T4()),i.metadata.push(o),Lt(e.wbrels,-1,"metadata."+r,ht.XLMETA),p.length>1&&(o="xl/persons/person.xml",ut(l,o,A7(p)),i.people.push(o),Lt(e.wbrels,-1,"persons/person.xml",ht.PEOPLE)),ut(l,"[Content_Types].xml",Ub(i,e)),ut(l,"_rels/.rels",yc(e.rels)),ut(l,"xl/_rels/workbook."+r+".rels",yc(e.wbrels)),delete e.revssf,delete e.ssf,l}function ox(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Un(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function dH(t,e){return Xe.find(t,"EncryptedPackage")?uH(t,e):ix(t,e)}function mH(t,e){var r,n=t,i=e||{};return i.type||(i.type=ft&&Buffer.isBuffer(t)?"buffer":"base64"),r=vb(n,i),aC(r,i)}function sC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sp(t.slice(r),e);default:break e}return Nc.to_workbook(t,e)}function pH(t,e){var r="",n=ox(t,e);switch(e.type){case"base64":r=Un(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=sl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=zt(r)),e.type="binary",sC(r,e)}function gH(t,e){var r=t;return e.type=="base64"&&(r=Un(r)),r=Tt.utils.decode(1200,r.slice(2),"str"),e.type="binary",sC(r,e)}function xH(t){return t.match(/[^\x00-\x7F]/)?Ma(t):t}function jm(t,e,r,n){return n?(r.type="string",Nc.to_workbook(t,r)):Nc.to_workbook(e,r)}function Fu(t,e){Uh();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Fu(new Uint8Array(t),(r=Gt(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ec={},r.dateNF&&(Ec.dateNF=r.dateNF),r.type||(r.type=ft&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ft?"buffer":"binary",n=vO(t),typeof Uint8Array<"u"&&!ft&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,n=xH(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=Gt(r),r.type="array",Fu(Sg(n),r)}switch((i=ox(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return dH(Xe.read(n,r),r);break;case 9:if(i[1]<=8)return ix(n,r);break;case 60:return Sp(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return NM(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return u4.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?mH(n,r):jm(t,n,r,l);case 239:return i[3]===60?Sp(n,r):jm(t,n,r,l);case 255:if(i[1]===254)return gH(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ys.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ys.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Tp.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return x4.to_workbook(n,r);break;case 10:case 13:case 32:return pH(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return AM.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Tp.to_workbook(n,r):jm(t,n,r,l)}function AE(t,e){var r=e||{};return r.type="file",Fu(t,r)}function lC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Ku(e.file,Xe.write(t,{type:ft?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Xe.write(t,e)}function vH(t,e){var r=Gt(e||{}),n=fH(t,r);return cC(n,r)}function _H(t,e){var r=Gt(e||{}),n=iC(t,r);return cC(n,r)}function cC(t,e){var r={},n=ft?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Xe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(qu(i))}return e.password&&typeof encrypt_agile<"u"?lC(encrypt_agile(i,e.password),e):e.type==="file"?Ku(e.file,i):e.type=="string"?zt(i):i}function yH(t,e){var r=e||{},n=Tj(t,r);return lC(n,r)}function Fa(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return wu(Ma(n));case"binary":return Ma(n);case"string":return t;case"file":return Ku(e.file,n,"utf8");case"buffer":return ft?wi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Fa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function wH(t,e){switch(e.type){case"base64":return wu(t);case"binary":return t;case"string":return t;case"file":return Ku(e.file,t,"binary");case"buffer":return ft?wi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function R0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?wu(r):e.type=="string"?zt(r):r;case"file":return Ku(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function ux(t,e){Uh(),z4(t);var r=Gt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=ux(t,r);return r.type="array",qu(n)}return _H(t,r)}function Yh(t,e){Uh(),z4(t);var r=Gt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Yh(t,r);return r.type="array",qu(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Fa(gj(t,r),r);case"slk":case"sylk":return Fa(o4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Fa(Z4(t.Sheets[t.SheetNames[i]],r),r);case"txt":return wH(fC(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Fa(hx(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Fa(u4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return R0(Tp.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Fa(Nc.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Fa(x4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Fa(f4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Fa(rC(t,r),r);case"wk1":return R0(Ys.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return R0(Ys.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),R0(q4(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),yH(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vH(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function fx(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function NE(t,e,r){var n=r||{};return n.type="file",n.file=e,fx(n),Yh(t,n)}function EH(t,e,r){var n=r||{};return n.type="file",n.file=e,fx(n),ux(t,n)}function TH(t,e,r,n){var i=r||{};i.type="file",i.file=t,fx(i),i.type="buffer";var l=n;return l instanceof Function||(l=r),ns.writeFile(t,Yh(e,i),l)}function oC(t,e,r,n,i,l,o,u){var h=or(r),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||t[r])for(var _=e.s.c;_<=e.e.c;++_){var E=o?t[r][_]:t[n[_]+h];if(E===void 0||E.t===void 0){if(d===void 0)continue;l[_]!=null&&(v[l[_]]=d);continue}var w=E.v;switch(E.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(l[_]!=null){if(w==null)if(E.t=="e"&&w===null)v[l[_]]=null;else if(d!==void 0)v[l[_]]=d;else if(p&&w===null)v[l[_]]=null;else continue;else v[l[_]]=p&&(E.t!=="n"||E.t==="n"&&u.rawNumbers!==!1)?w:Ha(E,w,u);w!=null&&(x=!1)}}return{row:v,isempty:x}}function vh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,l=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},p=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof p){case"string":h=wt(p);break;case"number":h=wt(t["!ref"]),h.s.r=p;break;default:h=p}n>0&&(i=0);var x=or(h.s.r),v=[],_=[],E=0,w=0,S=Array.isArray(t),N=h.s.r,M=0,C={};S&&!t[N]&&(t[N]=[]);var z=d.skipHidden&&t["!cols"]||[],X=d.skipHidden&&t["!rows"]||[];for(M=h.s.c;M<=h.e.c;++M)if(!(z[M]||{}).hidden)switch(v[M]=Jt(M),r=S?t[N][M]:t[v[M]+x],n){case 1:l[M]=M-h.s.c;break;case 2:l[M]=v[M];break;case 3:l[M]=d.header[M-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=Ha(r,null,d),w=C[o]||0,!w)C[o]=1;else{do u=o+"_"+w++;while(C[u]);C[o]=w,C[u]=1}l[M]=u}for(N=h.s.r+i;N<=h.e.r;++N)if(!(X[N]||{}).hidden){var G=oC(t,h,N,v,n,l,S,d);(G.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(_[E++]=G.row)}return _.length=E,_}var DE=/"/g;function uC(t,e,r,n,i,l,o,u){for(var h=!0,d=[],p="",x=or(r),v=e.s.c;v<=e.e.c;++v)if(n[v]){var _=u.dense?(t[r]||[])[v]:t[n[v]+x];if(_==null)p="";else if(_.v!=null){h=!1,p=""+(u.rawNumbers&&_.t=="n"?_.v:Ha(_,null,u));for(var E=0,w=0;E!==p.length;++E)if((w=p.charCodeAt(E))===i||w===l||w===34||u.forceQuotes){p='"'+p.replace(DE,'""')+'"';break}p=="ID"&&(p='"ID"')}else _.f!=null&&!_.F?(h=!1,p="="+_.f,p.indexOf(",")>=0&&(p='"'+p.replace(DE,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&h?null:d.join(o)}function hx(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=wt(t["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),p="",x=[];n.dense=Array.isArray(t);for(var v=n.skipHidden&&t["!cols"]||[],_=n.skipHidden&&t["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(v[E]||{}).hidden||(x[E]=Jt(E));for(var w=0,S=i.s.r;S<=i.e.r;++S)(_[S]||{}).hidden||(p=uC(t,i,S,x,o,h,l,n),p!=null&&(n.strip&&(p=p.replace(d,"")),(p||n.blankrows!==!1)&&r.push((w++?u:"")+p)));return delete n.dense,r.join("")}function fC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=hx(t,e);if(typeof Tt>"u"||e.type=="string")return r;var n=Tt.utils.encode(1200,r,"str");return""+n}function SH(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=wt(t["!ref"]),l="",o=[],u,h=[],d=Array.isArray(t);for(u=i.s.c;u<=i.e.c;++u)o[u]=Jt(u);for(var p=i.s.r;p<=i.e.r;++p)for(l=or(p),u=i.s.c;u<=i.e.c;++u)if(e=o[u]+l,r=d?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function hC(t,e,r){var n=r||{},i=+!n.skipHeader,l=t||{},o=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?ar(n.origin):n.origin;o=h.r,u=h.c}var d,p={s:{c:0,r:0},e:{c:u,r:o+e.length-1+i}};if(l["!ref"]){var x=wt(l["!ref"]);p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),o==-1&&(o=x.e.r+1,p.e.r=o+e.length-1+i)}else o==-1&&(o=0,p.e.r=e.length-1+i);var v=n.header||[],_=0;e.forEach(function(w,S){fr(w).forEach(function(N){(_=v.indexOf(N))==-1&&(v[_=v.length]=N);var M=w[N],C="z",z="",X=Je({c:u+_,r:o+S+i});d=Iu(l,X),M&&typeof M=="object"&&!(M instanceof Date)?l[X]=M:(typeof M=="number"?C="n":typeof M=="boolean"?C="b":typeof M=="string"?C="s":M instanceof Date?(C="d",n.cellDates||(C="n",M=Ar(M)),z=n.dateNF||Ke[14]):M===null&&n.nullError&&(C="e",M=0),d?(d.t=C,d.v=M,delete d.w,delete d.R,z&&(d.z=z)):l[X]=d={t:C,v:M},z&&(d.z=z))})}),p.e.c=Math.max(p.e.c,u+v.length-1);var E=or(o);if(i)for(_=0;_<v.length;++_)l[Jt(_+u)+E]={t:"s",v:v[_]};return l["!ref"]=ct(p),l}function bH(t,e){return hC(null,t,e)}function Iu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ar(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Iu(t,Je(e)):Iu(t,Je({r:e,c:r||0}))}function CH(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function dx(){return{SheetNames:[],Sheets:{}}}function mx(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);i=l&&+l[2]||0;var o=l&&l[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(H4(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function kH(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=CH(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function AH(t,e){return t.z=e,t}function dC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function NH(t,e,r){return dC(t,"#"+e,r)}function DH(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function RH(t,e,r,n){for(var i=typeof e!="string"?e:wt(e),l=typeof e=="string"?e:ct(e),o=i.s.r;o<=i.e.r;++o)for(var u=i.s.c;u<=i.e.c;++u){var h=Iu(t,o,u);h.t="n",h.F=l,delete h.v,o==i.s.r&&u==i.s.c&&(h.f=r,n&&(h.D=!0))}return t}var OH={encode_col:Jt,encode_row:or,encode_cell:Je,encode_range:ct,decode_col:jg,decode_row:Ug,split_cell:$O,decode_cell:ar,decode_range:hn,format_cell:Ha,sheet_add_aoa:Ob,sheet_add_json:hC,sheet_add_dom:J4,aoa_to_sheet:Hc,json_to_sheet:bH,table_to_sheet:eC,table_to_book:Hj,sheet_to_csv:hx,sheet_to_txt:fC,sheet_to_json:vh,sheet_to_html:Z4,sheet_to_formulae:SH,sheet_to_row_object_array:vh,sheet_get_cell:Iu,book_new:dx,book_append_sheet:mx,book_set_sheet_visibility:kH,cell_set_number_format:AH,cell_set_hyperlink:dC,cell_set_internal_link:NH,cell_add_comment:DH,sheet_set_array_formula:RH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Kh;function FH(t){Kh=t}function IH(t,e){var r=Kh(),n=e??{};if(t==null||t["!ref"]==null)return r.push(null),r;var i=wt(t["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),p="",x=[];n.dense=Array.isArray(t);for(var v=n.skipHidden&&t["!cols"]||[],_=n.skipHidden&&t["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(v[E]||{}).hidden||(x[E]=Jt(E));var w=i.s.r,S=!1,N=0;return r._read=function(){if(!S)return S=!0,r.push("\uFEFF");for(;w<=i.e.r;)if(++w,!(_[w-1]||{}).hidden&&(p=uC(t,i,w-1,x,o,h,l,n),p!=null&&(n.strip&&(p=p.replace(d,"")),p||n.blankrows!==!1)))return r.push((N++?u:"")+p);return r.push(null)},r}function MH(t,e){var r=Kh(),n=e||{},i=n.header!=null?n.header:K4,l=n.footer!=null?n.footer:$4;r.push(i);var o=hn(t["!ref"]);n.dense=Array.isArray(t),r.push(Q4(t,o,n));var u=o.s.r,h=!1;return r._read=function(){if(u>o.e.r)return h||(h=!0,r.push("</table>"+l)),r.push(null);for(;u<=o.e.r;){r.push(Y4(t,o,u,n)),++u;break}},r}function LH(t,e){var r=Kh({objectMode:!0});if(t==null||t["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},i=0,l=1,o=[],u=0,h="",d={s:{r:0,c:0},e:{r:0,c:0}},p=e||{},x=p.range!=null?p.range:t["!ref"];switch(p.header===1?i=1:p.header==="A"?i=2:Array.isArray(p.header)&&(i=3),typeof x){case"string":d=wt(x);break;case"number":d=wt(t["!ref"]),d.s.r=x;break;default:d=x}i>0&&(l=0);var v=or(d.s.r),_=[],E=0,w=Array.isArray(t),S=d.s.r,N=0,M={};w&&!t[S]&&(t[S]=[]);var C=p.skipHidden&&t["!cols"]||[],z=p.skipHidden&&t["!rows"]||[];for(N=d.s.c;N<=d.e.c;++N)if(!(C[N]||{}).hidden)switch(_[N]=Jt(N),n=w?t[S][N]:t[_[N]+v],i){case 1:o[N]=N-d.s.c;break;case 2:o[N]=_[N];break;case 3:o[N]=p.header[N-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),h=u=Ha(n,null,p),E=M[u]||0,!E)M[u]=1;else{do h=u+"_"+E++;while(M[h]);M[u]=E,M[h]=1}o[N]=h}return S=d.s.r+l,r._read=function(){for(;S<=d.e.r;)if(!(z[S-1]||{}).hidden){var X=oC(t,d,S,_,i,o,w,p);if(++S,X.isempty===!1||(i===1?p.blankrows!==!1:p.blankrows)){r.push(X.row);return}}return r.push(null)},r}var BH={to_json:LH,to_html:MH,to_csv:IH,set_readable:FH};const PH=yu.version,RE=Object.freeze(Object.defineProperty({__proto__:null,CFB:Xe,SSF:hb,parse_xlscfb:ix,parse_zip:aC,read:Fu,readFile:AE,readFileSync:AE,set_cptable:HR,set_fs:gO,stream:BH,utils:OH,version:PH,write:Yh,writeFile:NE,writeFileAsync:TH,writeFileSync:NE,writeFileXLSX:EH,writeXLSX:ux},Symbol.toStringTag,{value:"Module"})),$h=()=>RE,px=(t,e)=>{const r={},n=Object.keys(t);for(const[i,l]of Object.entries(e)){const o=n.find(u=>u.trim().toLowerCase().includes(i.toLowerCase()));o&&(r[l]=t[o])}return r},UH=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=i=>{var l;try{const o=$h(),u=(l=i.target)==null?void 0:l.result,h=o.read(u,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],x=o.utils.sheet_to_json(d).map(v=>{const _=px(v,{cccd:"cccd",mssv:"mssv","h tn":"hoTen","ngy vo":"ngayVaoDang","chnh thc":"loaiDangVien",nhm:"nhom"});return!_.cccd||!_.hoTen?null:{cccd:String(_.cccd).trim(),mssv:_.mssv?String(_.mssv).trim():"",hoTen:_.hoTen,ngayVaoDang:_.ngayVaoDang||"",loaiDangVien:_.loaiDangVien||"",nhom:_.nhom||"",hasVotedPhase1:!1,hasVotedPhase2:!1}}).filter(Boolean);e(x)}catch(o){r(o)}},n.readAsBinaryString(t)}),jH=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=i=>{var l;try{const o=$h(),u=(l=i.target)==null?void 0:l.result,h=o.read(u,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],x=o.utils.sheet_to_json(d).map(v=>{const _=px(v,{cccd:"cccd",mssv:"mssv","h tn":"hoTen","ngy vo":"ngayVaoDang","chnh thc":"loaiDangVien",nhm:"nhom",kha:"khoa","chc v":"chucVu","im ht":"diemHT","im rl":"diemRL","thnh tch":"thanhTich","t nh gi":"tuDanhGia","mc  htnv":"tuDanhGia"});return _.cccd?{..._,cccd:String(_.cccd).trim(),mssv:_.mssv?String(_.mssv).trim():"",tuDanhGia:_.tuDanhGia||""}:null}).filter(Boolean);e(x)}catch(o){r(o)}},n.readAsBinaryString(t)}),HH=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=i=>{var l;try{const o=$h(),u=(l=i.target)==null?void 0:l.result,h=o.read(u,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],x=o.utils.sheet_to_json(d).map(v=>{const _=px(v,{cccd:"cccd",mssv:"mssv","h tn":"hoTen","ngy vo":"ngayVaoDang","chnh thc":"loaiDangVien",nhm:"nhom",kha:"khoa","chc v":"chucVu","im ht":"diemHT","im rl":"diemRL","thnh tch":"thanhTich"," xut":"chiBoDeXuat"});return _.cccd?{..._,cccd:String(_.cccd).trim(),mssv:_.mssv?String(_.mssv).trim():"",tuDanhGia:""}:null}).filter(Boolean);e(x)}catch(o){r(o)}},n.readAsBinaryString(t)}),B0=(t,e)=>{try{const r=$h(),n=r.utils.json_to_sheet(t),i=r.utils.book_new();r.utils.book_append_sheet(i,n,"Result"),r.writeFile(i,`${e}.xlsx`)}catch(r){console.error("Export error",r),alert("Li xut file Excel. Vui lng th li.")}},Hm=t=>{let e=[],r="";t==="voters"?(e=[{CCCD:"0123456789",MSSV:"B123456","H tn":"Nguyn Vn A","Ngy vo ng":"03/02/2020","Chnh thc/D b":"Chnh thc",Nhm:"Chi b 1"}],r="Mau_DS_Cu_Tri"):t==="p1"?(e=[{CCCD:"0123456789",MSSV:"B123456","H tn":"Nguyn Vn A","Ngy vo ng":"03/02/2020","Chnh thc/D b":"Chnh thc",Nhm:"Chi b 1",Kha:"K46","Chc v":"ng vin","im HT":90,"im RL":85,"Thnh tch":"Giy khen","T nh gi mc  HTNV":"Hon thnh tt"}],r="Mau_DS_Bau_P1"):(e=[{CCCD:"0123456789",MSSV:"B123456","H tn":"Nguyn Vn A","Ngy vo ng":"03/02/2020","Chnh thc/D b":"Chnh thc",Nhm:"Chi b 1",Kha:"K46","Chc v":"ng vin","im HT":90,"im RL":85,"Thnh tch":"Giy khen","Chi b  xut":"Xut sc"}],r="Mau_DS_Bau_P2"),B0(e,r)};var sa=(t=>(t.KHONG_HOAN_THANH="Khng hon thnh",t.HOAN_THANH="Hon thnh",t.HOAN_THANH_TOT="Hon thnh tt",t))(sa||{});const En=({children:t,variant:e="primary",className:r,...n})=>{let i="px-4 py-2 rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed";const l={primary:"bg-[#BE1E2D] text-white hover:bg-[#991B1B] focus:ring-red-500",gold:"bg-yellow-500 text-red-900 hover:bg-yellow-400 focus:ring-yellow-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 focus:ring-red-500"};return y.jsx("button",{className:`${i} ${l[e]} ${r||""}`,...n,children:t})};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zH=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VH=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),OE=t=>{const e=VH(t);return e.charAt(0).toUpperCase()+e.slice(1)},mC=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),GH=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var WH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XH=at.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:l,iconNode:o,...u},h)=>at.createElement("svg",{ref:h,...WH,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:mC("lucide",i),...!l&&!GH(u)&&{"aria-hidden":"true"},...u},[...o.map(([d,p])=>at.createElement(d,p)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=(t,e)=>{const r=at.forwardRef(({className:n,...i},l)=>at.createElement(XH,{ref:l,iconNode:e,className:mC(`lucide-${zH(OE(t))}`,`lucide-${t}`,n),...i}));return r.displayName=OE(t),r};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qH=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],FE=it("activity",qH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YH=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],IE=it("award",YH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KH=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],$H=it("book-open",KH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QH=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ZH=it("calendar",QH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JH=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ME=it("check",JH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],tz=it("chevron-down",ez);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],LE=it("chevron-right",rz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],az=it("chevron-up",nz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],su=it("circle-alert",iz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Tc=it("circle-check-big",sz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],BE=it("circle-minus",lz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],oz=it("circle-question-mark",cz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],fz=it("cloud-lightning",uz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],dz=it("cloud-off",hz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],pz=it("cloud",mz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],lc=it("download",gz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],PE=it("eye-off",xz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],UE=it("file-spreadsheet",vz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],yz=it("flag",_z);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],pC=it("funnel",wz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Tz=it("hash",Ez);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],kp=it("layout-grid",Sz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Cz=it("list",bz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],zm=it("loader-circle",kz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],jE=it("lock",Az);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Dz=it("log-out",Nz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Oz=it("refresh-cw",Rz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Iz=it("rotate-ccw",Fz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],lu=it("search",Mz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],HE=it("settings",Lz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bz=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Pz=it("shield-check",Bz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],jz=it("shield",Uz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hz=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],zz=it("square-check-big",Hz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],cu=it("star",Vz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Wz=it("tag",Gz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],qz=it("thumbs-up",Xz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],zE=it("toggle-left",Yz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],VE=it("toggle-right",Kz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $z=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Vm=it("trash-2",$z);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Gm=it("triangle-alert",Qz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Wm=it("upload",Zz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],GE=it("user-check",Jz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eV=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ou=it("users",eV);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tV=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],rV=it("x",tV);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nV=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],aV=it("zap",nV),iV=({onBack:t})=>{const[e,r]=at.useState(!1),[n,i]=at.useState(""),[l,o]=at.useState(""),[u,h]=at.useState(Gr()),[d,p]=at.useState("system"),[x,v]=at.useState(null),[_,E]=at.useState(!1),[w,S]=at.useState(""),[N,M]=at.useState("all"),[C,z]=at.useState({isOpen:!1,type:"full"}),[X,G]=at.useState(""),[O,Q]=at.useState(""),W=Pc();at.useEffect(()=>{const be=()=>h(Gr());return window.addEventListener("db_update",be),()=>window.removeEventListener("db_update",be)},[]);const fe=be=>{be.preventDefault(),n==="admin123"?(r(!0),o("")):o("Mt khu khng chnh xc")},te=be=>{v(be),setTimeout(()=>v(null),3e3)},K=async(be,D)=>{const Te=Gr();Te.config={...Te.config,[be]:D},await Ia(Te),h(Te),te(" lu cu hnh.")},_e=async(be,D)=>{const Te=Gr();Te.config.p1Display[be]=D,await Ia(Te),h(Te)},Me=async(be,D)=>{const Te=Gr();Te.config.p2Display[be]=D,await Ia(Te),h(Te)},Se=async()=>{if(!confirm("Hnh ng ny s ly d liu t my ca BN v ghi  ln Cloud. Hy chc chn d liu trn my bn l chun nht."))return;E(!0);const be=await OR();E(!1),be.success?(te("ng b thnh cng!"),alert(be.message)):(te("ng b tht bi"),alert(be.message))},Y=async(be,D)=>{var Te;if((Te=be.target.files)!=null&&Te[0]){try{const Be=be.target.files[0],je=Gr();if(D==="voters"){const ke=(await UH(Be)).map(Ct=>{const ir=je.voters.find(Sr=>String(Sr.cccd).trim()===String(Ct.cccd).trim());return ir?{...Ct,hasVotedPhase1:ir.hasVotedPhase1,hasVotedPhase2:ir.hasVotedPhase2}:Ct});je.voters=ke}else D==="p1"?je.candidatesP1=await jH(Be):je.candidatesP2=await HH(Be);await Ia(je),h(je),te("Import d liu thnh cng!")}catch{te("Li c file Excel.")}be.target.value=""}},se=be=>{z({isOpen:!0,type:be}),G(""),Q("")},Le=async be=>{be.preventDefault(),X==="admin123"?(C.type==="full"?await eb(!0):C.type==="voters"?await MR():C.type==="p1"?await FR():C.type==="p2"&&await IR(),h(Gr()),z({...C,isOpen:!1}),te(" xa d liu thnh cng.")):Q("Mt khu xc nhn khng ng!")},Z=()=>{switch(C.type){case"voters":return"Hnh ng ny s xa ton b DANH SCH C TRI v KT QU BU C hin ti. D liu ng vin s c gi li.";case"p1":return"Hnh ng ny s xa ton b NG VIN PHN 1 v KT QU NH GI P1. Trng thi ' vote' ca c tri s c reset.";case"p2":return"Hnh ng ny s xa ton b NG VIN PHN 2 v KT QU BNH BU P2. Trng thi ' vote' ca c tri s c reset.";default:return"Hnh ng ny s XA VNH VIN ton b C tri, ng vin v Kt qu phiu bu hin ti."}},Oe=be=>{const D=u.votesP1.filter(Te=>String(Te.candidateCCCD).trim()===String(be).trim());return{kht:D.filter(Te=>Te.level===sa.KHONG_HOAN_THANH).length,ht:D.filter(Te=>Te.level===sa.HOAN_THANH).length,htt:D.filter(Te=>Te.level===sa.HOAN_THANH_TOT).length,total:D.length}},H=()=>{const be=u.candidatesP1.map(D=>{const Te=Oe(D.cccd),Be=Te.total||1,je=He=>`${He} (${(He/Be*100).toFixed(1)}%)`;return{"M D (CCCD)":D.cccd,MSSV:D.mssv,"H Tn":D.hoTen,"Ngy vo ng":D.ngayVaoDang,"Loi V":D.loaiDangVien,"Chi b/Nhm":D.nhom,"n v (Kha)":D.khoa,"Chc v":D.chucVu,"im HT":D.diemHT,"im RL":D.diemRL,"Thnh tch":D.thanhTich,"T nh gi":D.tuDanhGia,"K.Hon Thnh":je(Te.kht),"Hon Thnh":je(Te.ht),"HT Tt":je(Te.htt),"Tng phiu":Te.total}});B0(be,`Ket_Qua_Danh_Gia_P1_${new Date().getTime()}`)},k=()=>{const be=u.voters.filter(Te=>Te.hasVotedPhase2).length||1,D=(u.candidatesP2||[]).map(Te=>{const Be=u.votesP2.filter(He=>String(He.candidateCCCD).trim()===String(Te.cccd).trim()).length,je=(Be/be*100).toFixed(2)+"%";return{"M D (CCCD)":Te.cccd,MSSV:Te.mssv,"H Tn":Te.hoTen,"Ngy vo ng":Te.ngayVaoDang,"Loi V":Te.loaiDangVien,"Chi b/Nhm":Te.nhom,"n v (Kha)":Te.khoa,"Chc v":Te.chucVu,"im HT":Te.diemHT,"im RL":Te.diemRL,"Thnh tch":Te.thanhTich,"Chi b  xut":Te.chiBoDeXuat,"S phiu bu":Be,"T l t":je}}).sort((Te,Be)=>Be["S phiu bu"]-Te["S phiu bu"]);B0(D,`Ket_Qua_Binh_Bau_P2_${new Date().getTime()}`)},j=()=>{const be=u.voters.map(D=>({CCCD:D.cccd,MSSV:D.mssv,"H Tn":D.hoTen,"Ngy Vo ng":D.ngayVaoDang,"Chi B":D.nhom,"Trng thi P1":D.hasVotedPhase1?" Vote":"Cha","Trng thi P2":D.hasVotedPhase2?" Vote":"Cha"}));B0(be,`Trang_Thai_Cu_Tri_${new Date().getTime()}`)},L=({title:be,value:D,subtext:Te,icon:Be,color:je})=>y.jsxs("div",{className:`bg-white rounded-xl p-5 shadow-sm border border-gray-100 flex items-center justify-between group hover:border-${je}-200 transition-all`,children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase tracking-wider mb-1",children:be}),y.jsx("h3",{className:`text-2xl font-black text-${je}-600`,children:D}),Te&&y.jsx("p",{className:"text-xs text-gray-400 mt-1",children:Te})]}),y.jsx("div",{className:`p-3 rounded-full bg-${je}-50 text-${je}-600`,children:y.jsx(Be,{className:"w-6 h-6"})})]}),U=({label:be,field:D})=>y.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer bg-white p-2 rounded border border-gray-200 hover:bg-gray-50 transition-colors",children:[y.jsx("input",{type:"checkbox",className:"rounded text-[#BE1E2D] focus:ring-red-500",checked:u.config.p1Display[D],onChange:Te=>_e(D,Te.target.checked)}),y.jsx("span",{className:"text-sm text-gray-700 font-medium",children:be})]}),J=({label:be,field:D})=>y.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer bg-white p-2 rounded border border-gray-200 hover:bg-gray-50 transition-colors",children:[y.jsx("input",{type:"checkbox",className:"rounded text-yellow-600 focus:ring-yellow-500",checked:u.config.p2Display[D],onChange:Te=>Me(D,Te.target.checked)}),y.jsx("span",{className:"text-sm text-gray-700 font-medium",children:be})]}),pe=()=>{const be=u.voters.filter(D=>D.hoTen.toLowerCase().includes(w.toLowerCase())||D.mssv.toLowerCase().includes(w.toLowerCase())||D.cccd.includes(w)?N==="p1_done"?D.hasVotedPhase1:N==="p1_not"?!D.hasVotedPhase1:N==="p2_done"?D.hasVotedPhase2:N==="p2_not"?!D.hasVotedPhase2:!0:!1);return y.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[y.jsx(L,{title:"Tng C Tri",value:u.voters.length,subtext:"S lng ng vin trong h thng",icon:ou,color:"gray"}),y.jsxs("div",{className:"md:col-span-2 bg-gradient-to-r from-gray-800 to-gray-900 rounded-xl p-6 text-white flex flex-col justify-center relative overflow-hidden shadow-lg",children:[y.jsx("div",{className:"absolute right-0 top-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-10 -mt-10"}),y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsxs("h3",{className:"text-xl font-bold mb-2 flex items-center gap-2",children:[y.jsx(HE,{className:"w-5 h-5"})," Trng thi H thng"]}),y.jsxs("div",{className:"flex gap-8 mt-2",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("span",{className:`w-3 h-3 rounded-full ${u.config.isPhase1Open?"bg-green-400 shadow-[0_0_10px_rgba(74,222,128,0.5)]":"bg-red-500"}`}),y.jsxs("span",{className:"font-medium",children:["Cng 1: ",u.config.isPhase1Open?"ang m":" ng"]})]}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("span",{className:`w-3 h-3 rounded-full ${u.config.isPhase2Open?"bg-green-400 shadow-[0_0_10px_rgba(74,222,128,0.5)]":"bg-red-500"}`}),y.jsxs("span",{className:"font-medium",children:["Cng 2: ",u.config.isPhase2Open?"ang m":" ng"]})]}),!W&&y.jsxs("div",{className:"flex items-center gap-3 text-yellow-300",children:[y.jsx(Gm,{className:"w-4 h-4"})," ",y.jsx("span",{children:"Offline Mode (LocalStorage)"})]})]})]}),W&&y.jsxs("button",{onClick:Se,disabled:_,className:"bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-lg flex items-center gap-2 shadow-lg transition-all",title:"Nu ngi khc khng thy d liu, bm vo y  y d liu t my bn ln Cloud.",children:[y.jsx(Oz,{className:`w-4 h-4 ${_?"animate-spin":""}`}),_?"ang y ln...":"ng b ln Cloud"]})]})]})]}),y.jsx("div",{className:"grid md:grid-cols-1 gap-6",children:y.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col",children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[y.jsx(ou,{className:"w-4 h-4 text-gray-500"}),y.jsx("h3",{className:"font-bold text-gray-800",children:"Qun l D liu H thng"})]}),y.jsxs("div",{className:"p-6 flex flex-col md:flex-row gap-6",children:[y.jsx("div",{className:"flex-1 flex flex-col gap-4",children:y.jsxs("div",{className:"flex items-center justify-between bg-blue-50 p-4 rounded-lg border border-blue-100",children:[y.jsxs("div",{children:[y.jsx("div",{className:"font-bold text-blue-900",children:"Nhp Danh Sch C Tri"}),y.jsx("div",{className:"text-xs text-blue-700",children:"File Excel (.xlsx) cha CCCD, H tn..."})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>Hm("voters"),className:"p-2 bg-white text-blue-600 rounded border border-blue-200 hover:bg-blue-50",title:"Ti mu",children:y.jsx(lc,{className:"w-4 h-4"})}),y.jsxs("label",{className:"p-2 bg-blue-600 text-white rounded cursor-pointer hover:bg-blue-700 shadow-sm",children:[y.jsx(Wm,{className:"w-4 h-4"}),y.jsx("input",{type:"file",hidden:!0,accept:".xlsx",onChange:D=>Y(D,"voters")})]})]})]})}),y.jsxs("div",{className:"flex-1 border-l border-gray-100 pl-6 flex flex-col justify-center",children:[y.jsxs("h4",{className:"font-bold text-red-800 text-sm mb-2 flex items-center gap-1",children:[y.jsx(Gm,{className:"w-4 h-4"})," Reset H thng"]}),y.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Ty chn xa d liu  bt u li."}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs(En,{variant:"danger",className:"w-full text-sm py-2",onClick:()=>se("full"),children:[y.jsx(Vm,{className:"w-4 h-4 mr-2 inline"})," Xa Ton b H thng"]}),y.jsxs(En,{variant:"outline",className:"w-full text-sm py-2 text-red-600 border-red-200 hover:bg-red-50",onClick:()=>se("voters"),children:[y.jsx(ou,{className:"w-4 h-4 mr-2 inline"})," Ch xa DS C tri"]})]})]})]})]})}),y.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col min-h-[400px]",children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-wrap justify-between items-center gap-4 bg-gray-50",children:[y.jsxs("h3",{className:"font-bold text-gray-800 uppercase text-sm tracking-wider flex items-center gap-2",children:[y.jsx(Tc,{className:"w-4 h-4 text-green-600"})," Theo di Trng thi Bu c"]}),y.jsxs("div",{className:"flex gap-2 flex-1 justify-end max-w-2xl",children:[y.jsxs("div",{className:"relative flex-1",children:[y.jsx(lu,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),y.jsx("input",{className:"w-full pl-9 pr-3 py-1.5 rounded border border-gray-300 text-sm focus:ring-1 focus:ring-blue-500",placeholder:"Tm tn, MSSV, CCCD...",value:w,onChange:D=>S(D.target.value)})]}),y.jsxs("div",{className:"relative",children:[y.jsxs("select",{className:"pl-2 pr-8 py-1.5 rounded border border-gray-300 text-sm appearance-none bg-white cursor-pointer hover:bg-gray-50 focus:ring-1 focus:ring-blue-500 outline-none",value:N,onChange:D=>M(D.target.value),children:[y.jsx("option",{value:"all",children:"Tt c c tri"}),y.jsx("option",{value:"p1_done",children:" Vote P1"}),y.jsx("option",{value:"p1_not",children:"Cha Vote P1"}),y.jsx("option",{value:"p2_done",children:" Vote P2"}),y.jsx("option",{value:"p2_not",children:"Cha Vote P2"})]}),y.jsx(pC,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none"})]}),y.jsxs(En,{variant:"outline",onClick:j,className:"py-1.5 text-xs h-auto bg-white whitespace-nowrap",children:[y.jsx(lc,{className:"w-3 h-3 mr-1"})," Xut DS"]})]})]}),y.jsx("div",{className:"overflow-x-auto flex-1",children:y.jsxs("table",{className:"w-full text-sm text-left",children:[y.jsx("thead",{className:"bg-gray-100 text-gray-700 font-bold uppercase text-xs",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-4 py-3 w-10 text-center border-r",children:"STT"}),y.jsx("th",{className:"px-4 py-3 border-r",children:"C Tri"}),y.jsx("th",{className:"px-4 py-3 w-32 border-r",children:"CCCD"}),y.jsx("th",{className:"px-4 py-3 w-32 text-center border-r",children:"Vote Phn 1"}),y.jsx("th",{className:"px-4 py-3 w-32 text-center",children:"Vote Phn 2"})]})}),y.jsx("tbody",{className:"divide-y divide-gray-100",children:be.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-400",children:"Khng tm thy d liu ph hp"})}):be.map((D,Te)=>y.jsxs("tr",{className:"hover:bg-gray-50",children:[y.jsx("td",{className:"px-4 py-3 text-center text-gray-500 border-r",children:Te+1}),y.jsxs("td",{className:"px-4 py-3 border-r",children:[y.jsx("div",{className:"font-bold text-gray-800",children:D.hoTen}),y.jsxs("div",{className:"text-xs text-gray-400",children:[D.mssv," - ",D.nhom]})]}),y.jsx("td",{className:"px-4 py-3 border-r font-mono text-gray-500 text-xs",children:D.cccd}),y.jsx("td",{className:"px-4 py-3 text-center border-r",children:D.hasVotedPhase1?y.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-bold text-green-600 bg-green-50 px-2 py-1 rounded-full border border-green-200",children:[y.jsx(Tc,{className:"w-3 h-3"}),"  Vote"]}):y.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-400 bg-gray-100 px-2 py-1 rounded-full",children:[y.jsx(BE,{className:"w-3 h-3"})," Cha"]})}),y.jsx("td",{className:"px-4 py-3 text-center",children:D.hasVotedPhase2?y.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-bold text-green-600 bg-green-50 px-2 py-1 rounded-full border border-green-200",children:[y.jsx(Tc,{className:"w-3 h-3"}),"  Vote"]}):y.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-400 bg-gray-100 px-2 py-1 rounded-full",children:[y.jsx(BE,{className:"w-3 h-3"})," Cha"]})})]},D.cccd))})]})})]})]})},we=()=>{const be=u.voters.filter(Te=>Te.hasVotedPhase1).length,D=(u.candidatesP1||[]).filter(Te=>Te.hoTen.toLowerCase().includes(w.toLowerCase())||Te.mssv.toLowerCase().includes(w.toLowerCase()));return y.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[y.jsx(L,{title:"Tin  nh gi",value:`${Math.round(be/u.voters.length*100||0)}%`,subtext:`${be}/${u.voters.length} c tri  vote`,icon:FE,color:"red"}),y.jsxs("div",{className:"md:col-span-3 bg-white rounded-xl border border-gray-200 shadow-sm p-5 flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-gray-800",children:"iu khin Cng 1"}),y.jsx("p",{className:"text-sm text-gray-500",children:"Bt/Tt quyn truy cp nh gi xp loi"})]}),y.jsx("div",{className:"flex items-center gap-4",children:y.jsxs("button",{onClick:()=>K("isPhase1Open",!u.config.isPhase1Open),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold text-white transition-all ${u.config.isPhase1Open?"bg-red-600 hover:bg-red-700 shadow-red-200":"bg-gray-400 hover:bg-gray-500"}`,children:[u.config.isPhase1Open?y.jsx(VE,{className:"w-5 h-5"}):y.jsx(zE,{className:"w-5 h-5"}),u.config.isPhase1Open?"ang M":" ng"]})})]})]}),y.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[y.jsx(kp,{className:"w-4 h-4 text-gray-500"}),y.jsx("h3",{className:"font-bold text-gray-800",children:"Cu hnh hin th th (P1)"})]}),y.jsx("div",{className:"p-6",children:y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsx(U,{field:"showCCCD",label:"CCCD/M D"}),y.jsx(U,{field:"showMSSV",label:"M s sinh vin"}),y.jsx(U,{field:"showNgayVaoDang",label:"Ngy vo ng"}),y.jsx(U,{field:"showLoaiDangVien",label:"Loi ng vin"}),y.jsx(U,{field:"showNhom",label:"Chi b/Nhm"}),y.jsx(U,{field:"showKhoa",label:"n v (Kha)"}),y.jsx(U,{field:"showChucVu",label:"Chc v"}),y.jsx(U,{field:"showDiemHT",label:"im HT"}),y.jsx(U,{field:"showDiemRL",label:"im RL"}),y.jsx(U,{field:"showThanhTich",label:"Thnh tch"}),y.jsx(U,{field:"showTuDanhGia",label:"T nh gi"})]})})]}),y.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm flex flex-col overflow-hidden",children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[y.jsx(UE,{className:"w-4 h-4 text-gray-500"}),y.jsxs("div",{className:"flex-1",children:[y.jsx("h3",{className:"font-bold text-gray-800",children:"D liu ng vin (P1)"}),y.jsxs("div",{className:"text-xs text-gray-500",children:["Hin c: ",y.jsx("b",{children:u.candidatesP1.length})," ng vin"]})]})]}),y.jsx("div",{className:"p-6 flex-1 flex items-center",children:y.jsxs("div",{className:"w-full flex gap-3 bg-gray-50 p-4 rounded-lg border border-gray-100 items-center",children:[y.jsx("div",{className:"flex-1 text-sm text-gray-600",children:"Nhp danh sch ng vin cn nh gi t Excel."}),y.jsxs("button",{onClick:()=>Hm("p1"),className:"px-3 py-2 bg-white border border-gray-300 rounded text-sm font-medium hover:bg-gray-50 flex items-center gap-2",children:[y.jsx(lc,{className:"w-4 h-4"})," Ti mu"]}),y.jsxs("label",{className:"px-3 py-2 bg-[#BE1E2D] text-white rounded text-sm font-medium hover:bg-[#991B1B] cursor-pointer flex items-center gap-2 shadow-sm",children:[y.jsx(Wm,{className:"w-4 h-4"})," Nhp Excel",y.jsx("input",{type:"file",hidden:!0,accept:".xlsx",onChange:Te=>Y(Te,"p1")})]}),y.jsx("div",{className:"w-px h-8 bg-gray-200 mx-1"}),y.jsxs("button",{onClick:()=>se("p1"),className:"px-3 py-2 bg-red-50 text-red-600 border border-red-200 rounded hover:bg-red-100 transition-colors flex items-center gap-1 font-bold text-xs whitespace-nowrap",title:"Xa d liu P1",children:[y.jsx(Vm,{className:"w-4 h-4"})," Xa D Liu"]})]})})]})]}),y.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col min-h-[400px]",children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-wrap justify-between items-center gap-4 bg-gray-50",children:[y.jsx("h3",{className:"font-bold text-red-800 uppercase text-sm tracking-wider",children:"Kt qu Xp loi"}),y.jsxs("div",{className:"flex gap-2 flex-1 justify-end max-w-xl",children:[y.jsxs("div",{className:"relative flex-1",children:[y.jsx(lu,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),y.jsx("input",{className:"w-full pl-9 pr-3 py-1.5 rounded border border-gray-300 text-sm",placeholder:"Tm kim...",value:w,onChange:Te=>S(Te.target.value)})]}),y.jsxs(En,{variant:"outline",onClick:H,className:"py-1.5 text-xs h-auto bg-white",children:[y.jsx(lc,{className:"w-3 h-3 mr-1"})," Xut Excel"]})]})]}),y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"w-full text-sm text-left",children:[y.jsx("thead",{className:"bg-gray-100 text-gray-700 font-bold uppercase text-xs",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-4 py-3 w-10 text-center border-r",children:"STT"}),y.jsx("th",{className:"px-4 py-3 border-r",children:"ng vin"}),y.jsx("th",{className:"px-2 py-2 text-center w-28 border-r text-red-600 bg-red-50",children:"Khng HT"}),y.jsx("th",{className:"px-2 py-2 text-center w-28 border-r text-blue-600 bg-blue-50",children:"Hon thnh"}),y.jsx("th",{className:"px-2 py-2 text-center w-28 text-green-600 bg-green-50",children:"HT Tt"})]})}),y.jsx("tbody",{className:"divide-y divide-gray-100",children:D.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-400",children:"Cha c d liu"})}):D.map((Te,Be)=>{const je=Oe(Te.cccd),He=je.total||1;return y.jsxs("tr",{className:"hover:bg-gray-50",children:[y.jsx("td",{className:"px-4 py-3 text-center text-gray-500 border-r",children:Be+1}),y.jsxs("td",{className:"px-4 py-3 border-r font-medium",children:[Te.hoTen,y.jsxs("div",{className:"text-xs text-gray-400 font-normal",children:[Te.mssv," - ",Te.khoa]})]}),y.jsxs("td",{className:"px-4 py-3 text-center border-r font-bold text-red-600 bg-red-50/20",children:[y.jsx("div",{children:je.kht||0}),y.jsxs("div",{className:"text-[10px] font-normal opacity-75",children:[Math.round(je.kht/He*100),"%"]})]}),y.jsxs("td",{className:"px-4 py-3 text-center border-r font-bold text-blue-600 bg-blue-50/20",children:[y.jsx("div",{children:je.ht||0}),y.jsxs("div",{className:"text-[10px] font-normal opacity-75",children:[Math.round(je.ht/He*100),"%"]})]}),y.jsxs("td",{className:"px-4 py-3 text-center font-bold text-green-600 bg-green-50/20",children:[y.jsx("div",{children:je.htt||0}),y.jsxs("div",{className:"text-[10px] font-normal opacity-75",children:[Math.round(je.htt/He*100),"%"]})]})]},Te.cccd)})})]})})]})]})},ge=()=>{const be=u.voters.filter(Be=>Be.hasVotedPhase2).length,Te=(u.candidatesP2||[]).map(Be=>({...Be,votes:u.votesP2.filter(je=>String(je.candidateCCCD).trim()===String(Be.cccd).trim()).length})).sort((Be,je)=>je.votes-Be.votes).filter(Be=>Be.hoTen.toLowerCase().includes(w.toLowerCase()));return y.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[y.jsx(L,{title:"Tin  Bu c",value:`${Math.round(be/u.voters.length*100||0)}%`,subtext:`${be}/${u.voters.length} c tri  vote`,icon:cu,color:"yellow"}),y.jsxs("div",{className:"md:col-span-3 bg-white rounded-xl border border-gray-200 shadow-sm p-5 flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-gray-800",children:"iu khin Cng 2"}),y.jsx("p",{className:"text-sm text-gray-500",children:"Cu hnh s lng bu & hin th"})]}),y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 px-3 py-1.5 rounded-lg border border-gray-200",children:[y.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Max Vote:"}),y.jsx("input",{type:"number",min:"1",className:"w-12 text-center border rounded py-0.5 text-sm font-bold",value:u.config.maxExcellentVotes,onChange:Be=>K("maxExcellentVotes",parseInt(Be.target.value)||1)})]}),y.jsxs("button",{onClick:()=>K("isPhase2Open",!u.config.isPhase2Open),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold text-white transition-all ${u.config.isPhase2Open?"bg-yellow-500 hover:bg-yellow-600 shadow-yellow-200":"bg-gray-400 hover:bg-gray-500"}`,children:[u.config.isPhase2Open?y.jsx(VE,{className:"w-5 h-5"}):y.jsx(zE,{className:"w-5 h-5"}),u.config.isPhase2Open?"ang M":" ng"]})]})]})]}),y.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[y.jsx(kp,{className:"w-4 h-4 text-gray-500"}),y.jsx("h3",{className:"font-bold text-gray-800",children:"Cu hnh hin th th (P2)"})]}),y.jsx("div",{className:"p-6",children:y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsx(J,{field:"showCCCD",label:"CCCD/M D"}),y.jsx(J,{field:"showMSSV",label:"M s sinh vin"}),y.jsx(J,{field:"showNgayVaoDang",label:"Ngy vo ng"}),y.jsx(J,{field:"showLoaiDangVien",label:"Loi ng vin"}),y.jsx(J,{field:"showNhom",label:"Chi b/Nhm"}),y.jsx(J,{field:"showKhoa",label:"n v (Kha)"}),y.jsx(J,{field:"showChucVu",label:"Chc v"}),y.jsx(J,{field:"showDiemHT",label:"im HT"}),y.jsx(J,{field:"showDiemRL",label:"im RL"}),y.jsx(J,{field:"showThanhTich",label:"Thnh tch"}),y.jsx(J,{field:"showChiBoDeXuat",label:" xut"})]})})]}),y.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm flex flex-col overflow-hidden",children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[y.jsx(UE,{className:"w-4 h-4 text-gray-500"}),y.jsxs("div",{className:"flex-1",children:[y.jsx("h3",{className:"font-bold text-gray-800",children:"D liu ng vin (P2)"}),y.jsxs("div",{className:"text-xs text-gray-500",children:["Hin c: ",y.jsx("b",{children:u.candidatesP2.length})," ng vin"]})]})]}),y.jsx("div",{className:"p-6 flex-1 flex items-center",children:y.jsxs("div",{className:"w-full flex gap-3 bg-gray-50 p-4 rounded-lg border border-gray-100 items-center",children:[y.jsx("div",{className:"flex-1 text-sm text-gray-600",children:"Nhp danh sch ng vin c  xut bu xut sc."}),y.jsxs("button",{onClick:()=>Hm("p2"),className:"px-3 py-2 bg-white border border-gray-300 rounded text-sm font-medium hover:bg-gray-50 flex items-center gap-2",children:[y.jsx(lc,{className:"w-4 h-4"})," Ti mu"]}),y.jsxs("label",{className:"px-3 py-2 bg-yellow-500 text-white rounded text-sm font-medium hover:bg-yellow-600 cursor-pointer flex items-center gap-2 shadow-sm",children:[y.jsx(Wm,{className:"w-4 h-4"})," Nhp Excel",y.jsx("input",{type:"file",hidden:!0,accept:".xlsx",onChange:Be=>Y(Be,"p2")})]}),y.jsx("div",{className:"w-px h-8 bg-gray-200 mx-1"}),y.jsxs("button",{onClick:()=>se("p2"),className:"px-3 py-2 bg-red-50 text-red-600 border border-red-200 rounded hover:bg-red-100 transition-colors flex items-center gap-1 font-bold text-xs whitespace-nowrap",title:"Xa d liu P2",children:[y.jsx(Vm,{className:"w-4 h-4"})," Xa D Liu"]})]})})]})]}),y.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col min-h-[400px]",children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[y.jsx("h3",{className:"font-bold text-yellow-700 uppercase text-sm tracking-wider",children:"Chi tit Phiu Bu"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("div",{className:"relative w-48",children:[y.jsx(lu,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400"}),y.jsx("input",{className:"w-full pl-7 pr-2 py-1 rounded border border-gray-300 text-xs",placeholder:"Tm tn...",value:w,onChange:Be=>S(Be.target.value)})]}),y.jsxs("button",{onClick:k,className:"px-2 py-1 bg-white border border-gray-300 rounded text-xs hover:bg-gray-50",children:[y.jsx(lc,{className:"w-3 h-3 inline"})," Xut"]})]})]}),y.jsx("div",{className:"overflow-x-auto flex-1",children:y.jsxs("table",{className:"w-full text-sm text-left",children:[y.jsx("thead",{className:"bg-gray-100 text-gray-700 font-bold uppercase text-xs",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-4 py-3 w-10 text-center",children:"#"}),y.jsx("th",{className:"px-4 py-3",children:"ng vin"}),y.jsx("th",{className:"px-4 py-3",children:"Chi b  xut"}),y.jsx("th",{className:"px-4 py-3 text-center",children:"S phiu"}),y.jsx("th",{className:"px-4 py-3 w-24 text-right",children:"T l"})]})}),y.jsx("tbody",{className:"divide-y divide-gray-100",children:Te.map((Be,je)=>{const He=u.voters.filter(Ct=>Ct.hasVotedPhase2).length||1,ke=Math.round(Be.votes/He*100);return y.jsxs("tr",{className:"hover:bg-gray-50",children:[y.jsx("td",{className:"px-4 py-3 text-center font-bold text-gray-500",children:je+1}),y.jsx("td",{className:"px-4 py-3 font-medium",children:Be.hoTen}),y.jsx("td",{className:"px-4 py-3 text-xs text-amber-700",children:Be.chiBoDeXuat}),y.jsx("td",{className:"px-4 py-3 text-center font-bold text-lg",children:Be.votes}),y.jsxs("td",{className:"px-4 py-3 text-right text-xs text-gray-500",children:[ke,"%"]})]},Be.cccd)})})]})})]})]})};if(!e)return y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:y.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-sm p-8 border border-gray-200",children:[y.jsxs("div",{className:"text-center mb-6",children:[y.jsx("div",{className:"w-12 h-12 bg-[#BE1E2D] text-white rounded-full flex items-center justify-center mx-auto mb-3",children:y.jsx(Pz,{className:"w-6 h-6"})}),y.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"ng nhp Qun Tr"}),y.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Khu vc dnh cho cp y"})]}),y.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"relative",children:[y.jsx(jE,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),y.jsx("input",{type:"password",className:"w-full pl-9 pr-3 py-2.5 rounded-lg border border-gray-300 text-sm focus:ring-2 focus:ring-[#BE1E2D] focus:border-[#BE1E2D] outline-none transition-all",placeholder:"Mt khu",value:n,onChange:be=>i(be.target.value),autoFocus:!0})]}),l&&y.jsx("p",{className:"text-red-500 text-xs mt-2 pl-1",children:l})]}),y.jsx(En,{type:"submit",className:"w-full bg-[#BE1E2D] hover:bg-[#991B1B] text-white",children:"Xc nhn"}),y.jsx("button",{type:"button",onClick:t,className:"w-full text-xs text-gray-500 hover:text-gray-800 py-2",children:"Quay li trang ch"})]})]})});const Ee={system:"Cu hnh H thng & C tri",p1:"Qun l Phn 1: nh gi Xp loi",p2:"Qun l Phn 2: Bnh bu Xut sc"};return y.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col font-sans",children:[x&&y.jsx("div",{className:"fixed top-4 right-4 z-50 bg-gray-900 text-white px-4 py-3 rounded shadow-lg animate-bounce",children:x}),C.isOpen&&y.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in",children:y.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 border border-red-200",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsxs("h3",{className:"text-lg font-bold text-red-800 flex items-center gap-2",children:[y.jsx(Gm,{className:"w-5 h-5"})," Xc nhn Reset"]}),y.jsx("button",{onClick:()=>z({...C,isOpen:!1}),className:"text-gray-400 hover:text-gray-800",children:y.jsx(rV,{className:"w-5 h-5"})})]}),y.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[Z(),y.jsx("br",{}),y.jsx("br",{}),"Vui lng nhp mt khu admin  xc nhn."]}),y.jsxs("form",{onSubmit:Le,children:[y.jsxs("div",{className:"mb-4",children:[y.jsx("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-red-500 outline-none",placeholder:"Nhp mt khu...",value:X,onChange:be=>G(be.target.value),autoFocus:!0}),O&&y.jsxs("p",{className:"text-red-600 text-xs mt-1 flex items-center gap-1",children:[y.jsx(su,{className:"w-3 h-3"})," ",O]})]}),y.jsxs("div",{className:"flex justify-end gap-2",children:[y.jsx(En,{type:"button",variant:"outline",onClick:()=>z({...C,isOpen:!1}),children:"Hy"}),y.jsx(En,{type:"submit",variant:"danger",children:"Xc nhn Xa"})]})]})]})}),y.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between sticky top-0 z-30 shadow-sm",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-800",title:"ng xut",children:y.jsx(jE,{className:"w-5 h-5"})}),y.jsx("div",{className:"h-8 w-1 bg-[#BE1E2D] rounded-full hidden sm:block"}),y.jsx("h1",{className:"font-black text-lg sm:text-xl text-gray-800 tracking-tight uppercase",children:Ee[d]}),W?y.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-green-600 bg-green-50 px-2 py-0.5 rounded-full border border-green-100 font-bold",children:[y.jsx(pz,{className:"w-3 h-3"})," Online"]}):y.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full border border-gray-200 font-bold",children:[y.jsx(dz,{className:"w-3 h-3"})," Local"]})]}),y.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[y.jsxs("button",{onClick:()=>{p("system"),S("")},className:`px-3 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${d==="system"?"bg-white shadow-sm text-gray-900":"text-gray-500 hover:text-gray-700"}`,children:[y.jsx(HE,{className:"w-4 h-4"})," ",y.jsx("span",{className:"hidden sm:inline",children:"H Thng"})]}),y.jsxs("button",{onClick:()=>{p("p1"),S("")},className:`px-3 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${d==="p1"?"bg-white shadow-sm text-[#BE1E2D]":"text-gray-500 hover:text-gray-700"}`,children:[y.jsx(FE,{className:"w-4 h-4"})," ",y.jsx("span",{className:"hidden sm:inline",children:"Phn 1"})]}),y.jsxs("button",{onClick:()=>{p("p2"),S("")},className:`px-3 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${d==="p2"?"bg-white shadow-sm text-yellow-600":"text-gray-500 hover:text-gray-700"}`,children:[y.jsx(cu,{className:"w-4 h-4"})," ",y.jsx("span",{className:"hidden sm:inline",children:"Phn 2"})]})]})]}),y.jsxs("div",{className:"flex-1 p-6 max-w-7xl mx-auto w-full",children:[d==="system"&&y.jsx(pe,{}),d==="p1"&&y.jsx(we,{}),d==="p2"&&y.jsx(ge,{})]})]})},WE=({isOpen:t,title:e,message:r,type:n="confirm",onConfirm:i,onCancel:l,confirmText:o="ng ",cancelText:u="Hy b"})=>t?y.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:y.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full overflow-hidden transform transition-all scale-100",children:[y.jsxs("div",{className:`p-4 flex items-center gap-3 border-b ${n==="danger"?"bg-red-50 border-red-100":"bg-gray-50 border-gray-100"}`,children:[n==="danger"?y.jsx("div",{className:"p-2 bg-red-100 rounded-full text-red-600",children:y.jsx(su,{className:"w-5 h-5"})}):y.jsx("div",{className:"p-2 bg-blue-100 rounded-full text-blue-600",children:y.jsx(oz,{className:"w-5 h-5"})}),y.jsx("h3",{className:`font-bold text-lg ${n==="danger"?"text-red-800":"text-gray-800"}`,children:e})]}),y.jsx("div",{className:"p-5 text-gray-600 text-sm leading-relaxed whitespace-pre-wrap",children:r}),y.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-100 flex justify-end gap-3",children:[n!=="alert"&&y.jsx(En,{variant:"outline",onClick:l,className:"w-full sm:w-auto",children:u}),y.jsx(En,{variant:n==="danger"?"danger":"primary",onClick:i,className:"w-full sm:w-auto shadow-md",children:o})]})]})}):null,sV=({onLogout:t})=>{const[e,r]=at.useState(Gr()),[n,i]=at.useState(null),[l,o]=at.useState(""),[u,h]=at.useState(""),[d,p]=at.useState(!0),[x,v]=at.useState(!1),[_,E]=at.useState("login"),[w,S]=at.useState(null),[N,M]=at.useState(!1),[C,z]=at.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[X,G]=at.useState({}),[O,Q]=at.useState([]),[W,fe]=at.useState(""),[te,K]=at.useState("ALL"),[_e,Me]=at.useState(!1),[Se,Y]=at.useState("grid"),[se,Le]=at.useState({}),[Z,Oe]=at.useState("ALL"),[H,k]=at.useState(!1),[j,L]=at.useState(!1);at.useEffect(()=>{const Fe=()=>{const tt=Gr();r(tt);const Ze=tt.voters.length>0;v(Ze),Ze&&p(!1)};Fe();const We=()=>{if(Fe(),p(!1),n){const Ze=Gr().voters.find(Ye=>Ye.cccd===n.cccd);Ze&&i(Ze)}};window.addEventListener("storage",We),window.addEventListener("db_update",We);const Qe=setTimeout(()=>p(!1),3e3);return()=>{window.removeEventListener("storage",We),window.removeEventListener("db_update",We),clearTimeout(Qe)}},[n]);const U=(Fe,We="success")=>{S({msg:Fe,type:We}),setTimeout(()=>S(null),4e3)},J=()=>z(Fe=>({...Fe,isOpen:!1})),pe=()=>{i(null),G({}),Q([]),E("login"),t(),window.scrollTo(0,0)},we=Fe=>{if(Fe.preventDefault(),h(""),!x){h("H thng cha c d liu. Vui lng lin h Admin.");return}const We=l.trim();if(!We)return;const Qe=e.voters.find(pt=>String(pt.cccd).trim()===We||String(pt.mssv).trim().toLowerCase()===We.toLowerCase());if(!Qe){h("Khng tm thy thng tin ng vin.");return}i(Qe);const tt=e.votesP1.filter(pt=>pt.voterCCCD===Qe.cccd),Ze={};tt.forEach(pt=>Ze[pt.candidateCCCD]=pt.level),G(Ze);const Ye=e.votesP2.filter(pt=>pt.voterCCCD===Qe.cccd);Q(Ye.map(pt=>pt.candidateCCCD));const{isPhase1Open:St,isPhase2Open:Nr}=e.config;if(Qe.hasVotedPhase1&&Qe.hasVotedPhase2)E("done");else if(St&&!Qe.hasVotedPhase1)E("p1");else if(Nr&&!Qe.hasVotedPhase2)E("p2");else if(Qe.hasVotedPhase1&&!Nr)E("done");else if(!St&&Qe.hasVotedPhase2)E("done");else if(!St&&!Nr){h("H thng ang ng.");return}else E("done")},ge=async Fe=>{if(n){J(),M(!0);try{await new Promise(tt=>setTimeout(tt,500));const We=Object.entries(Fe).map(([tt,Ze])=>({candidateCCCD:tt,level:Ze}));await LR(n.cccd,We)?(U(" gi nh gi P1 thnh cng!","success"),setTimeout(()=>{Gr().config.isPhase2Open?E("p2"):E("done"),window.scrollTo(0,0)},800)):U("Li lu d liu. B nh c th  y.","error")}catch(We){console.error(We),U("Li h thng.","error")}finally{M(!1)}}},Ee=()=>{const Fe=je.filter(We=>!X[We.cccd]);Fe.length>0?z({isOpen:!0,title:"Xc nhn t ng in",message:y.jsxs("span",{children:["Bn cn ",y.jsx("b",{className:"text-red-600",children:Fe.length})," ngi cha nh gi.",y.jsx("br",{}),y.jsx("br",{}),"H thng s t ng in mc ",y.jsx("b",{className:"text-blue-600",children:'"HON THNH"'})," cho nhng ngi ny v np phiu ngay."]}),confirmText:"ng  & Gi ngay",onConfirm:()=>{let We={...X};Fe.forEach(Qe=>We[Qe.cccd]=sa.HOAN_THANH),ge(We)}}):z({isOpen:!0,title:"Xc nhn gi",message:"Bn  nh gi y . Bn c chc chn mun gi kt qu khng?",confirmText:"Gi kt qu",onConfirm:()=>ge(X)})},be=async()=>{if(n){J(),M(!0);try{await new Promise(We=>setTimeout(We,500)),await BR(n.cccd,O)?(U(" gi phiu bu xut sc!","success"),setTimeout(()=>{E("done"),window.scrollTo(0,0)},800)):U("Li lu d liu.","error")}catch(Fe){console.error(Fe),U("Li h thng.","error")}finally{M(!1)}}},D=()=>{O.length===0?z({isOpen:!0,title:"Np phiu trng?",message:"Bn cha chn ng ch no. Bn c chc chn mun np phiu trng khng?",type:"danger",confirmText:"Np phiu trng",onConfirm:()=>be()}):z({isOpen:!0,title:"Xc nhn bu c",message:`Bn  chn ${O.length} ng ch xut sc. Xc nhn np phiu?`,confirmText:"Np phiu",onConfirm:()=>be()})},Te=()=>{const We=Object.values(Sr).flat().filter(Qe=>!X[Qe.cccd]);if(We.length===0){U("Danh sch ang hin th  c nh gi ht.","error");return}z({isOpen:!0,title:"in nhanh",message:`in mc "Hon thnh" cho ${We.length} ngi ang hin th?`,confirmText:"in ngay",onConfirm:()=>{const Qe={...X};We.forEach(tt=>Qe[tt.cccd]=sa.HOAN_THANH),G(Qe),J(),U(" in xong!")}})},Be=async()=>{z({isOpen:!0,title:"Reset d liu?",message:"Hnh ng ny s xa ton b d liu trn trnh duyt ny. Bn c chc khng?",type:"danger",confirmText:"XA SCH",onConfirm:async()=>{await eb(),J()}})},je=e.candidatesP1||[],He=e.config.p1Display,ke=e.config.p2Display,Ct=at.useMemo(()=>Array.from(new Set(je.map(Fe=>Fe.khoa||"Khc"))).sort(),[je]),ir=at.useMemo(()=>Array.from(new Set((e.candidatesP2||[]).map(Fe=>Fe.chiBoDeXuat||"Khc"))).sort(),[e.candidatesP2]),Sr=at.useMemo(()=>{const Fe=je.filter(Qe=>{const tt=(Qe.hoTen||"").toLowerCase().includes(W.toLowerCase())||(Qe.mssv||"").toLowerCase().includes(W.toLowerCase()),Ze=te==="ALL"||(Qe.khoa||"Khc")===te,Ye=_e?!X[Qe.cccd]:!0;return tt&&Ze&&Ye}),We={};return Fe.forEach(Qe=>{const tt=Qe.khoa||"Khc";We[tt]||(We[tt]=[]),We[tt].push(Qe)}),We},[je,W,te,_e,X]),qr=at.useMemo(()=>(e.candidatesP2||[]).filter(Fe=>{const We=(Fe.hoTen||"").toLowerCase().includes(W.toLowerCase()),Qe=Z==="ALL"||(Fe.chiBoDeXuat||"Khc")===Z;let tt=!0;return H&&(tt=O.includes(Fe.cccd)),j&&(tt=!O.includes(Fe.cccd)),We&&Qe&&tt}),[e.candidatesP2,W,Z,H,j,O]),Ga=()=>w?y.jsxs("div",{className:`fixed top-20 left-1/2 -translate-x-1/2 z-[100] px-6 py-4 rounded-lg shadow-2xl flex items-center gap-3 animate-bounce border-2 ${w.type==="success"?"bg-emerald-600 border-emerald-500 text-white":"bg-red-600 border-red-500 text-white"}`,children:[w.type==="success"?y.jsx(Tc,{className:"w-6 h-6"}):y.jsx(su,{className:"w-6 h-6"}),y.jsx("span",{className:"font-bold text-lg",children:w.msg})]}):null,Hn=({current:Fe,total:We})=>{const Qe=Math.min(100,Math.round(Fe/(We||1)*100));return y.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-[40] shadow-sm px-4 py-3",children:y.jsxs("div",{className:"max-w-4xl mx-auto",children:[y.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-500 uppercase tracking-wide mb-1",children:[y.jsx("span",{children:"Tin  nh gi"}),y.jsxs("span",{className:Qe===100?"text-green-600":"text-[#BE1E2D]",children:[Fe,"/",We," (",Qe,"%)"]})]}),y.jsx("div",{className:"h-2.5 w-full bg-gray-100 rounded-full overflow-hidden",children:y.jsx("div",{className:"h-full bg-gradient-to-r from-[#BE1E2D] to-red-400 transition-all duration-500 ease-out",style:{width:`${Qe}%`}})})]})})};if(_==="login")return y.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-[#fffef5] p-4 relative overflow-hidden",children:[y.jsx(WE,{...C,onCancel:J}),y.jsx("div",{className:"absolute -top-[30%] -right-[10%] w-[70%] h-[70%] bg-[#BE1E2D] rounded-full blur-3xl opacity-5 pointer-events-none"}),y.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl border border-gray-100 p-8 relative z-10",children:[y.jsxs("div",{className:"text-center mb-8",children:[y.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-red-100",children:y.jsx(GE,{className:"w-8 h-8 text-[#BE1E2D]"})}),y.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"ng nhp h thng"}),y.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Nhp CCCD hoc M nh danh"})]}),d?y.jsxs("div",{className:"mb-6 flex flex-col items-center justify-center p-6 bg-gray-50 rounded-xl border border-gray-100 animate-pulse",children:[y.jsx(zm,{className:"w-8 h-8 text-[#BE1E2D] animate-spin mb-2"}),y.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"ang kt ni d liu Cloud..."})]}):x?y.jsxs("div",{className:"mb-6 p-2 bg-green-50 text-green-700 text-xs rounded-lg border border-green-100 flex items-center justify-center gap-1",children:[y.jsx(fz,{className:"w-3 h-3"})," H thng Online"]}):y.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 text-yellow-800 rounded-xl text-sm border border-yellow-200 flex flex-col gap-2",children:[y.jsxs("div",{className:"flex items-center gap-2 font-bold",children:[y.jsx(su,{className:"w-5 h-5"})," H thng cha c d liu"]}),y.jsxs("p",{children:["Vui lng lin h Ban T Chc hoc vo trang ",y.jsx("b",{children:"Qun Tr Vin"}),"  nhp danh sch."]}),y.jsx("p",{className:"text-xs text-yellow-600 border-t border-yellow-200 pt-2 mt-1",children:"*Nu bn l Admin v  nhp liu: Hy kim tra quyn truy cp (Rules) hoc m bo d liu  c y ln Cloud thnh cng."})]}),y.jsxs("form",{onSubmit:we,className:"space-y-4",children:[y.jsx("div",{children:y.jsx("input",{type:"text",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#BE1E2D] focus:border-[#BE1E2D] outline-none text-center text-lg font-medium",placeholder:"Nhp m s...",value:l,onChange:Fe=>o(Fe.target.value),disabled:!x||d,autoFocus:!0})}),u&&y.jsxs("div",{className:"bg-red-50 text-red-600 text-sm p-3 rounded-lg flex items-center gap-2",children:[y.jsx(su,{className:"w-4 h-4 flex-shrink-0"})," ",u]}),y.jsx(En,{disabled:!x||d,className:"w-full py-3 text-base bg-[#BE1E2D] hover:bg-[#991B1B] text-white",children:"Xc thc & Bt u"})]}),y.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 flex flex-col gap-2",children:[y.jsx("button",{onClick:pe,className:"text-sm text-gray-500 hover:text-gray-800",children:"Quay li trang ch"}),y.jsxs("button",{onClick:Be,className:"text-xs text-red-400 hover:text-red-600 flex items-center justify-center gap-1 mt-2",children:[y.jsx(Iz,{className:"w-3 h-3"})," Reset khn cp d liu"]})]})]})]});if(_==="done")return y.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#fffef5] p-6 text-center relative z-50",children:[y.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mb-6 animate-in zoom-in duration-500",children:y.jsx(ME,{className:"w-12 h-12 text-green-600"})}),y.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Hon thnh nhim v!"}),y.jsxs("p",{className:"text-gray-600 max-w-md mb-8",children:["Cm n ng ch ",y.jsx("strong",{children:n==null?void 0:n.hoTen}),"  hon thnh cc ni dung b phiu."]}),y.jsx(En,{onClick:pe,className:"w-full max-w-xs bg-[#BE1E2D] hover:bg-[#991B1B] text-white py-3 shadow-lg",children:"ng xut / V trang ch"})]});const Ot=_==="p2"?"bg-gradient-to-r from-yellow-500 to-yellow-600 border-b border-yellow-600":"bg-[#BE1E2D] border-b border-[#991B1B]";return y.jsxs("div",{className:"min-h-screen bg-[#fffef5] pb-24 font-sans",children:[y.jsx(Ga,{}),y.jsx(WE,{...C,onCancel:J}),y.jsx("div",{className:`${Ot} text-white px-4 py-3 shadow-md sticky top-0 z-[50] transition-colors duration-500`,children:y.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-9 h-9 bg-white/10 backdrop-blur-sm rounded-full flex items-center justify-center border border-white/20 font-bold text-sm",children:n==null?void 0:n.hoTen.charAt(0)}),y.jsxs("div",{children:[y.jsx("div",{className:"font-bold text-sm md:text-base leading-tight flex items-center gap-2",children:_==="p1"?"NH GI CHT LNG":y.jsxs(y.Fragment,{children:[y.jsx(cu,{className:"w-4 h-4 fill-white"})," BU XUT SC"]})}),y.jsx("div",{className:"text-xs text-white/80 opacity-90",children:n==null?void 0:n.hoTen})]})]}),y.jsxs("button",{onClick:pe,className:"text-xs bg-black/20 hover:bg-black/30 px-3 py-1.5 rounded-lg transition-colors flex items-center gap-1",children:[y.jsx(Dz,{className:"w-3 h-3"})," ",y.jsx("span",{className:"hidden sm:inline",children:"Thot"})]})]})}),_==="p1"&&y.jsx(Hn,{current:Object.keys(X).length,total:je.length}),y.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-3 sticky top-[57px] z-[30] shadow-sm",children:y.jsxs("div",{className:"max-w-4xl mx-auto space-y-3",children:[y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("div",{className:"relative flex-1",children:[y.jsx(lu,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),y.jsx("input",{className:"w-full pl-9 pr-3 py-2 rounded-lg border border-gray-300 text-sm focus:ring-1 focus:ring-[#BE1E2D] outline-none",placeholder:"Tm tn, MSSV...",value:W,onChange:Fe=>fe(Fe.target.value)})]}),_==="p1"&&y.jsxs("button",{onClick:()=>Me(!_e),className:`px-3 py-2 rounded-lg border text-sm font-medium whitespace-nowrap transition-colors flex items-center gap-1.5 ${_e?"bg-orange-50 border-orange-200 text-orange-700":"bg-gray-50 border-gray-300 text-gray-600"}`,children:[_e?y.jsx(PE,{className:"w-4 h-4"}):y.jsx(Tc,{className:"w-4 h-4"}),y.jsx("span",{className:"hidden sm:inline",children:"n  vote"})]}),_==="p2"&&y.jsxs(y.Fragment,{children:[y.jsxs("button",{onClick:()=>{H||L(!1),k(!H)},className:`px-3 py-2 rounded-lg border text-sm font-medium whitespace-nowrap transition-colors flex items-center gap-1.5 ${H?"bg-yellow-100 border-yellow-300 text-yellow-800":"bg-gray-50 border-gray-300 text-gray-600"}`,children:[y.jsx(zz,{className:"w-4 h-4"}),y.jsxs("span",{className:"hidden sm:inline",children:[" chn (",O.length,")"]})]}),y.jsxs("button",{onClick:()=>{j||k(!1),L(!j)},className:`px-3 py-2 rounded-lg border text-sm font-medium whitespace-nowrap transition-colors flex items-center gap-1.5 ${j?"bg-orange-50 border-orange-200 text-orange-700":"bg-gray-50 border-gray-300 text-gray-600"}`,children:[j?y.jsx(PE,{className:"w-4 h-4"}):y.jsx(Tc,{className:"w-4 h-4"}),y.jsx("span",{className:"hidden sm:inline",children:"n  chn"})]})]})]}),y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar",children:[y.jsx(pC,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),_==="p1"&&y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:()=>K("ALL"),className:`whitespace-nowrap px-3 py-1 rounded-full text-xs font-medium border transition-colors ${te==="ALL"?"bg-[#BE1E2D] text-white border-[#BE1E2D]":"bg-white text-gray-600 border-gray-300"}`,children:"Tt c Kha"}),Ct.map(Fe=>y.jsx("button",{onClick:()=>K(Fe),className:`whitespace-nowrap px-3 py-1 rounded-full text-xs font-medium border transition-colors ${te===Fe?"bg-[#BE1E2D] text-white border-[#BE1E2D]":"bg-white text-gray-600 border-gray-300"}`,children:Fe},Fe))]}),_==="p2"&&y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:()=>Oe("ALL"),className:`whitespace-nowrap px-3 py-1 rounded-full text-xs font-medium border transition-colors flex items-center gap-1 ${Z==="ALL"?"bg-yellow-600 text-white border-yellow-600":"bg-white text-gray-600 border-gray-300"}`,children:"Tt c  xut"}),ir.map(Fe=>y.jsxs("button",{onClick:()=>Oe(Fe),className:`whitespace-nowrap px-3 py-1 rounded-full text-xs font-medium border transition-colors flex items-center gap-1 ${Z===Fe?"bg-yellow-600 text-white border-yellow-600":"bg-white text-gray-600 border-gray-300"}`,children:[y.jsx(Wz,{className:"w-3 h-3"})," ",Fe]},Fe))]})]}),_==="p1"&&y.jsx("div",{className:"flex items-center gap-2 border-l pl-3 ml-2 border-gray-300",children:y.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-0.5",children:[y.jsx("button",{onClick:()=>Y("list"),className:`p-1.5 rounded-md ${Se==="list"?"bg-white shadow-sm text-gray-800":"text-gray-400"}`,children:y.jsx(Cz,{className:"w-4 h-4"})}),y.jsx("button",{onClick:()=>Y("grid"),className:`p-1.5 rounded-md ${Se==="grid"?"bg-white shadow-sm text-gray-800":"text-gray-400"}`,children:y.jsx(kp,{className:"w-4 h-4"})})]})})]})]})}),y.jsx("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:_==="p1"?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"flex justify-end mb-2",children:y.jsxs("button",{onClick:Te,className:"text-sm font-semibold text-blue-600 flex items-center gap-1 hover:bg-blue-50 px-3 py-1.5 rounded-lg transition-colors",children:[y.jsx(aV,{className:"w-4 h-4"}),' in nhanh "Hon thnh"']})}),Object.entries(Sr).map(([Fe,We])=>{if(We.length===0)return null;const Qe=se[Fe],tt=We.filter(Ze=>X[Ze.cccd]).length;return y.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[y.jsxs("div",{onClick:()=>Le(Ze=>({...Ze,[Fe]:!Ze[Fe]})),className:"bg-gray-50 px-4 py-3 flex justify-between items-center cursor-pointer hover:bg-gray-100 transition-colors border-b border-gray-100",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("h3",{className:"font-bold text-gray-800",children:Fe}),y.jsx("span",{className:"text-xs bg-white border border-gray-200 px-2 py-0.5 rounded text-gray-500",children:We.length})]}),y.jsxs("div",{className:"flex items-center gap-3 text-xs font-medium",children:[y.jsxs("span",{className:tt===We.length?"text-green-600":"text-orange-600",children:[tt,"/",We.length]}),Qe?y.jsx(tz,{className:"w-4 h-4 text-gray-400"}):y.jsx(az,{className:"w-4 h-4 text-gray-400"})]})]}),!Qe&&y.jsx("div",{className:`p-4 ${Se==="grid"?"grid grid-cols-1 md:grid-cols-2 gap-4":"space-y-4"}`,children:We.map(Ze=>{const Ye=X[Ze.cccd];return y.jsxs("div",{className:`bg-white border rounded-lg p-4 transition-all ${Ye?"border-l-4 border-l-green-500 shadow-sm":"border-gray-200 border-l-4 border-l-gray-300"}`,children:[y.jsxs("div",{className:"mb-4",children:[y.jsx("div",{className:"font-bold text-gray-800 text-lg mb-1",children:Ze.hoTen}),y.jsxs("div",{className:"flex flex-wrap gap-x-3 gap-y-1.5 text-xs text-gray-500 mb-2",children:[He.showCCCD&&y.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[y.jsx(Tz,{className:"w-3 h-3"})," ",Ze.cccd]}),He.showMSSV&&y.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[y.jsx($H,{className:"w-3 h-3"})," ",Ze.mssv]}),He.showChucVu&&y.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[y.jsx(GE,{className:"w-3 h-3"})," ",Ze.chucVu]}),He.showKhoa&&y.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[y.jsx(yz,{className:"w-3 h-3"})," ",Ze.khoa]}),He.showNgayVaoDang&&y.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[y.jsx(ZH,{className:"w-3 h-3"})," ",Ze.ngayVaoDang]}),He.showLoaiDangVien&&y.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[y.jsx(ou,{className:"w-3 h-3"})," ",Ze.loaiDangVien]})]}),y.jsxs("div",{className:"space-y-1.5",children:[(He.showDiemHT||He.showDiemRL)&&y.jsxs("div",{className:"flex items-center gap-3 text-xs bg-gray-50 p-2 rounded border border-gray-100",children:[He.showDiemHT&&y.jsxs("div",{children:["HT: ",y.jsx("b",{className:"text-gray-800",children:Ze.diemHT})]}),He.showDiemHT&&He.showDiemRL&&y.jsx("div",{className:"w-px h-3 bg-gray-300"}),He.showDiemRL&&y.jsxs("div",{children:["RL: ",y.jsx("b",{className:"text-gray-800",children:Ze.diemRL})]})]}),He.showThanhTich&&Ze.thanhTich&&y.jsxs("div",{className:"text-xs text-amber-700 bg-amber-50 p-2 rounded border border-amber-100 flex items-start gap-1.5",children:[y.jsx(IE,{className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5"}),y.jsx("span",{children:Ze.thanhTich})]}),He.showTuDanhGia&&Ze.tuDanhGia&&y.jsxs("div",{className:"text-xs text-blue-700 bg-blue-50 p-2 rounded border border-blue-100 flex items-start gap-1.5",children:[y.jsx(cu,{className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5"}),y.jsxs("span",{children:["T nh gi: ",y.jsx("b",{children:Ze.tuDanhGia})]})]})]})]}),y.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[y.jsx("button",{onClick:()=>G(St=>({...St,[Ze.cccd]:sa.KHONG_HOAN_THANH})),className:`py-2 rounded text-xs font-semibold transition-all ${Ye===sa.KHONG_HOAN_THANH?"bg-red-600 text-white shadow-md ring-2 ring-red-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:"K.H.Thnh"}),y.jsx("button",{onClick:()=>G(St=>({...St,[Ze.cccd]:sa.HOAN_THANH})),className:`py-2 rounded text-xs font-semibold transition-all ${Ye===sa.HOAN_THANH?"bg-blue-600 text-white shadow-md ring-2 ring-blue-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:"Hon thnh"}),y.jsx("button",{onClick:()=>G(St=>({...St,[Ze.cccd]:sa.HOAN_THANH_TOT})),className:`py-2 rounded text-xs font-semibold transition-all ${Ye===sa.HOAN_THANH_TOT?"bg-green-600 text-white shadow-md ring-2 ring-green-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:"Tt"})]})]},Ze.cccd)})})]},Fe)})]}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 text-red-900 p-6 rounded-xl shadow-lg mb-6 flex justify-between items-center relative overflow-hidden border border-yellow-400",children:[y.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-10 -mt-10 blur-xl"}),y.jsxs("div",{className:"relative z-10",children:[y.jsx("div",{className:"text-xs opacity-90 uppercase tracking-wider font-bold text-red-800 mb-1",children:"S lng bnh bu"}),y.jsxs("div",{className:"text-3xl font-black",children:[O.length," / ",e.config.maxExcellentVotes," ",y.jsx("span",{className:"text-sm font-normal align-middle opacity-75",children:"ng ch"})]})]}),y.jsx("div",{className:"relative z-10 bg-white/20 p-3 rounded-full",children:y.jsx(cu,{className:"w-8 h-8 text-red-800 fill-red-800 animate-pulse"})})]}),qr.length===0&&y.jsxs("div",{className:"text-center py-10 text-gray-500 bg-white rounded-xl border border-dashed border-gray-300",children:[y.jsx(lu,{className:"w-10 h-10 mx-auto mb-2 opacity-20"}),y.jsx("p",{children:"Khng tm thy ng vin ph hp vi b lc."})]}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:qr.map(Fe=>{const We=O.includes(Fe.cccd);return y.jsxs("div",{onClick:()=>{We?Q(Qe=>Qe.filter(tt=>tt!==Fe.cccd)):O.length>=e.config.maxExcellentVotes?U(`Ch c chn ti a ${e.config.maxExcellentVotes} ngi`,"error"):Q(Qe=>[...Qe,Fe.cccd])},className:`relative bg-white rounded-xl p-5 border-2 transition-all cursor-pointer group hover:shadow-lg ${We?"border-yellow-500 bg-yellow-50/50 shadow-md ring-1 ring-yellow-500/30":"border-gray-200 hover:border-yellow-300"}`,children:[ke.showChiBoDeXuat&&Fe.chiBoDeXuat&&y.jsxs("div",{className:"absolute -top-3 left-4 bg-[#BE1E2D] text-white text-[10px] font-bold px-3 py-1 rounded-full shadow-sm border border-yellow-500 z-10 flex items-center gap-1",children:[y.jsx(qz,{className:"w-3 h-3"}),"  xut: ",Fe.chiBoDeXuat]}),y.jsxs("div",{className:"flex justify-between items-start mt-2",children:[y.jsxs("div",{className:"flex-1 pr-2",children:[y.jsx("div",{className:`font-bold text-lg mb-0.5 ${We?"text-[#BE1E2D]":"text-gray-800"}`,children:Fe.hoTen}),y.jsxs("div",{className:"text-xs text-gray-500 font-medium flex flex-col gap-1",children:[ke.showKhoa&&y.jsx("span",{children:Fe.khoa}),y.jsxs("div",{className:"flex flex-wrap gap-x-2 gap-y-1 text-gray-400 font-normal",children:[ke.showMSSV&&Fe.mssv&&y.jsx("span",{children:Fe.mssv}),ke.showChucVu&&Fe.chucVu&&y.jsxs("span",{children:[" ",Fe.chucVu]}),ke.showCCCD&&y.jsxs("span",{children:[" ID: ",Fe.cccd]}),ke.showNhom&&y.jsxs("span",{children:[" ",Fe.nhom]}),ke.showLoaiDangVien&&y.jsxs("span",{children:[" ",Fe.loaiDangVien]})]})]}),(ke.showDiemHT||ke.showDiemRL)&&y.jsxs("div",{className:"flex flex-wrap gap-1 mt-3",children:[ke.showDiemHT&&y.jsxs("span",{className:"text-[10px] bg-gray-100 text-gray-600 px-2 py-0.5 rounded border border-gray-200",children:["HT: ",Fe.diemHT]}),ke.showDiemRL&&y.jsxs("span",{className:"text-[10px] bg-gray-100 text-gray-600 px-2 py-0.5 rounded border border-gray-200",children:["RL: ",Fe.diemRL]})]}),ke.showThanhTich&&Fe.thanhTich&&y.jsxs("div",{className:"mt-2 text-[10px] text-amber-700 bg-amber-50 p-1.5 rounded border border-amber-100 flex items-start gap-1",children:[y.jsx(IE,{className:"w-3 h-3 flex-shrink-0"}),y.jsx("span",{className:"line-clamp-2",children:Fe.thanhTich})]})]}),y.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 shadow-sm ${We?"bg-yellow-500 text-white scale-110":"bg-gray-100 text-gray-300 group-hover:bg-yellow-100 group-hover:text-yellow-400"}`,children:y.jsx(ME,{className:"w-5 h-5",strokeWidth:3})})]})]},Fe.cccd)})})]})}),y.jsx("div",{className:"fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 p-4 z-[50] shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)]",children:y.jsx("div",{className:"max-w-4xl mx-auto flex items-center justify-between gap-4",children:_==="p1"?y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"text-xs text-gray-500 font-medium hidden sm:block",children:["Hon thnh: ",y.jsx("b",{className:"text-gray-900",children:Object.keys(X).length})," / ",je.length]}),y.jsxs(En,{onClick:Ee,disabled:N,className:"w-full sm:w-auto bg-[#BE1E2D] hover:bg-[#991B1B] text-white shadow-lg shadow-red-900/20 px-8 py-3 text-base flex items-center justify-center gap-2",children:[N&&y.jsx(zm,{className:"w-4 h-4 animate-spin"}),N?"ang gi...":"Gi kt qu"]})]}):y.jsxs(y.Fragment,{children:[y.jsx(En,{variant:"outline",onClick:()=>Q([]),disabled:N,className:"border-gray-300 text-gray-500 hover:text-red-600 hover:border-red-200",children:"Xa chn"}),y.jsxs(En,{onClick:D,disabled:N,className:"flex-1 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white shadow-lg shadow-yellow-900/20 py-3 text-base flex items-center justify-center gap-2 font-bold border border-yellow-400",children:[N&&y.jsx(zm,{className:"w-4 h-4 animate-spin"}),N?"ang gi...":"Hon thnh bu c"]})]})})})]})},lV=()=>{const[t,e]=at.useState("home");return t==="admin"?y.jsx(iV,{onBack:()=>e("home")}):t==="voter"?y.jsx(sV,{onLogout:()=>e("home")}):y.jsxs("div",{className:"min-h-screen flex flex-col relative bg-[#fffef5] font-sans selection:bg-red-100 overflow-x-hidden",children:[y.jsx("div",{className:"absolute top-0 left-0 w-[500px] h-[500px] bg-[#BE1E2D] rounded-full blur-3xl opacity-5 -translate-x-1/2 -translate-y-1/2 pointer-events-none"}),y.jsx("div",{className:"absolute top-0 right-0 w-[400px] h-[400px] bg-[#FFD700] rounded-full blur-3xl opacity-5 translate-x-1/3 -translate-y-1/3 pointer-events-none"}),y.jsxs("div",{className:"relative w-full h-2 bg-[#BE1E2D] shadow-sm flex",children:[y.jsx("div",{className:"h-full w-1/3 bg-[#BE1E2D]"}),y.jsx("div",{className:"h-full w-1/3 bg-[#FFD700]"}),y.jsx("div",{className:"h-full w-1/3 bg-[#BE1E2D]"})]}),y.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 sm:p-8 w-full max-w-7xl mx-auto z-10",children:[y.jsxs("div",{className:"text-center space-y-4 mb-10 md:mb-16 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[y.jsx("div",{className:"w-28 h-28 mx-auto mb-6 relative z-20 transition-transform hover:scale-105 duration-300 drop-shadow-md",children:y.jsx("img",{src:"https://drive.google.com/thumbnail?id=1O7UZhqrJoTc6xac8yB05_laRxhZsfhom&sz=w1000",alt:"Logo Chi B Sinh Vin",className:"w-full h-full object-contain"})}),y.jsxs("div",{className:"flex flex-col items-center gap-1",children:[y.jsx("h3",{className:"text-[#BE1E2D] font-bold uppercase tracking-wide text-sm md:text-base opacity-90",children:"ng b trng i hc Kinh T"}),y.jsx("h2",{className:"text-[#BE1E2D] font-black uppercase tracking-wider text-xl md:text-2xl lg:text-3xl mb-4 bg-white/50 backdrop-blur-sm px-4 py-1 rounded-lg border border-red-50/50 shadow-sm inline-block",children:"Chi b sinh vin"}),y.jsx("div",{className:"mt-4",children:y.jsxs("h1",{className:"text-3xl md:text-5xl lg:text-6xl font-black text-[#BE1E2D] leading-tight drop-shadow-sm uppercase",children:["H THNG NH GI, XP LOI ",y.jsx("br",{}),y.jsxs("span",{className:"text-[#D32F2F] relative inline-block mt-2",children:["NG VIN NM 2025",y.jsx("svg",{className:"absolute w-full h-3 -bottom-2 left-0 text-[#FFD700]/60 -z-10",viewBox:"0 0 100 10",preserveAspectRatio:"none",children:y.jsx("path",{d:"M0 5 Q 50 10 100 5",stroke:"currentColor",strokeWidth:"8",fill:"none"})})]})]})})]}),y.jsxs("div",{className:"flex items-center justify-center gap-4 mt-8",children:[y.jsx("div",{className:"h-px w-8 md:w-16 bg-red-200"}),y.jsx("p",{className:"text-gray-600 font-medium text-sm md:text-base tracking-wide",children:"Minh bch - Khch quan - Chnh xc"}),y.jsx("div",{className:"h-px w-8 md:w-16 bg-red-200"})]})]}),y.jsxs("div",{className:"grid md:grid-cols-2 gap-6 md:gap-10 w-full max-w-4xl px-2 mb-12",children:[y.jsxs("div",{className:"group bg-white rounded-2xl shadow-xl border border-red-100 overflow-hidden hover:shadow-2xl hover:border-red-300 transition-all duration-300 hover:-translate-y-1 flex flex-col relative",children:[y.jsx("div",{className:"absolute top-0 left-0 w-full h-1.5 bg-[#BE1E2D]"}),y.jsxs("div",{className:"bg-gradient-to-b from-red-50 to-white p-6 flex justify-center items-center relative overflow-hidden h-40 md:h-48",children:[y.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),y.jsx("div",{className:"relative z-10 w-28 h-28 md:w-32 md:h-32 bg-white rounded-full flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform duration-500 border-4 border-red-50",children:y.jsx(ou,{className:"w-14 h-14 md:w-16 md:h-16 text-[#BE1E2D]"})})]}),y.jsxs("div",{className:"p-6 md:p-8 flex-1 flex flex-col text-center relative z-10",children:[y.jsx("h3",{className:"text-2xl font-bold text-[#BE1E2D] mb-2 uppercase",children:"ng Vin"}),y.jsx("p",{className:"text-gray-500 text-sm mb-6 flex-1 leading-relaxed",children:"Truy cp  thc hin nh gi xp loi v bnh bu danh hiu xut sc."}),y.jsxs("button",{onClick:()=>e("voter"),className:"w-full py-3.5 rounded-xl bg-[#BE1E2D] text-white font-bold hover:bg-[#991B1B] transition-all shadow-lg shadow-red-900/20 flex items-center justify-center gap-2 group-hover:gap-3 hover:shadow-red-900/30",children:["ng nhp ngay ",y.jsx(LE,{className:"w-4 h-4"})]})]})]}),y.jsxs("div",{className:"group bg-white rounded-2xl shadow-xl border border-yellow-100 overflow-hidden hover:shadow-2xl hover:border-yellow-300 transition-all duration-300 hover:-translate-y-1 flex flex-col relative",children:[y.jsx("div",{className:"absolute top-0 left-0 w-full h-1.5 bg-[#FFD700]"}),y.jsxs("div",{className:"bg-gradient-to-b from-yellow-50 to-white p-6 flex justify-center items-center relative overflow-hidden h-40 md:h-48",children:[y.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),y.jsx("div",{className:"relative z-10 w-28 h-28 md:w-32 md:h-32 bg-white rounded-full flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform duration-500 border-4 border-yellow-50",children:y.jsx(jz,{className:"w-14 h-14 md:w-16 md:h-16 text-[#F59E0B]"})})]}),y.jsxs("div",{className:"p-6 md:p-8 flex-1 flex flex-col text-center relative z-10",children:[y.jsx("h3",{className:"text-2xl font-bold text-[#B45309] mb-2 uppercase",children:"Qun Tr Vin"}),y.jsx("p",{className:"text-gray-500 text-sm mb-6 flex-1 leading-relaxed",children:"Khu vc dnh cho cp y cu hnh h thng, nhp liu v xut bo co."}),y.jsxs("button",{onClick:()=>e("admin"),className:"w-full py-3.5 rounded-xl bg-[#FFD700] text-red-900 font-bold hover:bg-[#FCD34D] transition-all shadow-lg shadow-yellow-900/10 flex items-center justify-center gap-2 group-hover:gap-3 hover:shadow-yellow-900/20",children:["Truy cp h thng ",y.jsx(LE,{className:"w-4 h-4"})]})]})]})]})]}),y.jsx("div",{className:"relative z-10 bg-[#BE1E2D] text-white py-6 mt-auto",children:y.jsx("div",{className:"container mx-auto px-6 text-center relative z-10",children:y.jsx("p",{className:"text-xs md:text-sm font-medium opacity-90 tracking-wide",children:" 2025 Bn quyn thuc v Chi b Sinh vin"})})})]})},gC=document.getElementById("root");if(!gC)throw new Error("Could not find root element to mount to");const cV=Mk.createRoot(gC);cV.render(y.jsx(Ak.StrictMode,{children:y.jsx(lV,{})}));
