(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();function kk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lm={exports:{}},Lo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ry;function Ak(){if(ry)return Lo;ry=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,l){var o=null;if(l!==void 0&&(o=""+l),i.key!==void 0&&(o=""+i.key),"key"in i){l={};for(var u in i)u!=="key"&&(l[u]=i[u])}else l=i;return i=l.ref,{$$typeof:t,type:n,key:o,ref:i!==void 0?i:null,props:l}}return Lo.Fragment=e,Lo.jsx=r,Lo.jsxs=r,Lo}var ny;function Nk(){return ny||(ny=1,lm.exports=Ak()),lm.exports}var _=Nk(),cm={exports:{}},lt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ay;function Dk(){if(ay)return lt;ay=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),v=Symbol.iterator;function y(U){return U===null||typeof U!="object"?null:(U=v&&U[v]||U["@@iterator"],typeof U=="function"?U:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function N(U,k,P){this.props=U,this.context=k,this.refs=S,this.updater=P||E}N.prototype.isReactComponent={},N.prototype.setState=function(U,k){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,k,"setState")},N.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function I(){}I.prototype=N.prototype;function C(U,k,P){this.props=U,this.context=k,this.refs=S,this.updater=P||E}var z=C.prototype=new I;z.constructor=C,w(z,N.prototype),z.isPureReactComponent=!0;var X=Array.isArray;function W(){}var R={H:null,A:null,T:null,S:null},Q=Object.prototype.hasOwnProperty;function G(U,k,P){var M=P.ref;return{$$typeof:t,type:U,key:k,ref:M!==void 0?M:null,props:P}}function fe(U,k){return G(U.type,k,U.props)}function re(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function K(U){var k={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(P){return k[P]})}var ye=/\/+/g;function Ie(U,k){return typeof U=="object"&&U!==null&&U.key!=null?K(""+U.key):k.toString(36)}function Ce(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(W,W):(U.status="pending",U.then(function(k){U.status==="pending"&&(U.status="fulfilled",U.value=k)},function(k){U.status==="pending"&&(U.status="rejected",U.reason=k)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function Y(U,k,P,M,j){var ee=typeof U;(ee==="undefined"||ee==="boolean")&&(U=null);var xe=!1;if(U===null)xe=!0;else switch(ee){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(U.$$typeof){case t:case e:xe=!0;break;case p:return xe=U._init,Y(xe(U._payload),k,P,M,j)}}if(xe)return j=j(U),xe=M===""?"."+Ie(U,0):M,X(j)?(P="",xe!=null&&(P=xe.replace(ye,"$&/")+"/"),Y(j,k,P,"",function(we){return we})):j!=null&&(re(j)&&(j=fe(j,P+(j.key==null||U&&U.key===j.key?"":(""+j.key).replace(ye,"$&/")+"/")+xe)),k.push(j)),1;xe=0;var Te=M===""?".":M+":";if(X(U))for(var me=0;me<U.length;me++)M=U[me],ee=Te+Ie(M,me),xe+=Y(M,k,P,ee,j);else if(me=y(U),typeof me=="function")for(U=me.call(U),me=0;!(M=U.next()).done;)M=M.value,ee=Te+Ie(M,me++),xe+=Y(M,k,P,ee,j);else if(ee==="object"){if(typeof U.then=="function")return Y(Ce(U),k,P,M,j);throw k=String(U),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.")}return xe}function ue(U,k,P){if(U==null)return U;var M=[],j=0;return Y(U,M,"","",function(ee){return k.call(P,ee,j++)}),M}function Me(U){if(U._status===-1){var k=U._result;k=k(),k.then(function(P){(U._status===0||U._status===-1)&&(U._status=1,U._result=P)},function(P){(U._status===0||U._status===-1)&&(U._status=2,U._result=P)}),U._status===-1&&(U._status=0,U._result=k)}if(U._status===1)return U._result.default;throw U._result}var Z=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var k=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(k))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},Le={map:ue,forEach:function(U,k,P){ue(U,function(){k.apply(this,arguments)},P)},count:function(U){var k=0;return ue(U,function(){k++}),k},toArray:function(U){return ue(U,function(k){return k})||[]},only:function(U){if(!re(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return lt.Activity=x,lt.Children=Le,lt.Component=N,lt.Fragment=r,lt.Profiler=i,lt.PureComponent=C,lt.StrictMode=n,lt.Suspense=h,lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,lt.__COMPILER_RUNTIME={__proto__:null,c:function(U){return R.H.useMemoCache(U)}},lt.cache=function(U){return function(){return U.apply(null,arguments)}},lt.cacheSignal=function(){return null},lt.cloneElement=function(U,k,P){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var M=w({},U.props),j=U.key;if(k!=null)for(ee in k.key!==void 0&&(j=""+k.key),k)!Q.call(k,ee)||ee==="key"||ee==="__self"||ee==="__source"||ee==="ref"&&k.ref===void 0||(M[ee]=k[ee]);var ee=arguments.length-2;if(ee===1)M.children=P;else if(1<ee){for(var xe=Array(ee),Te=0;Te<ee;Te++)xe[Te]=arguments[Te+2];M.children=xe}return G(U.type,j,M)},lt.createContext=function(U){return U={$$typeof:o,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},lt.createElement=function(U,k,P){var M,j={},ee=null;if(k!=null)for(M in k.key!==void 0&&(ee=""+k.key),k)Q.call(k,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(j[M]=k[M]);var xe=arguments.length-2;if(xe===1)j.children=P;else if(1<xe){for(var Te=Array(xe),me=0;me<xe;me++)Te[me]=arguments[me+2];j.children=Te}if(U&&U.defaultProps)for(M in xe=U.defaultProps,xe)j[M]===void 0&&(j[M]=xe[M]);return G(U,ee,j)},lt.createRef=function(){return{current:null}},lt.forwardRef=function(U){return{$$typeof:u,render:U}},lt.isValidElement=re,lt.lazy=function(U){return{$$typeof:p,_payload:{_status:-1,_result:U},_init:Me}},lt.memo=function(U,k){return{$$typeof:d,type:U,compare:k===void 0?null:k}},lt.startTransition=function(U){var k=R.T,P={};R.T=P;try{var M=U(),j=R.S;j!==null&&j(P,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(W,Z)}catch(ee){Z(ee)}finally{k!==null&&P.types!==null&&(k.types=P.types),R.T=k}},lt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},lt.use=function(U){return R.H.use(U)},lt.useActionState=function(U,k,P){return R.H.useActionState(U,k,P)},lt.useCallback=function(U,k){return R.H.useCallback(U,k)},lt.useContext=function(U){return R.H.useContext(U)},lt.useDebugValue=function(){},lt.useDeferredValue=function(U,k){return R.H.useDeferredValue(U,k)},lt.useEffect=function(U,k){return R.H.useEffect(U,k)},lt.useEffectEvent=function(U){return R.H.useEffectEvent(U)},lt.useId=function(){return R.H.useId()},lt.useImperativeHandle=function(U,k,P){return R.H.useImperativeHandle(U,k,P)},lt.useInsertionEffect=function(U,k){return R.H.useInsertionEffect(U,k)},lt.useLayoutEffect=function(U,k){return R.H.useLayoutEffect(U,k)},lt.useMemo=function(U,k){return R.H.useMemo(U,k)},lt.useOptimistic=function(U,k){return R.H.useOptimistic(U,k)},lt.useReducer=function(U,k,P){return R.H.useReducer(U,k,P)},lt.useRef=function(U){return R.H.useRef(U)},lt.useState=function(U){return R.H.useState(U)},lt.useSyncExternalStore=function(U,k,P){return R.H.useSyncExternalStore(U,k,P)},lt.useTransition=function(){return R.H.useTransition()},lt.version="19.2.1",lt}var iy;function Np(){return iy||(iy=1,cm.exports=Dk()),cm.exports}var it=Np();const Rk=kk(it);var om={exports:{}},Bo={},um={exports:{}},fm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sy;function Ok(){return sy||(sy=1,(function(t){function e(Y,ue){var Me=Y.length;Y.push(ue);e:for(;0<Me;){var Z=Me-1>>>1,Le=Y[Z];if(0<i(Le,ue))Y[Z]=ue,Y[Me]=Le,Me=Z;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var ue=Y[0],Me=Y.pop();if(Me!==ue){Y[0]=Me;e:for(var Z=0,Le=Y.length,U=Le>>>1;Z<U;){var k=2*(Z+1)-1,P=Y[k],M=k+1,j=Y[M];if(0>i(P,Me))M<Le&&0>i(j,P)?(Y[Z]=j,Y[M]=Me,Z=M):(Y[Z]=P,Y[k]=Me,Z=k);else if(M<Le&&0>i(j,Me))Y[Z]=j,Y[M]=Me,Z=M;else break e}}return ue}function i(Y,ue){var Me=Y.sortIndex-ue.sortIndex;return Me!==0?Me:Y.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var h=[],d=[],p=1,x=null,v=3,y=!1,E=!1,w=!1,S=!1,N=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function z(Y){for(var ue=r(d);ue!==null;){if(ue.callback===null)n(d);else if(ue.startTime<=Y)n(d),ue.sortIndex=ue.expirationTime,e(h,ue);else break;ue=r(d)}}function X(Y){if(w=!1,z(Y),!E)if(r(h)!==null)E=!0,W||(W=!0,K());else{var ue=r(d);ue!==null&&Ce(X,ue.startTime-Y)}}var W=!1,R=-1,Q=5,G=-1;function fe(){return S?!0:!(t.unstable_now()-G<Q)}function re(){if(S=!1,W){var Y=t.unstable_now();G=Y;var ue=!0;try{e:{E=!1,w&&(w=!1,I(R),R=-1),y=!0;var Me=v;try{t:{for(z(Y),x=r(h);x!==null&&!(x.expirationTime>Y&&fe());){var Z=x.callback;if(typeof Z=="function"){x.callback=null,v=x.priorityLevel;var Le=Z(x.expirationTime<=Y);if(Y=t.unstable_now(),typeof Le=="function"){x.callback=Le,z(Y),ue=!0;break t}x===r(h)&&n(h),z(Y)}else n(h);x=r(h)}if(x!==null)ue=!0;else{var U=r(d);U!==null&&Ce(X,U.startTime-Y),ue=!1}}break e}finally{x=null,v=Me,y=!1}ue=void 0}}finally{ue?K():W=!1}}}var K;if(typeof C=="function")K=function(){C(re)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,Ie=ye.port2;ye.port1.onmessage=re,K=function(){Ie.postMessage(null)}}else K=function(){N(re,0)};function Ce(Y,ue){R=N(function(){Y(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var ue=3;break;default:ue=v}var Me=v;v=ue;try{return Y()}finally{v=Me}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(Y,ue){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Me=v;v=Y;try{return ue()}finally{v=Me}},t.unstable_scheduleCallback=function(Y,ue,Me){var Z=t.unstable_now();switch(typeof Me=="object"&&Me!==null?(Me=Me.delay,Me=typeof Me=="number"&&0<Me?Z+Me:Z):Me=Z,Y){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=Me+Le,Y={id:p++,callback:ue,priorityLevel:Y,startTime:Me,expirationTime:Le,sortIndex:-1},Me>Z?(Y.sortIndex=Me,e(d,Y),r(h)===null&&Y===r(d)&&(w?(I(R),R=-1):w=!0,Ce(X,Me-Z))):(Y.sortIndex=Le,e(h,Y),E||y||(E=!0,W||(W=!0,K()))),Y},t.unstable_shouldYield=fe,t.unstable_wrapCallback=function(Y){var ue=v;return function(){var Me=v;v=ue;try{return Y.apply(this,arguments)}finally{v=Me}}}})(fm)),fm}var ly;function Fk(){return ly||(ly=1,um.exports=Ok()),um.exports}var hm={exports:{}},Kr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy;function Ik(){if(cy)return Kr;cy=1;var t=Np();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(h,d,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:x==null?null:""+x,children:h,containerInfo:d,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Kr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Kr.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return l(h,d,null,p)},Kr.flushSync=function(h){var d=o.T,p=n.p;try{if(o.T=null,n.p=2,h)return h()}finally{o.T=d,n.p=p,n.d.f()}},Kr.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Kr.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Kr.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,x=u(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:y}):p==="script"&&n.d.X(h,{crossOrigin:x,integrity:v,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Kr.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Kr.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,x=u(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Kr.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Kr.requestFormReset=function(h){n.d.r(h)},Kr.unstable_batchedUpdates=function(h,d){return h(d)},Kr.useFormState=function(h,d,p){return o.H.useFormState(h,d,p)},Kr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Kr.version="19.2.1",Kr}var oy;function Mk(){if(oy)return hm.exports;oy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),hm.exports=Ik(),hm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uy;function Lk(){if(uy)return Bo;uy=1;var t=Fk(),e=Np(),r=Mk();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var s=a,c=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(c=s.return),a=s.return;while(a)}return s.tag===3?c:null}function o(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(a.tag===31){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function h(a){if(l(a)!==a)throw Error(n(188))}function d(a){var s=a.alternate;if(!s){if(s=l(a),s===null)throw Error(n(188));return s!==a?null:a}for(var c=a,f=s;;){var m=c.return;if(m===null)break;var g=m.alternate;if(g===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===c)return h(m),a;if(g===f)return h(m),s;g=g.sibling}throw Error(n(188))}if(c.return!==f.return)c=m,f=g;else{for(var T=!1,A=m.child;A;){if(A===c){T=!0,c=m,f=g;break}if(A===f){T=!0,f=m,c=g;break}A=A.sibling}if(!T){for(A=g.child;A;){if(A===c){T=!0,c=g,f=m;break}if(A===f){T=!0,f=g,c=m;break}A=A.sibling}if(!T)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:s}function p(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=p(a),s!==null)return s;a=a.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),C=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),fe=Symbol.for("react.memo_cache_sentinel"),re=Symbol.iterator;function K(a){return a===null||typeof a!="object"?null:(a=re&&a[re]||a["@@iterator"],typeof a=="function"?a:null)}var ye=Symbol.for("react.client.reference");function Ie(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===ye?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case N:return"Profiler";case S:return"StrictMode";case X:return"Suspense";case W:return"SuspenseList";case G:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case E:return"Portal";case C:return a.displayName||"Context";case I:return(a._context.displayName||"Context")+".Consumer";case z:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case R:return s=a.displayName||null,s!==null?s:Ie(a.type)||"Memo";case Q:s=a._payload,a=a._init;try{return Ie(a(s))}catch{}}return null}var Ce=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Me={pending:!1,data:null,method:null,action:null},Z=[],Le=-1;function U(a){return{current:a}}function k(a){0>Le||(a.current=Z[Le],Z[Le]=null,Le--)}function P(a,s){Le++,Z[Le]=a.current,a.current=s}var M=U(null),j=U(null),ee=U(null),xe=U(null);function Te(a,s){switch(P(ee,s),P(j,a),P(M,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?b2(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=b2(s),a=C2(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}k(M),P(M,a)}function me(){k(M),k(j),k(ee)}function we(a){a.memoizedState!==null&&P(xe,a);var s=M.current,c=C2(s,a.type);s!==c&&(P(j,a),P(M,c))}function $e(a){j.current===a&&(k(M),k(j)),xe.current===a&&(k(xe),Oo._currentValue=Me)}var H,At;function at(a){if(H===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);H=s&&s[1]||"",At=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+H+a+At}var be=!1;function de(a,s){if(!a||be)return"";be=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(he){var ce=he}Reflect.construct(a,[],Ee)}else{try{Ee.call()}catch(he){ce=he}a.call(Ee.prototype)}}else{try{throw Error()}catch(he){ce=he}(Ee=a())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(he){if(he&&ce&&typeof he.stack=="string")return[he.stack,ce.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=f.DetermineComponentFrameRoot(),T=g[0],A=g[1];if(T&&A){var V=T.split(`
`),ae=A.split(`
`);for(m=f=0;f<V.length&&!V[f].includes("DetermineComponentFrameRoot");)f++;for(;m<ae.length&&!ae[m].includes("DetermineComponentFrameRoot");)m++;if(f===V.length||m===ae.length)for(f=V.length-1,m=ae.length-1;1<=f&&0<=m&&V[f]!==ae[m];)m--;for(;1<=f&&0<=m;f--,m--)if(V[f]!==ae[m]){if(f!==1||m!==1)do if(f--,m--,0>m||V[f]!==ae[m]){var ge=`
`+V[f].replace(" at new "," at ");return a.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",a.displayName)),ge}while(1<=f&&0<=m);break}}}finally{be=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?at(c):""}function te(a,s){switch(a.tag){case 26:case 27:case 5:return at(a.type);case 16:return at("Lazy");case 13:return a.child!==s&&s!==null?at("Suspense Fallback"):at("Suspense");case 19:return at("SuspenseList");case 0:case 15:return de(a.type,!1);case 11:return de(a.type.render,!1);case 1:return de(a.type,!0);case 31:return at("Activity");default:return""}}function Pe(a){try{var s="",c=null;do s+=te(a,c),c=a,a=a.return;while(a);return s}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Ge=Object.prototype.hasOwnProperty,bt=t.unstable_scheduleCallback,vr=t.unstable_cancelCallback,cn=t.unstable_shouldYield,Yr=t.unstable_requestPaint,Ot=t.unstable_now,Oe=t.unstable_getCurrentPriorityLevel,Ve=t.unstable_ImmediatePriority,Qe=t.unstable_UserBlockingPriority,tt=t.unstable_NormalPriority,Ze=t.unstable_LowPriority,qe=t.unstable_IdlePriority,Ct=t.log,Dr=t.unstable_setDisableYieldValue,gt=null,dr=null;function ha(a){if(typeof Ct=="function"&&Dr(a),dr&&typeof dr.setStrictMode=="function")try{dr.setStrictMode(gt,a)}catch{}}var on=Math.clz32?Math.clz32:af,Qh=Math.log,nf=Math.LN2;function af(a){return a>>>=0,a===0?32:31-(Qh(a)/nf|0)|0}var ys=256,wl=262144,El=4194304;function Gn(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Tl(a,s,c){var f=a.pendingLanes;if(f===0)return 0;var m=0,g=a.suspendedLanes,T=a.pingedLanes;a=a.warmLanes;var A=f&134217727;return A!==0?(f=A&~g,f!==0?m=Gn(f):(T&=A,T!==0?m=Gn(T):c||(c=A&~a,c!==0&&(m=Gn(c))))):(A=f&~g,A!==0?m=Gn(A):T!==0?m=Gn(T):c||(c=f&~a,c!==0&&(m=Gn(c)))),m===0?0:s!==0&&s!==m&&(s&g)===0&&(g=m&-m,c=s&-s,g>=c||g===32&&(c&4194048)!==0)?s:m}function ws(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function Zh(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sf(){var a=El;return El<<=1,(El&62914560)===0&&(El=4194304),a}function Gc(a){for(var s=[],c=0;31>c;c++)s.push(a);return s}function Es(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Jh(a,s,c,f,m,g){var T=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var A=a.entanglements,V=a.expirationTimes,ae=a.hiddenUpdates;for(c=T&~c;0<c;){var ge=31-on(c),Ee=1<<ge;A[ge]=0,V[ge]=-1;var ce=ae[ge];if(ce!==null)for(ae[ge]=null,ge=0;ge<ce.length;ge++){var he=ce[ge];he!==null&&(he.lane&=-536870913)}c&=~Ee}f!==0&&lf(a,f,0),g!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=g&~(T&~s))}function lf(a,s,c){a.pendingLanes|=s,a.suspendedLanes&=~s;var f=31-on(s);a.entangledLanes|=s,a.entanglements[f]=a.entanglements[f]|1073741824|c&261930}function Sl(a,s){var c=a.entangledLanes|=s;for(a=a.entanglements;c;){var f=31-on(c),m=1<<f;m&s|a[f]&s&&(a[f]|=s),c&=~m}}function cf(a,s){var c=s&-s;return c=(c&42)!==0?1:Wc(c),(c&(a.suspendedLanes|s))!==0?0:c}function Wc(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Xc(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function b(){var a=ue.p;return a!==0?a:(a=window.event,a===void 0?32:K2(a.type))}function L(a,s){var c=ue.p;try{return ue.p=a,s()}finally{ue.p=c}}var D=Math.random().toString(36).slice(2),O="__reactFiber$"+D,F="__reactProps$"+D,B="__reactContainer$"+D,ie="__reactEvents$"+D,ve="__reactListeners$"+D,se="__reactHandles$"+D,le="__reactResources$"+D,oe="__reactMarker$"+D;function ke(a){delete a[O],delete a[F],delete a[ie],delete a[ve],delete a[se]}function Ne(a){var s=a[O];if(s)return s;for(var c=a.parentNode;c;){if(s=c[B]||c[O]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(a=F2(a);a!==null;){if(c=a[O])return c;a=F2(a)}return s}a=c,c=a.parentNode}return null}function Ue(a){if(a=a[O]||a[B]){var s=a.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return a}return null}function Ae(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function Be(a){var s=a[le];return s||(s=a[le]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function He(a){a[oe]=!0}var Yt=new Set,Kt={};function nr(a,s){Wn(a,s),Wn(a+"Capture",s)}function Wn(a,s){for(Kt[a]=s,a=0;a<s.length;a++)Yt.add(s[a])}var Ts=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Si={},ka={};function qc(a){return Ge.call(ka,a)?!0:Ge.call(Si,a)?!1:Ts.test(a)?ka[a]=!0:(Si[a]=!0,!1)}function gn(a,s,c){if(qc(s))if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+c)}}function of(a,s,c){if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+c)}}function Wa(a,s,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(s,c,""+f)}}function Xn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function xx(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function yC(a,s,c){var f=Object.getOwnPropertyDescriptor(a.constructor.prototype,s);if(!a.hasOwnProperty(s)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var m=f.get,g=f.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return m.call(this)},set:function(T){c=""+T,g.call(this,T)}}),Object.defineProperty(a,s,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(T){c=""+T},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function ed(a){if(!a._valueTracker){var s=xx(a)?"checked":"value";a._valueTracker=yC(a,s,""+a[s])}}function vx(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return a&&(f=xx(a)?a.checked?"true":"false":a.value),a=f,a!==c?(s.setValue(a),!0):!1}function uf(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var wC=/[\n"\\]/g;function qn(a){return a.replace(wC,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function td(a,s,c,f,m,g,T,A){a.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?a.type=T:a.removeAttribute("type"),s!=null?T==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+Xn(s)):a.value!==""+Xn(s)&&(a.value=""+Xn(s)):T!=="submit"&&T!=="reset"||a.removeAttribute("value"),s!=null?rd(a,T,Xn(s)):c!=null?rd(a,T,Xn(c)):f!=null&&a.removeAttribute("value"),m==null&&g!=null&&(a.defaultChecked=!!g),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?a.name=""+Xn(A):a.removeAttribute("name")}function _x(a,s,c,f,m,g,T,A){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(a.type=g),s!=null||c!=null){if(!(g!=="submit"&&g!=="reset"||s!=null)){ed(a);return}c=c!=null?""+Xn(c):"",s=s!=null?""+Xn(s):c,A||s===a.value||(a.value=s),a.defaultValue=s}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=A?a.checked:!!f,a.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(a.name=T),ed(a)}function rd(a,s,c){s==="number"&&uf(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function bl(a,s,c,f){if(a=a.options,s){s={};for(var m=0;m<c.length;m++)s["$"+c[m]]=!0;for(c=0;c<a.length;c++)m=s.hasOwnProperty("$"+a[c].value),a[c].selected!==m&&(a[c].selected=m),m&&f&&(a[c].defaultSelected=!0)}else{for(c=""+Xn(c),s=null,m=0;m<a.length;m++){if(a[m].value===c){a[m].selected=!0,f&&(a[m].defaultSelected=!0);return}s!==null||a[m].disabled||(s=a[m])}s!==null&&(s.selected=!0)}}function yx(a,s,c){if(s!=null&&(s=""+Xn(s),s!==a.value&&(a.value=s),c==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=c!=null?""+Xn(c):""}function wx(a,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(n(92));if(Ce(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=Xn(s),a.defaultValue=c,f=a.textContent,f===c&&f!==""&&f!==null&&(a.value=f),ed(a)}function Cl(a,s){if(s){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=s;return}}a.textContent=s}var EC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ex(a,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":f?a.setProperty(s,c):typeof c!="number"||c===0||EC.has(s)?s==="float"?a.cssFloat=c:a[s]=(""+c).trim():a[s]=c+"px"}function Tx(a,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var m in s)f=s[m],s.hasOwnProperty(m)&&c[m]!==f&&Ex(a,m,f)}else for(var g in s)s.hasOwnProperty(g)&&Ex(a,g,s[g])}function nd(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var TC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),SC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ff(a){return SC.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Xa(){}var ad=null;function id(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var kl=null,Al=null;function Sx(a){var s=Ue(a);if(s&&(a=s.stateNode)){var c=a[F]||null;e:switch(a=s.stateNode,s.type){case"input":if(td(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+qn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==a&&f.form===a.form){var m=f[F]||null;if(!m)throw Error(n(90));td(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===a.form&&vx(f)}break e;case"textarea":yx(a,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&bl(a,!!c.multiple,s,!1)}}}var sd=!1;function bx(a,s,c){if(sd)return a(s,c);sd=!0;try{var f=a(s);return f}finally{if(sd=!1,(kl!==null||Al!==null)&&(Zf(),kl&&(s=kl,a=Al,Al=kl=null,Sx(s),a)))for(s=0;s<a.length;s++)Sx(a[s])}}function Yc(a,s){var c=a.stateNode;if(c===null)return null;var f=c[F]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ld=!1;if(qa)try{var Kc={};Object.defineProperty(Kc,"passive",{get:function(){ld=!0}}),window.addEventListener("test",Kc,Kc),window.removeEventListener("test",Kc,Kc)}catch{ld=!1}var bi=null,cd=null,hf=null;function Cx(){if(hf)return hf;var a,s=cd,c=s.length,f,m="value"in bi?bi.value:bi.textContent,g=m.length;for(a=0;a<c&&s[a]===m[a];a++);var T=c-a;for(f=1;f<=T&&s[c-f]===m[g-f];f++);return hf=m.slice(a,1<f?1-f:void 0)}function df(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function mf(){return!0}function kx(){return!1}function xn(a){function s(c,f,m,g,T){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var A in a)a.hasOwnProperty(A)&&(c=a[A],this[A]=c?c(g):g[A]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?mf:kx,this.isPropagationStopped=kx,this}return x(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=mf)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=mf)},persist:function(){},isPersistent:mf}),s}var Ss={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pf=xn(Ss),$c=x({},Ss,{view:0,detail:0}),bC=xn($c),od,ud,Qc,gf=x({},$c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Qc&&(Qc&&a.type==="mousemove"?(od=a.screenX-Qc.screenX,ud=a.screenY-Qc.screenY):ud=od=0,Qc=a),od)},movementY:function(a){return"movementY"in a?a.movementY:ud}}),Ax=xn(gf),CC=x({},gf,{dataTransfer:0}),kC=xn(CC),AC=x({},$c,{relatedTarget:0}),fd=xn(AC),NC=x({},Ss,{animationName:0,elapsedTime:0,pseudoElement:0}),DC=xn(NC),RC=x({},Ss,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),OC=xn(RC),FC=x({},Ss,{data:0}),Nx=xn(FC),IC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BC(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=LC[a])?!!s[a]:!1}function hd(){return BC}var PC=x({},$c,{key:function(a){if(a.key){var s=IC[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=df(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?MC[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hd,charCode:function(a){return a.type==="keypress"?df(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?df(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),UC=xn(PC),jC=x({},gf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dx=xn(jC),HC=x({},$c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hd}),zC=xn(HC),VC=x({},Ss,{propertyName:0,elapsedTime:0,pseudoElement:0}),GC=xn(VC),WC=x({},gf,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),XC=xn(WC),qC=x({},Ss,{newState:0,oldState:0}),YC=xn(qC),KC=[9,13,27,32],dd=qa&&"CompositionEvent"in window,Zc=null;qa&&"documentMode"in document&&(Zc=document.documentMode);var $C=qa&&"TextEvent"in window&&!Zc,Rx=qa&&(!dd||Zc&&8<Zc&&11>=Zc),Ox=" ",Fx=!1;function Ix(a,s){switch(a){case"keyup":return KC.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mx(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Nl=!1;function QC(a,s){switch(a){case"compositionend":return Mx(s);case"keypress":return s.which!==32?null:(Fx=!0,Ox);case"textInput":return a=s.data,a===Ox&&Fx?null:a;default:return null}}function ZC(a,s){if(Nl)return a==="compositionend"||!dd&&Ix(a,s)?(a=Cx(),hf=cd=bi=null,Nl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Rx&&s.locale!=="ko"?null:s.data;default:return null}}var JC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lx(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!JC[a.type]:s==="textarea"}function Bx(a,s,c,f){kl?Al?Al.push(f):Al=[f]:kl=f,s=i0(s,"onChange"),0<s.length&&(c=new pf("onChange","change",null,c,f),a.push({event:c,listeners:s}))}var Jc=null,eo=null;function e3(a){_2(a,0)}function xf(a){var s=Ae(a);if(vx(s))return a}function Px(a,s){if(a==="change")return s}var Ux=!1;if(qa){var md;if(qa){var pd="oninput"in document;if(!pd){var jx=document.createElement("div");jx.setAttribute("oninput","return;"),pd=typeof jx.oninput=="function"}md=pd}else md=!1;Ux=md&&(!document.documentMode||9<document.documentMode)}function Hx(){Jc&&(Jc.detachEvent("onpropertychange",zx),eo=Jc=null)}function zx(a){if(a.propertyName==="value"&&xf(eo)){var s=[];Bx(s,eo,a,id(a)),bx(e3,s)}}function t3(a,s,c){a==="focusin"?(Hx(),Jc=s,eo=c,Jc.attachEvent("onpropertychange",zx)):a==="focusout"&&Hx()}function r3(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return xf(eo)}function n3(a,s){if(a==="click")return xf(s)}function a3(a,s){if(a==="input"||a==="change")return xf(s)}function i3(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Rn=typeof Object.is=="function"?Object.is:i3;function to(a,s){if(Rn(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var c=Object.keys(a),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!Ge.call(s,m)||!Rn(a[m],s[m]))return!1}return!0}function Vx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Gx(a,s){var c=Vx(a);a=0;for(var f;c;){if(c.nodeType===3){if(f=a+c.textContent.length,a<=s&&f>=s)return{node:c,offset:s-a};a=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Vx(c)}}function Wx(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?Wx(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function Xx(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=uf(a.document);s instanceof a.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)a=s.contentWindow;else break;s=uf(a.document)}return s}function gd(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var s3=qa&&"documentMode"in document&&11>=document.documentMode,Dl=null,xd=null,ro=null,vd=!1;function qx(a,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;vd||Dl==null||Dl!==uf(f)||(f=Dl,"selectionStart"in f&&gd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ro&&to(ro,f)||(ro=f,f=i0(xd,"onSelect"),0<f.length&&(s=new pf("onSelect","select",null,s,c),a.push({event:s,listeners:f}),s.target=Dl)))}function bs(a,s){var c={};return c[a.toLowerCase()]=s.toLowerCase(),c["Webkit"+a]="webkit"+s,c["Moz"+a]="moz"+s,c}var Rl={animationend:bs("Animation","AnimationEnd"),animationiteration:bs("Animation","AnimationIteration"),animationstart:bs("Animation","AnimationStart"),transitionrun:bs("Transition","TransitionRun"),transitionstart:bs("Transition","TransitionStart"),transitioncancel:bs("Transition","TransitionCancel"),transitionend:bs("Transition","TransitionEnd")},_d={},Yx={};qa&&(Yx=document.createElement("div").style,"AnimationEvent"in window||(delete Rl.animationend.animation,delete Rl.animationiteration.animation,delete Rl.animationstart.animation),"TransitionEvent"in window||delete Rl.transitionend.transition);function Cs(a){if(_d[a])return _d[a];if(!Rl[a])return a;var s=Rl[a],c;for(c in s)if(s.hasOwnProperty(c)&&c in Yx)return _d[a]=s[c];return a}var Kx=Cs("animationend"),$x=Cs("animationiteration"),Qx=Cs("animationstart"),l3=Cs("transitionrun"),c3=Cs("transitionstart"),o3=Cs("transitioncancel"),Zx=Cs("transitionend"),Jx=new Map,yd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");yd.push("scrollEnd");function da(a,s){Jx.set(a,s),nr(s,[a])}var vf=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Yn=[],Ol=0,wd=0;function _f(){for(var a=Ol,s=wd=Ol=0;s<a;){var c=Yn[s];Yn[s++]=null;var f=Yn[s];Yn[s++]=null;var m=Yn[s];Yn[s++]=null;var g=Yn[s];if(Yn[s++]=null,f!==null&&m!==null){var T=f.pending;T===null?m.next=m:(m.next=T.next,T.next=m),f.pending=m}g!==0&&ev(c,m,g)}}function yf(a,s,c,f){Yn[Ol++]=a,Yn[Ol++]=s,Yn[Ol++]=c,Yn[Ol++]=f,wd|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function Ed(a,s,c,f){return yf(a,s,c,f),wf(a)}function ks(a,s){return yf(a,null,null,s),wf(a)}function ev(a,s,c){a.lanes|=c;var f=a.alternate;f!==null&&(f.lanes|=c);for(var m=!1,g=a.return;g!==null;)g.childLanes|=c,f=g.alternate,f!==null&&(f.childLanes|=c),g.tag===22&&(a=g.stateNode,a===null||a._visibility&1||(m=!0)),a=g,g=g.return;return a.tag===3?(g=a.stateNode,m&&s!==null&&(m=31-on(c),a=g.hiddenUpdates,f=a[m],f===null?a[m]=[s]:f.push(s),s.lane=c|536870912),g):null}function wf(a){if(50<bo)throw bo=0,R1=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var Fl={};function u3(a,s,c,f){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(a,s,c,f){return new u3(a,s,c,f)}function Td(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ya(a,s){var c=a.alternate;return c===null?(c=On(a.tag,s,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=s,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,s=a.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function tv(a,s){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,s=c.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function Ef(a,s,c,f,m,g){var T=0;if(f=a,typeof a=="function")Td(a)&&(T=1);else if(typeof a=="string")T=pk(a,c,M.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case G:return a=On(31,c,s,m),a.elementType=G,a.lanes=g,a;case w:return As(c.children,m,g,s);case S:T=8,m|=24;break;case N:return a=On(12,c,s,m|2),a.elementType=N,a.lanes=g,a;case X:return a=On(13,c,s,m),a.elementType=X,a.lanes=g,a;case W:return a=On(19,c,s,m),a.elementType=W,a.lanes=g,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case C:T=10;break e;case I:T=9;break e;case z:T=11;break e;case R:T=14;break e;case Q:T=16,f=null;break e}T=29,c=Error(n(130,a===null?"null":typeof a,"")),f=null}return s=On(T,c,s,m),s.elementType=a,s.type=f,s.lanes=g,s}function As(a,s,c,f){return a=On(7,a,f,s),a.lanes=c,a}function Sd(a,s,c){return a=On(6,a,null,s),a.lanes=c,a}function rv(a){var s=On(18,null,null,0);return s.stateNode=a,s}function bd(a,s,c){return s=On(4,a.children!==null?a.children:[],a.key,s),s.lanes=c,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var nv=new WeakMap;function Kn(a,s){if(typeof a=="object"&&a!==null){var c=nv.get(a);return c!==void 0?c:(s={value:a,source:s,stack:Pe(s)},nv.set(a,s),s)}return{value:a,source:s,stack:Pe(s)}}var Il=[],Ml=0,Tf=null,no=0,$n=[],Qn=0,Ci=null,Aa=1,Na="";function Ka(a,s){Il[Ml++]=no,Il[Ml++]=Tf,Tf=a,no=s}function av(a,s,c){$n[Qn++]=Aa,$n[Qn++]=Na,$n[Qn++]=Ci,Ci=a;var f=Aa;a=Na;var m=32-on(f)-1;f&=~(1<<m),c+=1;var g=32-on(s)+m;if(30<g){var T=m-m%5;g=(f&(1<<T)-1).toString(32),f>>=T,m-=T,Aa=1<<32-on(s)+m|c<<m|f,Na=g+a}else Aa=1<<g|c<<m|f,Na=a}function Cd(a){a.return!==null&&(Ka(a,1),av(a,1,0))}function kd(a){for(;a===Tf;)Tf=Il[--Ml],Il[Ml]=null,no=Il[--Ml],Il[Ml]=null;for(;a===Ci;)Ci=$n[--Qn],$n[Qn]=null,Na=$n[--Qn],$n[Qn]=null,Aa=$n[--Qn],$n[Qn]=null}function iv(a,s){$n[Qn++]=Aa,$n[Qn++]=Na,$n[Qn++]=Ci,Aa=s.id,Na=s.overflow,Ci=a}var jr=null,Qt=null,Tt=!1,ki=null,Zn=!1,Ad=Error(n(519));function Ai(a){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ao(Kn(s,a)),Ad}function sv(a){var s=a.stateNode,c=a.type,f=a.memoizedProps;switch(s[O]=a,s[F]=f,c){case"dialog":vt("cancel",s),vt("close",s);break;case"iframe":case"object":case"embed":vt("load",s);break;case"video":case"audio":for(c=0;c<ko.length;c++)vt(ko[c],s);break;case"source":vt("error",s);break;case"img":case"image":case"link":vt("error",s),vt("load",s);break;case"details":vt("toggle",s);break;case"input":vt("invalid",s),_x(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":vt("invalid",s);break;case"textarea":vt("invalid",s),wx(s,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||T2(s.textContent,c)?(f.popover!=null&&(vt("beforetoggle",s),vt("toggle",s)),f.onScroll!=null&&vt("scroll",s),f.onScrollEnd!=null&&vt("scrollend",s),f.onClick!=null&&(s.onclick=Xa),s=!0):s=!1,s||Ai(a,!0)}function lv(a){for(jr=a.return;jr;)switch(jr.tag){case 5:case 31:case 13:Zn=!1;return;case 27:case 3:Zn=!0;return;default:jr=jr.return}}function Ll(a){if(a!==jr)return!1;if(!Tt)return lv(a),Tt=!0,!1;var s=a.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||X1(a.type,a.memoizedProps)),c=!c),c&&Qt&&Ai(a),lv(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Qt=O2(a)}else if(s===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Qt=O2(a)}else s===27?(s=Qt,zi(a.type)?(a=Q1,Q1=null,Qt=a):Qt=s):Qt=jr?ea(a.stateNode.nextSibling):null;return!0}function Ns(){Qt=jr=null,Tt=!1}function Nd(){var a=ki;return a!==null&&(wn===null?wn=a:wn.push.apply(wn,a),ki=null),a}function ao(a){ki===null?ki=[a]:ki.push(a)}var Dd=U(null),Ds=null,$a=null;function Ni(a,s,c){P(Dd,s._currentValue),s._currentValue=c}function Qa(a){a._currentValue=Dd.current,k(Dd)}function Rd(a,s,c){for(;a!==null;){var f=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),a===c)break;a=a.return}}function Od(a,s,c,f){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var g=m.dependencies;if(g!==null){var T=m.child;g=g.firstContext;e:for(;g!==null;){var A=g;g=m;for(var V=0;V<s.length;V++)if(A.context===s[V]){g.lanes|=c,A=g.alternate,A!==null&&(A.lanes|=c),Rd(g.return,c,a),f||(T=null);break e}g=A.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(n(341));T.lanes|=c,g=T.alternate,g!==null&&(g.lanes|=c),Rd(T,c,a),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===a){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function Bl(a,s,c,f){a=null;for(var m=s,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var A=m.type;Rn(m.pendingProps.value,T.value)||(a!==null?a.push(A):a=[A])}}else if(m===xe.current){if(T=m.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(Oo):a=[Oo])}m=m.return}a!==null&&Od(s,a,c,f),s.flags|=262144}function Sf(a){for(a=a.firstContext;a!==null;){if(!Rn(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Rs(a){Ds=a,$a=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Hr(a){return cv(Ds,a)}function bf(a,s){return Ds===null&&Rs(a),cv(a,s)}function cv(a,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},$a===null){if(a===null)throw Error(n(308));$a=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else $a=$a.next=s;return c}var f3=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(c,f){a.push(f)}};this.abort=function(){s.aborted=!0,a.forEach(function(c){return c()})}},h3=t.unstable_scheduleCallback,d3=t.unstable_NormalPriority,_r={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fd(){return{controller:new f3,data:new Map,refCount:0}}function io(a){a.refCount--,a.refCount===0&&h3(d3,function(){a.controller.abort()})}var so=null,Id=0,Pl=0,Ul=null;function m3(a,s){if(so===null){var c=so=[];Id=0,Pl=B1(),Ul={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Id++,s.then(ov,ov),s}function ov(){if(--Id===0&&so!==null){Ul!==null&&(Ul.status="fulfilled");var a=so;so=null,Pl=0,Ul=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function p3(a,s){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return a.then(function(){f.status="fulfilled",f.value=s;for(var m=0;m<c.length;m++)(0,c[m])(s)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var uv=Y.S;Y.S=function(a,s){q_=Ot(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&m3(a,s),uv!==null&&uv(a,s)};var Os=U(null);function Md(){var a=Os.current;return a!==null?a:Wt.pooledCache}function Cf(a,s){s===null?P(Os,Os.current):P(Os,s.pool)}function fv(){var a=Md();return a===null?null:{parent:_r._currentValue,pool:a}}var jl=Error(n(460)),Ld=Error(n(474)),kf=Error(n(542)),Af={then:function(){}};function hv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function dv(a,s,c){switch(c=a[c],c===void 0?a.push(s):c!==s&&(s.then(Xa,Xa),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,pv(a),a;default:if(typeof s.status=="string")s.then(Xa,Xa);else{if(a=Wt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(f){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=f}},function(f){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,pv(a),a}throw Is=s,jl}}function Fs(a){try{var s=a._init;return s(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Is=c,jl):c}}var Is=null;function mv(){if(Is===null)throw Error(n(459));var a=Is;return Is=null,a}function pv(a){if(a===jl||a===kf)throw Error(n(483))}var Hl=null,lo=0;function Nf(a){var s=lo;return lo+=1,Hl===null&&(Hl=[]),dv(Hl,a,s)}function co(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function Df(a,s){throw s.$$typeof===v?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function gv(a){function s(J,q){if(a){var ne=J.deletions;ne===null?(J.deletions=[q],J.flags|=16):ne.push(q)}}function c(J,q){if(!a)return null;for(;q!==null;)s(J,q),q=q.sibling;return null}function f(J){for(var q=new Map;J!==null;)J.key!==null?q.set(J.key,J):q.set(J.index,J),J=J.sibling;return q}function m(J,q){return J=Ya(J,q),J.index=0,J.sibling=null,J}function g(J,q,ne){return J.index=ne,a?(ne=J.alternate,ne!==null?(ne=ne.index,ne<q?(J.flags|=67108866,q):ne):(J.flags|=67108866,q)):(J.flags|=1048576,q)}function T(J){return a&&J.alternate===null&&(J.flags|=67108866),J}function A(J,q,ne,_e){return q===null||q.tag!==6?(q=Sd(ne,J.mode,_e),q.return=J,q):(q=m(q,ne),q.return=J,q)}function V(J,q,ne,_e){var Xe=ne.type;return Xe===w?ge(J,q,ne.props.children,_e,ne.key):q!==null&&(q.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===Q&&Fs(Xe)===q.type)?(q=m(q,ne.props),co(q,ne),q.return=J,q):(q=Ef(ne.type,ne.key,ne.props,null,J.mode,_e),co(q,ne),q.return=J,q)}function ae(J,q,ne,_e){return q===null||q.tag!==4||q.stateNode.containerInfo!==ne.containerInfo||q.stateNode.implementation!==ne.implementation?(q=bd(ne,J.mode,_e),q.return=J,q):(q=m(q,ne.children||[]),q.return=J,q)}function ge(J,q,ne,_e,Xe){return q===null||q.tag!==7?(q=As(ne,J.mode,_e,Xe),q.return=J,q):(q=m(q,ne),q.return=J,q)}function Ee(J,q,ne){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Sd(""+q,J.mode,ne),q.return=J,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case y:return ne=Ef(q.type,q.key,q.props,null,J.mode,ne),co(ne,q),ne.return=J,ne;case E:return q=bd(q,J.mode,ne),q.return=J,q;case Q:return q=Fs(q),Ee(J,q,ne)}if(Ce(q)||K(q))return q=As(q,J.mode,ne,null),q.return=J,q;if(typeof q.then=="function")return Ee(J,Nf(q),ne);if(q.$$typeof===C)return Ee(J,bf(J,q),ne);Df(J,q)}return null}function ce(J,q,ne,_e){var Xe=q!==null?q.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Xe!==null?null:A(J,q,""+ne,_e);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case y:return ne.key===Xe?V(J,q,ne,_e):null;case E:return ne.key===Xe?ae(J,q,ne,_e):null;case Q:return ne=Fs(ne),ce(J,q,ne,_e)}if(Ce(ne)||K(ne))return Xe!==null?null:ge(J,q,ne,_e,null);if(typeof ne.then=="function")return ce(J,q,Nf(ne),_e);if(ne.$$typeof===C)return ce(J,q,bf(J,ne),_e);Df(J,ne)}return null}function he(J,q,ne,_e,Xe){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return J=J.get(ne)||null,A(q,J,""+_e,Xe);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case y:return J=J.get(_e.key===null?ne:_e.key)||null,V(q,J,_e,Xe);case E:return J=J.get(_e.key===null?ne:_e.key)||null,ae(q,J,_e,Xe);case Q:return _e=Fs(_e),he(J,q,ne,_e,Xe)}if(Ce(_e)||K(_e))return J=J.get(ne)||null,ge(q,J,_e,Xe,null);if(typeof _e.then=="function")return he(J,q,ne,Nf(_e),Xe);if(_e.$$typeof===C)return he(J,q,ne,bf(q,_e),Xe);Df(q,_e)}return null}function je(J,q,ne,_e){for(var Xe=null,Nt=null,ze=q,ut=q=0,wt=null;ze!==null&&ut<ne.length;ut++){ze.index>ut?(wt=ze,ze=null):wt=ze.sibling;var Dt=ce(J,ze,ne[ut],_e);if(Dt===null){ze===null&&(ze=wt);break}a&&ze&&Dt.alternate===null&&s(J,ze),q=g(Dt,q,ut),Nt===null?Xe=Dt:Nt.sibling=Dt,Nt=Dt,ze=wt}if(ut===ne.length)return c(J,ze),Tt&&Ka(J,ut),Xe;if(ze===null){for(;ut<ne.length;ut++)ze=Ee(J,ne[ut],_e),ze!==null&&(q=g(ze,q,ut),Nt===null?Xe=ze:Nt.sibling=ze,Nt=ze);return Tt&&Ka(J,ut),Xe}for(ze=f(ze);ut<ne.length;ut++)wt=he(ze,J,ut,ne[ut],_e),wt!==null&&(a&&wt.alternate!==null&&ze.delete(wt.key===null?ut:wt.key),q=g(wt,q,ut),Nt===null?Xe=wt:Nt.sibling=wt,Nt=wt);return a&&ze.forEach(function(qi){return s(J,qi)}),Tt&&Ka(J,ut),Xe}function Ke(J,q,ne,_e){if(ne==null)throw Error(n(151));for(var Xe=null,Nt=null,ze=q,ut=q=0,wt=null,Dt=ne.next();ze!==null&&!Dt.done;ut++,Dt=ne.next()){ze.index>ut?(wt=ze,ze=null):wt=ze.sibling;var qi=ce(J,ze,Dt.value,_e);if(qi===null){ze===null&&(ze=wt);break}a&&ze&&qi.alternate===null&&s(J,ze),q=g(qi,q,ut),Nt===null?Xe=qi:Nt.sibling=qi,Nt=qi,ze=wt}if(Dt.done)return c(J,ze),Tt&&Ka(J,ut),Xe;if(ze===null){for(;!Dt.done;ut++,Dt=ne.next())Dt=Ee(J,Dt.value,_e),Dt!==null&&(q=g(Dt,q,ut),Nt===null?Xe=Dt:Nt.sibling=Dt,Nt=Dt);return Tt&&Ka(J,ut),Xe}for(ze=f(ze);!Dt.done;ut++,Dt=ne.next())Dt=he(ze,J,ut,Dt.value,_e),Dt!==null&&(a&&Dt.alternate!==null&&ze.delete(Dt.key===null?ut:Dt.key),q=g(Dt,q,ut),Nt===null?Xe=Dt:Nt.sibling=Dt,Nt=Dt);return a&&ze.forEach(function(Ck){return s(J,Ck)}),Tt&&Ka(J,ut),Xe}function zt(J,q,ne,_e){if(typeof ne=="object"&&ne!==null&&ne.type===w&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case y:e:{for(var Xe=ne.key;q!==null;){if(q.key===Xe){if(Xe=ne.type,Xe===w){if(q.tag===7){c(J,q.sibling),_e=m(q,ne.props.children),_e.return=J,J=_e;break e}}else if(q.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===Q&&Fs(Xe)===q.type){c(J,q.sibling),_e=m(q,ne.props),co(_e,ne),_e.return=J,J=_e;break e}c(J,q);break}else s(J,q);q=q.sibling}ne.type===w?(_e=As(ne.props.children,J.mode,_e,ne.key),_e.return=J,J=_e):(_e=Ef(ne.type,ne.key,ne.props,null,J.mode,_e),co(_e,ne),_e.return=J,J=_e)}return T(J);case E:e:{for(Xe=ne.key;q!==null;){if(q.key===Xe)if(q.tag===4&&q.stateNode.containerInfo===ne.containerInfo&&q.stateNode.implementation===ne.implementation){c(J,q.sibling),_e=m(q,ne.children||[]),_e.return=J,J=_e;break e}else{c(J,q);break}else s(J,q);q=q.sibling}_e=bd(ne,J.mode,_e),_e.return=J,J=_e}return T(J);case Q:return ne=Fs(ne),zt(J,q,ne,_e)}if(Ce(ne))return je(J,q,ne,_e);if(K(ne)){if(Xe=K(ne),typeof Xe!="function")throw Error(n(150));return ne=Xe.call(ne),Ke(J,q,ne,_e)}if(typeof ne.then=="function")return zt(J,q,Nf(ne),_e);if(ne.$$typeof===C)return zt(J,q,bf(J,ne),_e);Df(J,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,q!==null&&q.tag===6?(c(J,q.sibling),_e=m(q,ne),_e.return=J,J=_e):(c(J,q),_e=Sd(ne,J.mode,_e),_e.return=J,J=_e),T(J)):c(J,q)}return function(J,q,ne,_e){try{lo=0;var Xe=zt(J,q,ne,_e);return Hl=null,Xe}catch(ze){if(ze===jl||ze===kf)throw ze;var Nt=On(29,ze,null,J.mode);return Nt.lanes=_e,Nt.return=J,Nt}finally{}}}var Ms=gv(!0),xv=gv(!1),Di=!1;function Bd(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pd(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ri(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Oi(a,s,c){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(Ft&2)!==0){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,s=wf(a),ev(a,null,c),s}return yf(a,f,s,c),wf(a)}function oo(a,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=a.pendingLanes,c|=f,s.lanes=c,Sl(a,c)}}function Ud(a,s){var c=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,g=null;if(c=c.firstBaseUpdate,c!==null){do{var T={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};g===null?m=g=T:g=g.next=T,c=c.next}while(c!==null);g===null?m=g=s:g=g.next=s}else m=g=s;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:f.shared,callbacks:f.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=s:a.next=s,c.lastBaseUpdate=s}var jd=!1;function uo(){if(jd){var a=Ul;if(a!==null)throw a}}function fo(a,s,c,f){jd=!1;var m=a.updateQueue;Di=!1;var g=m.firstBaseUpdate,T=m.lastBaseUpdate,A=m.shared.pending;if(A!==null){m.shared.pending=null;var V=A,ae=V.next;V.next=null,T===null?g=ae:T.next=ae,T=V;var ge=a.alternate;ge!==null&&(ge=ge.updateQueue,A=ge.lastBaseUpdate,A!==T&&(A===null?ge.firstBaseUpdate=ae:A.next=ae,ge.lastBaseUpdate=V))}if(g!==null){var Ee=m.baseState;T=0,ge=ae=V=null,A=g;do{var ce=A.lane&-536870913,he=ce!==A.lane;if(he?(yt&ce)===ce:(f&ce)===ce){ce!==0&&ce===Pl&&(jd=!0),ge!==null&&(ge=ge.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var je=a,Ke=A;ce=s;var zt=c;switch(Ke.tag){case 1:if(je=Ke.payload,typeof je=="function"){Ee=je.call(zt,Ee,ce);break e}Ee=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Ke.payload,ce=typeof je=="function"?je.call(zt,Ee,ce):je,ce==null)break e;Ee=x({},Ee,ce);break e;case 2:Di=!0}}ce=A.callback,ce!==null&&(a.flags|=64,he&&(a.flags|=8192),he=m.callbacks,he===null?m.callbacks=[ce]:he.push(ce))}else he={lane:ce,tag:A.tag,payload:A.payload,callback:A.callback,next:null},ge===null?(ae=ge=he,V=Ee):ge=ge.next=he,T|=ce;if(A=A.next,A===null){if(A=m.shared.pending,A===null)break;he=A,A=he.next,he.next=null,m.lastBaseUpdate=he,m.shared.pending=null}}while(!0);ge===null&&(V=Ee),m.baseState=V,m.firstBaseUpdate=ae,m.lastBaseUpdate=ge,g===null&&(m.shared.lanes=0),Bi|=T,a.lanes=T,a.memoizedState=Ee}}function vv(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function _v(a,s){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)vv(c[a],s)}var zl=U(null),Rf=U(0);function yv(a,s){a=si,P(Rf,a),P(zl,s),si=a|s.baseLanes}function Hd(){P(Rf,si),P(zl,zl.current)}function zd(){si=Rf.current,k(zl),k(Rf)}var Fn=U(null),Jn=null;function Fi(a){var s=a.alternate;P(mr,mr.current&1),P(Fn,a),Jn===null&&(s===null||zl.current!==null||s.memoizedState!==null)&&(Jn=a)}function Vd(a){P(mr,mr.current),P(Fn,a),Jn===null&&(Jn=a)}function wv(a){a.tag===22?(P(mr,mr.current),P(Fn,a),Jn===null&&(Jn=a)):Ii()}function Ii(){P(mr,mr.current),P(Fn,Fn.current)}function In(a){k(Fn),Jn===a&&(Jn=null),k(mr)}var mr=U(0);function Of(a){for(var s=a;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||K1(c)||$1(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Za=0,ct=null,jt=null,yr=null,Ff=!1,Vl=!1,Ls=!1,If=0,ho=0,Gl=null,g3=0;function lr(){throw Error(n(321))}function Gd(a,s){if(s===null)return!1;for(var c=0;c<s.length&&c<a.length;c++)if(!Rn(a[c],s[c]))return!1;return!0}function Wd(a,s,c,f,m,g){return Za=g,ct=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Y.H=a===null||a.memoizedState===null?a_:s1,Ls=!1,g=c(f,m),Ls=!1,Vl&&(g=Tv(s,c,f,m)),Ev(a),g}function Ev(a){Y.H=go;var s=jt!==null&&jt.next!==null;if(Za=0,yr=jt=ct=null,Ff=!1,ho=0,Gl=null,s)throw Error(n(300));a===null||wr||(a=a.dependencies,a!==null&&Sf(a)&&(wr=!0))}function Tv(a,s,c,f){ct=a;var m=0;do{if(Vl&&(Gl=null),ho=0,Vl=!1,25<=m)throw Error(n(301));if(m+=1,yr=jt=null,a.updateQueue!=null){var g=a.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}Y.H=i_,g=s(c,f)}while(Vl);return g}function x3(){var a=Y.H,s=a.useState()[0];return s=typeof s.then=="function"?mo(s):s,a=a.useState()[0],(jt!==null?jt.memoizedState:null)!==a&&(ct.flags|=1024),s}function Xd(){var a=If!==0;return If=0,a}function qd(a,s,c){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~c}function Yd(a){if(Ff){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Ff=!1}Za=0,yr=jt=ct=null,Vl=!1,ho=If=0,Gl=null}function un(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?ct.memoizedState=yr=a:yr=yr.next=a,yr}function pr(){if(jt===null){var a=ct.alternate;a=a!==null?a.memoizedState:null}else a=jt.next;var s=yr===null?ct.memoizedState:yr.next;if(s!==null)yr=s,jt=a;else{if(a===null)throw ct.alternate===null?Error(n(467)):Error(n(310));jt=a,a={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},yr===null?ct.memoizedState=yr=a:yr=yr.next=a}return yr}function Mf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mo(a){var s=ho;return ho+=1,Gl===null&&(Gl=[]),a=dv(Gl,a,s),s=ct,(yr===null?s.memoizedState:yr.next)===null&&(s=s.alternate,Y.H=s===null||s.memoizedState===null?a_:s1),a}function Lf(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return mo(a);if(a.$$typeof===C)return Hr(a)}throw Error(n(438,String(a)))}function Kd(a){var s=null,c=ct.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=ct.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Mf(),ct.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(a),f=0;f<a;f++)c[f]=fe;return s.index++,c}function Ja(a,s){return typeof s=="function"?s(a):s}function Bf(a){var s=pr();return $d(s,jt,a)}function $d(a,s,c){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var m=a.baseQueue,g=f.pending;if(g!==null){if(m!==null){var T=m.next;m.next=g.next,g.next=T}s.baseQueue=m=g,f.pending=null}if(g=a.baseState,m===null)a.memoizedState=g;else{s=m.next;var A=T=null,V=null,ae=s,ge=!1;do{var Ee=ae.lane&-536870913;if(Ee!==ae.lane?(yt&Ee)===Ee:(Za&Ee)===Ee){var ce=ae.revertLane;if(ce===0)V!==null&&(V=V.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),Ee===Pl&&(ge=!0);else if((Za&ce)===ce){ae=ae.next,ce===Pl&&(ge=!0);continue}else Ee={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},V===null?(A=V=Ee,T=g):V=V.next=Ee,ct.lanes|=ce,Bi|=ce;Ee=ae.action,Ls&&c(g,Ee),g=ae.hasEagerState?ae.eagerState:c(g,Ee)}else ce={lane:Ee,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},V===null?(A=V=ce,T=g):V=V.next=ce,ct.lanes|=Ee,Bi|=Ee;ae=ae.next}while(ae!==null&&ae!==s);if(V===null?T=g:V.next=A,!Rn(g,a.memoizedState)&&(wr=!0,ge&&(c=Ul,c!==null)))throw c;a.memoizedState=g,a.baseState=T,a.baseQueue=V,f.lastRenderedState=g}return m===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Qd(a){var s=pr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var f=c.dispatch,m=c.pending,g=s.memoizedState;if(m!==null){c.pending=null;var T=m=m.next;do g=a(g,T.action),T=T.next;while(T!==m);Rn(g,s.memoizedState)||(wr=!0),s.memoizedState=g,s.baseQueue===null&&(s.baseState=g),c.lastRenderedState=g}return[g,f]}function Sv(a,s,c){var f=ct,m=pr(),g=Tt;if(g){if(c===void 0)throw Error(n(407));c=c()}else c=s();var T=!Rn((jt||m).memoizedState,c);if(T&&(m.memoizedState=c,wr=!0),m=m.queue,e1(kv.bind(null,f,m,a),[a]),m.getSnapshot!==s||T||yr!==null&&yr.memoizedState.tag&1){if(f.flags|=2048,Wl(9,{destroy:void 0},Cv.bind(null,f,m,c,s),null),Wt===null)throw Error(n(349));g||(Za&127)!==0||bv(f,s,c)}return c}function bv(a,s,c){a.flags|=16384,a={getSnapshot:s,value:c},s=ct.updateQueue,s===null?(s=Mf(),ct.updateQueue=s,s.stores=[a]):(c=s.stores,c===null?s.stores=[a]:c.push(a))}function Cv(a,s,c,f){s.value=c,s.getSnapshot=f,Av(s)&&Nv(a)}function kv(a,s,c){return c(function(){Av(s)&&Nv(a)})}function Av(a){var s=a.getSnapshot;a=a.value;try{var c=s();return!Rn(a,c)}catch{return!0}}function Nv(a){var s=ks(a,2);s!==null&&En(s,a,2)}function Zd(a){var s=un();if(typeof a=="function"){var c=a;if(a=c(),Ls){ha(!0);try{c()}finally{ha(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:a},s}function Dv(a,s,c,f){return a.baseState=c,$d(a,jt,typeof f=="function"?f:Ja)}function v3(a,s,c,f,m){if(jf(a))throw Error(n(485));if(a=s.action,a!==null){var g={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};Y.T!==null?c(!0):g.isTransition=!1,f(g),c=s.pending,c===null?(g.next=s.pending=g,Rv(s,g)):(g.next=c.next,s.pending=c.next=g)}}function Rv(a,s){var c=s.action,f=s.payload,m=a.state;if(s.isTransition){var g=Y.T,T={};Y.T=T;try{var A=c(m,f),V=Y.S;V!==null&&V(T,A),Ov(a,s,A)}catch(ae){Jd(a,s,ae)}finally{g!==null&&T.types!==null&&(g.types=T.types),Y.T=g}}else try{g=c(m,f),Ov(a,s,g)}catch(ae){Jd(a,s,ae)}}function Ov(a,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){Fv(a,s,f)},function(f){return Jd(a,s,f)}):Fv(a,s,c)}function Fv(a,s,c){s.status="fulfilled",s.value=c,Iv(s),a.state=c,s=a.pending,s!==null&&(c=s.next,c===s?a.pending=null:(c=c.next,s.next=c,Rv(a,c)))}function Jd(a,s,c){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,Iv(s),s=s.next;while(s!==f)}a.action=null}function Iv(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function Mv(a,s){return s}function Lv(a,s){if(Tt){var c=Wt.formState;if(c!==null){e:{var f=ct;if(Tt){if(Qt){t:{for(var m=Qt,g=Zn;m.nodeType!==8;){if(!g){m=null;break t}if(m=ea(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){Qt=ea(m.nextSibling),f=m.data==="F!";break e}}Ai(f)}f=!1}f&&(s=c[0])}}return c=un(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mv,lastRenderedState:s},c.queue=f,c=t_.bind(null,ct,f),f.dispatch=c,f=Zd(!1),g=i1.bind(null,ct,!1,f.queue),f=un(),m={state:s,dispatch:null,action:a,pending:null},f.queue=m,c=v3.bind(null,ct,m,g,c),m.dispatch=c,f.memoizedState=a,[s,c,!1]}function Bv(a){var s=pr();return Pv(s,jt,a)}function Pv(a,s,c){if(s=$d(a,s,Mv)[0],a=Bf(Ja)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=mo(s)}catch(T){throw T===jl?kf:T}else f=s;s=pr();var m=s.queue,g=m.dispatch;return c!==s.memoizedState&&(ct.flags|=2048,Wl(9,{destroy:void 0},_3.bind(null,m,c),null)),[f,g,a]}function _3(a,s){a.action=s}function Uv(a){var s=pr(),c=jt;if(c!==null)return Pv(s,c,a);pr(),s=s.memoizedState,c=pr();var f=c.queue.dispatch;return c.memoizedState=a,[s,f,!1]}function Wl(a,s,c,f){return a={tag:a,create:c,deps:f,inst:s,next:null},s=ct.updateQueue,s===null&&(s=Mf(),ct.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=a.next=a:(f=c.next,c.next=a,a.next=f,s.lastEffect=a),a}function jv(){return pr().memoizedState}function Pf(a,s,c,f){var m=un();ct.flags|=a,m.memoizedState=Wl(1|s,{destroy:void 0},c,f===void 0?null:f)}function Uf(a,s,c,f){var m=pr();f=f===void 0?null:f;var g=m.memoizedState.inst;jt!==null&&f!==null&&Gd(f,jt.memoizedState.deps)?m.memoizedState=Wl(s,g,c,f):(ct.flags|=a,m.memoizedState=Wl(1|s,g,c,f))}function Hv(a,s){Pf(8390656,8,a,s)}function e1(a,s){Uf(2048,8,a,s)}function y3(a){ct.flags|=4;var s=ct.updateQueue;if(s===null)s=Mf(),ct.updateQueue=s,s.events=[a];else{var c=s.events;c===null?s.events=[a]:c.push(a)}}function zv(a){var s=pr().memoizedState;return y3({ref:s,nextImpl:a}),function(){if((Ft&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function Vv(a,s){return Uf(4,2,a,s)}function Gv(a,s){return Uf(4,4,a,s)}function Wv(a,s){if(typeof s=="function"){a=a();var c=s(a);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function Xv(a,s,c){c=c!=null?c.concat([a]):null,Uf(4,4,Wv.bind(null,s,a),c)}function t1(){}function qv(a,s){var c=pr();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&Gd(s,f[1])?f[0]:(c.memoizedState=[a,s],a)}function Yv(a,s){var c=pr();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&Gd(s,f[1]))return f[0];if(f=a(),Ls){ha(!0);try{a()}finally{ha(!1)}}return c.memoizedState=[f,s],f}function r1(a,s,c){return c===void 0||(Za&1073741824)!==0&&(yt&261930)===0?a.memoizedState=s:(a.memoizedState=c,a=K_(),ct.lanes|=a,Bi|=a,c)}function Kv(a,s,c,f){return Rn(c,s)?c:zl.current!==null?(a=r1(a,c,f),Rn(a,s)||(wr=!0),a):(Za&42)===0||(Za&1073741824)!==0&&(yt&261930)===0?(wr=!0,a.memoizedState=c):(a=K_(),ct.lanes|=a,Bi|=a,s)}function $v(a,s,c,f,m){var g=ue.p;ue.p=g!==0&&8>g?g:8;var T=Y.T,A={};Y.T=A,i1(a,!1,s,c);try{var V=m(),ae=Y.S;if(ae!==null&&ae(A,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var ge=p3(V,f);po(a,s,ge,Bn(a))}else po(a,s,f,Bn(a))}catch(Ee){po(a,s,{then:function(){},status:"rejected",reason:Ee},Bn())}finally{ue.p=g,T!==null&&A.types!==null&&(T.types=A.types),Y.T=T}}function w3(){}function n1(a,s,c,f){if(a.tag!==5)throw Error(n(476));var m=Qv(a).queue;$v(a,m,s,Me,c===null?w3:function(){return Zv(a),c(f)})}function Qv(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:Me,baseState:Me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:Me},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:c},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function Zv(a){var s=Qv(a);s.next===null&&(s=a.alternate.memoizedState),po(a,s.next.queue,{},Bn())}function a1(){return Hr(Oo)}function Jv(){return pr().memoizedState}function e_(){return pr().memoizedState}function E3(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var c=Bn();a=Ri(c);var f=Oi(s,a,c);f!==null&&(En(f,s,c),oo(f,s,c)),s={cache:Fd()},a.payload=s;return}s=s.return}}function T3(a,s,c){var f=Bn();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},jf(a)?r_(s,c):(c=Ed(a,s,c,f),c!==null&&(En(c,a,f),n_(c,s,f)))}function t_(a,s,c){var f=Bn();po(a,s,c,f)}function po(a,s,c,f){var m={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(jf(a))r_(s,m);else{var g=a.alternate;if(a.lanes===0&&(g===null||g.lanes===0)&&(g=s.lastRenderedReducer,g!==null))try{var T=s.lastRenderedState,A=g(T,c);if(m.hasEagerState=!0,m.eagerState=A,Rn(A,T))return yf(a,s,m,0),Wt===null&&_f(),!1}catch{}finally{}if(c=Ed(a,s,m,f),c!==null)return En(c,a,f),n_(c,s,f),!0}return!1}function i1(a,s,c,f){if(f={lane:2,revertLane:B1(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},jf(a)){if(s)throw Error(n(479))}else s=Ed(a,c,f,2),s!==null&&En(s,a,2)}function jf(a){var s=a.alternate;return a===ct||s!==null&&s===ct}function r_(a,s){Vl=Ff=!0;var c=a.pending;c===null?s.next=s:(s.next=c.next,c.next=s),a.pending=s}function n_(a,s,c){if((c&4194048)!==0){var f=s.lanes;f&=a.pendingLanes,c|=f,s.lanes=c,Sl(a,c)}}var go={readContext:Hr,use:Lf,useCallback:lr,useContext:lr,useEffect:lr,useImperativeHandle:lr,useLayoutEffect:lr,useInsertionEffect:lr,useMemo:lr,useReducer:lr,useRef:lr,useState:lr,useDebugValue:lr,useDeferredValue:lr,useTransition:lr,useSyncExternalStore:lr,useId:lr,useHostTransitionStatus:lr,useFormState:lr,useActionState:lr,useOptimistic:lr,useMemoCache:lr,useCacheRefresh:lr};go.useEffectEvent=lr;var a_={readContext:Hr,use:Lf,useCallback:function(a,s){return un().memoizedState=[a,s===void 0?null:s],a},useContext:Hr,useEffect:Hv,useImperativeHandle:function(a,s,c){c=c!=null?c.concat([a]):null,Pf(4194308,4,Wv.bind(null,s,a),c)},useLayoutEffect:function(a,s){return Pf(4194308,4,a,s)},useInsertionEffect:function(a,s){Pf(4,2,a,s)},useMemo:function(a,s){var c=un();s=s===void 0?null:s;var f=a();if(Ls){ha(!0);try{a()}finally{ha(!1)}}return c.memoizedState=[f,s],f},useReducer:function(a,s,c){var f=un();if(c!==void 0){var m=c(s);if(Ls){ha(!0);try{c(s)}finally{ha(!1)}}}else m=s;return f.memoizedState=f.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},f.queue=a,a=a.dispatch=T3.bind(null,ct,a),[f.memoizedState,a]},useRef:function(a){var s=un();return a={current:a},s.memoizedState=a},useState:function(a){a=Zd(a);var s=a.queue,c=t_.bind(null,ct,s);return s.dispatch=c,[a.memoizedState,c]},useDebugValue:t1,useDeferredValue:function(a,s){var c=un();return r1(c,a,s)},useTransition:function(){var a=Zd(!1);return a=$v.bind(null,ct,a.queue,!0,!1),un().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,c){var f=ct,m=un();if(Tt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),Wt===null)throw Error(n(349));(yt&127)!==0||bv(f,s,c)}m.memoizedState=c;var g={value:c,getSnapshot:s};return m.queue=g,Hv(kv.bind(null,f,g,a),[a]),f.flags|=2048,Wl(9,{destroy:void 0},Cv.bind(null,f,g,c,s),null),c},useId:function(){var a=un(),s=Wt.identifierPrefix;if(Tt){var c=Na,f=Aa;c=(f&~(1<<32-on(f)-1)).toString(32)+c,s="_"+s+"R_"+c,c=If++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=g3++,s="_"+s+"r_"+c.toString(32)+"_";return a.memoizedState=s},useHostTransitionStatus:a1,useFormState:Lv,useActionState:Lv,useOptimistic:function(a){var s=un();s.memoizedState=s.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=i1.bind(null,ct,!0,c),c.dispatch=s,[a,s]},useMemoCache:Kd,useCacheRefresh:function(){return un().memoizedState=E3.bind(null,ct)},useEffectEvent:function(a){var s=un(),c={impl:a};return s.memoizedState=c,function(){if((Ft&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},s1={readContext:Hr,use:Lf,useCallback:qv,useContext:Hr,useEffect:e1,useImperativeHandle:Xv,useInsertionEffect:Vv,useLayoutEffect:Gv,useMemo:Yv,useReducer:Bf,useRef:jv,useState:function(){return Bf(Ja)},useDebugValue:t1,useDeferredValue:function(a,s){var c=pr();return Kv(c,jt.memoizedState,a,s)},useTransition:function(){var a=Bf(Ja)[0],s=pr().memoizedState;return[typeof a=="boolean"?a:mo(a),s]},useSyncExternalStore:Sv,useId:Jv,useHostTransitionStatus:a1,useFormState:Bv,useActionState:Bv,useOptimistic:function(a,s){var c=pr();return Dv(c,jt,a,s)},useMemoCache:Kd,useCacheRefresh:e_};s1.useEffectEvent=zv;var i_={readContext:Hr,use:Lf,useCallback:qv,useContext:Hr,useEffect:e1,useImperativeHandle:Xv,useInsertionEffect:Vv,useLayoutEffect:Gv,useMemo:Yv,useReducer:Qd,useRef:jv,useState:function(){return Qd(Ja)},useDebugValue:t1,useDeferredValue:function(a,s){var c=pr();return jt===null?r1(c,a,s):Kv(c,jt.memoizedState,a,s)},useTransition:function(){var a=Qd(Ja)[0],s=pr().memoizedState;return[typeof a=="boolean"?a:mo(a),s]},useSyncExternalStore:Sv,useId:Jv,useHostTransitionStatus:a1,useFormState:Uv,useActionState:Uv,useOptimistic:function(a,s){var c=pr();return jt!==null?Dv(c,jt,a,s):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:Kd,useCacheRefresh:e_};i_.useEffectEvent=zv;function l1(a,s,c,f){s=a.memoizedState,c=c(f,s),c=c==null?s:x({},s,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var c1={enqueueSetState:function(a,s,c){a=a._reactInternals;var f=Bn(),m=Ri(f);m.payload=s,c!=null&&(m.callback=c),s=Oi(a,m,f),s!==null&&(En(s,a,f),oo(s,a,f))},enqueueReplaceState:function(a,s,c){a=a._reactInternals;var f=Bn(),m=Ri(f);m.tag=1,m.payload=s,c!=null&&(m.callback=c),s=Oi(a,m,f),s!==null&&(En(s,a,f),oo(s,a,f))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var c=Bn(),f=Ri(c);f.tag=2,s!=null&&(f.callback=s),s=Oi(a,f,c),s!==null&&(En(s,a,c),oo(s,a,c))}};function s_(a,s,c,f,m,g,T){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,g,T):s.prototype&&s.prototype.isPureReactComponent?!to(c,f)||!to(m,g):!0}function l_(a,s,c,f){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==a&&c1.enqueueReplaceState(s,s.state,null)}function Bs(a,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(a=a.defaultProps){c===s&&(c=x({},c));for(var m in a)c[m]===void 0&&(c[m]=a[m])}return c}function c_(a){vf(a)}function o_(a){console.error(a)}function u_(a){vf(a)}function Hf(a,s){try{var c=a.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function f_(a,s,c){try{var f=a.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function o1(a,s,c){return c=Ri(c),c.tag=3,c.payload={element:null},c.callback=function(){Hf(a,s)},c}function h_(a){return a=Ri(a),a.tag=3,a}function d_(a,s,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var g=f.value;a.payload=function(){return m(g)},a.callback=function(){f_(s,c,f)}}var T=c.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(a.callback=function(){f_(s,c,f),typeof m!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var A=f.stack;this.componentDidCatch(f.value,{componentStack:A!==null?A:""})})}function S3(a,s,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&Bl(s,c,m,!0),c=Fn.current,c!==null){switch(c.tag){case 31:case 13:return Jn===null?Jf():c.alternate===null&&cr===0&&(cr=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===Af?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),I1(a,f,m)),!1;case 22:return c.flags|=65536,f===Af?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),I1(a,f,m)),!1}throw Error(n(435,c.tag))}return I1(a,f,m),Jf(),!1}if(Tt)return s=Fn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=m,f!==Ad&&(a=Error(n(422),{cause:f}),ao(Kn(a,c)))):(f!==Ad&&(s=Error(n(423),{cause:f}),ao(Kn(s,c))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,f=Kn(f,c),m=o1(a.stateNode,f,m),Ud(a,m),cr!==4&&(cr=2)),!1;var g=Error(n(520),{cause:f});if(g=Kn(g,c),So===null?So=[g]:So.push(g),cr!==4&&(cr=2),s===null)return!0;f=Kn(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,a=m&-m,c.lanes|=a,a=o1(c.stateNode,f,a),Ud(c,a),!1;case 1:if(s=c.type,g=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Pi===null||!Pi.has(g))))return c.flags|=65536,m&=-m,c.lanes|=m,m=h_(m),d_(m,a,c,f),Ud(c,m),!1}c=c.return}while(c!==null);return!1}var u1=Error(n(461)),wr=!1;function zr(a,s,c,f){s.child=a===null?xv(s,null,c,f):Ms(s,a.child,c,f)}function m_(a,s,c,f,m){c=c.render;var g=s.ref;if("ref"in f){var T={};for(var A in f)A!=="ref"&&(T[A]=f[A])}else T=f;return Rs(s),f=Wd(a,s,c,T,g,m),A=Xd(),a!==null&&!wr?(qd(a,s,m),ei(a,s,m)):(Tt&&A&&Cd(s),s.flags|=1,zr(a,s,f,m),s.child)}function p_(a,s,c,f,m){if(a===null){var g=c.type;return typeof g=="function"&&!Td(g)&&g.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=g,g_(a,s,g,f,m)):(a=Ef(c.type,null,f,s,s.mode,m),a.ref=s.ref,a.return=s,s.child=a)}if(g=a.child,!v1(a,m)){var T=g.memoizedProps;if(c=c.compare,c=c!==null?c:to,c(T,f)&&a.ref===s.ref)return ei(a,s,m)}return s.flags|=1,a=Ya(g,f),a.ref=s.ref,a.return=s,s.child=a}function g_(a,s,c,f,m){if(a!==null){var g=a.memoizedProps;if(to(g,f)&&a.ref===s.ref)if(wr=!1,s.pendingProps=f=g,v1(a,m))(a.flags&131072)!==0&&(wr=!0);else return s.lanes=a.lanes,ei(a,s,m)}return f1(a,s,c,f,m)}function x_(a,s,c,f){var m=f.children,g=a!==null?a.memoizedState:null;if(a===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((s.flags&128)!==0){if(g=g!==null?g.baseLanes|c:c,a!==null){for(f=s.child=a.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;f=m&~g}else f=0,s.child=null;return v_(a,s,g,c,f)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&Cf(s,g!==null?g.cachePool:null),g!==null?yv(s,g):Hd(),wv(s);else return f=s.lanes=536870912,v_(a,s,g!==null?g.baseLanes|c:c,c,f)}else g!==null?(Cf(s,g.cachePool),yv(s,g),Ii(),s.memoizedState=null):(a!==null&&Cf(s,null),Hd(),Ii());return zr(a,s,m,c),s.child}function xo(a,s){return a!==null&&a.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function v_(a,s,c,f,m){var g=Md();return g=g===null?null:{parent:_r._currentValue,pool:g},s.memoizedState={baseLanes:c,cachePool:g},a!==null&&Cf(s,null),Hd(),wv(s),a!==null&&Bl(a,s,f,!0),s.childLanes=m,null}function zf(a,s){return s=Gf({mode:s.mode,children:s.children},a.mode),s.ref=a.ref,a.child=s,s.return=a,s}function __(a,s,c){return Ms(s,a.child,null,c),a=zf(s,s.pendingProps),a.flags|=2,In(s),s.memoizedState=null,a}function b3(a,s,c){var f=s.pendingProps,m=(s.flags&128)!==0;if(s.flags&=-129,a===null){if(Tt){if(f.mode==="hidden")return a=zf(s,f),s.lanes=536870912,xo(null,a);if(Vd(s),(a=Qt)?(a=R2(a,Zn),a=a!==null&&a.data==="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:Ci!==null?{id:Aa,overflow:Na}:null,retryLane:536870912,hydrationErrors:null},c=rv(a),c.return=s,s.child=c,jr=s,Qt=null)):a=null,a===null)throw Ai(s);return s.lanes=536870912,null}return zf(s,f)}var g=a.memoizedState;if(g!==null){var T=g.dehydrated;if(Vd(s),m)if(s.flags&256)s.flags&=-257,s=__(a,s,c);else if(s.memoizedState!==null)s.child=a.child,s.flags|=128,s=null;else throw Error(n(558));else if(wr||Bl(a,s,c,!1),m=(c&a.childLanes)!==0,wr||m){if(f=Wt,f!==null&&(T=cf(f,c),T!==0&&T!==g.retryLane))throw g.retryLane=T,ks(a,T),En(f,a,T),u1;Jf(),s=__(a,s,c)}else a=g.treeContext,Qt=ea(T.nextSibling),jr=s,Tt=!0,ki=null,Zn=!1,a!==null&&iv(s,a),s=zf(s,f),s.flags|=4096;return s}return a=Ya(a.child,{mode:f.mode,children:f.children}),a.ref=s.ref,s.child=a,a.return=s,a}function Vf(a,s){var c=s.ref;if(c===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(s.flags|=4194816)}}function f1(a,s,c,f,m){return Rs(s),c=Wd(a,s,c,f,void 0,m),f=Xd(),a!==null&&!wr?(qd(a,s,m),ei(a,s,m)):(Tt&&f&&Cd(s),s.flags|=1,zr(a,s,c,m),s.child)}function y_(a,s,c,f,m,g){return Rs(s),s.updateQueue=null,c=Tv(s,f,c,m),Ev(a),f=Xd(),a!==null&&!wr?(qd(a,s,g),ei(a,s,g)):(Tt&&f&&Cd(s),s.flags|=1,zr(a,s,c,g),s.child)}function w_(a,s,c,f,m){if(Rs(s),s.stateNode===null){var g=Fl,T=c.contextType;typeof T=="object"&&T!==null&&(g=Hr(T)),g=new c(f,g),s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=c1,s.stateNode=g,g._reactInternals=s,g=s.stateNode,g.props=f,g.state=s.memoizedState,g.refs={},Bd(s),T=c.contextType,g.context=typeof T=="object"&&T!==null?Hr(T):Fl,g.state=s.memoizedState,T=c.getDerivedStateFromProps,typeof T=="function"&&(l1(s,c,T,f),g.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&c1.enqueueReplaceState(g,g.state,null),fo(s,f,g,m),uo(),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(a===null){g=s.stateNode;var A=s.memoizedProps,V=Bs(c,A);g.props=V;var ae=g.context,ge=c.contextType;T=Fl,typeof ge=="object"&&ge!==null&&(T=Hr(ge));var Ee=c.getDerivedStateFromProps;ge=typeof Ee=="function"||typeof g.getSnapshotBeforeUpdate=="function",A=s.pendingProps!==A,ge||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(A||ae!==T)&&l_(s,g,f,T),Di=!1;var ce=s.memoizedState;g.state=ce,fo(s,f,g,m),uo(),ae=s.memoizedState,A||ce!==ae||Di?(typeof Ee=="function"&&(l1(s,c,Ee,f),ae=s.memoizedState),(V=Di||s_(s,c,V,f,ce,ae,T))?(ge||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(s.flags|=4194308)):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=ae),g.props=f,g.state=ae,g.context=T,f=V):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{g=s.stateNode,Pd(a,s),T=s.memoizedProps,ge=Bs(c,T),g.props=ge,Ee=s.pendingProps,ce=g.context,ae=c.contextType,V=Fl,typeof ae=="object"&&ae!==null&&(V=Hr(ae)),A=c.getDerivedStateFromProps,(ae=typeof A=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==Ee||ce!==V)&&l_(s,g,f,V),Di=!1,ce=s.memoizedState,g.state=ce,fo(s,f,g,m),uo();var he=s.memoizedState;T!==Ee||ce!==he||Di||a!==null&&a.dependencies!==null&&Sf(a.dependencies)?(typeof A=="function"&&(l1(s,c,A,f),he=s.memoizedState),(ge=Di||s_(s,c,ge,f,ce,he,V)||a!==null&&a.dependencies!==null&&Sf(a.dependencies))?(ae||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(f,he,V),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(f,he,V)),typeof g.componentDidUpdate=="function"&&(s.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===a.memoizedProps&&ce===a.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===a.memoizedProps&&ce===a.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=he),g.props=f,g.state=he,g.context=V,f=ge):(typeof g.componentDidUpdate!="function"||T===a.memoizedProps&&ce===a.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===a.memoizedProps&&ce===a.memoizedState||(s.flags|=1024),f=!1)}return g=f,Vf(a,s),f=(s.flags&128)!==0,g||f?(g=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:g.render(),s.flags|=1,a!==null&&f?(s.child=Ms(s,a.child,null,m),s.child=Ms(s,null,c,m)):zr(a,s,c,m),s.memoizedState=g.state,a=s.child):a=ei(a,s,m),a}function E_(a,s,c,f){return Ns(),s.flags|=256,zr(a,s,c,f),s.child}var h1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function d1(a){return{baseLanes:a,cachePool:fv()}}function m1(a,s,c){return a=a!==null?a.childLanes&~c:0,s&&(a|=Ln),a}function T_(a,s,c){var f=s.pendingProps,m=!1,g=(s.flags&128)!==0,T;if((T=g)||(T=a!==null&&a.memoizedState===null?!1:(mr.current&2)!==0),T&&(m=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,a===null){if(Tt){if(m?Fi(s):Ii(),(a=Qt)?(a=R2(a,Zn),a=a!==null&&a.data!=="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:Ci!==null?{id:Aa,overflow:Na}:null,retryLane:536870912,hydrationErrors:null},c=rv(a),c.return=s,s.child=c,jr=s,Qt=null)):a=null,a===null)throw Ai(s);return $1(a)?s.lanes=32:s.lanes=536870912,null}var A=f.children;return f=f.fallback,m?(Ii(),m=s.mode,A=Gf({mode:"hidden",children:A},m),f=As(f,m,c,null),A.return=s,f.return=s,A.sibling=f,s.child=A,f=s.child,f.memoizedState=d1(c),f.childLanes=m1(a,T,c),s.memoizedState=h1,xo(null,f)):(Fi(s),p1(s,A))}var V=a.memoizedState;if(V!==null&&(A=V.dehydrated,A!==null)){if(g)s.flags&256?(Fi(s),s.flags&=-257,s=g1(a,s,c)):s.memoizedState!==null?(Ii(),s.child=a.child,s.flags|=128,s=null):(Ii(),A=f.fallback,m=s.mode,f=Gf({mode:"visible",children:f.children},m),A=As(A,m,c,null),A.flags|=2,f.return=s,A.return=s,f.sibling=A,s.child=f,Ms(s,a.child,null,c),f=s.child,f.memoizedState=d1(c),f.childLanes=m1(a,T,c),s.memoizedState=h1,s=xo(null,f));else if(Fi(s),$1(A)){if(T=A.nextSibling&&A.nextSibling.dataset,T)var ae=T.dgst;T=ae,f=Error(n(419)),f.stack="",f.digest=T,ao({value:f,source:null,stack:null}),s=g1(a,s,c)}else if(wr||Bl(a,s,c,!1),T=(c&a.childLanes)!==0,wr||T){if(T=Wt,T!==null&&(f=cf(T,c),f!==0&&f!==V.retryLane))throw V.retryLane=f,ks(a,f),En(T,a,f),u1;K1(A)||Jf(),s=g1(a,s,c)}else K1(A)?(s.flags|=192,s.child=a.child,s=null):(a=V.treeContext,Qt=ea(A.nextSibling),jr=s,Tt=!0,ki=null,Zn=!1,a!==null&&iv(s,a),s=p1(s,f.children),s.flags|=4096);return s}return m?(Ii(),A=f.fallback,m=s.mode,V=a.child,ae=V.sibling,f=Ya(V,{mode:"hidden",children:f.children}),f.subtreeFlags=V.subtreeFlags&65011712,ae!==null?A=Ya(ae,A):(A=As(A,m,c,null),A.flags|=2),A.return=s,f.return=s,f.sibling=A,s.child=f,xo(null,f),f=s.child,A=a.child.memoizedState,A===null?A=d1(c):(m=A.cachePool,m!==null?(V=_r._currentValue,m=m.parent!==V?{parent:V,pool:V}:m):m=fv(),A={baseLanes:A.baseLanes|c,cachePool:m}),f.memoizedState=A,f.childLanes=m1(a,T,c),s.memoizedState=h1,xo(a.child,f)):(Fi(s),c=a.child,a=c.sibling,c=Ya(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,a!==null&&(T=s.deletions,T===null?(s.deletions=[a],s.flags|=16):T.push(a)),s.child=c,s.memoizedState=null,c)}function p1(a,s){return s=Gf({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Gf(a,s){return a=On(22,a,null,s),a.lanes=0,a}function g1(a,s,c){return Ms(s,a.child,null,c),a=p1(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function S_(a,s,c){a.lanes|=s;var f=a.alternate;f!==null&&(f.lanes|=s),Rd(a.return,s,c)}function x1(a,s,c,f,m,g){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m,treeForkCount:g}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=f,T.tail=c,T.tailMode=m,T.treeForkCount=g)}function b_(a,s,c){var f=s.pendingProps,m=f.revealOrder,g=f.tail;f=f.children;var T=mr.current,A=(T&2)!==0;if(A?(T=T&1|2,s.flags|=128):T&=1,P(mr,T),zr(a,s,f,c),f=Tt?no:0,!A&&a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&S_(a,c,s);else if(a.tag===19)S_(a,c,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(m){case"forwards":for(c=s.child,m=null;c!==null;)a=c.alternate,a!==null&&Of(a)===null&&(m=c),c=c.sibling;c=m,c===null?(m=s.child,s.child=null):(m=c.sibling,c.sibling=null),x1(s,!1,m,c,g,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,m=s.child,s.child=null;m!==null;){if(a=m.alternate,a!==null&&Of(a)===null){s.child=m;break}a=m.sibling,m.sibling=c,c=m,m=a}x1(s,!0,c,null,g,f);break;case"together":x1(s,!1,null,null,void 0,f);break;default:s.memoizedState=null}return s.child}function ei(a,s,c){if(a!==null&&(s.dependencies=a.dependencies),Bi|=s.lanes,(c&s.childLanes)===0)if(a!==null){if(Bl(a,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,c=Ya(a,a.pendingProps),s.child=c,c.return=s;a.sibling!==null;)a=a.sibling,c=c.sibling=Ya(a,a.pendingProps),c.return=s;c.sibling=null}return s.child}function v1(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&Sf(a)))}function C3(a,s,c){switch(s.tag){case 3:Te(s,s.stateNode.containerInfo),Ni(s,_r,a.memoizedState.cache),Ns();break;case 27:case 5:we(s);break;case 4:Te(s,s.stateNode.containerInfo);break;case 10:Ni(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Vd(s),null;break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(Fi(s),s.flags|=128,null):(c&s.child.childLanes)!==0?T_(a,s,c):(Fi(s),a=ei(a,s,c),a!==null?a.sibling:null);Fi(s);break;case 19:var m=(a.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(Bl(a,s,c,!1),f=(c&s.childLanes)!==0),m){if(f)return b_(a,s,c);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),P(mr,mr.current),f)break;return null;case 22:return s.lanes=0,x_(a,s,c,s.pendingProps);case 24:Ni(s,_r,a.memoizedState.cache)}return ei(a,s,c)}function C_(a,s,c){if(a!==null)if(a.memoizedProps!==s.pendingProps)wr=!0;else{if(!v1(a,c)&&(s.flags&128)===0)return wr=!1,C3(a,s,c);wr=(a.flags&131072)!==0}else wr=!1,Tt&&(s.flags&1048576)!==0&&av(s,no,s.index);switch(s.lanes=0,s.tag){case 16:e:{var f=s.pendingProps;if(a=Fs(s.elementType),s.type=a,typeof a=="function")Td(a)?(f=Bs(a,f),s.tag=1,s=w_(null,s,a,f,c)):(s.tag=0,s=f1(null,s,a,f,c));else{if(a!=null){var m=a.$$typeof;if(m===z){s.tag=11,s=m_(null,s,a,f,c);break e}else if(m===R){s.tag=14,s=p_(null,s,a,f,c);break e}}throw s=Ie(a)||a,Error(n(306,s,""))}}return s;case 0:return f1(a,s,s.type,s.pendingProps,c);case 1:return f=s.type,m=Bs(f,s.pendingProps),w_(a,s,f,m,c);case 3:e:{if(Te(s,s.stateNode.containerInfo),a===null)throw Error(n(387));f=s.pendingProps;var g=s.memoizedState;m=g.element,Pd(a,s),fo(s,f,null,c);var T=s.memoizedState;if(f=T.cache,Ni(s,_r,f),f!==g.cache&&Od(s,[_r],c,!0),uo(),f=T.element,g.isDehydrated)if(g={element:f,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=g,s.memoizedState=g,s.flags&256){s=E_(a,s,f,c);break e}else if(f!==m){m=Kn(Error(n(424)),s),ao(m),s=E_(a,s,f,c);break e}else{switch(a=s.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Qt=ea(a.firstChild),jr=s,Tt=!0,ki=null,Zn=!0,c=xv(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Ns(),f===m){s=ei(a,s,c);break e}zr(a,s,f,c)}s=s.child}return s;case 26:return Vf(a,s),a===null?(c=B2(s.type,null,s.pendingProps,null))?s.memoizedState=c:Tt||(c=s.type,a=s.pendingProps,f=s0(ee.current).createElement(c),f[O]=s,f[F]=a,Vr(f,c,a),He(f),s.stateNode=f):s.memoizedState=B2(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return we(s),a===null&&Tt&&(f=s.stateNode=I2(s.type,s.pendingProps,ee.current),jr=s,Zn=!0,m=Qt,zi(s.type)?(Q1=m,Qt=ea(f.firstChild)):Qt=m),zr(a,s,s.pendingProps.children,c),Vf(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&Tt&&((m=f=Qt)&&(f=rk(f,s.type,s.pendingProps,Zn),f!==null?(s.stateNode=f,jr=s,Qt=ea(f.firstChild),Zn=!1,m=!0):m=!1),m||Ai(s)),we(s),m=s.type,g=s.pendingProps,T=a!==null?a.memoizedProps:null,f=g.children,X1(m,g)?f=null:T!==null&&X1(m,T)&&(s.flags|=32),s.memoizedState!==null&&(m=Wd(a,s,x3,null,null,c),Oo._currentValue=m),Vf(a,s),zr(a,s,f,c),s.child;case 6:return a===null&&Tt&&((a=c=Qt)&&(c=nk(c,s.pendingProps,Zn),c!==null?(s.stateNode=c,jr=s,Qt=null,a=!0):a=!1),a||Ai(s)),null;case 13:return T_(a,s,c);case 4:return Te(s,s.stateNode.containerInfo),f=s.pendingProps,a===null?s.child=Ms(s,null,f,c):zr(a,s,f,c),s.child;case 11:return m_(a,s,s.type,s.pendingProps,c);case 7:return zr(a,s,s.pendingProps,c),s.child;case 8:return zr(a,s,s.pendingProps.children,c),s.child;case 12:return zr(a,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,Ni(s,s.type,f.value),zr(a,s,f.children,c),s.child;case 9:return m=s.type._context,f=s.pendingProps.children,Rs(s),m=Hr(m),f=f(m),s.flags|=1,zr(a,s,f,c),s.child;case 14:return p_(a,s,s.type,s.pendingProps,c);case 15:return g_(a,s,s.type,s.pendingProps,c);case 19:return b_(a,s,c);case 31:return b3(a,s,c);case 22:return x_(a,s,c,s.pendingProps);case 24:return Rs(s),f=Hr(_r),a===null?(m=Md(),m===null&&(m=Wt,g=Fd(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=c),m=g),s.memoizedState={parent:f,cache:m},Bd(s),Ni(s,_r,m)):((a.lanes&c)!==0&&(Pd(a,s),fo(s,null,null,c),uo()),m=a.memoizedState,g=s.memoizedState,m.parent!==f?(m={parent:f,cache:f},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),Ni(s,_r,f)):(f=g.cache,Ni(s,_r,f),f!==m.cache&&Od(s,[_r],c,!0))),zr(a,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function ti(a){a.flags|=4}function _1(a,s,c,f,m){if((s=(a.mode&32)!==0)&&(s=!1),s){if(a.flags|=16777216,(m&335544128)===m)if(a.stateNode.complete)a.flags|=8192;else if(J_())a.flags|=8192;else throw Is=Af,Ld}else a.flags&=-16777217}function k_(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!z2(s))if(J_())a.flags|=8192;else throw Is=Af,Ld}function Wf(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?sf():536870912,a.lanes|=s,Kl|=s)}function vo(a,s){if(!Tt)switch(a.tailMode){case"hidden":s=a.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function Zt(a){var s=a.alternate!==null&&a.alternate.child===a.child,c=0,f=0;if(s)for(var m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=c,s}function k3(a,s,c){var f=s.pendingProps;switch(kd(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(s),null;case 1:return Zt(s),null;case 3:return c=s.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Qa(_r),me(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(Ll(s)?ti(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Nd())),Zt(s),null;case 26:var m=s.type,g=s.memoizedState;return a===null?(ti(s),g!==null?(Zt(s),k_(s,g)):(Zt(s),_1(s,m,null,f,c))):g?g!==a.memoizedState?(ti(s),Zt(s),k_(s,g)):(Zt(s),s.flags&=-16777217):(a=a.memoizedProps,a!==f&&ti(s),Zt(s),_1(s,m,a,f,c)),null;case 27:if($e(s),c=ee.current,m=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&ti(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Zt(s),null}a=M.current,Ll(s)?sv(s):(a=I2(m,f,c),s.stateNode=a,ti(s))}return Zt(s),null;case 5:if($e(s),m=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&ti(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Zt(s),null}if(g=M.current,Ll(s))sv(s);else{var T=s0(ee.current);switch(g){case 1:g=T.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:g=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":g=T.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":g=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":g=T.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof f.is=="string"?T.createElement("select",{is:f.is}):T.createElement("select"),f.multiple?g.multiple=!0:f.size&&(g.size=f.size);break;default:g=typeof f.is=="string"?T.createElement(m,{is:f.is}):T.createElement(m)}}g[O]=s,g[F]=f;e:for(T=s.child;T!==null;){if(T.tag===5||T.tag===6)g.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===s)break e;for(;T.sibling===null;){if(T.return===null||T.return===s)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}s.stateNode=g;e:switch(Vr(g,m,f),m){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&ti(s)}}return Zt(s),_1(s,s.type,a===null?null:a.memoizedProps,s.pendingProps,c),null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==f&&ti(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(a=ee.current,Ll(s)){if(a=s.stateNode,c=s.memoizedProps,f=null,m=jr,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}a[O]=s,a=!!(a.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||T2(a.nodeValue,c)),a||Ai(s,!0)}else a=s0(a).createTextNode(f),a[O]=s,s.stateNode=a}return Zt(s),null;case 31:if(c=s.memoizedState,a===null||a.memoizedState!==null){if(f=Ll(s),c!==null){if(a===null){if(!f)throw Error(n(318));if(a=s.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[O]=s}else Ns(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Zt(s),a=!1}else c=Nd(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return s.flags&256?(In(s),s):(In(s),null);if((s.flags&128)!==0)throw Error(n(558))}return Zt(s),null;case 13:if(f=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=Ll(s),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[O]=s}else Ns(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Zt(s),m=!1}else m=Nd(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return s.flags&256?(In(s),s):(In(s),null)}return In(s),(s.flags&128)!==0?(s.lanes=c,s):(c=f!==null,a=a!==null&&a.memoizedState!==null,c&&(f=s.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool),g=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(g=f.memoizedState.cachePool.pool),g!==m&&(f.flags|=2048)),c!==a&&c&&(s.child.flags|=8192),Wf(s,s.updateQueue),Zt(s),null);case 4:return me(),a===null&&H1(s.stateNode.containerInfo),Zt(s),null;case 10:return Qa(s.type),Zt(s),null;case 19:if(k(mr),f=s.memoizedState,f===null)return Zt(s),null;if(m=(s.flags&128)!==0,g=f.rendering,g===null)if(m)vo(f,!1);else{if(cr!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(g=Of(a),g!==null){for(s.flags|=128,vo(f,!1),a=g.updateQueue,s.updateQueue=a,Wf(s,a),s.subtreeFlags=0,a=c,c=s.child;c!==null;)tv(c,a),c=c.sibling;return P(mr,mr.current&1|2),Tt&&Ka(s,f.treeForkCount),s.child}a=a.sibling}f.tail!==null&&Ot()>$f&&(s.flags|=128,m=!0,vo(f,!1),s.lanes=4194304)}else{if(!m)if(a=Of(g),a!==null){if(s.flags|=128,m=!0,a=a.updateQueue,s.updateQueue=a,Wf(s,a),vo(f,!0),f.tail===null&&f.tailMode==="hidden"&&!g.alternate&&!Tt)return Zt(s),null}else 2*Ot()-f.renderingStartTime>$f&&c!==536870912&&(s.flags|=128,m=!0,vo(f,!1),s.lanes=4194304);f.isBackwards?(g.sibling=s.child,s.child=g):(a=f.last,a!==null?a.sibling=g:s.child=g,f.last=g)}return f.tail!==null?(a=f.tail,f.rendering=a,f.tail=a.sibling,f.renderingStartTime=Ot(),a.sibling=null,c=mr.current,P(mr,m?c&1|2:c&1),Tt&&Ka(s,f.treeForkCount),a):(Zt(s),null);case 22:case 23:return In(s),zd(),f=s.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&(Zt(s),s.subtreeFlags&6&&(s.flags|=8192)):Zt(s),c=s.updateQueue,c!==null&&Wf(s,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),a!==null&&k(Os),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Qa(_r),Zt(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function A3(a,s){switch(kd(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Qa(_r),me(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return $e(s),null;case 31:if(s.memoizedState!==null){if(In(s),s.alternate===null)throw Error(n(340));Ns()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 13:if(In(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Ns()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return k(mr),null;case 4:return me(),null;case 10:return Qa(s.type),null;case 22:case 23:return In(s),zd(),a!==null&&k(Os),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Qa(_r),null;case 25:return null;default:return null}}function A_(a,s){switch(kd(s),s.tag){case 3:Qa(_r),me();break;case 26:case 27:case 5:$e(s);break;case 4:me();break;case 31:s.memoizedState!==null&&In(s);break;case 13:In(s);break;case 19:k(mr);break;case 10:Qa(s.type);break;case 22:case 23:In(s),zd(),a!==null&&k(Os);break;case 24:Qa(_r)}}function _o(a,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&a)===a){f=void 0;var g=c.create,T=c.inst;f=g(),T.destroy=f}c=c.next}while(c!==m)}}catch(A){Lt(s,s.return,A)}}function Mi(a,s,c){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var g=m.next;f=g;do{if((f.tag&a)===a){var T=f.inst,A=T.destroy;if(A!==void 0){T.destroy=void 0,m=s;var V=c,ae=A;try{ae()}catch(ge){Lt(m,V,ge)}}}f=f.next}while(f!==g)}}catch(ge){Lt(s,s.return,ge)}}function N_(a){var s=a.updateQueue;if(s!==null){var c=a.stateNode;try{_v(s,c)}catch(f){Lt(a,a.return,f)}}}function D_(a,s,c){c.props=Bs(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(f){Lt(a,s,f)}}function yo(a,s){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof c=="function"?a.refCleanup=c(f):c.current=f}}catch(m){Lt(a,s,m)}}function Da(a,s){var c=a.ref,f=a.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){Lt(a,s,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Lt(a,s,m)}else c.current=null}function R_(a){var s=a.type,c=a.memoizedProps,f=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){Lt(a,a.return,m)}}function y1(a,s,c){try{var f=a.stateNode;$3(f,a.type,c,s),f[F]=s}catch(m){Lt(a,a.return,m)}}function O_(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&zi(a.type)||a.tag===4}function w1(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||O_(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&zi(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function E1(a,s,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(a),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Xa));else if(f!==4&&(f===27&&zi(a.type)&&(c=a.stateNode,s=null),a=a.child,a!==null))for(E1(a,s,c),a=a.sibling;a!==null;)E1(a,s,c),a=a.sibling}function Xf(a,s,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?c.insertBefore(a,s):c.appendChild(a);else if(f!==4&&(f===27&&zi(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(Xf(a,s,c),a=a.sibling;a!==null;)Xf(a,s,c),a=a.sibling}function F_(a){var s=a.stateNode,c=a.memoizedProps;try{for(var f=a.type,m=s.attributes;m.length;)s.removeAttributeNode(m[0]);Vr(s,f,c),s[O]=a,s[F]=c}catch(g){Lt(a,a.return,g)}}var ri=!1,Er=!1,T1=!1,I_=typeof WeakSet=="function"?WeakSet:Set,Rr=null;function N3(a,s){if(a=a.containerInfo,G1=d0,a=Xx(a),gd(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,g=f.focusNode;f=f.focusOffset;try{c.nodeType,g.nodeType}catch{c=null;break e}var T=0,A=-1,V=-1,ae=0,ge=0,Ee=a,ce=null;t:for(;;){for(var he;Ee!==c||m!==0&&Ee.nodeType!==3||(A=T+m),Ee!==g||f!==0&&Ee.nodeType!==3||(V=T+f),Ee.nodeType===3&&(T+=Ee.nodeValue.length),(he=Ee.firstChild)!==null;)ce=Ee,Ee=he;for(;;){if(Ee===a)break t;if(ce===c&&++ae===m&&(A=T),ce===g&&++ge===f&&(V=T),(he=Ee.nextSibling)!==null)break;Ee=ce,ce=Ee.parentNode}Ee=he}c=A===-1||V===-1?null:{start:A,end:V}}else c=null}c=c||{start:0,end:0}}else c=null;for(W1={focusedElem:a,selectionRange:c},d0=!1,Rr=s;Rr!==null;)if(s=Rr,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,Rr=a;else for(;Rr!==null;){switch(s=Rr,g=s.alternate,a=s.flags,s.tag){case 0:if((a&4)!==0&&(a=s.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)m=a[c],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&g!==null){a=void 0,c=s,m=g.memoizedProps,g=g.memoizedState,f=c.stateNode;try{var je=Bs(c.type,m);a=f.getSnapshotBeforeUpdate(je,g),f.__reactInternalSnapshotBeforeUpdate=a}catch(Ke){Lt(c,c.return,Ke)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,c=a.nodeType,c===9)Y1(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Y1(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,Rr=a;break}Rr=s.return}}function M_(a,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:ai(a,c),f&4&&_o(5,c);break;case 1:if(ai(a,c),f&4)if(a=c.stateNode,s===null)try{a.componentDidMount()}catch(T){Lt(c,c.return,T)}else{var m=Bs(c.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(m,s,a.__reactInternalSnapshotBeforeUpdate)}catch(T){Lt(c,c.return,T)}}f&64&&N_(c),f&512&&yo(c,c.return);break;case 3:if(ai(a,c),f&64&&(a=c.updateQueue,a!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{_v(a,s)}catch(T){Lt(c,c.return,T)}}break;case 27:s===null&&f&4&&F_(c);case 26:case 5:ai(a,c),s===null&&f&4&&R_(c),f&512&&yo(c,c.return);break;case 12:ai(a,c);break;case 31:ai(a,c),f&4&&P_(a,c);break;case 13:ai(a,c),f&4&&U_(a,c),f&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=P3.bind(null,c),ak(a,c))));break;case 22:if(f=c.memoizedState!==null||ri,!f){s=s!==null&&s.memoizedState!==null||Er,m=ri;var g=Er;ri=f,(Er=s)&&!g?ii(a,c,(c.subtreeFlags&8772)!==0):ai(a,c),ri=m,Er=g}break;case 30:break;default:ai(a,c)}}function L_(a){var s=a.alternate;s!==null&&(a.alternate=null,L_(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&ke(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var ar=null,vn=!1;function ni(a,s,c){for(c=c.child;c!==null;)B_(a,s,c),c=c.sibling}function B_(a,s,c){if(dr&&typeof dr.onCommitFiberUnmount=="function")try{dr.onCommitFiberUnmount(gt,c)}catch{}switch(c.tag){case 26:Er||Da(c,s),ni(a,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Er||Da(c,s);var f=ar,m=vn;zi(c.type)&&(ar=c.stateNode,vn=!1),ni(a,s,c),No(c.stateNode),ar=f,vn=m;break;case 5:Er||Da(c,s);case 6:if(f=ar,m=vn,ar=null,ni(a,s,c),ar=f,vn=m,ar!==null)if(vn)try{(ar.nodeType===9?ar.body:ar.nodeName==="HTML"?ar.ownerDocument.body:ar).removeChild(c.stateNode)}catch(g){Lt(c,s,g)}else try{ar.removeChild(c.stateNode)}catch(g){Lt(c,s,g)}break;case 18:ar!==null&&(vn?(a=ar,N2(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),nc(a)):N2(ar,c.stateNode));break;case 4:f=ar,m=vn,ar=c.stateNode.containerInfo,vn=!0,ni(a,s,c),ar=f,vn=m;break;case 0:case 11:case 14:case 15:Mi(2,c,s),Er||Mi(4,c,s),ni(a,s,c);break;case 1:Er||(Da(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&D_(c,s,f)),ni(a,s,c);break;case 21:ni(a,s,c);break;case 22:Er=(f=Er)||c.memoizedState!==null,ni(a,s,c),Er=f;break;default:ni(a,s,c)}}function P_(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{nc(a)}catch(c){Lt(s,s.return,c)}}}function U_(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{nc(a)}catch(c){Lt(s,s.return,c)}}function D3(a){switch(a.tag){case 31:case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new I_),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new I_),s;default:throw Error(n(435,a.tag))}}function qf(a,s){var c=D3(a);s.forEach(function(f){if(!c.has(f)){c.add(f);var m=U3.bind(null,a,f);f.then(m,m)}})}function _n(a,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],g=a,T=s,A=T;e:for(;A!==null;){switch(A.tag){case 27:if(zi(A.type)){ar=A.stateNode,vn=!1;break e}break;case 5:ar=A.stateNode,vn=!1;break e;case 3:case 4:ar=A.stateNode.containerInfo,vn=!0;break e}A=A.return}if(ar===null)throw Error(n(160));B_(g,T,m),ar=null,vn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)j_(s,a),s=s.sibling}var ma=null;function j_(a,s){var c=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:_n(s,a),yn(a),f&4&&(Mi(3,a,a.return),_o(3,a),Mi(5,a,a.return));break;case 1:_n(s,a),yn(a),f&512&&(Er||c===null||Da(c,c.return)),f&64&&ri&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=ma;if(_n(s,a),yn(a),f&512&&(Er||c===null||Da(c,c.return)),f&4){var g=c!==null?c.memoizedState:null;if(f=a.memoizedState,c===null)if(f===null)if(a.stateNode===null){e:{f=a.type,c=a.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":g=m.getElementsByTagName("title")[0],(!g||g[oe]||g[O]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(f),m.head.insertBefore(g,m.querySelector("head > title"))),Vr(g,f,c),g[O]=a,He(g),f=g;break e;case"link":var T=j2("link","href",m).get(f+(c.href||""));if(T){for(var A=0;A<T.length;A++)if(g=T[A],g.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&g.getAttribute("rel")===(c.rel==null?null:c.rel)&&g.getAttribute("title")===(c.title==null?null:c.title)&&g.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){T.splice(A,1);break t}}g=m.createElement(f),Vr(g,f,c),m.head.appendChild(g);break;case"meta":if(T=j2("meta","content",m).get(f+(c.content||""))){for(A=0;A<T.length;A++)if(g=T[A],g.getAttribute("content")===(c.content==null?null:""+c.content)&&g.getAttribute("name")===(c.name==null?null:c.name)&&g.getAttribute("property")===(c.property==null?null:c.property)&&g.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&g.getAttribute("charset")===(c.charSet==null?null:c.charSet)){T.splice(A,1);break t}}g=m.createElement(f),Vr(g,f,c),m.head.appendChild(g);break;default:throw Error(n(468,f))}g[O]=a,He(g),f=g}a.stateNode=f}else H2(m,a.type,a.stateNode);else a.stateNode=U2(m,f,a.memoizedProps);else g!==f?(g===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):g.count--,f===null?H2(m,a.type,a.stateNode):U2(m,f,a.memoizedProps)):f===null&&a.stateNode!==null&&y1(a,a.memoizedProps,c.memoizedProps)}break;case 27:_n(s,a),yn(a),f&512&&(Er||c===null||Da(c,c.return)),c!==null&&f&4&&y1(a,a.memoizedProps,c.memoizedProps);break;case 5:if(_n(s,a),yn(a),f&512&&(Er||c===null||Da(c,c.return)),a.flags&32){m=a.stateNode;try{Cl(m,"")}catch(je){Lt(a,a.return,je)}}f&4&&a.stateNode!=null&&(m=a.memoizedProps,y1(a,m,c!==null?c.memoizedProps:m)),f&1024&&(T1=!0);break;case 6:if(_n(s,a),yn(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,c=a.stateNode;try{c.nodeValue=f}catch(je){Lt(a,a.return,je)}}break;case 3:if(o0=null,m=ma,ma=l0(s.containerInfo),_n(s,a),ma=m,yn(a),f&4&&c!==null&&c.memoizedState.isDehydrated)try{nc(s.containerInfo)}catch(je){Lt(a,a.return,je)}T1&&(T1=!1,H_(a));break;case 4:f=ma,ma=l0(a.stateNode.containerInfo),_n(s,a),yn(a),ma=f;break;case 12:_n(s,a),yn(a);break;case 31:_n(s,a),yn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,qf(a,f)));break;case 13:_n(s,a),yn(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Kf=Ot()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,qf(a,f)));break;case 22:m=a.memoizedState!==null;var V=c!==null&&c.memoizedState!==null,ae=ri,ge=Er;if(ri=ae||m,Er=ge||V,_n(s,a),Er=ge,ri=ae,yn(a),f&8192)e:for(s=a.stateNode,s._visibility=m?s._visibility&-2:s._visibility|1,m&&(c===null||V||ri||Er||Ps(a)),c=null,s=a;;){if(s.tag===5||s.tag===26){if(c===null){V=c=s;try{if(g=V.stateNode,m)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{A=V.stateNode;var Ee=V.memoizedProps.style,ce=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;A.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(je){Lt(V,V.return,je)}}}else if(s.tag===6){if(c===null){V=s;try{V.stateNode.nodeValue=m?"":V.memoizedProps}catch(je){Lt(V,V.return,je)}}}else if(s.tag===18){if(c===null){V=s;try{var he=V.stateNode;m?D2(he,!0):D2(V.stateNode,!1)}catch(je){Lt(V,V.return,je)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=a.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,qf(a,c))));break;case 19:_n(s,a),yn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,qf(a,f)));break;case 30:break;case 21:break;default:_n(s,a),yn(a)}}function yn(a){var s=a.flags;if(s&2){try{for(var c,f=a.return;f!==null;){if(O_(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var m=c.stateNode,g=w1(a);Xf(a,g,m);break;case 5:var T=c.stateNode;c.flags&32&&(Cl(T,""),c.flags&=-33);var A=w1(a);Xf(a,A,T);break;case 3:case 4:var V=c.stateNode.containerInfo,ae=w1(a);E1(a,ae,V);break;default:throw Error(n(161))}}catch(ge){Lt(a,a.return,ge)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function H_(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;H_(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function ai(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)M_(a,s.alternate,s),s=s.sibling}function Ps(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:Mi(4,s,s.return),Ps(s);break;case 1:Da(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&D_(s,s.return,c),Ps(s);break;case 27:No(s.stateNode);case 26:case 5:Da(s,s.return),Ps(s);break;case 22:s.memoizedState===null&&Ps(s);break;case 30:Ps(s);break;default:Ps(s)}a=a.sibling}}function ii(a,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,m=a,g=s,T=g.flags;switch(g.tag){case 0:case 11:case 15:ii(m,g,c),_o(4,g);break;case 1:if(ii(m,g,c),f=g,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ae){Lt(f,f.return,ae)}if(f=g,m=f.updateQueue,m!==null){var A=f.stateNode;try{var V=m.shared.hiddenCallbacks;if(V!==null)for(m.shared.hiddenCallbacks=null,m=0;m<V.length;m++)vv(V[m],A)}catch(ae){Lt(f,f.return,ae)}}c&&T&64&&N_(g),yo(g,g.return);break;case 27:F_(g);case 26:case 5:ii(m,g,c),c&&f===null&&T&4&&R_(g),yo(g,g.return);break;case 12:ii(m,g,c);break;case 31:ii(m,g,c),c&&T&4&&P_(m,g);break;case 13:ii(m,g,c),c&&T&4&&U_(m,g);break;case 22:g.memoizedState===null&&ii(m,g,c),yo(g,g.return);break;case 30:break;default:ii(m,g,c)}s=s.sibling}}function S1(a,s){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&io(c))}function b1(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&io(a))}function pa(a,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)z_(a,s,c,f),s=s.sibling}function z_(a,s,c,f){var m=s.flags;switch(s.tag){case 0:case 11:case 15:pa(a,s,c,f),m&2048&&_o(9,s);break;case 1:pa(a,s,c,f);break;case 3:pa(a,s,c,f),m&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&io(a)));break;case 12:if(m&2048){pa(a,s,c,f),a=s.stateNode;try{var g=s.memoizedProps,T=g.id,A=g.onPostCommit;typeof A=="function"&&A(T,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(V){Lt(s,s.return,V)}}else pa(a,s,c,f);break;case 31:pa(a,s,c,f);break;case 13:pa(a,s,c,f);break;case 23:break;case 22:g=s.stateNode,T=s.alternate,s.memoizedState!==null?g._visibility&2?pa(a,s,c,f):wo(a,s):g._visibility&2?pa(a,s,c,f):(g._visibility|=2,Xl(a,s,c,f,(s.subtreeFlags&10256)!==0||!1)),m&2048&&S1(T,s);break;case 24:pa(a,s,c,f),m&2048&&b1(s.alternate,s);break;default:pa(a,s,c,f)}}function Xl(a,s,c,f,m){for(m=m&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var g=a,T=s,A=c,V=f,ae=T.flags;switch(T.tag){case 0:case 11:case 15:Xl(g,T,A,V,m),_o(8,T);break;case 23:break;case 22:var ge=T.stateNode;T.memoizedState!==null?ge._visibility&2?Xl(g,T,A,V,m):wo(g,T):(ge._visibility|=2,Xl(g,T,A,V,m)),m&&ae&2048&&S1(T.alternate,T);break;case 24:Xl(g,T,A,V,m),m&&ae&2048&&b1(T.alternate,T);break;default:Xl(g,T,A,V,m)}s=s.sibling}}function wo(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=a,f=s,m=f.flags;switch(f.tag){case 22:wo(c,f),m&2048&&S1(f.alternate,f);break;case 24:wo(c,f),m&2048&&b1(f.alternate,f);break;default:wo(c,f)}s=s.sibling}}var Eo=8192;function ql(a,s,c){if(a.subtreeFlags&Eo)for(a=a.child;a!==null;)V_(a,s,c),a=a.sibling}function V_(a,s,c){switch(a.tag){case 26:ql(a,s,c),a.flags&Eo&&a.memoizedState!==null&&gk(c,ma,a.memoizedState,a.memoizedProps);break;case 5:ql(a,s,c);break;case 3:case 4:var f=ma;ma=l0(a.stateNode.containerInfo),ql(a,s,c),ma=f;break;case 22:a.memoizedState===null&&(f=a.alternate,f!==null&&f.memoizedState!==null?(f=Eo,Eo=16777216,ql(a,s,c),Eo=f):ql(a,s,c));break;default:ql(a,s,c)}}function G_(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function To(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];Rr=f,X_(f,a)}G_(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)W_(a),a=a.sibling}function W_(a){switch(a.tag){case 0:case 11:case 15:To(a),a.flags&2048&&Mi(9,a,a.return);break;case 3:To(a);break;case 12:To(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,Yf(a)):To(a);break;default:To(a)}}function Yf(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];Rr=f,X_(f,a)}G_(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:Mi(8,s,s.return),Yf(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,Yf(s));break;default:Yf(s)}a=a.sibling}}function X_(a,s){for(;Rr!==null;){var c=Rr;switch(c.tag){case 0:case 11:case 15:Mi(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:io(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,Rr=f;else e:for(c=a;Rr!==null;){f=Rr;var m=f.sibling,g=f.return;if(L_(f),f===c){Rr=null;break e}if(m!==null){m.return=g,Rr=m;break e}Rr=g}}}var R3={getCacheForType:function(a){var s=Hr(_r),c=s.data.get(a);return c===void 0&&(c=a(),s.data.set(a,c)),c},cacheSignal:function(){return Hr(_r).controller.signal}},O3=typeof WeakMap=="function"?WeakMap:Map,Ft=0,Wt=null,xt=null,yt=0,Mt=0,Mn=null,Li=!1,Yl=!1,C1=!1,si=0,cr=0,Bi=0,Us=0,k1=0,Ln=0,Kl=0,So=null,wn=null,A1=!1,Kf=0,q_=0,$f=1/0,Qf=null,Pi=null,Cr=0,Ui=null,$l=null,li=0,N1=0,D1=null,Y_=null,bo=0,R1=null;function Bn(){return(Ft&2)!==0&&yt!==0?yt&-yt:Y.T!==null?B1():b()}function K_(){if(Ln===0)if((yt&536870912)===0||Tt){var a=wl;wl<<=1,(wl&3932160)===0&&(wl=262144),Ln=a}else Ln=536870912;return a=Fn.current,a!==null&&(a.flags|=32),Ln}function En(a,s,c){(a===Wt&&(Mt===2||Mt===9)||a.cancelPendingCommit!==null)&&(Ql(a,0),ji(a,yt,Ln,!1)),Es(a,c),((Ft&2)===0||a!==Wt)&&(a===Wt&&((Ft&2)===0&&(Us|=c),cr===4&&ji(a,yt,Ln,!1)),Ra(a))}function $_(a,s,c){if((Ft&6)!==0)throw Error(n(327));var f=!c&&(s&127)===0&&(s&a.expiredLanes)===0||ws(a,s),m=f?M3(a,s):F1(a,s,!0),g=f;do{if(m===0){Yl&&!f&&ji(a,s,0,!1);break}else{if(c=a.current.alternate,g&&!F3(c)){m=F1(a,s,!1),g=!1;continue}if(m===2){if(g=s,a.errorRecoveryDisabledLanes&g)var T=0;else T=a.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;e:{var A=a;m=So;var V=A.current.memoizedState.isDehydrated;if(V&&(Ql(A,T).flags|=256),T=F1(A,T,!1),T!==2){if(C1&&!V){A.errorRecoveryDisabledLanes|=g,Us|=g,m=4;break e}g=wn,wn=m,g!==null&&(wn===null?wn=g:wn.push.apply(wn,g))}m=T}if(g=!1,m!==2)continue}}if(m===1){Ql(a,0),ji(a,s,0,!0);break}e:{switch(f=a,g=m,g){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:ji(f,s,Ln,!Li);break e;case 2:wn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(m=Kf+300-Ot(),10<m)){if(ji(f,s,Ln,!Li),Tl(f,0,!0)!==0)break e;li=s,f.timeoutHandle=k2(Q_.bind(null,f,c,wn,Qf,A1,s,Ln,Us,Kl,Li,g,"Throttled",-0,0),m);break e}Q_(f,c,wn,Qf,A1,s,Ln,Us,Kl,Li,g,null,-0,0)}}break}while(!0);Ra(a)}function Q_(a,s,c,f,m,g,T,A,V,ae,ge,Ee,ce,he){if(a.timeoutHandle=-1,Ee=s.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xa},V_(s,g,Ee);var je=(g&62914560)===g?Kf-Ot():(g&4194048)===g?q_-Ot():0;if(je=xk(Ee,je),je!==null){li=g,a.cancelPendingCommit=je(i2.bind(null,a,s,g,c,f,m,T,A,V,ge,Ee,null,ce,he)),ji(a,g,T,!ae);return}}i2(a,s,g,c,f,m,T,A,V)}function F3(a){for(var s=a;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],g=m.getSnapshot;m=m.value;try{if(!Rn(g(),m))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ji(a,s,c,f){s&=~k1,s&=~Us,a.suspendedLanes|=s,a.pingedLanes&=~s,f&&(a.warmLanes|=s),f=a.expirationTimes;for(var m=s;0<m;){var g=31-on(m),T=1<<g;f[g]=-1,m&=~T}c!==0&&lf(a,c,s)}function Zf(){return(Ft&6)===0?(Co(0),!1):!0}function O1(){if(xt!==null){if(Mt===0)var a=xt.return;else a=xt,$a=Ds=null,Yd(a),Hl=null,lo=0,a=xt;for(;a!==null;)A_(a.alternate,a),a=a.return;xt=null}}function Ql(a,s){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,J3(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),li=0,O1(),Wt=a,xt=c=Ya(a.current,null),yt=s,Mt=0,Mn=null,Li=!1,Yl=ws(a,s),C1=!1,Kl=Ln=k1=Us=Bi=cr=0,wn=So=null,A1=!1,(s&8)!==0&&(s|=s&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=s;0<f;){var m=31-on(f),g=1<<m;s|=a[m],f&=~g}return si=s,_f(),c}function Z_(a,s){ct=null,Y.H=go,s===jl||s===kf?(s=mv(),Mt=3):s===Ld?(s=mv(),Mt=4):Mt=s===u1?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Mn=s,xt===null&&(cr=1,Hf(a,Kn(s,a.current)))}function J_(){var a=Fn.current;return a===null?!0:(yt&4194048)===yt?Jn===null:(yt&62914560)===yt||(yt&536870912)!==0?a===Jn:!1}function e2(){var a=Y.H;return Y.H=go,a===null?go:a}function t2(){var a=Y.A;return Y.A=R3,a}function Jf(){cr=4,Li||(yt&4194048)!==yt&&Fn.current!==null||(Yl=!0),(Bi&134217727)===0&&(Us&134217727)===0||Wt===null||ji(Wt,yt,Ln,!1)}function F1(a,s,c){var f=Ft;Ft|=2;var m=e2(),g=t2();(Wt!==a||yt!==s)&&(Qf=null,Ql(a,s)),s=!1;var T=cr;e:do try{if(Mt!==0&&xt!==null){var A=xt,V=Mn;switch(Mt){case 8:O1(),T=6;break e;case 3:case 2:case 9:case 6:Fn.current===null&&(s=!0);var ae=Mt;if(Mt=0,Mn=null,Zl(a,A,V,ae),c&&Yl){T=0;break e}break;default:ae=Mt,Mt=0,Mn=null,Zl(a,A,V,ae)}}I3(),T=cr;break}catch(ge){Z_(a,ge)}while(!0);return s&&a.shellSuspendCounter++,$a=Ds=null,Ft=f,Y.H=m,Y.A=g,xt===null&&(Wt=null,yt=0,_f()),T}function I3(){for(;xt!==null;)r2(xt)}function M3(a,s){var c=Ft;Ft|=2;var f=e2(),m=t2();Wt!==a||yt!==s?(Qf=null,$f=Ot()+500,Ql(a,s)):Yl=ws(a,s);e:do try{if(Mt!==0&&xt!==null){s=xt;var g=Mn;t:switch(Mt){case 1:Mt=0,Mn=null,Zl(a,s,g,1);break;case 2:case 9:if(hv(g)){Mt=0,Mn=null,n2(s);break}s=function(){Mt!==2&&Mt!==9||Wt!==a||(Mt=7),Ra(a)},g.then(s,s);break e;case 3:Mt=7;break e;case 4:Mt=5;break e;case 7:hv(g)?(Mt=0,Mn=null,n2(s)):(Mt=0,Mn=null,Zl(a,s,g,7));break;case 5:var T=null;switch(xt.tag){case 26:T=xt.memoizedState;case 5:case 27:var A=xt;if(T?z2(T):A.stateNode.complete){Mt=0,Mn=null;var V=A.sibling;if(V!==null)xt=V;else{var ae=A.return;ae!==null?(xt=ae,e0(ae)):xt=null}break t}}Mt=0,Mn=null,Zl(a,s,g,5);break;case 6:Mt=0,Mn=null,Zl(a,s,g,6);break;case 8:O1(),cr=6;break e;default:throw Error(n(462))}}L3();break}catch(ge){Z_(a,ge)}while(!0);return $a=Ds=null,Y.H=f,Y.A=m,Ft=c,xt!==null?0:(Wt=null,yt=0,_f(),cr)}function L3(){for(;xt!==null&&!cn();)r2(xt)}function r2(a){var s=C_(a.alternate,a,si);a.memoizedProps=a.pendingProps,s===null?e0(a):xt=s}function n2(a){var s=a,c=s.alternate;switch(s.tag){case 15:case 0:s=y_(c,s,s.pendingProps,s.type,void 0,yt);break;case 11:s=y_(c,s,s.pendingProps,s.type.render,s.ref,yt);break;case 5:Yd(s);default:A_(c,s),s=xt=tv(s,si),s=C_(c,s,si)}a.memoizedProps=a.pendingProps,s===null?e0(a):xt=s}function Zl(a,s,c,f){$a=Ds=null,Yd(s),Hl=null,lo=0;var m=s.return;try{if(S3(a,m,s,c,yt)){cr=1,Hf(a,Kn(c,a.current)),xt=null;return}}catch(g){if(m!==null)throw xt=m,g;cr=1,Hf(a,Kn(c,a.current)),xt=null;return}s.flags&32768?(Tt||f===1?a=!0:Yl||(yt&536870912)!==0?a=!1:(Li=a=!0,(f===2||f===9||f===3||f===6)&&(f=Fn.current,f!==null&&f.tag===13&&(f.flags|=16384))),a2(s,a)):e0(s)}function e0(a){var s=a;do{if((s.flags&32768)!==0){a2(s,Li);return}a=s.return;var c=k3(s.alternate,s,si);if(c!==null){xt=c;return}if(s=s.sibling,s!==null){xt=s;return}xt=s=a}while(s!==null);cr===0&&(cr=5)}function a2(a,s){do{var c=A3(a.alternate,a);if(c!==null){c.flags&=32767,xt=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(a=a.sibling,a!==null)){xt=a;return}xt=a=c}while(a!==null);cr=6,xt=null}function i2(a,s,c,f,m,g,T,A,V){a.cancelPendingCommit=null;do t0();while(Cr!==0);if((Ft&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(g=s.lanes|s.childLanes,g|=wd,Jh(a,c,g,T,A,V),a===Wt&&(xt=Wt=null,yt=0),$l=s,Ui=a,li=c,N1=g,D1=m,Y_=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,j3(tt,function(){return u2(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=Y.T,Y.T=null,m=ue.p,ue.p=2,T=Ft,Ft|=4;try{N3(a,s,c)}finally{Ft=T,ue.p=m,Y.T=f}}Cr=1,s2(),l2(),c2()}}function s2(){if(Cr===1){Cr=0;var a=Ui,s=$l,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=Y.T,Y.T=null;var f=ue.p;ue.p=2;var m=Ft;Ft|=4;try{j_(s,a);var g=W1,T=Xx(a.containerInfo),A=g.focusedElem,V=g.selectionRange;if(T!==A&&A&&A.ownerDocument&&Wx(A.ownerDocument.documentElement,A)){if(V!==null&&gd(A)){var ae=V.start,ge=V.end;if(ge===void 0&&(ge=ae),"selectionStart"in A)A.selectionStart=ae,A.selectionEnd=Math.min(ge,A.value.length);else{var Ee=A.ownerDocument||document,ce=Ee&&Ee.defaultView||window;if(ce.getSelection){var he=ce.getSelection(),je=A.textContent.length,Ke=Math.min(V.start,je),zt=V.end===void 0?Ke:Math.min(V.end,je);!he.extend&&Ke>zt&&(T=zt,zt=Ke,Ke=T);var J=Gx(A,Ke),q=Gx(A,zt);if(J&&q&&(he.rangeCount!==1||he.anchorNode!==J.node||he.anchorOffset!==J.offset||he.focusNode!==q.node||he.focusOffset!==q.offset)){var ne=Ee.createRange();ne.setStart(J.node,J.offset),he.removeAllRanges(),Ke>zt?(he.addRange(ne),he.extend(q.node,q.offset)):(ne.setEnd(q.node,q.offset),he.addRange(ne))}}}}for(Ee=[],he=A;he=he.parentNode;)he.nodeType===1&&Ee.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<Ee.length;A++){var _e=Ee[A];_e.element.scrollLeft=_e.left,_e.element.scrollTop=_e.top}}d0=!!G1,W1=G1=null}finally{Ft=m,ue.p=f,Y.T=c}}a.current=s,Cr=2}}function l2(){if(Cr===2){Cr=0;var a=Ui,s=$l,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=Y.T,Y.T=null;var f=ue.p;ue.p=2;var m=Ft;Ft|=4;try{M_(a,s.alternate,s)}finally{Ft=m,ue.p=f,Y.T=c}}Cr=3}}function c2(){if(Cr===4||Cr===3){Cr=0,Yr();var a=Ui,s=$l,c=li,f=Y_;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Cr=5:(Cr=0,$l=Ui=null,o2(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(Pi=null),Xc(c),s=s.stateNode,dr&&typeof dr.onCommitFiberRoot=="function")try{dr.onCommitFiberRoot(gt,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=Y.T,m=ue.p,ue.p=2,Y.T=null;try{for(var g=a.onRecoverableError,T=0;T<f.length;T++){var A=f[T];g(A.value,{componentStack:A.stack})}}finally{Y.T=s,ue.p=m}}(li&3)!==0&&t0(),Ra(a),m=a.pendingLanes,(c&261930)!==0&&(m&42)!==0?a===R1?bo++:(bo=0,R1=a):bo=0,Co(0)}}function o2(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,io(s)))}function t0(){return s2(),l2(),c2(),u2()}function u2(){if(Cr!==5)return!1;var a=Ui,s=N1;N1=0;var c=Xc(li),f=Y.T,m=ue.p;try{ue.p=32>c?32:c,Y.T=null,c=D1,D1=null;var g=Ui,T=li;if(Cr=0,$l=Ui=null,li=0,(Ft&6)!==0)throw Error(n(331));var A=Ft;if(Ft|=4,W_(g.current),z_(g,g.current,T,c),Ft=A,Co(0,!1),dr&&typeof dr.onPostCommitFiberRoot=="function")try{dr.onPostCommitFiberRoot(gt,g)}catch{}return!0}finally{ue.p=m,Y.T=f,o2(a,s)}}function f2(a,s,c){s=Kn(c,s),s=o1(a.stateNode,s,2),a=Oi(a,s,2),a!==null&&(Es(a,2),Ra(a))}function Lt(a,s,c){if(a.tag===3)f2(a,a,c);else for(;s!==null;){if(s.tag===3){f2(s,a,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Pi===null||!Pi.has(f))){a=Kn(c,a),c=h_(2),f=Oi(s,c,2),f!==null&&(d_(c,f,s,a),Es(f,2),Ra(f));break}}s=s.return}}function I1(a,s,c){var f=a.pingCache;if(f===null){f=a.pingCache=new O3;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(c)||(C1=!0,m.add(c),a=B3.bind(null,a,s,c),s.then(a,a))}function B3(a,s,c){var f=a.pingCache;f!==null&&f.delete(s),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Wt===a&&(yt&c)===c&&(cr===4||cr===3&&(yt&62914560)===yt&&300>Ot()-Kf?(Ft&2)===0&&Ql(a,0):k1|=c,Kl===yt&&(Kl=0)),Ra(a)}function h2(a,s){s===0&&(s=sf()),a=ks(a,s),a!==null&&(Es(a,s),Ra(a))}function P3(a){var s=a.memoizedState,c=0;s!==null&&(c=s.retryLane),h2(a,c)}function U3(a,s){var c=0;switch(a.tag){case 31:case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),h2(a,c)}function j3(a,s){return bt(a,s)}var r0=null,Jl=null,M1=!1,n0=!1,L1=!1,Hi=0;function Ra(a){a!==Jl&&a.next===null&&(Jl===null?r0=Jl=a:Jl=Jl.next=a),n0=!0,M1||(M1=!0,z3())}function Co(a,s){if(!L1&&n0){L1=!0;do for(var c=!1,f=r0;f!==null;){if(a!==0){var m=f.pendingLanes;if(m===0)var g=0;else{var T=f.suspendedLanes,A=f.pingedLanes;g=(1<<31-on(42|a)+1)-1,g&=m&~(T&~A),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(c=!0,g2(f,g))}else g=yt,g=Tl(f,f===Wt?g:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(g&3)===0||ws(f,g)||(c=!0,g2(f,g));f=f.next}while(c);L1=!1}}function H3(){d2()}function d2(){n0=M1=!1;var a=0;Hi!==0&&Z3()&&(a=Hi);for(var s=Ot(),c=null,f=r0;f!==null;){var m=f.next,g=m2(f,s);g===0?(f.next=null,c===null?r0=m:c.next=m,m===null&&(Jl=c)):(c=f,(a!==0||(g&3)!==0)&&(n0=!0)),f=m}Cr!==0&&Cr!==5||Co(a),Hi!==0&&(Hi=0)}function m2(a,s){for(var c=a.suspendedLanes,f=a.pingedLanes,m=a.expirationTimes,g=a.pendingLanes&-62914561;0<g;){var T=31-on(g),A=1<<T,V=m[T];V===-1?((A&c)===0||(A&f)!==0)&&(m[T]=Zh(A,s)):V<=s&&(a.expiredLanes|=A),g&=~A}if(s=Wt,c=yt,c=Tl(a,a===s?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,c===0||a===s&&(Mt===2||Mt===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&vr(f),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||ws(a,c)){if(s=c&-c,s===a.callbackPriority)return s;switch(f!==null&&vr(f),Xc(c)){case 2:case 8:c=Qe;break;case 32:c=tt;break;case 268435456:c=qe;break;default:c=tt}return f=p2.bind(null,a),c=bt(c,f),a.callbackPriority=s,a.callbackNode=c,s}return f!==null&&f!==null&&vr(f),a.callbackPriority=2,a.callbackNode=null,2}function p2(a,s){if(Cr!==0&&Cr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(t0()&&a.callbackNode!==c)return null;var f=yt;return f=Tl(a,a===Wt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:($_(a,f,s),m2(a,Ot()),a.callbackNode!=null&&a.callbackNode===c?p2.bind(null,a):null)}function g2(a,s){if(t0())return null;$_(a,s,!0)}function z3(){ek(function(){(Ft&6)!==0?bt(Ve,H3):d2()})}function B1(){if(Hi===0){var a=Pl;a===0&&(a=ys,ys<<=1,(ys&261888)===0&&(ys=256)),Hi=a}return Hi}function x2(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:ff(""+a)}function v2(a,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,a.id&&c.setAttribute("form",a.id),s.parentNode.insertBefore(c,s),a=new FormData(a),c.parentNode.removeChild(c),a}function V3(a,s,c,f,m){if(s==="submit"&&c&&c.stateNode===m){var g=x2((m[F]||null).action),T=f.submitter;T&&(s=(s=T[F]||null)?x2(s.formAction):T.getAttribute("formAction"),s!==null&&(g=s,T=null));var A=new pf("action","action",null,f,m);a.push({event:A,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Hi!==0){var V=T?v2(m,T):new FormData(m);n1(c,{pending:!0,data:V,method:m.method,action:g},null,V)}}else typeof g=="function"&&(A.preventDefault(),V=T?v2(m,T):new FormData(m),n1(c,{pending:!0,data:V,method:m.method,action:g},g,V))},currentTarget:m}]})}}for(var P1=0;P1<yd.length;P1++){var U1=yd[P1],G3=U1.toLowerCase(),W3=U1[0].toUpperCase()+U1.slice(1);da(G3,"on"+W3)}da(Kx,"onAnimationEnd"),da($x,"onAnimationIteration"),da(Qx,"onAnimationStart"),da("dblclick","onDoubleClick"),da("focusin","onFocus"),da("focusout","onBlur"),da(l3,"onTransitionRun"),da(c3,"onTransitionStart"),da(o3,"onTransitionCancel"),da(Zx,"onTransitionEnd"),Wn("onMouseEnter",["mouseout","mouseover"]),Wn("onMouseLeave",["mouseout","mouseover"]),Wn("onPointerEnter",["pointerout","pointerover"]),Wn("onPointerLeave",["pointerout","pointerover"]),nr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nr("onBeforeInput",["compositionend","keypress","textInput","paste"]),nr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),X3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ko));function _2(a,s){s=(s&4)!==0;for(var c=0;c<a.length;c++){var f=a[c],m=f.event;f=f.listeners;e:{var g=void 0;if(s)for(var T=f.length-1;0<=T;T--){var A=f[T],V=A.instance,ae=A.currentTarget;if(A=A.listener,V!==g&&m.isPropagationStopped())break e;g=A,m.currentTarget=ae;try{g(m)}catch(ge){vf(ge)}m.currentTarget=null,g=V}else for(T=0;T<f.length;T++){if(A=f[T],V=A.instance,ae=A.currentTarget,A=A.listener,V!==g&&m.isPropagationStopped())break e;g=A,m.currentTarget=ae;try{g(m)}catch(ge){vf(ge)}m.currentTarget=null,g=V}}}}function vt(a,s){var c=s[ie];c===void 0&&(c=s[ie]=new Set);var f=a+"__bubble";c.has(f)||(y2(s,a,2,!1),c.add(f))}function j1(a,s,c){var f=0;s&&(f|=4),y2(c,a,f,s)}var a0="_reactListening"+Math.random().toString(36).slice(2);function H1(a){if(!a[a0]){a[a0]=!0,Yt.forEach(function(c){c!=="selectionchange"&&(X3.has(c)||j1(c,!1,a),j1(c,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[a0]||(s[a0]=!0,j1("selectionchange",!1,s))}}function y2(a,s,c,f){switch(K2(s)){case 2:var m=yk;break;case 8:m=wk;break;default:m=rm}c=m.bind(null,s,c,a),m=void 0,!ld||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?a.addEventListener(s,c,{capture:!0,passive:m}):a.addEventListener(s,c,!0):m!==void 0?a.addEventListener(s,c,{passive:m}):a.addEventListener(s,c,!1)}function z1(a,s,c,f,m){var g=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var A=f.stateNode.containerInfo;if(A===m)break;if(T===4)for(T=f.return;T!==null;){var V=T.tag;if((V===3||V===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;A!==null;){if(T=Ne(A),T===null)return;if(V=T.tag,V===5||V===6||V===26||V===27){f=g=T;continue e}A=A.parentNode}}f=f.return}bx(function(){var ae=g,ge=id(c),Ee=[];e:{var ce=Jx.get(a);if(ce!==void 0){var he=pf,je=a;switch(a){case"keypress":if(df(c)===0)break e;case"keydown":case"keyup":he=UC;break;case"focusin":je="focus",he=fd;break;case"focusout":je="blur",he=fd;break;case"beforeblur":case"afterblur":he=fd;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Ax;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=kC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=zC;break;case Kx:case $x:case Qx:he=DC;break;case Zx:he=GC;break;case"scroll":case"scrollend":he=bC;break;case"wheel":he=XC;break;case"copy":case"cut":case"paste":he=OC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=Dx;break;case"toggle":case"beforetoggle":he=YC}var Ke=(s&4)!==0,zt=!Ke&&(a==="scroll"||a==="scrollend"),J=Ke?ce!==null?ce+"Capture":null:ce;Ke=[];for(var q=ae,ne;q!==null;){var _e=q;if(ne=_e.stateNode,_e=_e.tag,_e!==5&&_e!==26&&_e!==27||ne===null||J===null||(_e=Yc(q,J),_e!=null&&Ke.push(Ao(q,_e,ne))),zt)break;q=q.return}0<Ke.length&&(ce=new he(ce,je,null,c,ge),Ee.push({event:ce,listeners:Ke}))}}if((s&7)===0){e:{if(ce=a==="mouseover"||a==="pointerover",he=a==="mouseout"||a==="pointerout",ce&&c!==ad&&(je=c.relatedTarget||c.fromElement)&&(Ne(je)||je[B]))break e;if((he||ce)&&(ce=ge.window===ge?ge:(ce=ge.ownerDocument)?ce.defaultView||ce.parentWindow:window,he?(je=c.relatedTarget||c.toElement,he=ae,je=je?Ne(je):null,je!==null&&(zt=l(je),Ke=je.tag,je!==zt||Ke!==5&&Ke!==27&&Ke!==6)&&(je=null)):(he=null,je=ae),he!==je)){if(Ke=Ax,_e="onMouseLeave",J="onMouseEnter",q="mouse",(a==="pointerout"||a==="pointerover")&&(Ke=Dx,_e="onPointerLeave",J="onPointerEnter",q="pointer"),zt=he==null?ce:Ae(he),ne=je==null?ce:Ae(je),ce=new Ke(_e,q+"leave",he,c,ge),ce.target=zt,ce.relatedTarget=ne,_e=null,Ne(ge)===ae&&(Ke=new Ke(J,q+"enter",je,c,ge),Ke.target=ne,Ke.relatedTarget=zt,_e=Ke),zt=_e,he&&je)t:{for(Ke=q3,J=he,q=je,ne=0,_e=J;_e;_e=Ke(_e))ne++;_e=0;for(var Xe=q;Xe;Xe=Ke(Xe))_e++;for(;0<ne-_e;)J=Ke(J),ne--;for(;0<_e-ne;)q=Ke(q),_e--;for(;ne--;){if(J===q||q!==null&&J===q.alternate){Ke=J;break t}J=Ke(J),q=Ke(q)}Ke=null}else Ke=null;he!==null&&w2(Ee,ce,he,Ke,!1),je!==null&&zt!==null&&w2(Ee,zt,je,Ke,!0)}}e:{if(ce=ae?Ae(ae):window,he=ce.nodeName&&ce.nodeName.toLowerCase(),he==="select"||he==="input"&&ce.type==="file")var Nt=Px;else if(Lx(ce))if(Ux)Nt=a3;else{Nt=r3;var ze=t3}else he=ce.nodeName,!he||he.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ae&&nd(ae.elementType)&&(Nt=Px):Nt=n3;if(Nt&&(Nt=Nt(a,ae))){Bx(Ee,Nt,c,ge);break e}ze&&ze(a,ce,ae),a==="focusout"&&ae&&ce.type==="number"&&ae.memoizedProps.value!=null&&rd(ce,"number",ce.value)}switch(ze=ae?Ae(ae):window,a){case"focusin":(Lx(ze)||ze.contentEditable==="true")&&(Dl=ze,xd=ae,ro=null);break;case"focusout":ro=xd=Dl=null;break;case"mousedown":vd=!0;break;case"contextmenu":case"mouseup":case"dragend":vd=!1,qx(Ee,c,ge);break;case"selectionchange":if(s3)break;case"keydown":case"keyup":qx(Ee,c,ge)}var ut;if(dd)e:{switch(a){case"compositionstart":var wt="onCompositionStart";break e;case"compositionend":wt="onCompositionEnd";break e;case"compositionupdate":wt="onCompositionUpdate";break e}wt=void 0}else Nl?Ix(a,c)&&(wt="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(wt="onCompositionStart");wt&&(Rx&&c.locale!=="ko"&&(Nl||wt!=="onCompositionStart"?wt==="onCompositionEnd"&&Nl&&(ut=Cx()):(bi=ge,cd="value"in bi?bi.value:bi.textContent,Nl=!0)),ze=i0(ae,wt),0<ze.length&&(wt=new Nx(wt,a,null,c,ge),Ee.push({event:wt,listeners:ze}),ut?wt.data=ut:(ut=Mx(c),ut!==null&&(wt.data=ut)))),(ut=$C?QC(a,c):ZC(a,c))&&(wt=i0(ae,"onBeforeInput"),0<wt.length&&(ze=new Nx("onBeforeInput","beforeinput",null,c,ge),Ee.push({event:ze,listeners:wt}),ze.data=ut)),V3(Ee,a,ae,c,ge)}_2(Ee,s)})}function Ao(a,s,c){return{instance:a,listener:s,currentTarget:c}}function i0(a,s){for(var c=s+"Capture",f=[];a!==null;){var m=a,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=Yc(a,c),m!=null&&f.unshift(Ao(a,m,g)),m=Yc(a,s),m!=null&&f.push(Ao(a,m,g))),a.tag===3)return f;a=a.return}return[]}function q3(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function w2(a,s,c,f,m){for(var g=s._reactName,T=[];c!==null&&c!==f;){var A=c,V=A.alternate,ae=A.stateNode;if(A=A.tag,V!==null&&V===f)break;A!==5&&A!==26&&A!==27||ae===null||(V=ae,m?(ae=Yc(c,g),ae!=null&&T.unshift(Ao(c,ae,V))):m||(ae=Yc(c,g),ae!=null&&T.push(Ao(c,ae,V)))),c=c.return}T.length!==0&&a.push({event:s,listeners:T})}var Y3=/\r\n?/g,K3=/\u0000|\uFFFD/g;function E2(a){return(typeof a=="string"?a:""+a).replace(Y3,`
`).replace(K3,"")}function T2(a,s){return s=E2(s),E2(a)===s}function Ht(a,s,c,f,m,g){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||Cl(a,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&Cl(a,""+f);break;case"className":of(a,"class",f);break;case"tabIndex":of(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":of(a,c,f);break;case"style":Tx(a,f,g);break;case"data":if(s!=="object"){of(a,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){a.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=ff(""+f),a.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(c==="formAction"?(s!=="input"&&Ht(a,s,"name",m.name,m,null),Ht(a,s,"formEncType",m.formEncType,m,null),Ht(a,s,"formMethod",m.formMethod,m,null),Ht(a,s,"formTarget",m.formTarget,m,null)):(Ht(a,s,"encType",m.encType,m,null),Ht(a,s,"method",m.method,m,null),Ht(a,s,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=ff(""+f),a.setAttribute(c,f);break;case"onClick":f!=null&&(a.onclick=Xa);break;case"onScroll":f!=null&&vt("scroll",a);break;case"onScrollEnd":f!=null&&vt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}c=ff(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""+f):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":f===!0?a.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,f):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(c,f):a.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(c):a.setAttribute(c,f);break;case"popover":vt("beforetoggle",a),vt("toggle",a),gn(a,"popover",f);break;case"xlinkActuate":Wa(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Wa(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Wa(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Wa(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Wa(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Wa(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Wa(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Wa(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Wa(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":gn(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=TC.get(c)||c,gn(a,c,f))}}function V1(a,s,c,f,m,g){switch(c){case"style":Tx(a,f,g);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof f=="string"?Cl(a,f):(typeof f=="number"||typeof f=="bigint")&&Cl(a,""+f);break;case"onScroll":f!=null&&vt("scroll",a);break;case"onScrollEnd":f!=null&&vt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Xa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),s=c.slice(2,m?c.length-7:void 0),g=a[F]||null,g=g!=null?g[c]:null,typeof g=="function"&&a.removeEventListener(s,g,m),typeof f=="function")){typeof g!="function"&&g!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(s,f,m);break e}c in a?a[c]=f:f===!0?a.setAttribute(c,""):gn(a,c,f)}}}function Vr(a,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vt("error",a),vt("load",a);var f=!1,m=!1,g;for(g in c)if(c.hasOwnProperty(g)){var T=c[g];if(T!=null)switch(g){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ht(a,s,g,T,c,null)}}m&&Ht(a,s,"srcSet",c.srcSet,c,null),f&&Ht(a,s,"src",c.src,c,null);return;case"input":vt("invalid",a);var A=g=T=m=null,V=null,ae=null;for(f in c)if(c.hasOwnProperty(f)){var ge=c[f];if(ge!=null)switch(f){case"name":m=ge;break;case"type":T=ge;break;case"checked":V=ge;break;case"defaultChecked":ae=ge;break;case"value":g=ge;break;case"defaultValue":A=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(n(137,s));break;default:Ht(a,s,f,ge,c,null)}}_x(a,g,A,V,ae,T,m,!1);return;case"select":vt("invalid",a),f=T=g=null;for(m in c)if(c.hasOwnProperty(m)&&(A=c[m],A!=null))switch(m){case"value":g=A;break;case"defaultValue":T=A;break;case"multiple":f=A;default:Ht(a,s,m,A,c,null)}s=g,c=T,a.multiple=!!f,s!=null?bl(a,!!f,s,!1):c!=null&&bl(a,!!f,c,!0);return;case"textarea":vt("invalid",a),g=m=f=null;for(T in c)if(c.hasOwnProperty(T)&&(A=c[T],A!=null))switch(T){case"value":f=A;break;case"defaultValue":m=A;break;case"children":g=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:Ht(a,s,T,A,c,null)}wx(a,f,m,g);return;case"option":for(V in c)if(c.hasOwnProperty(V)&&(f=c[V],f!=null))switch(V){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ht(a,s,V,f,c,null)}return;case"dialog":vt("beforetoggle",a),vt("toggle",a),vt("cancel",a),vt("close",a);break;case"iframe":case"object":vt("load",a);break;case"video":case"audio":for(f=0;f<ko.length;f++)vt(ko[f],a);break;case"image":vt("error",a),vt("load",a);break;case"details":vt("toggle",a);break;case"embed":case"source":case"link":vt("error",a),vt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in c)if(c.hasOwnProperty(ae)&&(f=c[ae],f!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ht(a,s,ae,f,c,null)}return;default:if(nd(s)){for(ge in c)c.hasOwnProperty(ge)&&(f=c[ge],f!==void 0&&V1(a,s,ge,f,c,void 0));return}}for(A in c)c.hasOwnProperty(A)&&(f=c[A],f!=null&&Ht(a,s,A,f,c,null))}function $3(a,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,T=null,A=null,V=null,ae=null,ge=null;for(he in c){var Ee=c[he];if(c.hasOwnProperty(he)&&Ee!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":V=Ee;default:f.hasOwnProperty(he)||Ht(a,s,he,null,f,Ee)}}for(var ce in f){var he=f[ce];if(Ee=c[ce],f.hasOwnProperty(ce)&&(he!=null||Ee!=null))switch(ce){case"type":g=he;break;case"name":m=he;break;case"checked":ae=he;break;case"defaultChecked":ge=he;break;case"value":T=he;break;case"defaultValue":A=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(n(137,s));break;default:he!==Ee&&Ht(a,s,ce,he,f,Ee)}}td(a,T,A,V,ae,ge,g,m);return;case"select":he=T=A=ce=null;for(g in c)if(V=c[g],c.hasOwnProperty(g)&&V!=null)switch(g){case"value":break;case"multiple":he=V;default:f.hasOwnProperty(g)||Ht(a,s,g,null,f,V)}for(m in f)if(g=f[m],V=c[m],f.hasOwnProperty(m)&&(g!=null||V!=null))switch(m){case"value":ce=g;break;case"defaultValue":A=g;break;case"multiple":T=g;default:g!==V&&Ht(a,s,m,g,f,V)}s=A,c=T,f=he,ce!=null?bl(a,!!c,ce,!1):!!f!=!!c&&(s!=null?bl(a,!!c,s,!0):bl(a,!!c,c?[]:"",!1));return;case"textarea":he=ce=null;for(A in c)if(m=c[A],c.hasOwnProperty(A)&&m!=null&&!f.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:Ht(a,s,A,null,f,m)}for(T in f)if(m=f[T],g=c[T],f.hasOwnProperty(T)&&(m!=null||g!=null))switch(T){case"value":ce=m;break;case"defaultValue":he=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==g&&Ht(a,s,T,m,f,g)}yx(a,ce,he);return;case"option":for(var je in c)if(ce=c[je],c.hasOwnProperty(je)&&ce!=null&&!f.hasOwnProperty(je))switch(je){case"selected":a.selected=!1;break;default:Ht(a,s,je,null,f,ce)}for(V in f)if(ce=f[V],he=c[V],f.hasOwnProperty(V)&&ce!==he&&(ce!=null||he!=null))switch(V){case"selected":a.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:Ht(a,s,V,ce,f,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in c)ce=c[Ke],c.hasOwnProperty(Ke)&&ce!=null&&!f.hasOwnProperty(Ke)&&Ht(a,s,Ke,null,f,ce);for(ae in f)if(ce=f[ae],he=c[ae],f.hasOwnProperty(ae)&&ce!==he&&(ce!=null||he!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(n(137,s));break;default:Ht(a,s,ae,ce,f,he)}return;default:if(nd(s)){for(var zt in c)ce=c[zt],c.hasOwnProperty(zt)&&ce!==void 0&&!f.hasOwnProperty(zt)&&V1(a,s,zt,void 0,f,ce);for(ge in f)ce=f[ge],he=c[ge],!f.hasOwnProperty(ge)||ce===he||ce===void 0&&he===void 0||V1(a,s,ge,ce,f,he);return}}for(var J in c)ce=c[J],c.hasOwnProperty(J)&&ce!=null&&!f.hasOwnProperty(J)&&Ht(a,s,J,null,f,ce);for(Ee in f)ce=f[Ee],he=c[Ee],!f.hasOwnProperty(Ee)||ce===he||ce==null&&he==null||Ht(a,s,Ee,ce,f,he)}function S2(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Q3(){if(typeof performance.getEntriesByType=="function"){for(var a=0,s=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var m=c[f],g=m.transferSize,T=m.initiatorType,A=m.duration;if(g&&A&&S2(T)){for(T=0,A=m.responseEnd,f+=1;f<c.length;f++){var V=c[f],ae=V.startTime;if(ae>A)break;var ge=V.transferSize,Ee=V.initiatorType;ge&&S2(Ee)&&(V=V.responseEnd,T+=ge*(V<A?1:(A-ae)/(V-ae)))}if(--f,s+=8*(g+T)/(m.duration/1e3),a++,10<a)break}}if(0<a)return s/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var G1=null,W1=null;function s0(a){return a.nodeType===9?a:a.ownerDocument}function b2(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function C2(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function X1(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var q1=null;function Z3(){var a=window.event;return a&&a.type==="popstate"?a===q1?!1:(q1=a,!0):(q1=null,!1)}var k2=typeof setTimeout=="function"?setTimeout:void 0,J3=typeof clearTimeout=="function"?clearTimeout:void 0,A2=typeof Promise=="function"?Promise:void 0,ek=typeof queueMicrotask=="function"?queueMicrotask:typeof A2<"u"?function(a){return A2.resolve(null).then(a).catch(tk)}:k2;function tk(a){setTimeout(function(){throw a})}function zi(a){return a==="head"}function N2(a,s){var c=s,f=0;do{var m=c.nextSibling;if(a.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"||c==="/&"){if(f===0){a.removeChild(m),nc(s);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")No(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,No(c);for(var g=c.firstChild;g;){var T=g.nextSibling,A=g.nodeName;g[oe]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&g.rel.toLowerCase()==="stylesheet"||c.removeChild(g),g=T}}else c==="body"&&No(a.ownerDocument.body);c=m}while(c);nc(s)}function D2(a,s){var c=a;a=0;do{var f=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=f}while(c)}function Y1(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Y1(c),ke(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function rk(a,s,c,f){for(;a.nodeType===1;){var m=c;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[oe])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(g=a.getAttribute("rel"),g==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(g!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(g=a.getAttribute("src"),(g!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===g)return a}else return a;if(a=ea(a.nextSibling),a===null)break}return null}function nk(a,s,c){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=ea(a.nextSibling),a===null))return null;return a}function R2(a,s){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!s||(a=ea(a.nextSibling),a===null))return null;return a}function K1(a){return a.data==="$?"||a.data==="$~"}function $1(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function ak(a,s){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=s;else if(a.data!=="$?"||c.readyState!=="loading")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function ea(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return a}var Q1=null;function O2(a){a=a.nextSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(s===0)return ea(a.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}a=a.nextSibling}return null}function F2(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return a;s--}else c!=="/$"&&c!=="/&"||s++}a=a.previousSibling}return null}function I2(a,s,c){switch(s=s0(c),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function No(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);ke(a)}var ta=new Map,M2=new Set;function l0(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ci=ue.d;ue.d={f:ik,r:sk,D:lk,C:ck,L:ok,m:uk,X:hk,S:fk,M:dk};function ik(){var a=ci.f(),s=Zf();return a||s}function sk(a){var s=Ue(a);s!==null&&s.tag===5&&s.type==="form"?Zv(s):ci.r(a)}var ec=typeof document>"u"?null:document;function L2(a,s,c){var f=ec;if(f&&typeof s=="string"&&s){var m=qn(s);m='link[rel="'+a+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),M2.has(m)||(M2.add(m),a={rel:a,crossOrigin:c,href:s},f.querySelector(m)===null&&(s=f.createElement("link"),Vr(s,"link",a),He(s),f.head.appendChild(s)))}}function lk(a){ci.D(a),L2("dns-prefetch",a,null)}function ck(a,s){ci.C(a,s),L2("preconnect",a,s)}function ok(a,s,c){ci.L(a,s,c);var f=ec;if(f&&a&&s){var m='link[rel="preload"][as="'+qn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+qn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+qn(c.imageSizes)+'"]')):m+='[href="'+qn(a)+'"]';var g=m;switch(s){case"style":g=tc(a);break;case"script":g=rc(a)}ta.has(g)||(a=x({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:a,as:s},c),ta.set(g,a),f.querySelector(m)!==null||s==="style"&&f.querySelector(Do(g))||s==="script"&&f.querySelector(Ro(g))||(s=f.createElement("link"),Vr(s,"link",a),He(s),f.head.appendChild(s)))}}function uk(a,s){ci.m(a,s);var c=ec;if(c&&a){var f=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+qn(f)+'"][href="'+qn(a)+'"]',g=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=rc(a)}if(!ta.has(g)&&(a=x({rel:"modulepreload",href:a},s),ta.set(g,a),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Ro(g)))return}f=c.createElement("link"),Vr(f,"link",a),He(f),c.head.appendChild(f)}}}function fk(a,s,c){ci.S(a,s,c);var f=ec;if(f&&a){var m=Be(f).hoistableStyles,g=tc(a);s=s||"default";var T=m.get(g);if(!T){var A={loading:0,preload:null};if(T=f.querySelector(Do(g)))A.loading=5;else{a=x({rel:"stylesheet",href:a,"data-precedence":s},c),(c=ta.get(g))&&Z1(a,c);var V=T=f.createElement("link");He(V),Vr(V,"link",a),V._p=new Promise(function(ae,ge){V.onload=ae,V.onerror=ge}),V.addEventListener("load",function(){A.loading|=1}),V.addEventListener("error",function(){A.loading|=2}),A.loading|=4,c0(T,s,f)}T={type:"stylesheet",instance:T,count:1,state:A},m.set(g,T)}}}function hk(a,s){ci.X(a,s);var c=ec;if(c&&a){var f=Be(c).hoistableScripts,m=rc(a),g=f.get(m);g||(g=c.querySelector(Ro(m)),g||(a=x({src:a,async:!0},s),(s=ta.get(m))&&J1(a,s),g=c.createElement("script"),He(g),Vr(g,"link",a),c.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(m,g))}}function dk(a,s){ci.M(a,s);var c=ec;if(c&&a){var f=Be(c).hoistableScripts,m=rc(a),g=f.get(m);g||(g=c.querySelector(Ro(m)),g||(a=x({src:a,async:!0,type:"module"},s),(s=ta.get(m))&&J1(a,s),g=c.createElement("script"),He(g),Vr(g,"link",a),c.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(m,g))}}function B2(a,s,c,f){var m=(m=ee.current)?l0(m):null;if(!m)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=tc(c.href),c=Be(m).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=tc(c.href);var g=Be(m).hoistableStyles,T=g.get(a);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(a,T),(g=m.querySelector(Do(a)))&&!g._p&&(T.instance=g,T.state.loading=5),ta.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},ta.set(a,c),g||mk(m,a,c,T.state))),s&&f===null)throw Error(n(528,""));return T}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=rc(c),c=Be(m).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function tc(a){return'href="'+qn(a)+'"'}function Do(a){return'link[rel="stylesheet"]['+a+"]"}function P2(a){return x({},a,{"data-precedence":a.precedence,precedence:null})}function mk(a,s,c,f){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=a.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Vr(s,"link",c),He(s),a.head.appendChild(s))}function rc(a){return'[src="'+qn(a)+'"]'}function Ro(a){return"script[async]"+a}function U2(a,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=a.querySelector('style[data-href~="'+qn(c.href)+'"]');if(f)return s.instance=f,He(f),f;var m=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),He(f),Vr(f,"style",m),c0(f,c.precedence,a),s.instance=f;case"stylesheet":m=tc(c.href);var g=a.querySelector(Do(m));if(g)return s.state.loading|=4,s.instance=g,He(g),g;f=P2(c),(m=ta.get(m))&&Z1(f,m),g=(a.ownerDocument||a).createElement("link"),He(g);var T=g;return T._p=new Promise(function(A,V){T.onload=A,T.onerror=V}),Vr(g,"link",f),s.state.loading|=4,c0(g,c.precedence,a),s.instance=g;case"script":return g=rc(c.src),(m=a.querySelector(Ro(g)))?(s.instance=m,He(m),m):(f=c,(m=ta.get(g))&&(f=x({},c),J1(f,m)),a=a.ownerDocument||a,m=a.createElement("script"),He(m),Vr(m,"link",f),a.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,c0(f,c.precedence,a));return s.instance}function c0(a,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,g=m,T=0;T<f.length;T++){var A=f[T];if(A.dataset.precedence===s)g=A;else if(g!==m)break}g?g.parentNode.insertBefore(a,g.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(a,s.firstChild))}function Z1(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function J1(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var o0=null;function j2(a,s,c){if(o0===null){var f=new Map,m=o0=new Map;m.set(c,f)}else m=o0,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(a))return f;for(f.set(a,null),c=c.getElementsByTagName(a),m=0;m<c.length;m++){var g=c[m];if(!(g[oe]||g[O]||a==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(s)||"";T=a+T;var A=f.get(T);A?A.push(g):f.set(T,[g])}}return f}function H2(a,s,c){a=a.ownerDocument||a,a.head.insertBefore(c,s==="title"?a.querySelector("head > title"):null)}function pk(a,s,c){if(c===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function z2(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function gk(a,s,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var m=tc(f.href),g=s.querySelector(Do(m));if(g){s=g._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(a.count++,a=u0.bind(a),s.then(a,a)),c.state.loading|=4,c.instance=g,He(g);return}g=s.ownerDocument||s,f=P2(f),(m=ta.get(m))&&Z1(f,m),g=g.createElement("link"),He(g);var T=g;T._p=new Promise(function(A,V){T.onload=A,T.onerror=V}),Vr(g,"link",f),c.instance=g}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=u0.bind(a),s.addEventListener("load",c),s.addEventListener("error",c))}}var em=0;function xk(a,s){return a.stylesheets&&a.count===0&&h0(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var f=setTimeout(function(){if(a.stylesheets&&h0(a,a.stylesheets),a.unsuspend){var g=a.unsuspend;a.unsuspend=null,g()}},6e4+s);0<a.imgBytes&&em===0&&(em=62500*Q3());var m=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&h0(a,a.stylesheets),a.unsuspend)){var g=a.unsuspend;a.unsuspend=null,g()}},(a.imgBytes>em?50:800)+s);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(f),clearTimeout(m)}}:null}function u0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)h0(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var f0=null;function h0(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,f0=new Map,s.forEach(vk,a),f0=null,u0.call(a))}function vk(a,s){if(!(s.state.loading&4)){var c=f0.get(a);if(c)var f=c.get(null);else{c=new Map,f0.set(a,c);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var T=m[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(c.set(T.dataset.precedence,T),f=T)}f&&c.set(null,f)}m=s.instance,T=m.getAttribute("data-precedence"),g=c.get(T)||f,g===f&&c.set(null,m),c.set(T,m),this.count++,f=u0.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),g?g.parentNode.insertBefore(m,g.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),s.state.loading|=4}}var Oo={$$typeof:C,Provider:null,Consumer:null,_currentValue:Me,_currentValue2:Me,_threadCount:0};function _k(a,s,c,f,m,g,T,A,V){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gc(0),this.hiddenUpdates=Gc(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function V2(a,s,c,f,m,g,T,A,V,ae,ge,Ee){return a=new _k(a,s,c,T,V,ae,ge,Ee,A),s=1,g===!0&&(s|=24),g=On(3,null,null,s),a.current=g,g.stateNode=a,s=Fd(),s.refCount++,a.pooledCache=s,s.refCount++,g.memoizedState={element:f,isDehydrated:c,cache:s},Bd(g),a}function G2(a){return a?(a=Fl,a):Fl}function W2(a,s,c,f,m,g){m=G2(m),f.context===null?f.context=m:f.pendingContext=m,f=Ri(s),f.payload={element:c},g=g===void 0?null:g,g!==null&&(f.callback=g),c=Oi(a,f,s),c!==null&&(En(c,a,s),oo(c,a,s))}function X2(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<s?c:s}}function tm(a,s){X2(a,s),(a=a.alternate)&&X2(a,s)}function q2(a){if(a.tag===13||a.tag===31){var s=ks(a,67108864);s!==null&&En(s,a,67108864),tm(a,67108864)}}function Y2(a){if(a.tag===13||a.tag===31){var s=Bn();s=Wc(s);var c=ks(a,s);c!==null&&En(c,a,s),tm(a,s)}}var d0=!0;function yk(a,s,c,f){var m=Y.T;Y.T=null;var g=ue.p;try{ue.p=2,rm(a,s,c,f)}finally{ue.p=g,Y.T=m}}function wk(a,s,c,f){var m=Y.T;Y.T=null;var g=ue.p;try{ue.p=8,rm(a,s,c,f)}finally{ue.p=g,Y.T=m}}function rm(a,s,c,f){if(d0){var m=nm(f);if(m===null)z1(a,s,f,m0,c),$2(a,f);else if(Tk(m,a,s,c,f))f.stopPropagation();else if($2(a,f),s&4&&-1<Ek.indexOf(a)){for(;m!==null;){var g=Ue(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=Gn(g.pendingLanes);if(T!==0){var A=g;for(A.pendingLanes|=2,A.entangledLanes|=2;T;){var V=1<<31-on(T);A.entanglements[1]|=V,T&=~V}Ra(g),(Ft&6)===0&&($f=Ot()+500,Co(0))}}break;case 31:case 13:A=ks(g,2),A!==null&&En(A,g,2),Zf(),tm(g,2)}if(g=nm(f),g===null&&z1(a,s,f,m0,c),g===m)break;m=g}m!==null&&f.stopPropagation()}else z1(a,s,f,null,c)}}function nm(a){return a=id(a),am(a)}var m0=null;function am(a){if(m0=null,a=Ne(a),a!==null){var s=l(a);if(s===null)a=null;else{var c=s.tag;if(c===13){if(a=o(s),a!==null)return a;a=null}else if(c===31){if(a=u(s),a!==null)return a;a=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return m0=a,null}function K2(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oe()){case Ve:return 2;case Qe:return 8;case tt:case Ze:return 32;case qe:return 268435456;default:return 32}default:return 32}}var im=!1,Vi=null,Gi=null,Wi=null,Fo=new Map,Io=new Map,Xi=[],Ek="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $2(a,s){switch(a){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":Gi=null;break;case"mouseover":case"mouseout":Wi=null;break;case"pointerover":case"pointerout":Fo.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Io.delete(s.pointerId)}}function Mo(a,s,c,f,m,g){return a===null||a.nativeEvent!==g?(a={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:g,targetContainers:[m]},s!==null&&(s=Ue(s),s!==null&&q2(s)),a):(a.eventSystemFlags|=f,s=a.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),a)}function Tk(a,s,c,f,m){switch(s){case"focusin":return Vi=Mo(Vi,a,s,c,f,m),!0;case"dragenter":return Gi=Mo(Gi,a,s,c,f,m),!0;case"mouseover":return Wi=Mo(Wi,a,s,c,f,m),!0;case"pointerover":var g=m.pointerId;return Fo.set(g,Mo(Fo.get(g)||null,a,s,c,f,m)),!0;case"gotpointercapture":return g=m.pointerId,Io.set(g,Mo(Io.get(g)||null,a,s,c,f,m)),!0}return!1}function Q2(a){var s=Ne(a.target);if(s!==null){var c=l(s);if(c!==null){if(s=c.tag,s===13){if(s=o(c),s!==null){a.blockedOn=s,L(a.priority,function(){Y2(c)});return}}else if(s===31){if(s=u(c),s!==null){a.blockedOn=s,L(a.priority,function(){Y2(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function p0(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var c=nm(a.nativeEvent);if(c===null){c=a.nativeEvent;var f=new c.constructor(c.type,c);ad=f,c.target.dispatchEvent(f),ad=null}else return s=Ue(c),s!==null&&q2(s),a.blockedOn=c,!1;s.shift()}return!0}function Z2(a,s,c){p0(a)&&c.delete(s)}function Sk(){im=!1,Vi!==null&&p0(Vi)&&(Vi=null),Gi!==null&&p0(Gi)&&(Gi=null),Wi!==null&&p0(Wi)&&(Wi=null),Fo.forEach(Z2),Io.forEach(Z2)}function g0(a,s){a.blockedOn===s&&(a.blockedOn=null,im||(im=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Sk)))}var x0=null;function J2(a){x0!==a&&(x0=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){x0===a&&(x0=null);for(var s=0;s<a.length;s+=3){var c=a[s],f=a[s+1],m=a[s+2];if(typeof f!="function"){if(am(f||c)===null)continue;break}var g=Ue(c);g!==null&&(a.splice(s,3),s-=3,n1(g,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function nc(a){function s(V){return g0(V,a)}Vi!==null&&g0(Vi,a),Gi!==null&&g0(Gi,a),Wi!==null&&g0(Wi,a),Fo.forEach(s),Io.forEach(s);for(var c=0;c<Xi.length;c++){var f=Xi[c];f.blockedOn===a&&(f.blockedOn=null)}for(;0<Xi.length&&(c=Xi[0],c.blockedOn===null);)Q2(c),c.blockedOn===null&&Xi.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],g=c[f+1],T=m[F]||null;if(typeof g=="function")T||J2(c);else if(T){var A=null;if(g&&g.hasAttribute("formAction")){if(m=g,T=g[F]||null)A=T.formAction;else if(am(m)!==null)continue}else A=T.action;typeof A=="function"?c[f+1]=A:(c.splice(f,3),f-=3),J2(c)}}}function ey(){function a(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(T){return m=T})},focusReset:"manual",scroll:"manual"})}function s(){m!==null&&(m(),m=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,m=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),m!==null&&(m(),m=null)}}}function sm(a){this._internalRoot=a}v0.prototype.render=sm.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,f=Bn();W2(c,f,a,s,null,null)},v0.prototype.unmount=sm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;W2(a.current,2,null,a,null,null),Zf(),s[B]=null}};function v0(a){this._internalRoot=a}v0.prototype.unstable_scheduleHydration=function(a){if(a){var s=b();a={blockedOn:null,target:a,priority:s};for(var c=0;c<Xi.length&&s!==0&&s<Xi[c].priority;c++);Xi.splice(c,0,a),c===0&&Q2(a)}};var ty=e.version;if(ty!=="19.2.1")throw Error(n(527,ty,"19.2.1"));ue.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=d(s),a=a!==null?p(a):null,a=a===null?null:a.stateNode,a};var bk={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_0.isDisabled&&_0.supportsFiber)try{gt=_0.inject(bk),dr=_0}catch{}}return Bo.createRoot=function(a,s){if(!i(a))throw Error(n(299));var c=!1,f="",m=c_,g=o_,T=u_;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(g=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),s=V2(a,1,!1,null,null,c,f,null,m,g,T,ey),a[B]=s.current,H1(a),new sm(s)},Bo.hydrateRoot=function(a,s,c){if(!i(a))throw Error(n(299));var f=!1,m="",g=c_,T=o_,A=u_,V=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(g=c.onUncaughtError),c.onCaughtError!==void 0&&(T=c.onCaughtError),c.onRecoverableError!==void 0&&(A=c.onRecoverableError),c.formState!==void 0&&(V=c.formState)),s=V2(a,1,!0,s,c??null,f,m,V,g,T,A,ey),s.context=G2(null),c=s.current,f=Bn(),f=Wc(f),m=Ri(f),m.callback=null,Oi(c,m,f),c=f,s.current.lanes=c,Es(s,c),Ra(s),a[B]=s.current,H1(a),new v0(s)},Bo.version="19.2.1",Bo}var fy;function Bk(){if(fy)return om.exports;fy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),om.exports=Lk(),om.exports}var Pk=Bk();const Uk=()=>{};var hy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re=function(t,e){if(!t)throw Oc(e)},Oc=function(t){return new Error("Firebase Database ("+YE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},jk=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const l=t[r++];e[n++]=String.fromCharCode((i&31)<<6|l&63)}else if(i>239&&i<365){const l=t[r++],o=t[r++],u=t[r++],h=((i&7)<<18|(l&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const l=t[r++],o=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(l&63)<<6|o&63)}}return e.join("")},Dp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const l=t[i],o=i+1<t.length,u=o?t[i+1]:0,h=i+2<t.length,d=h?t[i+2]:0,p=l>>2,x=(l&3)<<4|u>>4;let v=(u&15)<<2|d>>6,y=d&63;h||(y=64,o||(v=64)),n.push(r[p],r[x],r[v],r[y])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(KE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const l=r[t.charAt(i++)],u=i<t.length?r[t.charAt(i)]:0;++i;const d=i<t.length?r[t.charAt(i)]:64;++i;const x=i<t.length?r[t.charAt(i)]:64;if(++i,l==null||u==null||d==null||x==null)throw new Hk;const v=l<<2|u>>4;if(n.push(v),d!==64){const y=u<<4&240|d>>2;if(n.push(y),x!==64){const E=d<<6&192|x;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Hk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $E=function(t){const e=KE(t);return Dp.encodeByteArray(e,!0)},U0=function(t){return $E(t).replace(/\./g,"")},j0=function(t){try{return Dp.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(t){return QE(void 0,t)}function QE(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const r=e;return new Date(r.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)!e.hasOwnProperty(r)||!Vk(r)||(t[r]=QE(t[r],e[r]));return t}function Vk(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk=()=>Gk().__FIREBASE_DEFAULTS__,Xk=()=>{if(typeof process>"u"||typeof hy>"u")return;const t=hy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},qk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&j0(t[1]);return e&&JSON.parse(e)},Rp=()=>{try{return Uk()||Wk()||Xk()||qk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ZE=t=>{var e,r;return(r=(e=Rp())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},Yk=t=>{const e=ZE(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},JE=()=>{var t;return(t=Rp())==null?void 0:t.config},eT=t=>{var e;return(e=Rp())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function tT(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[U0(JSON.stringify(r)),U0(JSON.stringify(o)),""].join(".")}const Xo={};function $k(){const t={prod:[],emulator:[]};for(const e of Object.keys(Xo))Xo[e]?t.emulator.push(e):t.prod.push(e);return t}function Qk(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let dy=!1;function rT(t,e){if(typeof window>"u"||typeof document>"u"||!Fc(window.location.host)||Xo[t]===e||Xo[t]||dy)return;Xo[t]=e;function r(v){return`__firebase__banner__${v}`}const n="__firebase__banner",l=$k().prod.length>0;function o(){const v=document.getElementById(n);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,y){v.setAttribute("width","24"),v.setAttribute("id",y),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function d(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{dy=!0,o()},v}function p(v,y){v.setAttribute("id",y),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function x(){const v=Qk(n),y=r("text"),E=document.getElementById(y)||document.createElement("span"),w=r("learnmore"),S=document.getElementById(w)||document.createElement("a"),N=r("preprendIcon"),I=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const C=v.element;u(C),p(S,w);const z=d();h(I,N),C.append(I,E,S,z),document.body.appendChild(C)}l?(E.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Op(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mn())}function Zk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Jk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function nT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eA(){const t=mn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function tA(){return YE.NODE_ADMIN===!0}function rA(){try{return typeof indexedDB=="object"}catch{return!1}}function nA(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var l;e(((l=i.error)==null?void 0:l.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA="FirebaseError";class gs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=aA,Object.setPrototypeOf(this,gs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Lu.prototype.create)}}class Lu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,l=this.errors[e],o=l?iA(l,n):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new gs(i,u,n)}}function iA(t,e){return t.replace(sA,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const sA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t){return JSON.parse(t)}function Br(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT=function(t){let e={},r={},n={},i="";try{const l=t.split(".");e=uu(j0(l[0])||""),r=uu(j0(l[1])||""),i=l[2],n=r.d||{},delete r.d}catch{}return{header:e,claims:r,data:n,signature:i}},lA=function(t){const e=aT(t),r=e.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},cA=function(t){const e=aT(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ca(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Qs(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function qm(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function H0(t,e,r){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=e.call(r,t[i],i,t));return n}function Zs(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const l=t[i],o=e[i];if(my(l)&&my(o)){if(!Zs(l,o))return!1}else if(l!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function my(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,r){r||(r=0);const n=this.W_;if(typeof e=="string")for(let x=0;x<16;x++)n[x]=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),r+=4;else for(let x=0;x<16;x++)n[x]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4;for(let x=16;x<80;x++){const v=n[x-3]^n[x-8]^n[x-14]^n[x-16];n[x]=(v<<1|v>>>31)&4294967295}let i=this.chain_[0],l=this.chain_[1],o=this.chain_[2],u=this.chain_[3],h=this.chain_[4],d,p;for(let x=0;x<80;x++){x<40?x<20?(d=u^l&(o^u),p=1518500249):(d=l^o^u,p=1859775393):x<60?(d=l&o|u&(l|o),p=2400959708):(d=l^o^u,p=3395469782);const v=(i<<5|i>>>27)+d+h+p+n[x]&4294967295;h=u,u=o,o=(l<<30|l>>>2)&4294967295,l=i,i=v}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,r){if(e==null)return;r===void 0&&(r=e.length);const n=r-this.blockSize;let i=0;const l=this.buf_;let o=this.inbuf_;for(;i<r;){if(o===0)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<r;)if(l[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(l),o=0;break}}else for(;i<r;)if(l[o]=e[i],++o,++i,o===this.blockSize){this.compress_(l),o=0;break}}this.inbuf_=o,this.total_+=r}digest(){const e=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=r&255,r/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let l=24;l>=0;l-=8)e[n]=this.chain_[i]>>l&255,++n;return e}}function uA(t,e){const r=new fA(t,e);return r.subscribe.bind(r)}class fA{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");hA(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=dm),i.error===void 0&&(i.error=dm),i.complete===void 0&&(i.complete=dm);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function hA(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function dm(){}function Fp(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i>=55296&&i<=56319){const l=i-55296;n++,Re(n<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(n)-56320;i=65536+(l<<10)+o}i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):i<65536?(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},yh=function(t){let e=0;for(let r=0;r<t.length;r++){const n=t.charCodeAt(r);n<128?e++:n<2048?e+=2:n>=55296&&n<=56319?(e+=4,r++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(t){return t&&t._delegate?t._delegate:t}class Js{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Mu;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gA(e))try{this.getOrInitializeService({instanceIdentifier:js})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const l=this.getOrInitializeService({instanceIdentifier:i});n.resolve(l)}catch{}}}}clearInstance(e=js){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=js){return this.instances.has(e)}getOptions(e=js){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[l,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(l);n===u&&o.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const l=this.instances.get(n);return l&&e(l,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:pA(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=js){return this.component?this.component.multipleInstances?e:js:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pA(t){return t===js?void 0:t}function gA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new mA(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Vt||(Vt={}));const vA={debug:Vt.DEBUG,verbose:Vt.VERBOSE,info:Vt.INFO,warn:Vt.WARN,error:Vt.ERROR,silent:Vt.SILENT},_A=Vt.INFO,yA={[Vt.DEBUG]:"log",[Vt.VERBOSE]:"log",[Vt.INFO]:"info",[Vt.WARN]:"warn",[Vt.ERROR]:"error"},wA=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=yA[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ip{constructor(e){this.name=e,this._logLevel=_A,this._logHandler=wA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vt.DEBUG,...e),this._logHandler(this,Vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vt.VERBOSE,...e),this._logHandler(this,Vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vt.INFO,...e),this._logHandler(this,Vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vt.WARN,...e),this._logHandler(this,Vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vt.ERROR,...e),this._logHandler(this,Vt.ERROR,...e)}}const EA=(t,e)=>e.some(r=>t instanceof r);let py,gy;function TA(){return py||(py=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SA(){return gy||(gy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iT=new WeakMap,Ym=new WeakMap,sT=new WeakMap,mm=new WeakMap,Mp=new WeakMap;function bA(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",l),t.removeEventListener("error",o)},l=()=>{r(as(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",l),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&iT.set(r,t)}).catch(()=>{}),Mp.set(e,t),e}function CA(t){if(Ym.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",o),t.removeEventListener("abort",o)},l=()=>{r(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",l),t.addEventListener("error",o),t.addEventListener("abort",o)});Ym.set(t,e)}let Km={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ym.get(t);if(e==="objectStoreNames")return t.objectStoreNames||sT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return as(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function kA(t){Km=t(Km)}function AA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(pm(this),e,...r);return sT.set(n,e.sort?e.sort():[e]),as(n)}:SA().includes(t)?function(...e){return t.apply(pm(this),e),as(iT.get(this))}:function(...e){return as(t.apply(pm(this),e))}}function NA(t){return typeof t=="function"?AA(t):(t instanceof IDBTransaction&&CA(t),EA(t,TA())?new Proxy(t,Km):t)}function as(t){if(t instanceof IDBRequest)return bA(t);if(mm.has(t))return mm.get(t);const e=NA(t);return e!==t&&(mm.set(t,e),Mp.set(e,t)),e}const pm=t=>Mp.get(t);function DA(t,e,{blocked:r,upgrade:n,blocking:i,terminated:l}={}){const o=indexedDB.open(t,e),u=as(o);return n&&o.addEventListener("upgradeneeded",h=>{n(as(o.result),h.oldVersion,h.newVersion,as(o.transaction),h)}),r&&o.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{l&&h.addEventListener("close",()=>l()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const RA=["get","getKey","getAll","getAllKeys","count"],OA=["put","add","delete","clear"],gm=new Map;function xy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(gm.get(e))return gm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=OA.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||RA.includes(r)))return;const l=async function(o,...u){const h=this.transaction(o,i?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),i&&h.done]))[0]};return gm.set(e,l),l}kA(t=>({...t,get:(e,r,n)=>xy(e,r)||t.get(e,r,n),has:(e,r)=>!!xy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(IA(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function IA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $m="@firebase/app",vy="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi=new Ip("@firebase/app"),MA="@firebase/app-compat",LA="@firebase/analytics-compat",BA="@firebase/analytics",PA="@firebase/app-check-compat",UA="@firebase/app-check",jA="@firebase/auth",HA="@firebase/auth-compat",zA="@firebase/database",VA="@firebase/data-connect",GA="@firebase/database-compat",WA="@firebase/functions",XA="@firebase/functions-compat",qA="@firebase/installations",YA="@firebase/installations-compat",KA="@firebase/messaging",$A="@firebase/messaging-compat",QA="@firebase/performance",ZA="@firebase/performance-compat",JA="@firebase/remote-config",eN="@firebase/remote-config-compat",tN="@firebase/storage",rN="@firebase/storage-compat",nN="@firebase/firestore",aN="@firebase/ai",iN="@firebase/firestore-compat",sN="firebase",lN="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qm="[DEFAULT]",cN={[$m]:"fire-core",[MA]:"fire-core-compat",[BA]:"fire-analytics",[LA]:"fire-analytics-compat",[UA]:"fire-app-check",[PA]:"fire-app-check-compat",[jA]:"fire-auth",[HA]:"fire-auth-compat",[zA]:"fire-rtdb",[VA]:"fire-data-connect",[GA]:"fire-rtdb-compat",[WA]:"fire-fn",[XA]:"fire-fn-compat",[qA]:"fire-iid",[YA]:"fire-iid-compat",[KA]:"fire-fcm",[$A]:"fire-fcm-compat",[QA]:"fire-perf",[ZA]:"fire-perf-compat",[JA]:"fire-rc",[eN]:"fire-rc-compat",[tN]:"fire-gcs",[rN]:"fire-gcs-compat",[nN]:"fire-fst",[iN]:"fire-fst-compat",[aN]:"fire-vertex","fire-js":"fire-js",[sN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0=new Map,oN=new Map,Zm=new Map;function _y(t,e){try{t.container.addComponent(e)}catch(r){gi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function bc(t){const e=t.name;if(Zm.has(e))return gi.debug(`There were multiple attempts to register component ${e}.`),!1;Zm.set(e,t);for(const r of z0.values())_y(r,t);for(const r of oN.values())_y(r,t);return!0}function Lp(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function xa(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},is=new Lu("app","Firebase",uN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Js("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw is.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=lN;function lT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Qm,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw is.create("bad-app-name",{appName:String(i)});if(r||(r=JE()),!r)throw is.create("no-options");const l=z0.get(i);if(l){if(Zs(r,l.options)&&Zs(n,l.config))return l;throw is.create("duplicate-app",{appName:i})}const o=new xA(i);for(const h of Zm.values())o.addComponent(h);const u=new fN(r,n,o);return z0.set(i,u),u}function cT(t=Qm){const e=z0.get(t);if(!e&&t===Qm&&JE())return lT();if(!e)throw is.create("no-app",{appName:t});return e}function ss(t,e,r){let n=cN[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),l=e.match(/\s|\//);if(i||l){const o=[`Unable to register library "${n}" with version "${e}":`];i&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&l&&o.push("and"),l&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gi.warn(o.join(" "));return}bc(new Js(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN="firebase-heartbeat-database",dN=1,fu="firebase-heartbeat-store";let xm=null;function oT(){return xm||(xm=DA(hN,dN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(fu)}catch(r){console.warn(r)}}}}).catch(t=>{throw is.create("idb-open",{originalErrorMessage:t.message})})),xm}async function mN(t){try{const r=(await oT()).transaction(fu),n=await r.objectStore(fu).get(uT(t));return await r.done,n}catch(e){if(e instanceof gs)gi.warn(e.message);else{const r=is.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gi.warn(r.message)}}}async function yy(t,e){try{const n=(await oT()).transaction(fu,"readwrite");await n.objectStore(fu).put(e,uT(t)),await n.done}catch(r){if(r instanceof gs)gi.warn(r.message);else{const n=is.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});gi.warn(n.message)}}}function uT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=1024,gN=30;class xN{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new _N(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=wy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(o=>o.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:i}),this._heartbeatsCache.heartbeats.length>gN){const o=yN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){gi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=wy(),{heartbeatsToSend:n,unsentEntries:i}=vN(this._heartbeatsCache.heartbeats),l=U0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(r){return gi.warn(r),""}}}function wy(){return new Date().toISOString().substring(0,10)}function vN(t,e=pN){const r=[];let n=t.slice();for(const i of t){const l=r.find(o=>o.agent===i.agent);if(l){if(l.dates.push(i.date),Ey(r)>e){l.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Ey(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class _N{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rA()?nA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await mN(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return yy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return yy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Ey(t){return U0(JSON.stringify({version:2,heartbeats:t})).length}function yN(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wN(t){bc(new Js("platform-logger",e=>new FA(e),"PRIVATE")),bc(new Js("heartbeat",e=>new xN(e),"PRIVATE")),ss($m,vy,t),ss($m,vy,"esm2020"),ss("fire-js","")}wN("");var EN="firebase",TN="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ss(EN,TN,"app");var Ty={};const Sy="@firebase/database",by="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fT="";function SN(t){fT=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,r){r==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Br(r))}get(e){const r=this.domStorage_.getItem(this.prefixedName_(e));return r==null?null:uu(r)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,r){r==null?delete this.cache_[e]:this.cache_[e]=r}get(e){return Ca(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new bN(e)}}catch{}return new CN},Vs=hT("localStorage"),kN=hT("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mc=new Ip("@firebase/database"),dT=(function(){let t=1;return function(){return t++}})(),mT=function(t){const e=dA(t),r=new oA;r.update(e);const n=r.digest();return Dp.encodeByteArray(n)},Bu=function(...t){let e="";for(let r=0;r<t.length;r++){const n=t[r];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?e+=Bu.apply(null,n):typeof n=="object"?e+=Br(n):e+=n,e+=" "}return e};let qo=null,Cy=!0;const AN=function(t,e){Re(!0,"Can't turn on custom loggers persistently."),mc.logLevel=Vt.VERBOSE,qo=mc.log.bind(mc)},en=function(...t){if(Cy===!0&&(Cy=!1,qo===null&&kN.get("logging_enabled")===!0&&AN()),qo){const e=Bu.apply(null,t);qo(e)}},Pu=function(t){return function(...e){en(t,...e)}},Jm=function(...t){const e="FIREBASE INTERNAL ERROR: "+Bu(...t);mc.error(e)},xi=function(...t){const e=`FIREBASE FATAL ERROR: ${Bu(...t)}`;throw mc.error(e),new Error(e)},An=function(...t){const e="FIREBASE WARNING: "+Bu(...t);mc.warn(e)},NN=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&An("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Bp=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},DN=function(t){if(document.readyState==="complete")t();else{let e=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},Cc="[MIN_NAME]",el="[MAX_NAME]",Lc=function(t,e){if(t===e)return 0;if(t===Cc||e===el)return-1;if(e===Cc||t===el)return 1;{const r=ky(t),n=ky(e);return r!==null?n!==null?r-n===0?t.length-e.length:r-n:-1:n!==null?1:t<e?-1:1}},RN=function(t,e){return t===e?0:t<e?-1:1},Po=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Br(e))},Pp=function(t){if(typeof t!="object"||t===null)return Br(t);const e=[];for(const n in t)e.push(n);e.sort();let r="{";for(let n=0;n<e.length;n++)n!==0&&(r+=","),r+=Br(e[n]),r+=":",r+=Pp(t[e[n]]);return r+="}",r},pT=function(t,e){const r=t.length;if(r<=e)return[t];const n=[];for(let i=0;i<r;i+=e)i+e>r?n.push(t.substring(i,r)):n.push(t.substring(i,i+e));return n};function Dn(t,e){for(const r in t)t.hasOwnProperty(r)&&e(r,t[r])}const gT=function(t){Re(!Bp(t),"Invalid JSON number");const e=11,r=52,n=(1<<e-1)-1;let i,l,o,u,h;t===0?(l=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-n)?(u=Math.min(Math.floor(Math.log(t)/Math.LN2),n),l=u+n,o=Math.round(t*Math.pow(2,r-u)-Math.pow(2,r))):(l=0,o=Math.round(t/Math.pow(2,1-n-r))));const d=[];for(h=r;h;h-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(h=e;h;h-=1)d.push(l%2?1:0),l=Math.floor(l/2);d.push(i?1:0),d.reverse();const p=d.join("");let x="";for(h=0;h<64;h+=8){let v=parseInt(p.substr(h,8),2).toString(16);v.length===1&&(v="0"+v),x=x+v}return x.toLowerCase()},ON=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},FN=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function IN(t,e){let r="Unknown Error";t==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?r="Client doesn't have permission to access the desired data.":t==="unavailable"&&(r="The service is unavailable");const n=new Error(t+" at "+e._path.toString()+": "+r);return n.code=t.toUpperCase(),n}const MN=new RegExp("^-?(0*)\\d{1,10}$"),LN=-2147483648,BN=2147483647,ky=function(t){if(MN.test(t)){const e=Number(t);if(e>=LN&&e<=BN)return e}return null},Bc=function(t){try{t()}catch(e){setTimeout(()=>{const r=e.stack||"";throw An("Exception was thrown by user callback.",r),e},Math.floor(0))}},PN=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Yo=function(t,e){const r=setTimeout(t,e);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(e,r){this.appCheckProvider=r,this.appName=e.name,xa(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(n=>this.appCheck=n)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((r,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(r,n):r(null)},0)})}addTokenChangeListener(e){var r;(r=this.appCheckProvider)==null||r.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){An(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e,r,n){this.appName_=e,this.firebaseOptions_=r,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(r=>r&&r.code==="auth/token-not-initialized"?(en("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(r,n):r(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(r=>r.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(r=>r.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',An(e)}}class F0{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}F0.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up="5",xT="v",vT="s",_T="r",yT="f",wT=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ET="ls",TT="p",ep="ac",ST="websocket",bT="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,r,n,i,l=!1,o="",u=!1,h=!1,d=null){this.secure=r,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=l,this.persistenceKey=o,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=h,this.emulatorOptions=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Vs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Vs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${r}`}}function HN(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function kT(t,e,r){Re(typeof e=="string","typeof type must == string"),Re(typeof r=="object","typeof params must == object");let n;if(e===ST)n=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===bT)n=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);HN(t)&&(r.ns=t.namespace);const i=[];return Dn(r,(l,o)=>{i.push(l+"="+o)}),n+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(){this.counters_={}}incrementCounter(e,r=1){Ca(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=r}get(){return zk(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm={},_m={};function jp(t){const e=t.toString();return vm[e]||(vm[e]=new zN),vm[e]}function VN(t,e){const r=t.toString();return _m[r]||(_m[r]=e()),_m[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,r){this.closeAfterResponse=e,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,r){for(this.pendingResponses[e]=r;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<n.length;++i)n[i]&&Bc(()=>{this.onMessage_(n[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="start",WN="close",XN="pLPCommand",qN="pRTLPCB",AT="id",NT="pw",DT="ser",YN="cb",KN="seg",$N="ts",QN="d",ZN="dframe",RT=1870,OT=30,JN=RT-OT,e6=25e3,t6=3e4;class uc{constructor(e,r,n,i,l,o,u){this.connId=e,this.repoInfo=r,this.applicationId=n,this.appCheckToken=i,this.authToken=l,this.transportSessionId=o,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Pu(e),this.stats_=jp(r),this.urlFn=h=>(this.appCheckToken&&(h[ep]=this.appCheckToken),kT(r,bT,h))}open(e,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new GN(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(t6)),DN(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Hp((...l)=>{const[o,u,h,d,p]=l;if(this.incrementIncomingBytes_(l),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Ay)this.id=u,this.password=h;else if(o===WN)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...l)=>{const[o,u]=l;this.incrementIncomingBytes_(l),this.myPacketOrderer.handleResponse(o,u)},()=>{this.onClosed_()},this.urlFn);const n={};n[Ay]="t",n[DT]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[YN]=this.scriptTagHolder.uniqueCallbackIdentifier),n[xT]=Up,this.transportSessionId&&(n[vT]=this.transportSessionId),this.lastSessionId&&(n[ET]=this.lastSessionId),this.applicationId&&(n[TT]=this.applicationId),this.appCheckToken&&(n[ep]=this.appCheckToken),typeof location<"u"&&location.hostname&&wT.test(location.hostname)&&(n[_T]=yT);const i=this.urlFn(n);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){uc.forceAllow_=!0}static forceDisallow(){uc.forceDisallow_=!0}static isAvailable(){return uc.forceAllow_?!0:!uc.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!ON()&&!FN()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const r=Br(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=$E(r),i=pT(n,JN);for(let l=0;l<i.length;l++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[l]),this.curSegmentNum++}addDisconnectPingFrame(e,r){this.myDisconnFrame=document.createElement("iframe");const n={};n[ZN]="t",n[AT]=e,n[NT]=r,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const r=Br(e).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class Hp{constructor(e,r,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=dT(),window[XN+this.uniqueCallbackIdentifier]=e,window[qN+this.uniqueCallbackIdentifier]=r,this.myIFrame=Hp.createIFrame_();let l="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(l='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+l+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(u){en("frame writing exception"),u.stack&&en(u.stack),en(u)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||en("No IE domain setting required")}catch{const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,r){for(this.myID=e,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[AT]=this.myID,e[NT]=this.myPW,e[DT]=this.currentSerial;let r=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+OT+n.length<=RT;){const o=this.pendingSegs.shift();n=n+"&"+KN+i+"="+o.seg+"&"+$N+i+"="+o.ts+"&"+QN+i+"="+o.d,i++}return r=r+n,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(e,r,n){this.pendingSegs.push({seg:e,ts:r,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,r){this.outstandingRequests.add(r);const n=()=>{this.outstandingRequests.delete(r),this.newRequest_()},i=setTimeout(n,Math.floor(e6)),l=()=>{clearTimeout(i),n()};this.addTag(e,l)}addTag(e,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const i=n.readyState;(!i||i==="loaded"||i==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),r())},n.onerror=()=>{en("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r6=16384,n6=45e3;let V0=null;typeof MozWebSocket<"u"?V0=MozWebSocket:typeof WebSocket<"u"&&(V0=WebSocket);class va{constructor(e,r,n,i,l,o,u){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Pu(this.connId),this.stats_=jp(r),this.connURL=va.connectionURL_(r,o,u,i,n),this.nodeAdmin=r.nodeAdmin}static connectionURL_(e,r,n,i,l){const o={};return o[xT]=Up,typeof location<"u"&&location.hostname&&wT.test(location.hostname)&&(o[_T]=yT),r&&(o[vT]=r),n&&(o[ET]=n),i&&(o[ep]=i),l&&(o[TT]=l),kT(e,ST,o)}open(e,r){this.onDisconnect=r,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Vs.set("previous_websocket_failure",!0);try{let n;tA(),this.mySock=new V0(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){va.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(r);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&V0!==null&&!va.forceDisallow_}static previouslyFailed(){return Vs.isInMemoryStorage||Vs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Vs.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const n=uu(r);this.onMessage(n)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Re(this.frames===null,"We already have a frame buffer"),e.length<=6){const r=Number(e);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const r=e.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const n=this.extractFrameCount_(r);n!==null&&this.appendFrame_(n)}}send(e){this.resetKeepAlive();const r=Br(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=pT(r,r6);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(n6))}sendString_(e){try{this.mySock.send(e)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}va.responsesRequiredToBeHealthy=2;va.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{static get ALL_TRANSPORTS(){return[uc,va]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const r=va&&va.isAvailable();let n=r&&!va.previouslyFailed();if(e.webSocketOnly&&(r||An("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[va];else{const i=this.transports_=[];for(const l of hu.ALL_TRANSPORTS)l&&l.isAvailable()&&i.push(l);hu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}hu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a6=6e4,i6=5e3,s6=10*1024,l6=100*1024,ym="t",Ny="d",c6="s",Dy="r",o6="e",Ry="o",Oy="a",Fy="n",Iy="p",u6="h";class f6{constructor(e,r,n,i,l,o,u,h,d,p){this.id=e,this.repoInfo_=r,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=l,this.onMessage_=o,this.onReady_=u,this.onDisconnect_=h,this.onKill_=d,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Pu("c:"+this.id+":"),this.transportManager_=new hu(r),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Yo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>l6?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>s6?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return r=>{e===this.conn_?this.onConnectionLost_(r):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return r=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(r):e===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(e){const r={t:"d",d:e};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ym in e){const r=e[ym];r===Oy?this.upgradeIfSecondaryHealthy_():r===Dy?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===Ry&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const r=Po("t",e),n=Po("d",e);if(r==="c")this.onSecondaryControl_(n);else if(r==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Iy,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Oy,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Fy,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const r=Po("t",e),n=Po("d",e);r==="c"?this.onControl_(n):r==="d"&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const r=Po(ym,e);if(Ny in e){const n=e[Ny];if(r===u6){const i={...n};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(r===Fy){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===c6?this.onConnectionShutdown_(n):r===Dy?this.onReset_(n):r===o6?Jm("Server Error: "+n):r===Ry?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Jm("Unknown control packet command: "+r)}}onHandshake_(e){const r=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),Up!==n&&An("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),Yo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(a6))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,r){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Yo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(i6))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Iy,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Vs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{put(e,r,n,i){}merge(e,r,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,r,n){}onDisconnectMerge(e,r,n){}onDisconnectCancel(e,r){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e){this.allowedEvents_=e,this.listeners_={},Re(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...r){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,r)}}on(e,r,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:r,context:n});const i=this.getInitialEvent(e);i&&r.apply(n,i)}off(e,r,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let l=0;l<i.length;l++)if(i[l].callback===r&&(!n||n===i[l].context)){i.splice(l,1);return}}validateEventType_(e){Re(this.allowedEvents_.find(r=>r===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0 extends IT{static getInstance(){return new G0}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Op()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Re(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My=32,Ly=768;class qt{constructor(e,r){if(r===void 0){this.pieces_=e.split("/");let n=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=r}toString(){let e="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(e+="/"+this.pieces_[r]);return e||"/"}}function It(){return new qt("")}function mt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function os(t){return t.pieces_.length-t.pieceNum_}function $t(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new qt(t.pieces_,e)}function MT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function h6(t){let e="";for(let r=t.pieceNum_;r<t.pieces_.length;r++)t.pieces_[r]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[r])));return e||"/"}function LT(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function BT(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let r=t.pieceNum_;r<t.pieces_.length-1;r++)e.push(t.pieces_[r]);return new qt(e,0)}function kr(t,e){const r=[];for(let n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);if(e instanceof qt)for(let n=e.pieceNum_;n<e.pieces_.length;n++)r.push(e.pieces_[n]);else{const n=e.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&r.push(n[i])}return new qt(r,0)}function _t(t){return t.pieceNum_>=t.pieces_.length}function Cn(t,e){const r=mt(t),n=mt(e);if(r===null)return e;if(r===n)return Cn($t(t),$t(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function zp(t,e){if(os(t)!==os(e))return!1;for(let r=t.pieceNum_,n=e.pieceNum_;r<=t.pieces_.length;r++,n++)if(t.pieces_[r]!==e.pieces_[n])return!1;return!0}function _a(t,e){let r=t.pieceNum_,n=e.pieceNum_;if(os(t)>os(e))return!1;for(;r<t.pieces_.length;){if(t.pieces_[r]!==e.pieces_[n])return!1;++r,++n}return!0}class d6{constructor(e,r){this.errorPrefix_=r,this.parts_=LT(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=yh(this.parts_[n]);PT(this)}}function m6(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=yh(e),PT(t)}function p6(t){const e=t.parts_.pop();t.byteLength_-=yh(e),t.parts_.length>0&&(t.byteLength_-=1)}function PT(t){if(t.byteLength_>Ly)throw new Error(t.errorPrefix_+"has a key path longer than "+Ly+" bytes ("+t.byteLength_+").");if(t.parts_.length>My)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+My+") or object contains a cycle "+Hs(t))}function Hs(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp extends IT{static getInstance(){return new Vp}constructor(){super(["visible"]);let e,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const n=!document[e];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}getInitialEvent(e){return Re(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo=1e3,g6=300*1e3,By=30*1e3,x6=1.3,v6=3e4,_6="server_kill",Py=3;class di extends FT{constructor(e,r,n,i,l,o,u,h){if(super(),this.repoInfo_=e,this.applicationId_=r,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=l,this.authTokenProvider_=o,this.appCheckTokenProvider_=u,this.authOverride_=h,this.id=di.nextPersistentConnectionId_++,this.log_=Pu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Uo,this.maxReconnectDelay_=g6,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,h)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Vp.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&G0.getInstance().on("online",this.onOnline_,this)}sendRequest(e,r,n){const i=++this.requestNumber_,l={r:i,a:e,b:r};this.log_(Br(l)),Re(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const r=new Mu,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const u=o.d;o.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const l=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(l),r.promise}listen(e,r,n,i){this.initConnection_();const l=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+l),this.listens.has(o)||this.listens.set(o,new Map),Re(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Re(!this.listens.get(o).has(l),"listen() called twice for same path/queryId.");const u={onComplete:i,hashFn:r,query:e,tag:n};this.listens.get(o).set(l,u),this.connected_&&this.sendListen_(u)}sendGet_(e){const r=this.outstandingGets_[e];this.sendRequest("g",r.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(n)})}sendListen_(e){const r=e.query,n=r._path.toString(),i=r._queryIdentifier;this.log_("Listen on "+n+" for "+i);const l={p:n},o="q";e.tag&&(l.q=r._queryObject,l.t=e.tag),l.h=e.hashFn(),this.sendRequest(o,l,u=>{const h=u.d,d=u.s;di.warnOnListenWarnings_(h,r),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",u),d!=="ok"&&this.removeListen_(n,i),e.onComplete&&e.onComplete(d,h))})}static warnOnListenWarnings_(e,r){if(e&&typeof e=="object"&&Ca(e,"w")){const n=Qs(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const i='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();An(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||cA(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=By)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,r=lA(e)?"auth":"gauth",n={cred:e};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(r,n,i=>{const l=i.s,o=i.d||"error";this.authToken_===e&&(l==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const r=e.s,n=e.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,n)})}unlisten(e,r){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),Re(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,r)}sendUnlisten_(e,r,n,i){this.log_("Unlisten on "+e+" for "+r);const l={p:e},o="n";i&&(l.q=n,l.t=i),this.sendRequest(o,l)}onDisconnectPut(e,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,r,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:r,onComplete:n})}onDisconnectMerge(e,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,r,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:r,onComplete:n})}onDisconnectCancel(e,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(e,r,n,i){const l={p:r,d:n};this.log_("onDisconnect "+e,l),this.sendRequest(e,l,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,r,n,i){this.putInternal("p",e,r,n,i)}merge(e,r,n,i){this.putInternal("m",e,r,n,i)}putInternal(e,r,n,i,l){this.initConnection_();const o={p:r,d:n};l!==void 0&&(o.h=l),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(e){const r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(l.s,l.d)})}reportStats(e){if(this.connected_){const r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,n=>{if(n.s!=="ok"){const l=n.d;this.log_("reportStats","Error sending stats: "+l)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Br(e));const r=e.r,n=this.requestCBHash_[r];n&&(delete this.requestCBHash_[r],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,r){this.log_("handleServerMessage",e,r),e==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):e==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):e==="c"?this.onListenRevoked_(r.p,r.q):e==="ac"?this.onAuthRevoked_(r.s,r.d):e==="apc"?this.onAppCheckRevoked_(r.s,r.d):e==="sd"?this.onSecurityDebugPacket_(r):Jm("Unrecognized action received from server: "+Br(e)+`
Are you using the latest client?`)}onReady_(e,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Re(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Uo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Uo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>v6&&(this.reconnectDelay_=Uo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-e);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*x6)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+di.nextConnectionId_++,l=this.lastSessionId;let o=!1,u=null;const h=function(){u?u.close():(o=!0,n())},d=function(x){Re(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(x)};this.realtime_={close:h,sendRequest:d};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[x,v]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?en("getToken() completed but was canceled"):(en("getToken() completed. Creating connection."),this.authToken_=x&&x.accessToken,this.appCheckToken_=v&&v.token,u=new f6(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,r,n,y=>{An(y+" ("+this.repoInfo_.toString()+")"),this.interrupt(_6)},l))}catch(x){this.log_("Failed to get token: "+x),o||(this.repoInfo_.nodeAdmin&&An(x),h())}}}interrupt(e){en("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){en("Resuming connection for reason: "+e),delete this.interruptReasons_[e],qm(this.interruptReasons_)&&(this.reconnectDelay_=Uo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const r=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const r=this.outstandingPuts_[e];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,r){let n;r?n=r.map(l=>Pp(l)).join("$"):n="default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,r){const n=new qt(e).toString();let i;if(this.listens.has(n)){const l=this.listens.get(n);i=l.get(r),l.delete(r),l.size===0&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,r){en("Auth token revoked: "+e+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Py&&(this.reconnectDelay_=By,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,r){en("App check token revoked: "+e+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Py&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const r of e.values())this.sendListen_(r);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let r="js";e["sdk."+r+"."+fT.replace(/\./g,"-")]=1,Op()?e["framework.cordova"]=1:nT()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=G0.getInstance().currentlyOnline();return qm(this.interruptReasons_)&&e}}di.nextPersistentConnectionId_=0;di.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,r){this.name=e,this.node=r}static Wrap(e,r){return new pt(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,r){const n=new pt(Cc,e),i=new pt(Cc,r);return this.compare(n,i)!==0}minPost(){return pt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let y0;class UT extends wh{static get __EMPTY_NODE(){return y0}static set __EMPTY_NODE(e){y0=e}compare(e,r){return Lc(e.name,r.name)}isDefinedOn(e){throw Oc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,r){return!1}minPost(){return pt.MIN}maxPost(){return new pt(el,y0)}makePost(e,r){return Re(typeof e=="string","KeyIndex indexValue must always be a string."),new pt(e,y0)}toString(){return".key"}}const pc=new UT;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,r,n,i,l=null){this.isReverse_=i,this.resultGenerator_=l,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=r?n(e.key,r):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(e.key,e.value):r={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ir{constructor(e,r,n,i,l){this.key=e,this.value=r,this.color=n??Ir.RED,this.left=i??kn.EMPTY_NODE,this.right=l??kn.EMPTY_NODE}copy(e,r,n,i,l){return new Ir(e??this.key,r??this.value,n??this.color,i??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const l=n(e,i.key);return l<0?i=i.copy(null,null,null,i.left.insert(e,r,n),null):l===0?i=i.copy(null,r,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return kn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,r){let n,i;if(n=this,r(e,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,r),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),r(e,n.key)===0){if(n.right.isEmpty())return kn.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,r))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ir.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ir.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ir.RED=!0;Ir.BLACK=!1;class y6{copy(e,r,n,i,l){return this}insert(e,r,n){return new Ir(e,r,null)}remove(e,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class kn{constructor(e,r=kn.EMPTY_NODE){this.comparator_=e,this.root_=r}insert(e,r){return new kn(this.comparator_,this.root_.insert(e,r,this.comparator_).copy(null,null,Ir.BLACK,null,null))}remove(e){return new kn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ir.BLACK,null,null))}get(e){let r,n=this.root_;for(;!n.isEmpty();){if(r=this.comparator_(e,n.key),r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}getPredecessorKey(e){let r,n=this.root_,i=null;for(;!n.isEmpty();)if(r=this.comparator_(e,n.key),r===0){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else r<0?n=n.left:r>0&&(i=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new w0(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,r){return new w0(this.root_,e,this.comparator_,!1,r)}getReverseIteratorFrom(e,r){return new w0(this.root_,e,this.comparator_,!0,r)}getReverseIterator(e){return new w0(this.root_,null,this.comparator_,!0,e)}}kn.EMPTY_NODE=new y6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w6(t,e){return Lc(t.name,e.name)}function Gp(t,e){return Lc(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tp;function E6(t){tp=t}const jT=function(t){return typeof t=="number"?"number:"+gT(t):"string:"+t},HT=function(t){if(t.isLeafNode()){const e=t.val();Re(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ca(e,".sv"),"Priority must be a string or number.")}else Re(t===tp||t.isEmpty(),"priority of unexpected type.");Re(t===tp||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uy;class Or{static set __childrenNodeConstructor(e){Uy=e}static get __childrenNodeConstructor(){return Uy}constructor(e,r=Or.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=r,this.lazyHash_=null,Re(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),HT(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Or(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Or.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return _t(e)?this:mt(e)===".priority"?this.priorityNode_:Or.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,r){return null}updateImmediateChild(e,r){return e===".priority"?this.updatePriority(r):r.isEmpty()&&e!==".priority"?this:Or.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,r).updatePriority(this.priorityNode_)}updateChild(e,r){const n=mt(e);return n===null?r:r.isEmpty()&&n!==".priority"?this:(Re(n!==".priority"||os(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,Or.__childrenNodeConstructor.EMPTY_NODE.updateChild($t(e),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,r){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+jT(this.priorityNode_.val())+":");const r=typeof this.value_;e+=r+":",r==="number"?e+=gT(this.value_):e+=this.value_,this.lazyHash_=mT(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Or.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Or.__childrenNodeConstructor?-1:(Re(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const r=typeof e.value_,n=typeof this.value_,i=Or.VALUE_TYPE_ORDER.indexOf(r),l=Or.VALUE_TYPE_ORDER.indexOf(n);return Re(i>=0,"Unknown leaf type: "+r),Re(l>=0,"Unknown leaf type: "+n),i===l?n==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:l-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const r=e;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}Or.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zT,VT;function T6(t){zT=t}function S6(t){VT=t}class b6 extends wh{compare(e,r){const n=e.node.getPriority(),i=r.node.getPriority(),l=n.compareTo(i);return l===0?Lc(e.name,r.name):l}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,r){return!e.getPriority().equals(r.getPriority())}minPost(){return pt.MIN}maxPost(){return new pt(el,new Or("[PRIORITY-POST]",VT))}makePost(e,r){const n=zT(e);return new pt(r,new Or("[PRIORITY-POST]",n))}toString(){return".priority"}}const ir=new b6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=Math.log(2);class k6{constructor(e){const r=l=>parseInt(Math.log(l)/C6,10),n=l=>parseInt(Array(l+1).join("1"),2);this.count=r(e+1),this.current_=this.count-1;const i=n(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const W0=function(t,e,r,n){t.sort(e);const i=function(h,d){const p=d-h;let x,v;if(p===0)return null;if(p===1)return x=t[h],v=r?r(x):x,new Ir(v,x.node,Ir.BLACK,null,null);{const y=parseInt(p/2,10)+h,E=i(h,y),w=i(y+1,d);return x=t[y],v=r?r(x):x,new Ir(v,x.node,Ir.BLACK,E,w)}},l=function(h){let d=null,p=null,x=t.length;const v=function(E,w){const S=x-E,N=x;x-=E;const I=i(S+1,N),C=t[S],z=r?r(C):C;y(new Ir(z,C.node,w,null,I))},y=function(E){d?(d.left=E,d=E):(p=E,d=E)};for(let E=0;E<h.count;++E){const w=h.nextBitIsOne(),S=Math.pow(2,h.count-(E+1));w?v(S,Ir.BLACK):(v(S,Ir.BLACK),v(S,Ir.RED))}return p},o=new k6(t.length),u=l(o);return new kn(n||e,u)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wm;const ac={};class oi{static get Default(){return Re(ac&&ir,"ChildrenNode.ts has not been loaded"),wm=wm||new oi({".priority":ac},{".priority":ir}),wm}constructor(e,r){this.indexes_=e,this.indexSet_=r}get(e){const r=Qs(this.indexes_,e);if(!r)throw new Error("No index defined for "+e);return r instanceof kn?r:null}hasIndex(e){return Ca(this.indexSet_,e.toString())}addIndex(e,r){Re(e!==pc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const l=r.getIterator(pt.Wrap);let o=l.getNext();for(;o;)i=i||e.isDefinedOn(o.node),n.push(o),o=l.getNext();let u;i?u=W0(n,e.getCompare()):u=ac;const h=e.toString(),d={...this.indexSet_};d[h]=e;const p={...this.indexes_};return p[h]=u,new oi(p,d)}addToIndexes(e,r){const n=H0(this.indexes_,(i,l)=>{const o=Qs(this.indexSet_,l);if(Re(o,"Missing index implementation for "+l),i===ac)if(o.isDefinedOn(e.node)){const u=[],h=r.getIterator(pt.Wrap);let d=h.getNext();for(;d;)d.name!==e.name&&u.push(d),d=h.getNext();return u.push(e),W0(u,o.getCompare())}else return ac;else{const u=r.get(e.name);let h=i;return u&&(h=h.remove(new pt(e.name,u))),h.insert(e,e.node)}});return new oi(n,this.indexSet_)}removeFromIndexes(e,r){const n=H0(this.indexes_,i=>{if(i===ac)return i;{const l=r.get(e.name);return l?i.remove(new pt(e.name,l)):i}});return new oi(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jo;class et{static get EMPTY_NODE(){return jo||(jo=new et(new kn(Gp),null,oi.Default))}constructor(e,r,n){this.children_=e,this.priorityNode_=r,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&HT(this.priorityNode_),this.children_.isEmpty()&&Re(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||jo}updatePriority(e){return this.children_.isEmpty()?this:new et(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const r=this.children_.get(e);return r===null?jo:r}}getChild(e){const r=mt(e);return r===null?this:this.getImmediateChild(r).getChild($t(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,r){if(Re(r,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(r);{const n=new pt(e,r);let i,l;r.isEmpty()?(i=this.children_.remove(e),l=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,r),l=this.indexMap_.addToIndexes(n,this.children_));const o=i.isEmpty()?jo:this.priorityNode_;return new et(i,o,l)}}updateChild(e,r){const n=mt(e);if(n===null)return r;{Re(mt(e)!==".priority"||os(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild($t(e),r);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const r={};let n=0,i=0,l=!0;if(this.forEachChild(ir,(o,u)=>{r[o]=u.val(e),n++,l&&et.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):l=!1}),!e&&l&&i<2*n){const o=[];for(const u in r)o[u]=r[u];return o}else return e&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+jT(this.getPriority().val())+":"),this.forEachChild(ir,(r,n)=>{const i=n.hash();i!==""&&(e+=":"+r+":"+i)}),this.lazyHash_=e===""?"":mT(e)}return this.lazyHash_}getPredecessorChildName(e,r,n){const i=this.resolveIndex_(n);if(i){const l=i.getPredecessorKey(new pt(e,r));return l?l.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const r=this.resolveIndex_(e);if(r){const n=r.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(e){const r=this.getFirstChildName(e);return r?new pt(r,this.children_.get(r)):null}getLastChildName(e){const r=this.resolveIndex_(e);if(r){const n=r.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(e){const r=this.getLastChildName(e);return r?new pt(r,this.children_.get(r)):null}forEachChild(e,r){const n=this.resolveIndex_(e);return n?n.inorderTraversal(i=>r(i.name,i.node)):this.children_.inorderTraversal(r)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,r){const n=this.resolveIndex_(r);if(n)return n.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,pt.Wrap);let l=i.peek();for(;l!=null&&r.compare(l,e)<0;)i.getNext(),l=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,r){const n=this.resolveIndex_(r);if(n)return n.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,pt.Wrap);let l=i.peek();for(;l!=null&&r.compare(l,e)>0;)i.getNext(),l=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Uu?-1:0}withIndex(e){if(e===pc||this.indexMap_.hasIndex(e))return this;{const r=this.indexMap_.addIndex(e,this.children_);return new et(this.children_,this.priorityNode_,r)}}isIndexed(e){return e===pc||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const r=e;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const n=this.getIterator(ir),i=r.getIterator(ir);let l=n.getNext(),o=i.getNext();for(;l&&o;){if(l.name!==o.name||!l.node.equals(o.node))return!1;l=n.getNext(),o=i.getNext()}return l===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===pc?null:this.indexMap_.get(e.toString())}}et.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class A6 extends et{constructor(){super(new kn(Gp),et.EMPTY_NODE,oi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return et.EMPTY_NODE}isEmpty(){return!1}}const Uu=new A6;Object.defineProperties(pt,{MIN:{value:new pt(Cc,et.EMPTY_NODE)},MAX:{value:new pt(el,Uu)}});UT.__EMPTY_NODE=et.EMPTY_NODE;Or.__childrenNodeConstructor=et;E6(Uu);S6(Uu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N6=!0;function Mr(t,e=null){if(t===null)return et.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),Re(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const r=t;return new Or(r,Mr(e))}if(!(t instanceof Array)&&N6){const r=[];let n=!1;if(Dn(t,(o,u)=>{if(o.substring(0,1)!=="."){const h=Mr(u);h.isEmpty()||(n=n||!h.getPriority().isEmpty(),r.push(new pt(o,h)))}}),r.length===0)return et.EMPTY_NODE;const l=W0(r,w6,o=>o.name,Gp);if(n){const o=W0(r,ir.getCompare());return new et(l,Mr(e),new oi({".priority":o},{".priority":ir}))}else return new et(l,Mr(e),oi.Default)}else{let r=et.EMPTY_NODE;return Dn(t,(n,i)=>{if(Ca(t,n)&&n.substring(0,1)!=="."){const l=Mr(i);(l.isLeafNode()||!l.isEmpty())&&(r=r.updateImmediateChild(n,l))}}),r.updatePriority(Mr(e))}}T6(Mr);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6 extends wh{constructor(e){super(),this.indexPath_=e,Re(!_t(e)&&mt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,r){const n=this.extractChild(e.node),i=this.extractChild(r.node),l=n.compareTo(i);return l===0?Lc(e.name,r.name):l}makePost(e,r){const n=Mr(e),i=et.EMPTY_NODE.updateChild(this.indexPath_,n);return new pt(r,i)}maxPost(){const e=et.EMPTY_NODE.updateChild(this.indexPath_,Uu);return new pt(el,e)}toString(){return LT(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6 extends wh{compare(e,r){const n=e.node.compareTo(r.node);return n===0?Lc(e.name,r.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,r){return!e.equals(r)}minPost(){return pt.MIN}maxPost(){return pt.MAX}makePost(e,r){const n=Mr(e);return new pt(r,n)}toString(){return".value"}}const O6=new R6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GT(t){return{type:"value",snapshotNode:t}}function kc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function du(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function mu(t,e,r){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:r}}function F6(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e){this.index_=e}updateChild(e,r,n,i,l,o){Re(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const u=e.getImmediateChild(r);return u.getChild(i).equals(n.getChild(i))&&u.isEmpty()===n.isEmpty()||(o!=null&&(n.isEmpty()?e.hasChild(r)?o.trackChildChange(du(r,u)):Re(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?o.trackChildChange(kc(r,n)):o.trackChildChange(mu(r,n,u))),e.isLeafNode()&&n.isEmpty())?e:e.updateImmediateChild(r,n).withIndex(this.index_)}updateFullNode(e,r,n){return n!=null&&(e.isLeafNode()||e.forEachChild(ir,(i,l)=>{r.hasChild(i)||n.trackChildChange(du(i,l))}),r.isLeafNode()||r.forEachChild(ir,(i,l)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(l)||n.trackChildChange(mu(i,l,o))}else n.trackChildChange(kc(i,l))})),r.withIndex(this.index_)}updatePriority(e,r){return e.isEmpty()?et.EMPTY_NODE:e.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this.indexedFilter_=new Wp(e.getIndex()),this.index_=e.getIndex(),this.startPost_=pu.getStartPost_(e),this.endPost_=pu.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return r&&n}updateChild(e,r,n,i,l,o){return this.matches(new pt(r,n))||(n=et.EMPTY_NODE),this.indexedFilter_.updateChild(e,r,n,i,l,o)}updateFullNode(e,r,n){r.isLeafNode()&&(r=et.EMPTY_NODE);let i=r.withIndex(this.index_);i=i.updatePriority(et.EMPTY_NODE);const l=this;return r.forEachChild(ir,(o,u)=>{l.matches(new pt(o,u))||(i=i.updateImmediateChild(o,et.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,r){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const r=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),r)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const r=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),r)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const n=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=r=>{const n=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new pu(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,r,n,i,l,o){return this.rangedFilter_.matches(new pt(r,n))||(n=et.EMPTY_NODE),e.getImmediateChild(r).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,r,n,i,l,o):this.fullLimitUpdateChild_(e,r,n,l,o)}updateFullNode(e,r,n){let i;if(r.isLeafNode()||r.isEmpty())i=et.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){i=et.EMPTY_NODE.withIndex(this.index_);let l;this.reverse_?l=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):l=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;l.hasNext()&&o<this.limit_;){const u=l.getNext();if(this.withinDirectionalStart(u))if(this.withinDirectionalEnd(u))i=i.updateImmediateChild(u.name,u.node),o++;else break;else continue}}else{i=r.withIndex(this.index_),i=i.updatePriority(et.EMPTY_NODE);let l;this.reverse_?l=i.getReverseIterator(this.index_):l=i.getIterator(this.index_);let o=0;for(;l.hasNext();){const u=l.getNext();o<this.limit_&&this.withinDirectionalStart(u)&&this.withinDirectionalEnd(u)?o++:i=i.updateImmediateChild(u.name,et.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,r){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,r,n,i,l){let o;if(this.reverse_){const x=this.index_.getCompare();o=(v,y)=>x(y,v)}else o=this.index_.getCompare();const u=e;Re(u.numChildren()===this.limit_,"");const h=new pt(r,n),d=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),p=this.rangedFilter_.matches(h);if(u.hasChild(r)){const x=u.getImmediateChild(r);let v=i.getChildAfterChild(this.index_,d,this.reverse_);for(;v!=null&&(v.name===r||u.hasChild(v.name));)v=i.getChildAfterChild(this.index_,v,this.reverse_);const y=v==null?1:o(v,h);if(p&&!n.isEmpty()&&y>=0)return l!=null&&l.trackChildChange(mu(r,n,x)),u.updateImmediateChild(r,n);{l!=null&&l.trackChildChange(du(r,x));const w=u.updateImmediateChild(r,et.EMPTY_NODE);return v!=null&&this.rangedFilter_.matches(v)?(l!=null&&l.trackChildChange(kc(v.name,v.node)),w.updateImmediateChild(v.name,v.node)):w}}else return n.isEmpty()?e:p&&o(d,h)>=0?(l!=null&&(l.trackChildChange(du(d.name,d.node)),l.trackChildChange(kc(r,n))),u.updateImmediateChild(r,n).updateImmediateChild(d.name,et.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ir}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Re(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Re(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Cc}hasEnd(){return this.endSet_}getIndexEndValue(){return Re(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Re(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:el}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Re(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ir}copy(){const e=new Xp;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function M6(t){return t.loadsAllData()?new Wp(t.getIndex()):t.hasLimit()?new I6(t):new pu(t)}function jy(t){const e={};if(t.isDefault())return e;let r;if(t.index_===ir?r="$priority":t.index_===O6?r="$value":t.index_===pc?r="$key":(Re(t.index_ instanceof D6,"Unrecognized index type!"),r=t.index_.toString()),e.orderBy=Br(r),t.startSet_){const n=t.startAfterSet_?"startAfter":"startAt";e[n]=Br(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+Br(t.indexStartName_))}if(t.endSet_){const n=t.endBeforeSet_?"endBefore":"endAt";e[n]=Br(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+Br(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Hy(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let r=t.viewFrom_;r===""&&(t.isViewFromLeft()?r="l":r="r"),e.vf=r}return t.index_!==ir&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0 extends FT{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,r){return r!==void 0?"tag$"+r:(Re(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,r,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=r,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Pu("p:rest:"),this.listens_={}}listen(e,r,n,i){const l=e._path.toString();this.log_("Listen called for "+l+" "+e._queryIdentifier);const o=X0.getListenId_(e,n),u={};this.listens_[o]=u;const h=jy(e._queryParams);this.restRequest_(l+".json",h,(d,p)=>{let x=p;if(d===404&&(x=null,d=null),d===null&&this.onDataUpdate_(l,x,!1,n),Qs(this.listens_,o)===u){let v;d?d===401?v="permission_denied":v="rest_error:"+d:v="ok",i(v,null)}})}unlisten(e,r){const n=X0.getListenId_(e,r);delete this.listens_[n]}get(e){const r=jy(e._queryParams),n=e._path.toString(),i=new Mu;return this.restRequest_(n+".json",r,(l,o)=>{let u=o;l===404&&(u=null,l=null),l===null?(this.onDataUpdate_(n,u,!1,null),i.resolve(u)):i.reject(new Error(u))}),i.promise}refreshAuthToken(e){}restRequest_(e,r={},n){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,l])=>{i&&i.accessToken&&(r.auth=i.accessToken),l&&l.token&&(r.ac=l.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ic(r);this.log_("Sending REST request for "+o);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(n&&u.readyState===4){this.log_("REST Response for "+o+" received. status:",u.status,"response:",u.responseText);let h=null;if(u.status>=200&&u.status<300){try{h=uu(u.responseText)}catch{An("Failed to parse JSON response for "+o+": "+u.responseText)}n(null,h)}else u.status!==401&&u.status!==404&&An("Got unsuccessful REST response for "+o+" Status: "+u.status),n(u.status);n=null}},u.open("GET",o,!0),u.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(){this.rootNode_=et.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,r){this.rootNode_=this.rootNode_.updateChild(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(){return{value:null,children:new Map}}function WT(t,e,r){if(_t(e))t.value=r,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,r);else{const n=mt(e);t.children.has(n)||t.children.set(n,q0());const i=t.children.get(n);e=$t(e),WT(i,e,r)}}function rp(t,e,r){t.value!==null?r(e,t.value):B6(t,(n,i)=>{const l=new qt(e.toString()+"/"+n);rp(i,l,r)})}function B6(t,e){t.children.forEach((r,n)=>{e(n,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),r={...e};return this.last_&&Dn(this.last_,(n,i)=>{r[n]=r[n]-i}),this.last_=e,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy=10*1e3,U6=30*1e3,j6=300*1e3;class H6{constructor(e,r){this.server_=r,this.statsToReport_={},this.statsListener_=new P6(e);const n=zy+(U6-zy)*Math.random();Yo(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),r={};let n=!1;Dn(e,(i,l)=>{l>0&&Ca(this.statsToReport_,i)&&(r[i]=l,n=!0)}),n&&this.server_.reportStats(r),Yo(this.reportStats_.bind(this),Math.floor(Math.random()*2*j6))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ya;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ya||(ya={}));function XT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function qp(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Yp(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,r,n){this.path=e,this.affectedTree=r,this.revert=n,this.type=ya.ACK_USER_WRITE,this.source=XT()}operationForChild(e){if(_t(this.path)){if(this.affectedTree.value!=null)return Re(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new qt(e));return new Y0(It(),r,this.revert)}}else return Re(mt(this.path)===e,"operationForChild called for unrelated child."),new Y0($t(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,r){this.source=e,this.path=r,this.type=ya.LISTEN_COMPLETE}operationForChild(e){return _t(this.path)?new gu(this.source,It()):new gu(this.source,$t(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,r,n){this.source=e,this.path=r,this.snap=n,this.type=ya.OVERWRITE}operationForChild(e){return _t(this.path)?new tl(this.source,It(),this.snap.getImmediateChild(e)):new tl(this.source,$t(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,r,n){this.source=e,this.path=r,this.children=n,this.type=ya.MERGE}operationForChild(e){if(_t(this.path)){const r=this.children.subtree(new qt(e));return r.isEmpty()?null:r.value?new tl(this.source,It(),r.value):new xu(this.source,It(),r)}else return Re(mt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new xu(this.source,$t(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,r,n){this.node_=e,this.fullyInitialized_=r,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_t(e))return this.isFullyInitialized()&&!this.filtered_;const r=mt(e);return this.isCompleteForChild(r)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z6{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function V6(t,e,r,n){const i=[],l=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&l.push(F6(o.childName,o.snapshotNode))}),Ho(t,i,"child_removed",e,n,r),Ho(t,i,"child_added",e,n,r),Ho(t,i,"child_moved",l,n,r),Ho(t,i,"child_changed",e,n,r),Ho(t,i,"value",e,n,r),i}function Ho(t,e,r,n,i,l){const o=n.filter(u=>u.type===r);o.sort((u,h)=>W6(t,u,h)),o.forEach(u=>{const h=G6(t,u,l);i.forEach(d=>{d.respondsTo(u.type)&&e.push(d.createEvent(h,t.query_))})})}function G6(t,e,r){return e.type==="value"||e.type==="child_removed"||(e.prevName=r.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function W6(t,e,r){if(e.childName==null||r.childName==null)throw Oc("Should only compare child_ events.");const n=new pt(e.childName,e.snapshotNode),i=new pt(r.childName,r.snapshotNode);return t.index_.compare(n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eh(t,e){return{eventCache:t,serverCache:e}}function Ko(t,e,r,n){return Eh(new rl(e,r,n),t.serverCache)}function qT(t,e,r,n){return Eh(t.eventCache,new rl(e,r,n))}function np(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function nl(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Em;const X6=()=>(Em||(Em=new kn(RN)),Em);class Jt{static fromObject(e){let r=new Jt(null);return Dn(e,(n,i)=>{r=r.set(new qt(n),i)}),r}constructor(e,r=X6()){this.value=e,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,r){if(this.value!=null&&r(this.value))return{path:It(),value:this.value};if(_t(e))return null;{const n=mt(e),i=this.children.get(n);if(i!==null){const l=i.findRootMostMatchingPathAndValue($t(e),r);return l!=null?{path:kr(new qt(n),l.path),value:l.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_t(e))return this;{const r=mt(e),n=this.children.get(r);return n!==null?n.subtree($t(e)):new Jt(null)}}set(e,r){if(_t(e))return new Jt(r,this.children);{const n=mt(e),l=(this.children.get(n)||new Jt(null)).set($t(e),r),o=this.children.insert(n,l);return new Jt(this.value,o)}}remove(e){if(_t(e))return this.children.isEmpty()?new Jt(null):new Jt(null,this.children);{const r=mt(e),n=this.children.get(r);if(n){const i=n.remove($t(e));let l;return i.isEmpty()?l=this.children.remove(r):l=this.children.insert(r,i),this.value===null&&l.isEmpty()?new Jt(null):new Jt(this.value,l)}else return this}}get(e){if(_t(e))return this.value;{const r=mt(e),n=this.children.get(r);return n?n.get($t(e)):null}}setTree(e,r){if(_t(e))return r;{const n=mt(e),l=(this.children.get(n)||new Jt(null)).setTree($t(e),r);let o;return l.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,l),new Jt(this.value,o)}}fold(e){return this.fold_(It(),e)}fold_(e,r){const n={};return this.children.inorderTraversal((i,l)=>{n[i]=l.fold_(kr(e,i),r)}),r(e,this.value,n)}findOnPath(e,r){return this.findOnPath_(e,It(),r)}findOnPath_(e,r,n){const i=this.value?n(r,this.value):!1;if(i)return i;if(_t(e))return null;{const l=mt(e),o=this.children.get(l);return o?o.findOnPath_($t(e),kr(r,l),n):null}}foreachOnPath(e,r){return this.foreachOnPath_(e,It(),r)}foreachOnPath_(e,r,n){if(_t(e))return this;{this.value&&n(r,this.value);const i=mt(e),l=this.children.get(i);return l?l.foreachOnPath_($t(e),kr(r,i),n):new Jt(null)}}foreach(e){this.foreach_(It(),e)}foreach_(e,r){this.children.inorderTraversal((n,i)=>{i.foreach_(kr(e,n),r)}),this.value&&r(e,this.value)}foreachChild(e){this.children.inorderTraversal((r,n)=>{n.value&&e(r,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e){this.writeTree_=e}static empty(){return new Ta(new Jt(null))}}function $o(t,e,r){if(_t(e))return new Ta(new Jt(r));{const n=t.writeTree_.findRootMostValueAndPath(e);if(n!=null){const i=n.path;let l=n.value;const o=Cn(i,e);return l=l.updateChild(o,r),new Ta(t.writeTree_.set(i,l))}else{const i=new Jt(r),l=t.writeTree_.setTree(e,i);return new Ta(l)}}}function Vy(t,e,r){let n=t;return Dn(r,(i,l)=>{n=$o(n,kr(e,i),l)}),n}function Gy(t,e){if(_t(e))return Ta.empty();{const r=t.writeTree_.setTree(e,new Jt(null));return new Ta(r)}}function ap(t,e){return hl(t,e)!=null}function hl(t,e){const r=t.writeTree_.findRootMostValueAndPath(e);return r!=null?t.writeTree_.get(r.path).getChild(Cn(r.path,e)):null}function Wy(t){const e=[],r=t.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(ir,(n,i)=>{e.push(new pt(n,i))}):t.writeTree_.children.inorderTraversal((n,i)=>{i.value!=null&&e.push(new pt(n,i.value))}),e}function ls(t,e){if(_t(e))return t;{const r=hl(t,e);return r!=null?new Ta(new Jt(r)):new Ta(t.writeTree_.subtree(e))}}function ip(t){return t.writeTree_.isEmpty()}function Ac(t,e){return YT(It(),t.writeTree_,e)}function YT(t,e,r){if(e.value!=null)return r.updateChild(t,e.value);{let n=null;return e.children.inorderTraversal((i,l)=>{i===".priority"?(Re(l.value!==null,"Priority writes must always be leaf nodes"),n=l.value):r=YT(kr(t,i),l,r)}),!r.getChild(t).isEmpty()&&n!==null&&(r=r.updateChild(kr(t,".priority"),n)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(t,e){return ZT(e,t)}function q6(t,e,r,n,i){Re(n>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:r,writeId:n,visible:i}),i&&(t.visibleWrites=$o(t.visibleWrites,e,r)),t.lastWriteId=n}function Y6(t,e){for(let r=0;r<t.allWrites.length;r++){const n=t.allWrites[r];if(n.writeId===e)return n}return null}function K6(t,e){const r=t.allWrites.findIndex(u=>u.writeId===e);Re(r>=0,"removeWrite called with nonexistent writeId.");const n=t.allWrites[r];t.allWrites.splice(r,1);let i=n.visible,l=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const u=t.allWrites[o];u.visible&&(o>=r&&$6(u,n.path)?i=!1:_a(n.path,u.path)&&(l=!0)),o--}if(i){if(l)return Q6(t),!0;if(n.snap)t.visibleWrites=Gy(t.visibleWrites,n.path);else{const u=n.children;Dn(u,h=>{t.visibleWrites=Gy(t.visibleWrites,kr(n.path,h))})}return!0}else return!1}function $6(t,e){if(t.snap)return _a(t.path,e);for(const r in t.children)if(t.children.hasOwnProperty(r)&&_a(kr(t.path,r),e))return!0;return!1}function Q6(t){t.visibleWrites=KT(t.allWrites,Z6,It()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Z6(t){return t.visible}function KT(t,e,r){let n=Ta.empty();for(let i=0;i<t.length;++i){const l=t[i];if(e(l)){const o=l.path;let u;if(l.snap)_a(r,o)?(u=Cn(r,o),n=$o(n,u,l.snap)):_a(o,r)&&(u=Cn(o,r),n=$o(n,It(),l.snap.getChild(u)));else if(l.children){if(_a(r,o))u=Cn(r,o),n=Vy(n,u,l.children);else if(_a(o,r))if(u=Cn(o,r),_t(u))n=Vy(n,It(),l.children);else{const h=Qs(l.children,mt(u));if(h){const d=h.getChild($t(u));n=$o(n,It(),d)}}}else throw Oc("WriteRecord should have .snap or .children")}}return n}function $T(t,e,r,n,i){if(!n&&!i){const l=hl(t.visibleWrites,e);if(l!=null)return l;{const o=ls(t.visibleWrites,e);if(ip(o))return r;if(r==null&&!ap(o,It()))return null;{const u=r||et.EMPTY_NODE;return Ac(o,u)}}}else{const l=ls(t.visibleWrites,e);if(!i&&ip(l))return r;if(!i&&r==null&&!ap(l,It()))return null;{const o=function(d){return(d.visible||i)&&(!n||!~n.indexOf(d.writeId))&&(_a(d.path,e)||_a(e,d.path))},u=KT(t.allWrites,o,e),h=r||et.EMPTY_NODE;return Ac(u,h)}}}function J6(t,e,r){let n=et.EMPTY_NODE;const i=hl(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ir,(l,o)=>{n=n.updateImmediateChild(l,o)}),n;if(r){const l=ls(t.visibleWrites,e);return r.forEachChild(ir,(o,u)=>{const h=Ac(ls(l,new qt(o)),u);n=n.updateImmediateChild(o,h)}),Wy(l).forEach(o=>{n=n.updateImmediateChild(o.name,o.node)}),n}else{const l=ls(t.visibleWrites,e);return Wy(l).forEach(o=>{n=n.updateImmediateChild(o.name,o.node)}),n}}function e8(t,e,r,n,i){Re(n||i,"Either existingEventSnap or existingServerSnap must exist");const l=kr(e,r);if(ap(t.visibleWrites,l))return null;{const o=ls(t.visibleWrites,l);return ip(o)?i.getChild(r):Ac(o,i.getChild(r))}}function t8(t,e,r,n){const i=kr(e,r),l=hl(t.visibleWrites,i);if(l!=null)return l;if(n.isCompleteForChild(r)){const o=ls(t.visibleWrites,i);return Ac(o,n.getNode().getImmediateChild(r))}else return null}function r8(t,e){return hl(t.visibleWrites,e)}function n8(t,e,r,n,i,l,o){let u;const h=ls(t.visibleWrites,e),d=hl(h,It());if(d!=null)u=d;else if(r!=null)u=Ac(h,r);else return[];if(u=u.withIndex(o),!u.isEmpty()&&!u.isLeafNode()){const p=[],x=o.getCompare(),v=l?u.getReverseIteratorFrom(n,o):u.getIteratorFrom(n,o);let y=v.getNext();for(;y&&p.length<i;)x(y,n)!==0&&p.push(y),y=v.getNext();return p}else return[]}function a8(){return{visibleWrites:Ta.empty(),allWrites:[],lastWriteId:-1}}function K0(t,e,r,n){return $T(t.writeTree,t.treePath,e,r,n)}function $p(t,e){return J6(t.writeTree,t.treePath,e)}function Xy(t,e,r,n){return e8(t.writeTree,t.treePath,e,r,n)}function $0(t,e){return r8(t.writeTree,kr(t.treePath,e))}function i8(t,e,r,n,i,l){return n8(t.writeTree,t.treePath,e,r,n,i,l)}function Qp(t,e,r){return t8(t.writeTree,t.treePath,e,r)}function QT(t,e){return ZT(kr(t.treePath,e),t.writeTree)}function ZT(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s8{constructor(){this.changeMap=new Map}trackChildChange(e){const r=e.type,n=e.childName;Re(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),Re(n!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const l=i.type;if(r==="child_added"&&l==="child_removed")this.changeMap.set(n,mu(n,e.snapshotNode,i.snapshotNode));else if(r==="child_removed"&&l==="child_added")this.changeMap.delete(n);else if(r==="child_removed"&&l==="child_changed")this.changeMap.set(n,du(n,i.oldSnap));else if(r==="child_changed"&&l==="child_added")this.changeMap.set(n,kc(n,e.snapshotNode));else if(r==="child_changed"&&l==="child_changed")this.changeMap.set(n,mu(n,e.snapshotNode,i.oldSnap));else throw Oc("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{getCompleteChild(e){return null}getChildAfterChild(e,r,n){return null}}const JT=new l8;class Zp{constructor(e,r,n=null){this.writes_=e,this.viewCache_=r,this.optCompleteServerCache_=n}getCompleteChild(e){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(e))return r.getNode().getImmediateChild(e);{const n=this.optCompleteServerCache_!=null?new rl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Qp(this.writes_,e,n)}}getChildAfterChild(e,r,n){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:nl(this.viewCache_),l=i8(this.writes_,i,r,1,n,e);return l.length===0?null:l[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(t){return{filter:t}}function o8(t,e){Re(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),Re(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function u8(t,e,r,n,i){const l=new s8;let o,u;if(r.type===ya.OVERWRITE){const d=r;d.source.fromUser?o=sp(t,e,d.path,d.snap,n,i,l):(Re(d.source.fromServer,"Unknown source."),u=d.source.tagged||e.serverCache.isFiltered()&&!_t(d.path),o=Q0(t,e,d.path,d.snap,n,i,u,l))}else if(r.type===ya.MERGE){const d=r;d.source.fromUser?o=h8(t,e,d.path,d.children,n,i,l):(Re(d.source.fromServer,"Unknown source."),u=d.source.tagged||e.serverCache.isFiltered(),o=lp(t,e,d.path,d.children,n,i,u,l))}else if(r.type===ya.ACK_USER_WRITE){const d=r;d.revert?o=p8(t,e,d.path,n,i,l):o=d8(t,e,d.path,d.affectedTree,n,i,l)}else if(r.type===ya.LISTEN_COMPLETE)o=m8(t,e,r.path,n,l);else throw Oc("Unknown operation type: "+r.type);const h=l.getChanges();return f8(e,o,h),{viewCache:o,changes:h}}function f8(t,e,r){const n=e.eventCache;if(n.isFullyInitialized()){const i=n.getNode().isLeafNode()||n.getNode().isEmpty(),l=np(t);(r.length>0||!t.eventCache.isFullyInitialized()||i&&!n.getNode().equals(l)||!n.getNode().getPriority().equals(l.getPriority()))&&r.push(GT(np(e)))}}function eS(t,e,r,n,i,l){const o=e.eventCache;if($0(n,r)!=null)return e;{let u,h;if(_t(r))if(Re(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=nl(e),p=d instanceof et?d:et.EMPTY_NODE,x=$p(n,p);u=t.filter.updateFullNode(e.eventCache.getNode(),x,l)}else{const d=K0(n,nl(e));u=t.filter.updateFullNode(e.eventCache.getNode(),d,l)}else{const d=mt(r);if(d===".priority"){Re(os(r)===1,"Can't have a priority with additional path components");const p=o.getNode();h=e.serverCache.getNode();const x=Xy(n,r,p,h);x!=null?u=t.filter.updatePriority(p,x):u=o.getNode()}else{const p=$t(r);let x;if(o.isCompleteForChild(d)){h=e.serverCache.getNode();const v=Xy(n,r,o.getNode(),h);v!=null?x=o.getNode().getImmediateChild(d).updateChild(p,v):x=o.getNode().getImmediateChild(d)}else x=Qp(n,d,e.serverCache);x!=null?u=t.filter.updateChild(o.getNode(),d,x,p,i,l):u=o.getNode()}}return Ko(e,u,o.isFullyInitialized()||_t(r),t.filter.filtersNodes())}}function Q0(t,e,r,n,i,l,o,u){const h=e.serverCache;let d;const p=o?t.filter:t.filter.getIndexedFilter();if(_t(r))d=p.updateFullNode(h.getNode(),n,null);else if(p.filtersNodes()&&!h.isFiltered()){const y=h.getNode().updateChild(r,n);d=p.updateFullNode(h.getNode(),y,null)}else{const y=mt(r);if(!h.isCompleteForPath(r)&&os(r)>1)return e;const E=$t(r),S=h.getNode().getImmediateChild(y).updateChild(E,n);y===".priority"?d=p.updatePriority(h.getNode(),S):d=p.updateChild(h.getNode(),y,S,E,JT,null)}const x=qT(e,d,h.isFullyInitialized()||_t(r),p.filtersNodes()),v=new Zp(i,x,l);return eS(t,x,r,i,v,u)}function sp(t,e,r,n,i,l,o){const u=e.eventCache;let h,d;const p=new Zp(i,e,l);if(_t(r))d=t.filter.updateFullNode(e.eventCache.getNode(),n,o),h=Ko(e,d,!0,t.filter.filtersNodes());else{const x=mt(r);if(x===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),n),h=Ko(e,d,u.isFullyInitialized(),u.isFiltered());else{const v=$t(r),y=u.getNode().getImmediateChild(x);let E;if(_t(v))E=n;else{const w=p.getCompleteChild(x);w!=null?MT(v)===".priority"&&w.getChild(BT(v)).isEmpty()?E=w:E=w.updateChild(v,n):E=et.EMPTY_NODE}if(y.equals(E))h=e;else{const w=t.filter.updateChild(u.getNode(),x,E,v,p,o);h=Ko(e,w,u.isFullyInitialized(),t.filter.filtersNodes())}}}return h}function qy(t,e){return t.eventCache.isCompleteForChild(e)}function h8(t,e,r,n,i,l,o){let u=e;return n.foreach((h,d)=>{const p=kr(r,h);qy(e,mt(p))&&(u=sp(t,u,p,d,i,l,o))}),n.foreach((h,d)=>{const p=kr(r,h);qy(e,mt(p))||(u=sp(t,u,p,d,i,l,o))}),u}function Yy(t,e,r){return r.foreach((n,i)=>{e=e.updateChild(n,i)}),e}function lp(t,e,r,n,i,l,o,u){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,d;_t(r)?d=n:d=new Jt(null).setTree(r,n);const p=e.serverCache.getNode();return d.children.inorderTraversal((x,v)=>{if(p.hasChild(x)){const y=e.serverCache.getNode().getImmediateChild(x),E=Yy(t,y,v);h=Q0(t,h,new qt(x),E,i,l,o,u)}}),d.children.inorderTraversal((x,v)=>{const y=!e.serverCache.isCompleteForChild(x)&&v.value===null;if(!p.hasChild(x)&&!y){const E=e.serverCache.getNode().getImmediateChild(x),w=Yy(t,E,v);h=Q0(t,h,new qt(x),w,i,l,o,u)}}),h}function d8(t,e,r,n,i,l,o){if($0(i,r)!=null)return e;const u=e.serverCache.isFiltered(),h=e.serverCache;if(n.value!=null){if(_t(r)&&h.isFullyInitialized()||h.isCompleteForPath(r))return Q0(t,e,r,h.getNode().getChild(r),i,l,u,o);if(_t(r)){let d=new Jt(null);return h.getNode().forEachChild(pc,(p,x)=>{d=d.set(new qt(p),x)}),lp(t,e,r,d,i,l,u,o)}else return e}else{let d=new Jt(null);return n.foreach((p,x)=>{const v=kr(r,p);h.isCompleteForPath(v)&&(d=d.set(p,h.getNode().getChild(v)))}),lp(t,e,r,d,i,l,u,o)}}function m8(t,e,r,n,i){const l=e.serverCache,o=qT(e,l.getNode(),l.isFullyInitialized()||_t(r),l.isFiltered());return eS(t,o,r,n,JT,i)}function p8(t,e,r,n,i,l){let o;if($0(n,r)!=null)return e;{const u=new Zp(n,e,i),h=e.eventCache.getNode();let d;if(_t(r)||mt(r)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=K0(n,nl(e));else{const x=e.serverCache.getNode();Re(x instanceof et,"serverChildren would be complete if leaf node"),p=$p(n,x)}p=p,d=t.filter.updateFullNode(h,p,l)}else{const p=mt(r);let x=Qp(n,p,e.serverCache);x==null&&e.serverCache.isCompleteForChild(p)&&(x=h.getImmediateChild(p)),x!=null?d=t.filter.updateChild(h,p,x,$t(r),u,l):e.eventCache.getNode().hasChild(p)?d=t.filter.updateChild(h,p,et.EMPTY_NODE,$t(r),u,l):d=h,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=K0(n,nl(e)),o.isLeafNode()&&(d=t.filter.updateFullNode(d,o,l)))}return o=e.serverCache.isFullyInitialized()||$0(n,It())!=null,Ko(e,d,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g8{constructor(e,r){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new Wp(n.getIndex()),l=M6(n);this.processor_=c8(l);const o=r.serverCache,u=r.eventCache,h=i.updateFullNode(et.EMPTY_NODE,o.getNode(),null),d=l.updateFullNode(et.EMPTY_NODE,u.getNode(),null),p=new rl(h,o.isFullyInitialized(),i.filtersNodes()),x=new rl(d,u.isFullyInitialized(),l.filtersNodes());this.viewCache_=Eh(x,p),this.eventGenerator_=new z6(this.query_)}get query(){return this.query_}}function x8(t){return t.viewCache_.serverCache.getNode()}function v8(t,e){const r=nl(t.viewCache_);return r&&(t.query._queryParams.loadsAllData()||!_t(e)&&!r.getImmediateChild(mt(e)).isEmpty())?r.getChild(e):null}function Ky(t){return t.eventRegistrations_.length===0}function _8(t,e){t.eventRegistrations_.push(e)}function $y(t,e,r){const n=[];if(r){Re(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(l=>{const o=l.createCancelEvent(r,i);o&&n.push(o)})}if(e){let i=[];for(let l=0;l<t.eventRegistrations_.length;++l){const o=t.eventRegistrations_[l];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(l+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return n}function Qy(t,e,r,n){e.type===ya.MERGE&&e.source.queryId!==null&&(Re(nl(t.viewCache_),"We should always have a full cache before handling merges"),Re(np(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,l=u8(t.processor_,i,e,r,n);return o8(t.processor_,l.viewCache),Re(l.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=l.viewCache,tS(t,l.changes,l.viewCache.eventCache.getNode(),null)}function y8(t,e){const r=t.viewCache_.eventCache,n=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(ir,(l,o)=>{n.push(kc(l,o))}),r.isFullyInitialized()&&n.push(GT(r.getNode())),tS(t,n,r.getNode(),e)}function tS(t,e,r,n){const i=n?[n]:t.eventRegistrations_;return V6(t.eventGenerator_,e,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0;class w8{constructor(){this.views=new Map}}function E8(t){Re(!Z0,"__referenceConstructor has already been defined"),Z0=t}function T8(){return Re(Z0,"Reference.ts has not been loaded"),Z0}function S8(t){return t.views.size===0}function Jp(t,e,r,n){const i=e.source.queryId;if(i!==null){const l=t.views.get(i);return Re(l!=null,"SyncTree gave us an op for an invalid query."),Qy(l,e,r,n)}else{let l=[];for(const o of t.views.values())l=l.concat(Qy(o,e,r,n));return l}}function b8(t,e,r,n,i){const l=e._queryIdentifier,o=t.views.get(l);if(!o){let u=K0(r,i?n:null),h=!1;u?h=!0:n instanceof et?(u=$p(r,n),h=!1):(u=et.EMPTY_NODE,h=!1);const d=Eh(new rl(u,h,!1),new rl(n,i,!1));return new g8(e,d)}return o}function C8(t,e,r,n,i,l){const o=b8(t,e,n,i,l);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),_8(o,r),y8(o,r)}function k8(t,e,r,n){const i=e._queryIdentifier,l=[];let o=[];const u=us(t);if(i==="default")for(const[h,d]of t.views.entries())o=o.concat($y(d,r,n)),Ky(d)&&(t.views.delete(h),d.query._queryParams.loadsAllData()||l.push(d.query));else{const h=t.views.get(i);h&&(o=o.concat($y(h,r,n)),Ky(h)&&(t.views.delete(i),h.query._queryParams.loadsAllData()||l.push(h.query)))}return u&&!us(t)&&l.push(new(T8())(e._repo,e._path)),{removed:l,events:o}}function rS(t){const e=[];for(const r of t.views.values())r.query._queryParams.loadsAllData()||e.push(r);return e}function gc(t,e){let r=null;for(const n of t.views.values())r=r||v8(n,e);return r}function nS(t,e){if(e._queryParams.loadsAllData())return Th(t);{const n=e._queryIdentifier;return t.views.get(n)}}function aS(t,e){return nS(t,e)!=null}function us(t){return Th(t)!=null}function Th(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let J0;function A8(t){Re(!J0,"__referenceConstructor has already been defined"),J0=t}function N8(){return Re(J0,"Reference.ts has not been loaded"),J0}let D8=1;class Zy{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Jt(null),this.pendingWriteTree_=a8(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function eg(t,e,r,n,i){return q6(t.pendingWriteTree_,e,r,n,i),i?ju(t,new tl(XT(),e,r)):[]}function Gs(t,e,r=!1){const n=Y6(t.pendingWriteTree_,e);if(K6(t.pendingWriteTree_,e)){let l=new Jt(null);return n.snap!=null?l=l.set(It(),!0):Dn(n.children,o=>{l=l.set(new qt(o),!0)}),ju(t,new Y0(n.path,l,r))}else return[]}function Sh(t,e,r){return ju(t,new tl(qp(),e,r))}function R8(t,e,r){const n=Jt.fromObject(r);return ju(t,new xu(qp(),e,n))}function O8(t,e){return ju(t,new gu(qp(),e))}function F8(t,e,r){const n=tg(t,r);if(n){const i=rg(n),l=i.path,o=i.queryId,u=Cn(l,e),h=new gu(Yp(o),u);return ng(t,l,h)}else return[]}function cp(t,e,r,n,i=!1){const l=e._path,o=t.syncPointTree_.get(l);let u=[];if(o&&(e._queryIdentifier==="default"||aS(o,e))){const h=k8(o,e,r,n);S8(o)&&(t.syncPointTree_=t.syncPointTree_.remove(l));const d=h.removed;if(u=h.events,!i){const p=d.findIndex(v=>v._queryParams.loadsAllData())!==-1,x=t.syncPointTree_.findOnPath(l,(v,y)=>us(y));if(p&&!x){const v=t.syncPointTree_.subtree(l);if(!v.isEmpty()){const y=L8(v);for(let E=0;E<y.length;++E){const w=y[E],S=w.query,N=lS(t,w);t.listenProvider_.startListening(Qo(S),eh(t,S),N.hashFn,N.onComplete)}}}!x&&d.length>0&&!n&&(p?t.listenProvider_.stopListening(Qo(e),null):d.forEach(v=>{const y=t.queryToTagMap.get(Ch(v));t.listenProvider_.stopListening(Qo(v),y)}))}B8(t,d)}return u}function I8(t,e,r,n){const i=tg(t,n);if(i!=null){const l=rg(i),o=l.path,u=l.queryId,h=Cn(o,e),d=new tl(Yp(u),h,r);return ng(t,o,d)}else return[]}function M8(t,e,r,n){const i=tg(t,n);if(i){const l=rg(i),o=l.path,u=l.queryId,h=Cn(o,e),d=Jt.fromObject(r),p=new xu(Yp(u),h,d);return ng(t,o,p)}else return[]}function Jy(t,e,r,n=!1){const i=e._path;let l=null,o=!1;t.syncPointTree_.foreachOnPath(i,(v,y)=>{const E=Cn(v,i);l=l||gc(y,E),o=o||us(y)});let u=t.syncPointTree_.get(i);u?(o=o||us(u),l=l||gc(u,It())):(u=new w8,t.syncPointTree_=t.syncPointTree_.set(i,u));let h;l!=null?h=!0:(h=!1,l=et.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((y,E)=>{const w=gc(E,It());w&&(l=l.updateImmediateChild(y,w))}));const d=aS(u,e);if(!d&&!e._queryParams.loadsAllData()){const v=Ch(e);Re(!t.queryToTagMap.has(v),"View does not exist, but we have a tag");const y=P8();t.queryToTagMap.set(v,y),t.tagToQueryMap.set(y,v)}const p=Kp(t.pendingWriteTree_,i);let x=C8(u,e,r,p,l,h);if(!d&&!o&&!n){const v=nS(u,e);x=x.concat(U8(t,e,v))}return x}function bh(t,e,r){const i=t.pendingWriteTree_,l=t.syncPointTree_.findOnPath(e,(o,u)=>{const h=Cn(o,e),d=gc(u,h);if(d)return d});return $T(i,e,l,r,!0)}function ju(t,e){return iS(e,t.syncPointTree_,null,Kp(t.pendingWriteTree_,It()))}function iS(t,e,r,n){if(_t(t.path))return sS(t,e,r,n);{const i=e.get(It());r==null&&i!=null&&(r=gc(i,It()));let l=[];const o=mt(t.path),u=t.operationForChild(o),h=e.children.get(o);if(h&&u){const d=r?r.getImmediateChild(o):null,p=QT(n,o);l=l.concat(iS(u,h,d,p))}return i&&(l=l.concat(Jp(i,t,n,r))),l}}function sS(t,e,r,n){const i=e.get(It());r==null&&i!=null&&(r=gc(i,It()));let l=[];return e.children.inorderTraversal((o,u)=>{const h=r?r.getImmediateChild(o):null,d=QT(n,o),p=t.operationForChild(o);p&&(l=l.concat(sS(p,u,h,d)))}),i&&(l=l.concat(Jp(i,t,n,r))),l}function lS(t,e){const r=e.query,n=eh(t,r);return{hashFn:()=>(x8(e)||et.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return n?F8(t,r._path,n):O8(t,r._path);{const l=IN(i,r);return cp(t,r,null,l)}}}}function eh(t,e){const r=Ch(e);return t.queryToTagMap.get(r)}function Ch(t){return t._path.toString()+"$"+t._queryIdentifier}function tg(t,e){return t.tagToQueryMap.get(e)}function rg(t){const e=t.indexOf("$");return Re(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new qt(t.substr(0,e))}}function ng(t,e,r){const n=t.syncPointTree_.get(e);Re(n,"Missing sync point for query tag that we're tracking");const i=Kp(t.pendingWriteTree_,e);return Jp(n,r,i,null)}function L8(t){return t.fold((e,r,n)=>{if(r&&us(r))return[Th(r)];{let i=[];return r&&(i=rS(r)),Dn(n,(l,o)=>{i=i.concat(o)}),i}})}function Qo(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(N8())(t._repo,t._path):t}function B8(t,e){for(let r=0;r<e.length;++r){const n=e[r];if(!n._queryParams.loadsAllData()){const i=Ch(n),l=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(l)}}}function P8(){return D8++}function U8(t,e,r){const n=e._path,i=eh(t,e),l=lS(t,r),o=t.listenProvider_.startListening(Qo(e),i,l.hashFn,l.onComplete),u=t.syncPointTree_.subtree(n);if(i)Re(!us(u.value),"If we're adding a query, it shouldn't be shadowed");else{const h=u.fold((d,p,x)=>{if(!_t(d)&&p&&us(p))return[Th(p).query];{let v=[];return p&&(v=v.concat(rS(p).map(y=>y.query))),Dn(x,(y,E)=>{v=v.concat(E)}),v}});for(let d=0;d<h.length;++d){const p=h[d];t.listenProvider_.stopListening(Qo(p),eh(t,p))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e){this.node_=e}getImmediateChild(e){const r=this.node_.getImmediateChild(e);return new ag(r)}node(){return this.node_}}class ig{constructor(e,r){this.syncTree_=e,this.path_=r}getImmediateChild(e){const r=kr(this.path_,e);return new ig(this.syncTree_,r)}node(){return bh(this.syncTree_,this.path_)}}const j8=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},ew=function(t,e,r){if(!t||typeof t!="object")return t;if(Re(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return H8(t[".sv"],e,r);if(typeof t[".sv"]=="object")return z8(t[".sv"],e);Re(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},H8=function(t,e,r){switch(t){case"timestamp":return r.timestamp;default:Re(!1,"Unexpected server value: "+t)}},z8=function(t,e,r){t.hasOwnProperty("increment")||Re(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const n=t.increment;typeof n!="number"&&Re(!1,"Unexpected increment value: "+n);const i=e.node();if(Re(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;const o=i.getValue();return typeof o!="number"?n:o+n},V8=function(t,e,r,n){return lg(e,new ig(r,t),n)},sg=function(t,e,r){return lg(t,new ag(e),r)};function lg(t,e,r){const n=t.getPriority().val(),i=ew(n,e.getImmediateChild(".priority"),r);let l;if(t.isLeafNode()){const o=t,u=ew(o.getValue(),e,r);return u!==o.getValue()||i!==o.getPriority().val()?new Or(u,Mr(i)):t}else{const o=t;return l=o,i!==o.getPriority().val()&&(l=l.updatePriority(new Or(i))),o.forEachChild(ir,(u,h)=>{const d=lg(h,e.getImmediateChild(u),r);d!==h&&(l=l.updateImmediateChild(u,d))}),l}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e="",r=null,n={children:{},childCount:0}){this.name=e,this.parent=r,this.node=n}}function kh(t,e){let r=e instanceof qt?e:new qt(e),n=t,i=mt(r);for(;i!==null;){const l=Qs(n.node.children,i)||{children:{},childCount:0};n=new cg(i,n,l),r=$t(r),i=mt(r)}return n}function dl(t){return t.node.value}function og(t,e){t.node.value=e,op(t)}function cS(t){return t.node.childCount>0}function G8(t){return dl(t)===void 0&&!cS(t)}function Ah(t,e){Dn(t.node.children,(r,n)=>{e(new cg(r,t,n))})}function oS(t,e,r,n){r&&e(t),Ah(t,i=>{oS(i,e,!0)})}function W8(t,e,r){let n=t.parent;for(;n!==null;){if(e(n))return!0;n=n.parent}return!1}function Hu(t){return new qt(t.parent===null?t.name:Hu(t.parent)+"/"+t.name)}function op(t){t.parent!==null&&X8(t.parent,t.name,t)}function X8(t,e,r){const n=G8(r),i=Ca(t.node.children,e);n&&i?(delete t.node.children[e],t.node.childCount--,op(t)):!n&&!i&&(t.node.children[e]=r.node,t.node.childCount++,op(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q8=/[\[\].#$\/\u0000-\u001F\u007F]/,Y8=/[\[\].#$\u0000-\u001F\u007F]/,Tm=10*1024*1024,uS=function(t){return typeof t=="string"&&t.length!==0&&!q8.test(t)},fS=function(t){return typeof t=="string"&&t.length!==0&&!Y8.test(t)},K8=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),fS(t)},$8=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Bp(t)||t&&typeof t=="object"&&Ca(t,".sv")},Q8=function(t,e,r,n){Nh(Fp(t,"value"),e,r)},Nh=function(t,e,r){const n=r instanceof qt?new d6(r,t):r;if(e===void 0)throw new Error(t+"contains undefined "+Hs(n));if(typeof e=="function")throw new Error(t+"contains a function "+Hs(n)+" with contents = "+e.toString());if(Bp(e))throw new Error(t+"contains "+e.toString()+" "+Hs(n));if(typeof e=="string"&&e.length>Tm/3&&yh(e)>Tm)throw new Error(t+"contains a string greater than "+Tm+" utf8 bytes "+Hs(n)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,l=!1;if(Dn(e,(o,u)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(l=!0,!uS(o)))throw new Error(t+" contains an invalid key ("+o+") "+Hs(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);m6(n,o),Nh(t,u,n),p6(n)}),i&&l)throw new Error(t+' contains ".value" child '+Hs(n)+" in addition to actual children.")}},hS=function(t,e,r,n){if(!fS(r))throw new Error(Fp(t,e)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Z8=function(t,e,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),hS(t,e,r)},dS=function(t,e){if(mt(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},J8=function(t,e){const r=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!uS(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!K8(r))throw new Error(Fp(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ug(t,e){let r=null;for(let n=0;n<e.length;n++){const i=e[n],l=i.getPath();r!==null&&!zp(l,r.path)&&(t.eventLists_.push(r),r=null),r===null&&(r={events:[],path:l}),r.events.push(i)}r&&t.eventLists_.push(r)}function mS(t,e,r){ug(t,r),pS(t,n=>zp(n,e))}function ja(t,e,r){ug(t,r),pS(t,n=>_a(n,e)||_a(e,n))}function pS(t,e){t.recursionDepth_++;let r=!0;for(let n=0;n<t.eventLists_.length;n++){const i=t.eventLists_[n];if(i){const l=i.path;e(l)?(tD(t.eventLists_[n]),t.eventLists_[n]=null):r=!1}}r&&(t.eventLists_=[]),t.recursionDepth_--}function tD(t){for(let e=0;e<t.events.length;e++){const r=t.events[e];if(r!==null){t.events[e]=null;const n=r.getEventRunner();qo&&en("event: "+r.toString()),Bc(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD="repo_interrupt",nD=25;class aD{constructor(e,r,n,i){this.repoInfo_=e,this.forceRestClient_=r,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new eD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=q0(),this.transactionQueueTree_=new cg,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function iD(t,e,r){if(t.stats_=jp(t.repoInfo_),t.forceRestClient_||PN())t.server_=new X0(t.repoInfo_,(n,i,l,o)=>{tw(t,n,i,l,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>rw(t,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Br(r)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}t.persistentConnection_=new di(t.repoInfo_,e,(n,i,l,o)=>{tw(t,n,i,l,o)},n=>{rw(t,n)},n=>{lD(t,n)},t.authTokenProvider_,t.appCheckProvider_,r),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(n=>{t.server_.refreshAuthToken(n)}),t.appCheckProvider_.addTokenChangeListener(n=>{t.server_.refreshAppCheckToken(n.token)}),t.statsReporter_=VN(t.repoInfo_,()=>new H6(t.stats_,t.server_)),t.infoData_=new L6,t.infoSyncTree_=new Zy({startListening:(n,i,l,o)=>{let u=[];const h=t.infoData_.getNode(n._path);return h.isEmpty()||(u=Sh(t.infoSyncTree_,n._path,h),setTimeout(()=>{o("ok")},0)),u},stopListening:()=>{}}),fg(t,"connected",!1),t.serverSyncTree_=new Zy({startListening:(n,i,l,o)=>(t.server_.listen(n,l,i,(u,h)=>{const d=o(u,h);ja(t.eventQueue_,n._path,d)}),[]),stopListening:(n,i)=>{t.server_.unlisten(n,i)}})}function sD(t){const r=t.infoData_.getNode(new qt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function Dh(t){return j8({timestamp:sD(t)})}function tw(t,e,r,n,i){t.dataUpdateCount++;const l=new qt(e);r=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,r):r;let o=[];if(i)if(n){const h=H0(r,d=>Mr(d));o=M8(t.serverSyncTree_,l,h,i)}else{const h=Mr(r);o=I8(t.serverSyncTree_,l,h,i)}else if(n){const h=H0(r,d=>Mr(d));o=R8(t.serverSyncTree_,l,h)}else{const h=Mr(r);o=Sh(t.serverSyncTree_,l,h)}let u=l;o.length>0&&(u=Fh(t,l)),ja(t.eventQueue_,u,o)}function rw(t,e){fg(t,"connected",e),e===!1&&oD(t)}function lD(t,e){Dn(e,(r,n)=>{fg(t,r,n)})}function fg(t,e,r){const n=new qt("/.info/"+e),i=Mr(r);t.infoData_.updateSnapshot(n,i);const l=Sh(t.infoSyncTree_,n,i);ja(t.eventQueue_,n,l)}function hg(t){return t.nextWriteId_++}function cD(t,e,r,n,i){Rh(t,"set",{path:e.toString(),value:r,priority:n});const l=Dh(t),o=Mr(r,n),u=bh(t.serverSyncTree_,e),h=sg(o,u,l),d=hg(t),p=eg(t.serverSyncTree_,e,h,d,!0);ug(t.eventQueue_,p),t.server_.put(e.toString(),o.val(!0),(v,y)=>{const E=v==="ok";E||An("set at "+e+" failed: "+v);const w=Gs(t.serverSyncTree_,d,!E);ja(t.eventQueue_,e,w),hD(t,i,v,y)});const x=_S(t,e);Fh(t,x),ja(t.eventQueue_,x,[])}function oD(t){Rh(t,"onDisconnectEvents");const e=Dh(t),r=q0();rp(t.onDisconnect_,It(),(i,l)=>{const o=V8(i,l,t.serverSyncTree_,e);WT(r,i,o)});let n=[];rp(r,It(),(i,l)=>{n=n.concat(Sh(t.serverSyncTree_,i,l));const o=_S(t,i);Fh(t,o)}),t.onDisconnect_=q0(),ja(t.eventQueue_,It(),n)}function uD(t,e,r){let n;mt(e._path)===".info"?n=Jy(t.infoSyncTree_,e,r):n=Jy(t.serverSyncTree_,e,r),mS(t.eventQueue_,e._path,n)}function nw(t,e,r){let n;mt(e._path)===".info"?n=cp(t.infoSyncTree_,e,r):n=cp(t.serverSyncTree_,e,r),mS(t.eventQueue_,e._path,n)}function fD(t){t.persistentConnection_&&t.persistentConnection_.interrupt(rD)}function Rh(t,...e){let r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),en(r,...e)}function hD(t,e,r,n){e&&Bc(()=>{if(r==="ok")e(null);else{const i=(r||"error").toUpperCase();let l=i;n&&(l+=": "+n);const o=new Error(l);o.code=i,e(o)}})}function dD(t,e,r,n,i,l){Rh(t,"transaction on "+e);const o={path:e,update:r,onComplete:n,status:null,order:dT(),applyLocally:l,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=dg(t,e,void 0);o.currentInputSnapshot=u;const h=o.update(u.val());if(h===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Nh("transaction failed: Data returned ",h,o.path),o.status=0;const d=kh(t.transactionQueueTree_,e),p=dl(d)||[];p.push(o),og(d,p);let x;typeof h=="object"&&h!==null&&Ca(h,".priority")?(x=Qs(h,".priority"),Re($8(x),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):x=(bh(t.serverSyncTree_,e)||et.EMPTY_NODE).getPriority().val();const v=Dh(t),y=Mr(h,x),E=sg(y,u,v);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=E,o.currentWriteId=hg(t);const w=eg(t.serverSyncTree_,e,E,o.currentWriteId,o.applyLocally);ja(t.eventQueue_,e,w),Oh(t,t.transactionQueueTree_)}}function dg(t,e,r){return bh(t.serverSyncTree_,e,r)||et.EMPTY_NODE}function Oh(t,e=t.transactionQueueTree_){if(e||Ih(t,e),dl(e)){const r=xS(t,e);Re(r.length>0,"Sending zero length transaction queue"),r.every(i=>i.status===0)&&mD(t,Hu(e),r)}else cS(e)&&Ah(e,r=>{Oh(t,r)})}function mD(t,e,r){const n=r.map(d=>d.currentWriteId),i=dg(t,e,n);let l=i;const o=i.hash();for(let d=0;d<r.length;d++){const p=r[d];Re(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const x=Cn(e,p.path);l=l.updateChild(x,p.currentOutputSnapshotRaw)}const u=l.val(!0),h=e;t.server_.put(h.toString(),u,d=>{Rh(t,"transaction put response",{path:h.toString(),status:d});let p=[];if(d==="ok"){const x=[];for(let v=0;v<r.length;v++)r[v].status=2,p=p.concat(Gs(t.serverSyncTree_,r[v].currentWriteId)),r[v].onComplete&&x.push(()=>r[v].onComplete(null,!0,r[v].currentOutputSnapshotResolved)),r[v].unwatcher();Ih(t,kh(t.transactionQueueTree_,e)),Oh(t,t.transactionQueueTree_),ja(t.eventQueue_,e,p);for(let v=0;v<x.length;v++)Bc(x[v])}else{if(d==="datastale")for(let x=0;x<r.length;x++)r[x].status===3?r[x].status=4:r[x].status=0;else{An("transaction at "+h.toString()+" failed: "+d);for(let x=0;x<r.length;x++)r[x].status=4,r[x].abortReason=d}Fh(t,e)}},o)}function Fh(t,e){const r=gS(t,e),n=Hu(r),i=xS(t,r);return pD(t,i,n),n}function pD(t,e,r){if(e.length===0)return;const n=[];let i=[];const o=e.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<e.length;u++){const h=e[u],d=Cn(r,h.path);let p=!1,x;if(Re(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)p=!0,x=h.abortReason,i=i.concat(Gs(t.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=nD)p=!0,x="maxretry",i=i.concat(Gs(t.serverSyncTree_,h.currentWriteId,!0));else{const v=dg(t,h.path,o);h.currentInputSnapshot=v;const y=e[u].update(v.val());if(y!==void 0){Nh("transaction failed: Data returned ",y,h.path);let E=Mr(y);typeof y=="object"&&y!=null&&Ca(y,".priority")||(E=E.updatePriority(v.getPriority()));const S=h.currentWriteId,N=Dh(t),I=sg(E,v,N);h.currentOutputSnapshotRaw=E,h.currentOutputSnapshotResolved=I,h.currentWriteId=hg(t),o.splice(o.indexOf(S),1),i=i.concat(eg(t.serverSyncTree_,h.path,I,h.currentWriteId,h.applyLocally)),i=i.concat(Gs(t.serverSyncTree_,S,!0))}else p=!0,x="nodata",i=i.concat(Gs(t.serverSyncTree_,h.currentWriteId,!0))}ja(t.eventQueue_,r,i),i=[],p&&(e[u].status=2,(function(v){setTimeout(v,Math.floor(0))})(e[u].unwatcher),e[u].onComplete&&(x==="nodata"?n.push(()=>e[u].onComplete(null,!1,e[u].currentInputSnapshot)):n.push(()=>e[u].onComplete(new Error(x),!1,null))))}Ih(t,t.transactionQueueTree_);for(let u=0;u<n.length;u++)Bc(n[u]);Oh(t,t.transactionQueueTree_)}function gS(t,e){let r,n=t.transactionQueueTree_;for(r=mt(e);r!==null&&dl(n)===void 0;)n=kh(n,r),e=$t(e),r=mt(e);return n}function xS(t,e){const r=[];return vS(t,e,r),r.sort((n,i)=>n.order-i.order),r}function vS(t,e,r){const n=dl(e);if(n)for(let i=0;i<n.length;i++)r.push(n[i]);Ah(e,i=>{vS(t,i,r)})}function Ih(t,e){const r=dl(e);if(r){let n=0;for(let i=0;i<r.length;i++)r[i].status!==2&&(r[n]=r[i],n++);r.length=n,og(e,r.length>0?r:void 0)}Ah(e,n=>{Ih(t,n)})}function _S(t,e){const r=Hu(gS(t,e)),n=kh(t.transactionQueueTree_,e);return W8(n,i=>{Sm(t,i)}),Sm(t,n),oS(n,i=>{Sm(t,i)}),r}function Sm(t,e){const r=dl(e);if(r){const n=[];let i=[],l=-1;for(let o=0;o<r.length;o++)r[o].status===3||(r[o].status===1?(Re(l===o-1,"All SENT items should be at beginning of queue."),l=o,r[o].status=3,r[o].abortReason="set"):(Re(r[o].status===0,"Unexpected transaction status in abort"),r[o].unwatcher(),i=i.concat(Gs(t.serverSyncTree_,r[o].currentWriteId,!0)),r[o].onComplete&&n.push(r[o].onComplete.bind(null,new Error("set"),!1,null))));l===-1?og(e,void 0):r.length=l+1,ja(t.eventQueue_,Hu(e),i);for(let o=0;o<n.length;o++)Bc(n[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gD(t){let e="";const r=t.split("/");for(let n=0;n<r.length;n++)if(r[n].length>0){let i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function xD(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const r of t.split("&")){if(r.length===0)continue;const n=r.split("=");n.length===2?e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):An(`Invalid query segment '${r}' in query '${t}'`)}return e}const aw=function(t,e){const r=vD(t),n=r.namespace;r.domain==="firebase.com"&&xi(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&r.domain!=="localhost"&&xi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||NN();const i=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new CT(r.host,r.secure,n,i,e,"",n!==r.subdomain),path:new qt(r.pathString)}},vD=function(t){let e="",r="",n="",i="",l="",o=!0,u="https",h=443;if(typeof t=="string"){let d=t.indexOf("//");d>=0&&(u=t.substring(0,d-1),t=t.substring(d+2));let p=t.indexOf("/");p===-1&&(p=t.length);let x=t.indexOf("?");x===-1&&(x=t.length),e=t.substring(0,Math.min(p,x)),p<x&&(i=gD(t.substring(p,x)));const v=xD(t.substring(Math.min(t.length,x)));d=e.indexOf(":"),d>=0?(o=u==="https"||u==="wss",h=parseInt(e.substring(d+1),10)):d=e.length;const y=e.slice(0,d);if(y.toLowerCase()==="localhost")r="localhost";else if(y.split(".").length<=2)r=y;else{const E=e.indexOf(".");n=e.substring(0,E).toLowerCase(),r=e.substring(E+1),l=n}"ns"in v&&(l=v.ns)}return{host:e,port:h,domain:r,subdomain:n,secure:o,scheme:u,pathString:i,namespace:l}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e,r,n,i){this.eventType=e,this.eventRegistration=r,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Br(this.snapshot.exportVal())}}class yD{constructor(e,r,n){this.eventRegistration=e,this.error=r,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e,r){this.snapshotCallback=e,this.cancelCallback=r}onValue(e,r){this.snapshotCallback.call(null,e,r)}onCancel(e){return Re(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e,r,n,i){this._repo=e,this._path=r,this._queryParams=n,this._orderByCalled=i}get key(){return _t(this._path)?null:MT(this._path)}get ref(){return new yi(this._repo,this._path)}get _queryIdentifier(){const e=Hy(this._queryParams),r=Pp(e);return r==="{}"?"default":r}get _queryObject(){return Hy(this._queryParams)}isEqual(e){if(e=ua(e),!(e instanceof mg))return!1;const r=this._repo===e._repo,n=zp(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return r&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+h6(this._path)}}class yi extends mg{constructor(e,r){super(e,r,new Xp,!1)}get parent(){const e=BT(this._path);return e===null?null:new yi(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class vu{constructor(e,r,n){this._node=e,this.ref=r,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const r=new qt(e),n=up(this.ref,e);return new vu(this._node.getChild(r),n,ir)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,i)=>e(new vu(i,up(this.ref,n),ir)))}hasChild(e){const r=new qt(e);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function zu(t,e){return t=ua(t),t._checkNotDeleted("ref"),up(t._root,e)}function up(t,e){return t=ua(t),mt(t._path)===null?Z8("child","path",e):hS("child","path",e),new yi(t._repo,kr(t._path,e))}function yS(t,e){t=ua(t),dS("set",t._path),Q8("set",e,t._path);const r=new Mu;return cD(t._repo,t._path,e,null,r.wrapCallback(()=>{})),r.promise}class pg{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,r){const n=r._queryParams.getIndex();return new _D("value",this,new vu(e.snapshotNode,new yi(r._repo,r._path),n))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,r){return this.callbackContext.hasCancelCallback?new yD(this,e,r):null}matches(e){return e instanceof pg?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function ED(t,e,r,n,i){let l;if(typeof n=="object"&&(l=void 0,i=n),typeof n=="function"&&(l=n),i&&i.onlyOnce){const h=r,d=(p,x)=>{nw(t._repo,t,u),h(p,x)};d.userCallback=r.userCallback,d.context=r.context,r=d}const o=new wD(r,l||void 0),u=new pg(o);return uD(t._repo,t,u),()=>nw(t._repo,t,u)}function wS(t,e,r,n){return ED(t,"value",e,r,n)}E8(yi);A8(yi);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD="FIREBASE_DATABASE_EMULATOR_HOST",fp={};let SD=!1;function bD(t,e,r,n){const i=e.lastIndexOf(":"),l=e.substring(0,i),o=Fc(l);t.repoInfo_=new CT(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,r),n&&(t.authTokenProvider_=n)}function CD(t,e,r,n,i){let l=n||t.options.databaseURL;l===void 0&&(t.options.projectId||xi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),en("Using default host for project ",t.options.projectId),l=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=aw(l,i),u=o.repoInfo,h;typeof process<"u"&&Ty&&(h=Ty[TD]),h?(l=`http://${h}?ns=${u.namespace}`,o=aw(l,i),u=o.repoInfo):o.repoInfo.secure;const d=new jN(t.name,t.options,e);J8("Invalid Firebase Database URL",o),_t(o.path)||xi("Database URL must point to the root of a Firebase Database (not including a child path).");const p=AD(u,t,d,new UN(t,r));return new ND(p,t)}function kD(t,e){const r=fp[e];(!r||r[t.key]!==t)&&xi(`Database ${e}(${t.repoInfo_}) has already been deleted.`),fD(t),delete r[t.key]}function AD(t,e,r,n){let i=fp[e.name];i||(i={},fp[e.name]=i);let l=i[t.toURLString()];return l&&xi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),l=new aD(t,SD,r,n),i[t.toURLString()]=l,l}class ND{constructor(e,r){this._repoInternal=e,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(iD(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new yi(this._repo,It())),this._rootInternal}_delete(){return this._rootInternal!==null&&(kD(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&xi("Cannot call "+e+" on a deleted database.")}}function DD(t=cT(),e){const r=Lp(t,"database").getImmediate({identifier:e});if(!r._instanceStarted){const n=Yk("database");n&&RD(r,...n)}return r}function RD(t,e,r,n={}){t=ua(t),t._checkNotDeleted("useEmulator");const i=`${e}:${r}`,l=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&Zs(n,l.repoInfo_.emulatorOptions))return;xi("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(l.repoInfo_.nodeAdmin)n.mockUserToken&&xi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new F0(F0.OWNER);else if(n.mockUserToken){const u=typeof n.mockUserToken=="string"?n.mockUserToken:Kk(n.mockUserToken,t.app.options.projectId);o=new F0(u)}Fc(e)&&(tT(e),rT("Database",!0)),bD(l,i,n,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OD(t){SN(Mc),bc(new Js("database",(e,{instanceIdentifier:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),l=e.getProvider("app-check-internal");return CD(n,i,l,r)},"PUBLIC").setMultipleInstances(!0)),ss(Sy,by,t),ss(Sy,by,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e,r){this.committed=e,this.snapshot=r}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function ES(t,e,r){if(t=ua(t),dS("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const n=!0,i=new Mu,l=(u,h,d)=>{let p=null;u?i.reject(u):(p=new vu(d,new yi(t._repo,t._path),ir),i.resolve(new FD(h,p)))},o=wS(t,()=>{});return dD(t._repo,t._path,e,l,o,n),i.promise}di.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};di.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};OD();function TS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ID=TS,SS=new Lu("auth","Firebase",TS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th=new Ip("@firebase/auth");function MD(t,...e){th.logLevel<=Vt.WARN&&th.warn(`Auth (${Mc}): ${t}`,...e)}function I0(t,...e){th.logLevel<=Vt.ERROR&&th.error(`Auth (${Mc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(t,...e){throw gg(t,...e)}function Ba(t,...e){return gg(t,...e)}function bS(t,e,r){const n={...ID(),[e]:r};return new Lu("auth","Firebase",n).create(e,{appName:t.name})}function cs(t){return bS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return SS.create(t,...e)}function nt(t,e,...r){if(!t)throw gg(e,...r)}function ui(t){const e="INTERNAL ASSERTION FAILED: "+t;throw I0(e),new Error(e)}function _i(t,e){t||ui(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function LD(){return iw()==="http:"||iw()==="https:"}function iw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(LD()||Jk()||"connection"in navigator)?navigator.onLine:!0}function PD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,r){this.shortDelay=e,this.longDelay=r,_i(r>e,"Short delay should be less than long delay!"),this.isMobile=Op()||nT()}get(){return BD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xg(t,e){_i(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],HD=new Vu(3e4,6e4);function Mh(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Pc(t,e,r,n,i={}){return kS(t,i,async()=>{let l={},o={};n&&(e==="GET"?o=n:l={body:JSON.stringify(n)});const u=Ic({key:t.config.apiKey,...o}).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:h,...l};return Zk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Fc(t.emulatorConfig.host)&&(d.credentials="include"),CS.fetch()(await NS(t,t.config.apiHost,r,u),d)})}async function kS(t,e,r){t._canInitEmulator=!1;const n={...UD,...e};try{const i=new zD(t),l=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const o=await l.json();if("needConfirmation"in o)throw E0(t,"account-exists-with-different-credential",o);if(l.ok&&!("errorMessage"in o))return o;{const u=l.ok?o.errorMessage:o.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw E0(t,"credential-already-in-use",o);if(h==="EMAIL_EXISTS")throw E0(t,"email-already-in-use",o);if(h==="USER_DISABLED")throw E0(t,"user-disabled",o);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw bS(t,p,d);vi(t,p)}}catch(i){if(i instanceof gs)throw i;vi(t,"network-request-failed",{message:String(i)})}}async function AS(t,e,r,n,i={}){const l=await Pc(t,e,r,n,i);return"mfaPendingCredential"in l&&vi(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function NS(t,e,r,n){const i=`${e}${r}?${n}`,l=t,o=l.config.emulator?xg(t.config,i):`${t.config.apiScheme}://${i}`;return jD.includes(r)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(o).toString():o}class zD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Ba(this.auth,"network-request-failed")),HD.get())})}}function E0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Ba(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VD(t,e){return Pc(t,"POST","/v1/accounts:delete",e)}async function rh(t,e){return Pc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function GD(t,e=!1){const r=ua(t),n=await r.getIdToken(e),i=vg(n);nt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const l=typeof i.firebase=="object"?i.firebase:void 0,o=l==null?void 0:l.sign_in_provider;return{claims:i,token:n,authTime:Zo(bm(i.auth_time)),issuedAtTime:Zo(bm(i.iat)),expirationTime:Zo(bm(i.exp)),signInProvider:o||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function bm(t){return Number(t)*1e3}function vg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return I0("JWT malformed, contained fewer than 3 sections"),null;try{const i=j0(r);return i?JSON.parse(i):(I0("Failed to decode base64 JWT payload"),null)}catch(i){return I0("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function sw(t){const e=vg(t);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _u(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof gs&&WD(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function WD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zo(this.lastLoginAt),this.creationTime=Zo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nh(t){var x;const e=t.auth,r=await t.getIdToken(),n=await _u(t,rh(e,{idToken:r}));nt(n==null?void 0:n.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const l=(x=i.providerUserInfo)!=null&&x.length?DS(i.providerUserInfo):[],o=YD(t.providerData,l),u=t.isAnonymous,h=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=u?h:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new dp(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,p)}async function qD(t){const e=ua(t);await nh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function YD(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function DS(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KD(t,e){const r=await kS(t,{},async()=>{const n=Ic({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:l}=t.config,o=await NS(t,i,"/v1/token",`key=${l}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&Fc(t.emulatorConfig.host)&&(h.credentials="include"),CS.fetch()(o,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function $D(t,e){return Pc(t,"POST","/v2/accounts:revokeToken",Mh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const r=sw(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:l}=await KD(e,r);this.updateTokensAndExpiration(n,i,Number(l))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:l}=r,o=new xc;return n&&(nt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(nt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),l&&(nt(typeof l=="number","internal-error",{appName:e}),o.expirationTime=l),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new xc,this.toJSON())}_performRefresh(){return ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t,e){nt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class wa{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new XD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new dp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await _u(this,this.stsTokenManager.getToken(this.auth,e));return nt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return GD(this,e)}reload(){return qD(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new wa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await nh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xa(this.auth.app))return Promise.reject(cs(this.auth));const e=await this.getIdToken();return await _u(this,VD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,l=r.phoneNumber??void 0,o=r.photoURL??void 0,u=r.tenantId??void 0,h=r._redirectEventId??void 0,d=r.createdAt??void 0,p=r.lastLoginAt??void 0,{uid:x,emailVerified:v,isAnonymous:y,providerData:E,stsTokenManager:w}=r;nt(x&&w,e,"internal-error");const S=xc.fromJSON(this.name,w);nt(typeof x=="string",e,"internal-error"),Yi(n,e.name),Yi(i,e.name),nt(typeof v=="boolean",e,"internal-error"),nt(typeof y=="boolean",e,"internal-error"),Yi(l,e.name),Yi(o,e.name),Yi(u,e.name),Yi(h,e.name),Yi(d,e.name),Yi(p,e.name);const N=new wa({uid:x,auth:e,email:i,emailVerified:v,displayName:n,isAnonymous:y,photoURL:o,phoneNumber:l,tenantId:u,stsTokenManager:S,createdAt:d,lastLoginAt:p});return E&&Array.isArray(E)&&(N.providerData=E.map(I=>({...I}))),h&&(N._redirectEventId=h),N}static async _fromIdTokenResponse(e,r,n=!1){const i=new xc;i.updateFromServerResponse(r);const l=new wa({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await nh(l),l}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];nt(i.localId!==void 0,"internal-error");const l=i.providerUserInfo!==void 0?DS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(l!=null&&l.length),u=new xc;u.updateFromIdToken(n);const h=new wa({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new dp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(l!=null&&l.length)};return Object.assign(h,d),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw=new Map;function fi(t){_i(t instanceof Function,"Expected a class definition");let e=lw.get(t);return e?(_i(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,lw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}RS.type="NONE";const cw=RS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(t,e,r){return`firebase:${t}:${e}:${r}`}class vc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:l}=this.auth;this.fullUserKey=M0(this.userKey,i.apiKey,l),this.fullPersistenceKey=M0("persistence",i.apiKey,l),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await rh(this.auth,{idToken:e}).catch(()=>{});return r?wa._fromGetAccountInfoResponse(this.auth,r,e):null}return wa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new vc(fi(cw),e,n);const i=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let l=i[0]||fi(cw);const o=M0(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const p=await d._get(o);if(p){let x;if(typeof p=="string"){const v=await rh(e,{idToken:p}).catch(()=>{});if(!v)break;x=await wa._fromGetAccountInfoResponse(e,v,p)}else x=wa._fromJSON(e,p);d!==l&&(u=x),l=d;break}}catch{}const h=i.filter(d=>d._shouldAllowMigration);return!l._shouldAllowMigration||!h.length?new vc(l,e,n):(l=h[0],u&&await l._set(o,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==l)try{await d._remove(o)}catch{}})),new vc(l,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(MS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(OS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BS(e))return"Blackberry";if(PS(e))return"Webos";if(FS(e))return"Safari";if((e.includes("chrome/")||IS(e))&&!e.includes("edge/"))return"Chrome";if(LS(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function OS(t=mn()){return/firefox\//i.test(t)}function FS(t=mn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IS(t=mn()){return/crios\//i.test(t)}function MS(t=mn()){return/iemobile/i.test(t)}function LS(t=mn()){return/android/i.test(t)}function BS(t=mn()){return/blackberry/i.test(t)}function PS(t=mn()){return/webos/i.test(t)}function _g(t=mn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function QD(t=mn()){var e;return _g(t)&&!!((e=window.navigator)!=null&&e.standalone)}function ZD(){return eA()&&document.documentMode===10}function US(t=mn()){return _g(t)||LS(t)||PS(t)||BS(t)||/windows phone/i.test(t)||MS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jS(t,e=[]){let r;switch(t){case"Browser":r=ow(mn());break;case"Worker":r=`${ow(mn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Mc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=l=>new Promise((o,u)=>{try{const h=e(l);o(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e5(t,e={}){return Pc(t,"GET","/v2/passwordPolicy",Mh(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t5=6;class r5{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??t5,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uw(this),this.idTokenSubscription=new uw(this),this.beforeStateQueue=new JD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=SS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=fi(r)),this._initializationPromise=this.queue(async()=>{var n,i,l;if(!this._deleted&&(this.persistenceManager=await vc.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await rh(this,{idToken:e}),n=await wa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(xa(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(l=this.redirectUser)==null?void 0:l._redirectEventId,u=n==null?void 0:n._redirectEventId,h=await this.tryRedirectSignIn(e);(!o||o===u)&&(h!=null&&h.user)&&(n=h.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await nh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xa(this.app))return Promise.reject(cs(this));const r=e?ua(e):null;return r&&nt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xa(this.app)?Promise.reject(cs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xa(this.app)?Promise.reject(cs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await e5(this),r=new r5(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Lu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await $D(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&fi(e)||this._popupRedirectResolver;nt(r,this,"argument-error"),this.redirectPersistenceManager=await vc.create(this,[fi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const l=typeof r=="function"?r:r.next.bind(r);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(u,this,"internal-error"),u.then(()=>{o||l(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,i);return()=>{o=!0,h()}}else{const h=e.addObserver(r);return()=>{o=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(xa(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&MD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Lh(t){return ua(t)}class uw{constructor(e){this.auth=e,this.observer=null,this.addObserver=uA(r=>this.observer=r)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function a5(t){yg=t}function i5(t){return yg.loadJS(t)}function s5(){return yg.gapiScript}function l5(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c5(t,e){const r=Lp(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),l=r.getOptions();if(Zs(l,e??{}))return i;vi(i,"already-initialized")}return r.initialize({options:e})}function o5(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(fi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function u5(t,e,r){const n=Lh(t);nt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,l=HS(e),{host:o,port:u}=f5(e),h=u===null?"":`:${u}`,d={url:`${l}//${o}${h}/`},p=Object.freeze({host:o,port:u,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){nt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),nt(Zs(d,n.config.emulator)&&Zs(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,Fc(o)?(tT(`${l}//${o}${h}`),rT("Auth",!0)):h5()}function HS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function f5(t){const e=HS(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const l=i[1];return{host:l,port:fw(n.substr(l.length+1))}}else{const[l,o]=n.split(":");return{host:l,port:fw(o)}}}function fw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function h5(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ui("not implemented")}_getIdTokenResponse(e){return ui("not implemented")}_linkToIdToken(e,r){return ui("not implemented")}_getReauthenticationResolver(e){return ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _c(t,e){return AS(t,"POST","/v1/accounts:signInWithIdp",Mh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d5="http://localhost";class al extends zS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new al(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):vi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...l}=r;if(!n||!i)return null;const o=new al(n,i);return o.idToken=l.idToken||void 0,o.accessToken=l.accessToken||void 0,o.secret=l.secret,o.nonce=l.nonce,o.pendingToken=l.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return _c(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,_c(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,_c(e,r)}buildRequest(){const e={requestUri:d5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Ic(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu extends VS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends Gu{constructor(){super("facebook.com")}static credential(e){return al._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $i.credential(e.oauthAccessToken)}catch{return null}}}$i.FACEBOOK_SIGN_IN_METHOD="facebook.com";$i.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends Gu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return al._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Qi.credential(r,n)}catch{return null}}}Qi.GOOGLE_SIGN_IN_METHOD="google.com";Qi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi extends Gu{constructor(){super("github.com")}static credential(e){return al._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zi.credential(e.oauthAccessToken)}catch{return null}}}Zi.GITHUB_SIGN_IN_METHOD="github.com";Zi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji extends Gu{constructor(){super("twitter.com")}static credential(e,r){return al._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ji.credential(r,n)}catch{return null}}}Ji.TWITTER_SIGN_IN_METHOD="twitter.com";Ji.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m5(t,e){return AS(t,"POST","/v1/accounts:signUp",Mh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const l=await wa._fromIdTokenResponse(e,n,i),o=hw(n);return new fs({user:l,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=hw(n);return new fs({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function hw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p5(t){var i;if(xa(t.app))return Promise.reject(cs(t));const e=Lh(t);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new fs({user:e.currentUser,providerId:null,operationType:"signIn"});const r=await m5(e,{returnSecureToken:!0}),n=await fs._fromIdTokenResponse(e,"signIn",r,!0);return await e._updateCurrentUser(n.user),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah extends gs{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ah.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new ah(e,r,n,i)}}function GS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?ah._fromErrorAndOperation(t,l,e,n):l})}async function g5(t,e,r=!1){const n=await _u(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return fs._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x5(t,e,r=!1){const{auth:n}=t;if(xa(n.app))return Promise.reject(cs(n));const i="reauthenticate";try{const l=await _u(t,GS(n,i,e,t),r);nt(l.idToken,n,"internal-error");const o=vg(l.idToken);nt(o,n,"internal-error");const{sub:u}=o;return nt(t.uid===u,n,"user-mismatch"),fs._forOperation(t,i,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&vi(n,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v5(t,e,r=!1){if(xa(t.app))return Promise.reject(cs(t));const n="signIn",i=await GS(t,n,e),l=await fs._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(l.user),l}function _5(t,e,r,n){return ua(t).onIdTokenChanged(e,r,n)}function y5(t,e,r){return ua(t).beforeAuthStateChanged(e,r)}const ih="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ih,"1"),this.storage.removeItem(ih),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w5=1e3,E5=10;class XS extends WS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=US(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,u,h)=>{this.notifyListeners(o,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},l=this.storage.getItem(n);ZD()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,E5):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},w5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}XS.type="LOCAL";const T5=XS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS extends WS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}qS.type="SESSION";const YS=qS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S5(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Bh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:l}=r.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const u=Array.from(o).map(async d=>d(r.origin,l)),h=await S5(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Bh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let l,o;return new Promise((u,h)=>{const d=wg("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(x){const v=x;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(p),l=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),u(v.data.response);break;default:clearTimeout(p),clearTimeout(l),h(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(){return window}function C5(t){Pa().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(){return typeof Pa().WorkerGlobalScope<"u"&&typeof Pa().importScripts=="function"}async function k5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function A5(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function N5(){return KS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S="firebaseLocalStorageDb",D5=1,sh="firebaseLocalStorage",QS="fbase_key";class Wu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ph(t,e){return t.transaction([sh],e?"readwrite":"readonly").objectStore(sh)}function R5(){const t=indexedDB.deleteDatabase($S);return new Wu(t).toPromise()}function mp(){const t=indexedDB.open($S,D5);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(sh,{keyPath:QS})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(sh)?e(n):(n.close(),await R5(),e(await mp()))})})}async function dw(t,e,r){const n=Ph(t,!0).put({[QS]:e,value:r});return new Wu(n).toPromise()}async function O5(t,e){const r=Ph(t,!1).get(e),n=await new Wu(r).toPromise();return n===void 0?null:n.value}function mw(t,e){const r=Ph(t,!0).delete(e);return new Wu(r).toPromise()}const F5=800,I5=3;class ZS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>I5)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Bh._getInstance(N5()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await k5(),!this.activeServiceWorker)return;this.sender=new b5(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||A5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mp();return await dw(e,ih,"1"),await mw(e,ih),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>dw(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>O5(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>mw(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const l=Ph(i,!1).getAll();return new Wu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:l}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(l)&&(this.notifyListeners(i,l),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),F5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ZS.type="LOCAL";const M5=ZS;new Vu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(t,e){return e?fi(e):(nt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg extends zS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _c(e,this._buildIdpRequest())}_linkToIdToken(e,r){return _c(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return _c(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function B5(t){return v5(t.auth,new Eg(t),t.bypassAuthState)}function P5(t){const{auth:e,user:r}=t;return nt(r,e,"internal-error"),x5(r,new Eg(t),t.bypassAuthState)}async function U5(t){const{auth:e,user:r}=t;return nt(r,e,"internal-error"),g5(r,new Eg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,r,n,i,l=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:l,error:o,type:u}=e;if(o){this.reject(o);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:l||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return B5;case"linkViaPopup":case"linkViaRedirect":return U5;case"reauthViaPopup":case"reauthViaRedirect":return P5;default:vi(this.auth,"internal-error")}}resolve(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j5=new Vu(2e3,1e4);class fc extends JS{constructor(e,r,n,i,l){super(e,r,i,l),this.provider=n,this.authWindow=null,this.pollId=null,fc.currentPopupAction&&fc.currentPopupAction.cancel(),fc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){_i(this.filter.length===1,"Popup operations only handle one event");const e=wg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ba(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Ba(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ba(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,j5.get())};e()}}fc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H5="pendingRedirect",L0=new Map;class z5 extends JS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=L0.get(this.auth._key());if(!e){try{const n=await V5(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}L0.set(this.auth._key(),e)}return this.bypassAuthState||L0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function V5(t,e){const r=X5(e),n=W5(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function G5(t,e){L0.set(t._key(),e)}function W5(t){return fi(t._redirectPersistence)}function X5(t){return M0(H5,t.config.apiKey,t.name)}async function q5(t,e,r=!1){if(xa(t.app))return Promise.reject(cs(t));const n=Lh(t),i=L5(n,e),o=await new z5(n,i,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y5=600*1e3;class K5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$5(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!eb(e)){const i=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(Ba(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Y5&&this.cachedEventUids.clear(),this.cachedEventUids.has(pw(e))}saveEventToCache(e){this.cachedEventUids.add(pw(e)),this.lastProcessedEventTime=Date.now()}}function pw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function eb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function $5(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q5(t,e={}){return Pc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,J5=/^https?/;async function eR(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Q5(t);for(const r of e)try{if(tR(r))return}catch{}vi(t,"unauthorized-domain")}function tR(t){const e=hp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!J5.test(r))return!1;if(Z5.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=new Vu(3e4,6e4);function gw(){const t=Pa().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function nR(t){return new Promise((e,r)=>{var i,l,o;function n(){gw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gw(),r(Ba(t,"network-request-failed"))},timeout:rR.get()})}if((l=(i=Pa().gapi)==null?void 0:i.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((o=Pa().gapi)!=null&&o.load)n();else{const u=l5("iframefcb");return Pa()[u]=()=>{gapi.load?n():r(Ba(t,"network-request-failed"))},i5(`${s5()}?onload=${u}`).catch(h=>r(h))}}).catch(e=>{throw B0=null,e})}let B0=null;function aR(t){return B0=B0||nR(t),B0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR=new Vu(5e3,15e3),sR="__/auth/iframe",lR="emulator/auth/iframe",cR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uR(t){const e=t.config;nt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?xg(e,lR):`https://${t.config.authDomain}/${sR}`,n={apiKey:e.apiKey,appName:t.name,v:Mc},i=oR.get(t.config.apiHost);i&&(n.eid=i);const l=t._getFrameworks();return l.length&&(n.fw=l.join(",")),`${r}?${Ic(n).slice(1)}`}async function fR(t){const e=await aR(t),r=Pa().gapi;return nt(r,t,"internal-error"),e.open({where:document.body,url:uR(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cR,dontclear:!0},n=>new Promise(async(i,l)=>{await n.restyle({setHideOnLeave:!1});const o=Ba(t,"network-request-failed"),u=Pa().setTimeout(()=>{l(o)},iR.get());function h(){Pa().clearTimeout(u),i(n)}n.ping(h).then(h,()=>{l(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dR=500,mR=600,pR="_blank",gR="http://localhost";class xw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xR(t,e,r,n=dR,i=mR){const l=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h={...hR,width:n.toString(),height:i.toString(),top:l,left:o},d=mn().toLowerCase();r&&(u=IS(d)?pR:r),OS(d)&&(e=e||gR,h.scrollbars="yes");const p=Object.entries(h).reduce((v,[y,E])=>`${v}${y}=${E},`,"");if(QD(d)&&u!=="_self")return vR(e||"",u),new xw(null);const x=window.open(e||"",u,p);nt(x,t,"popup-blocked");try{x.focus()}catch{}return new xw(x)}function vR(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="__/auth/handler",yR="emulator/auth/handler",wR=encodeURIComponent("fac");async function vw(t,e,r,n,i,l){nt(t.config.authDomain,t,"auth-domain-config-required"),nt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Mc,eventId:i};if(e instanceof VS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",qm(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,x]of Object.entries({}))o[p]=x}if(e instanceof Gu){const p=e.getScopes().filter(x=>x!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await t._getAppCheckToken(),d=h?`#${wR}=${encodeURIComponent(h)}`:"";return`${ER(t)}?${Ic(u).slice(1)}${d}`}function ER({config:t}){return t.emulator?xg(t,yR):`https://${t.authDomain}/${_R}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="webStorageSupport";class TR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=YS,this._completeRedirectFn=q5,this._overrideRedirectResult=G5}async _openPopup(e,r,n,i){var o;_i((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const l=await vw(e,r,n,hp(),i);return xR(e,l,wg())}async _openRedirect(e,r,n,i){await this._originValidation(e);const l=await vw(e,r,n,hp(),i);return C5(l),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:l}=this.eventManagers[r];return i?Promise.resolve(i):(_i(l,"If manager is not set, promise should be"),l)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await fR(e),n=new K5(e);return r.register("authEvent",i=>(nt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Cm,{type:Cm},i=>{var o;const l=(o=i==null?void 0:i[0])==null?void 0:o[Cm];l!==void 0&&r(!!l),vi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=eR(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return US()||FS()||_g()}}const SR=TR;var _w="@firebase/auth",yw="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kR(t){bc(new Js("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;nt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jS(t)},d=new n5(n,i,l,h);return o5(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),bc(new Js("auth-internal",e=>{const r=Lh(e.getProvider("auth").getImmediate());return(n=>new bR(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ss(_w,yw,CR(t)),ss(_w,yw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR=300,NR=eT("authIdTokenMaxAge")||AR;let ww=null;const DR=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>NR)return;const i=r==null?void 0:r.token;ww!==i&&(ww=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function RR(t=cT()){const e=Lp(t,"auth");if(e.isInitialized())return e.getImmediate();const r=c5(t,{popupRedirectResolver:SR,persistence:[M5,T5,YS]}),n=eT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(n,location.origin);if(location.origin===l.origin){const o=DR(l.toString());y5(r,o,()=>o(r.currentUser)),_5(r,u=>o(u))}}const i=ZE("auth");return i&&u5(r,`http://${i}`),r}function OR(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}a5({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const l=Ba("internal-error");l.customData=i,r(l)},n.type="text/javascript",n.charset="UTF-8",OR().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kR("Browser");const pp={apiKey:"AIzaSyBpFRM3vgdTIwlRXe6uR6Oxk9Dr2hEOoCo",authDomain:"quan-ly-chi-bo-4ea6b.firebaseapp.com",databaseURL:"https://quan-ly-chi-bo-4ea6b-default-rtdb.firebaseio.com",projectId:"quan-ly-chi-bo-4ea6b",storageBucket:"quan-ly-chi-bo-4ea6b.firebasestorage.app",messagingSenderId:"1043830977640",appId:"1:1043830977640:web:63c57c51a0589c826a37dd",measurementId:"G-E7H6HTHXVB"},Uc=()=>pp.apiKey!=="DN_API_KEY_CA_BN_VO_Y"&&pp.databaseURL!=="",tb="DANG_VIEN_VOTE_DB_V2_PRO",Ws={voters:[],candidatesP1:[],candidatesP2:[],votesP1:[],votesP2:[],config:{maxExcellentVotes:5,isPhase1Open:!0,isPhase2Open:!0,p1Display:{showCCCD:!1,showMSSV:!0,showNgayVaoDang:!1,showLoaiDangVien:!0,showNhom:!0,showKhoa:!0,showChucVu:!0,showDiemHT:!0,showDiemRL:!0,showThanhTich:!1,showTuDanhGia:!0},p2Display:{showCCCD:!1,showMSSV:!0,showNgayVaoDang:!1,showLoaiDangVien:!1,showNhom:!0,showKhoa:!0,showChucVu:!0,showDiemHT:!0,showDiemRL:!0,showThanhTich:!1,showChiBoDeXuat:!0}}};let fn=JSON.parse(JSON.stringify(Ws)),FR=!1,Ha=null;const bn=t=>String(t||"").trim(),Tg=()=>window.dispatchEvent(new Event("db_update")),Xu=t=>{console.error("Firebase Error:",t);const e=(t.message||JSON.stringify(t)).toLowerCase();e.includes("permission_denied")||e.includes("permission denied")?setTimeout(()=>{alert(`LI QUYN TRUY CP (PERMISSION DENIED)!

Nguyn nhn: Firebase Database ang chn ng dng c/ghi d liu.

CCH KHC PHC:
1. Vo Firebase Console (console.firebase.google.com)
2. Chn Project -> Realtime Database -> Tab 'Rules'
3. Xa ht code c v dn on sau:

{
  "rules": {
    ".read": true,
    ".write": true
  }
}

4. Bm 'Publish' (Xut bn)`)},1e3):console.warn("Li kt ni Cloud khc: "+e)},IR=()=>{if(Uc())try{console.log("ang kt ni Firebase...");const t=lT(pp),e=RR(t);p5(e).then(()=>{console.log(" ng nhp n danh vo Firebase.")}).catch(n=>{console.warn("Li ng nhp n danh (C th cha bt Anonymous Provider):",n)}),Ha=DD(t);const r=zu(Ha,"app_data");wS(r,n=>{var l,o;const i=n.val();i?(fn={...Ws,...i,config:{...Ws.config,...i.config}},fn.config.p1Display={...Ws.config.p1Display,...(l=i.config)==null?void 0:l.p1Display},fn.config.p2Display={...Ws.config.p2Display,...(o=i.config)==null?void 0:o.p2Display},fn.voters=Array.isArray(fn.voters)?fn.voters:[],fn.votesP1=Array.isArray(fn.votesP1)?fn.votesP1:[],fn.votesP2=Array.isArray(fn.votesP2)?fn.votesP2:[],console.log(" ng b d liu t Cloud")):console.log("Cloud cha c d liu, dng mc nh."),FR=!0,Tg()},n=>{console.error("Li c d liu:",n),Xu(n)})}catch(t){console.error("Li kt ni Firebase Init:",t),Ew()}else console.warn("Cha cu hnh Firebase. S dng LocalStorage (Ch offline)."),Ew()},Ew=()=>{try{const t=localStorage.getItem(tb);if(t){const e=JSON.parse(t);fn={...Ws,...e}}Tg()}catch(t){console.error(t)}};IR();const Wr=()=>JSON.parse(JSON.stringify(fn)),Ma=async t=>{if(fn=t,Tg(),Uc()&&Ha)try{return await yS(zu(Ha,"app_data"),t),!0}catch(e){return Xu(e),!1}else return localStorage.setItem(tb,JSON.stringify(t)),!0},MR=async()=>{if(!Uc()||!Ha)return{success:!1,message:"Cha kt ni c Firebase."};try{console.log("ang bt buc y d liu ln Cloud...");const t=Wr();return await yS(zu(Ha,"app_data"),t),{success:!0,message:" ng b thnh cng! Ngi khc c th thy d liu ngay by gi."}}catch(t){return Xu(t),{success:!1,message:"Li: "+(t.message||"Khng xc nh")}}},rb=async(t=!1)=>{(t||confirm("CNH BO: Bn c chc chn mun XA TON B d liu trn h thng?"))&&(await Ma(JSON.parse(JSON.stringify(Ws))),t||window.location.reload())},LR=async()=>{const t=Wr();return t.candidatesP1=[],t.votesP1=[],t.voters=t.voters.map(e=>({...e,hasVotedPhase1:!1})),await Ma(t)},BR=async()=>{const t=Wr();return t.candidatesP2=[],t.votesP2=[],t.voters=t.voters.map(e=>({...e,hasVotedPhase2:!1})),await Ma(t)},PR=async()=>{const t=Wr();return t.voters=[],t.votesP1=[],t.votesP2=[],await Ma(t)},UR=async(t,e)=>{const r=bn(t);if(Uc()&&Ha)try{return await ES(zu(Ha,"app_data"),n=>{if(!n)return n;if(n.voters){const i=n.voters.findIndex(l=>bn(l.cccd)===r);i!==-1&&(n.voters[i].hasVotedPhase1=!0)}return Array.isArray(n.votesP1)||(n.votesP1=[]),n.votesP1=n.votesP1.filter(i=>bn(i.voterCCCD)!==r),e.forEach(i=>{n.votesP1.push({voterCCCD:r,candidateCCCD:bn(i.candidateCCCD),level:i.level})}),n}),!0}catch(n){return Xu(n),!1}else{const n=Wr(),i=n.voters.findIndex(l=>bn(l.cccd)===r);return i===-1?!1:(n.voters[i].hasVotedPhase1=!0,n.votesP1=n.votesP1.filter(l=>bn(l.voterCCCD)!==r),e.forEach(l=>{n.votesP1.push({voterCCCD:r,candidateCCCD:bn(l.candidateCCCD),level:l.level})}),await Ma(n))}},jR=async(t,e)=>{const r=bn(t);if(Uc()&&Ha)try{return await ES(zu(Ha,"app_data"),n=>{if(!n)return n;if(n.voters){const i=n.voters.findIndex(l=>bn(l.cccd)===r);i!==-1&&(n.voters[i].hasVotedPhase2=!0)}return Array.isArray(n.votesP2)||(n.votesP2=[]),n.votesP2=n.votesP2.filter(i=>bn(i.voterCCCD)!==r),e.forEach(i=>{n.votesP2.push({voterCCCD:r,candidateCCCD:bn(i)})}),n}),!0}catch(n){return Xu(n),!1}else{const n=Wr(),i=n.voters.findIndex(l=>bn(l.cccd)===r);return i===-1?!1:(n.voters[i].hasVotedPhase2=!0,n.votesP2=n.votesP2.filter(l=>bn(l.voterCCCD)!==r),e.forEach(l=>{n.votesP2.push({voterCCCD:r,candidateCCCD:bn(l)})}),await Ma(n))}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yu={};yu.version="0.18.5";var Hn=1200,il=1252,HR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Uh=function(t){HR.indexOf(t)!=-1&&(il=Sg[0]=t)};function zR(){Uh(1252)}var ca=function(t){Hn=t,Uh(t)};function jh(){ca(1200),zR()}function lh(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function VR(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function nb(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var hc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?VR(t.slice(2)):e==254&&r==255?nb(t.slice(2)):e==65279?t.slice(1):t},Vo=function(e){return String.fromCharCode(e)},gp=function(e){return String.fromCharCode(e)},St;function GR(t){St=t,ca=function(e){Hn=e,Uh(e)},hc=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?St.utils.decode(1200,lh(e.slice(2))):e},Vo=function(r){return Hn===1200?String.fromCharCode(r):St.utils.decode(Hn,[r&255,r>>8])[0]},gp=function(r){return St.utils.decode(il,[r])[0]},Ob()}var es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function wu(t){for(var e="",r=0,n=0,i=0,l=0,o=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),l=r>>2,n=t.charCodeAt(d++),o=(r&3)<<4|n>>4,i=t.charCodeAt(d++),u=(n&15)<<2|i>>6,h=i&63,isNaN(n)?u=h=64:isNaN(i)&&(h=64),e+=es.charAt(l)+es.charAt(o)+es.charAt(u)+es.charAt(h);return e}function zn(t){var e="",r=0,n=0,i=0,l=0,o=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)l=es.indexOf(t.charAt(d++)),o=es.indexOf(t.charAt(d++)),r=l<<2|o>>4,e+=String.fromCharCode(r),u=es.indexOf(t.charAt(d++)),n=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=es.indexOf(t.charAt(d++)),i=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(i));return e}var ht=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),wi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function hs(t){return ht?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Tw(t){return ht?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Un=function(e){return ht?wi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function qu(t){if(typeof ArrayBuffer>"u")return Un(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function xs(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function WR(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function bg(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return bg(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Pr=ht?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:wi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function XR(t){for(var e=[],r=0,n=t.length+250,i=hs(t.length+255),l=0;l<t.length;++l){var o=t.charCodeAt(l);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=t.charCodeAt(++l)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|u>>6&15|(o&3)<<4,i[r++]=128|u&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=hs(65535),n=65530)}return e.push(i.slice(0,r)),Pr(e)}var nn=/\u0000/g,Go=/[\u0001-\u0006]/g;function yc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ea(t,e){var r=""+t;return r.length>=e?r:or("0",e-r.length)+r}function Cg(t,e){var r=""+t;return r.length>=e?r:or(" ",e-r.length)+r}function ch(t,e){var r=""+t;return r.length>=e?r:r+or(" ",e-r.length)}function qR(t,e){var r=""+Math.round(t);return r.length>=e?r:or("0",e-r.length)+r}function YR(t,e){var r=""+t;return r.length>=e?r:or("0",e-r.length)+r}var Sw=Math.pow(2,32);function ic(t,e){if(t>Sw||t<-Sw)return qR(t,e);var r=Math.round(t);return YR(r,e)}function oh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var bw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],km=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function KR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ye={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Cw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$R={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function uh(t,e,r){for(var n=t<0?-1:1,i=t*n,l=0,o=1,u=0,h=1,d=0,p=0,x=Math.floor(i);d<e&&(x=Math.floor(i),u=x*o+l,p=x*d+h,!(i-x<5e-8));)i=1/(i-x),l=o,o=u,h=d,d=p;if(p>e&&(d>e?(p=h,u=l):(p=d,u=o)),!r)return[0,n*u,p];var v=Math.floor(n*u/p);return[v,n*u-v*p,p]}function ts(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),l=0,o=[],u={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),n<60&&(l=(l+6)%7),r&&(l=rO(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=l,u}var ab=new Date(1899,11,31,0,0,0),QR=ab.getTime(),ZR=new Date(1900,2,1,0,0,0);function ib(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=ZR&&(r+=1440*60*1e3),(r-(QR+(t.getTimezoneOffset()-ab.getTimezoneOffset())*6e4))/(1440*60*1e3)}function kg(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function JR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function eO(t){var e=t<0?12:11,r=kg(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function tO(t){var e=kg(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Eu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=eO(t):e===10?r=t.toFixed(10).substr(0,12):r=tO(t),kg(JR(r.toUpperCase()))}function sl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Eu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Vn(14,ib(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function rO(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function nO(t,e,r,n){var i="",l=0,o=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return km[r.m-1][1];case 5:return km[r.m-1][0];default:return km[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return bw[r.q][0];default:return bw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ea(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),e==="s"?l===0?"0":""+l/o:(i=Ea(l,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var p=d>0?Ea(h,d):"";return p}function rs(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var sb=/%/g;function aO(t,e,r){var n=e.replace(sb,""),i=e.length-n.length;return mi(t,n,r*Math.pow(10,2*i))+or("%",i)}function iO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return mi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function lb(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lb(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(e/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cb=/# (\?+)( ?)\/( ?)(\d+)/;function sO(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),l=Math.floor(i/n),o=i-l*n,u=n;return r+(l===0?"":""+l)+" "+(o===0?or(" ",t[1].length+1+t[4].length):Cg(o,t[1].length)+t[2]+"/"+t[3]+Ea(u,t[4].length))}function lO(t,e,r){return r+(e===0?"":""+e)+or(" ",t[1].length+2+t[4].length)}var ob=/^#*0*\.([0#]+)/,ub=/\).*[0#]/,fb=/\(###\) ###\\?-####/;function hn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function kw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Aw(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function cO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function oO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function na(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ub)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?na("n",n,r):"("+na("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return iO(t,e,r);if(e.indexOf("%")!==-1)return aO(t,e,r);if(e.indexOf("E")!==-1)return lb(e,r);if(e.charCodeAt(0)===36)return"$"+na(t,e.substr(e.charAt(1)==" "?2:1),r);var i,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+ic(h,e.length);if(e.match(/^[#?]+$/))return i=ic(r,0),i==="0"&&(i=""),i.length>e.length?i:hn(e.substr(0,e.length-i.length))+i;if(l=e.match(cb))return sO(l,h,d);if(e.match(/^#+0+$/))return d+ic(h,e.length-e.indexOf("0"));if(l=e.match(ob))return i=kw(r,l[1].length).replace(/^([^\.]+)$/,"$1."+hn(l[1])).replace(/\.$/,"."+hn(l[1])).replace(/\.(\d*)$/,function(E,w){return"."+w+or("0",hn(l[1]).length-w.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return d+kw(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return d+rs(ic(h,0));if(l=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+na(t,e,-r):rs(""+(Math.floor(r)+cO(r,l[1].length)))+"."+Ea(Aw(r,l[1].length),l[1].length);if(l=e.match(/^#,#*,#0/))return na(t,e.replace(/^#,#*,/,""),r);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=yc(na(t,e.replace(/[\\-]/g,""),r)),o=0,yc(yc(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(e.match(fb))return i=na(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=uh(h,Math.pow(10,o)-1,!1),i=""+d,p=mi("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=ch(u[2],o),p.length<l[4].length&&(p=hn(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=uh(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Cg(u[1],o)+l[2]+"/"+l[3]+ch(u[2],o):or(" ",2*o+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return i=ic(r,0),e.length<=i.length?i:hn(e.substr(0,e.length-i.length))+i;if(l=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=e.indexOf(".")-o,v=e.length-i.length-x;return hn(e.substr(0,x)+i+e.substr(e.length-v))}if(l=e.match(/^00,000\.([#0]*0)$/))return o=Aw(r,l[1].length),r<0?"-"+na(t,e,-r):rs(oO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Ea(0,3-E.length):"")+E})+"."+Ea(o,l[1].length);switch(e){case"###,##0.00":return na(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=rs(ic(h,0));return y!=="0"?d+y:"";case"###,###.00":return na(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return na(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function uO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return mi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function fO(t,e,r){var n=e.replace(sb,""),i=e.length-n.length;return mi(t,n,r*Math.pow(10,2*i))+or("%",i)}function hb(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+hb(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(e/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ub)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fa("n",n,r):"("+Fa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return uO(t,e,r);if(e.indexOf("%")!==-1)return fO(t,e,r);if(e.indexOf("E")!==-1)return hb(e,r);if(e.charCodeAt(0)===36)return"$"+Fa(t,e.substr(e.charAt(1)==" "?2:1),r);var i,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Ea(h,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:hn(e.substr(0,e.length-i.length))+i;if(l=e.match(cb))return lO(l,h,d);if(e.match(/^#+0+$/))return d+Ea(h,e.length-e.indexOf("0"));if(l=e.match(ob))return i=(""+r).replace(/^([^\.]+)$/,"$1."+hn(l[1])).replace(/\.$/,"."+hn(l[1])),i=i.replace(/\.(\d*)$/,function(E,w){return"."+w+or("0",hn(l[1]).length-w.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return d+rs(""+h);if(l=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fa(t,e,-r):rs(""+r)+"."+or("0",l[1].length);if(l=e.match(/^#,#*,#0/))return Fa(t,e.replace(/^#,#*,/,""),r);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=yc(Fa(t,e.replace(/[\\-]/g,""),r)),o=0,yc(yc(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(e.match(fb))return i=Fa(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=uh(h,Math.pow(10,o)-1,!1),i=""+d,p=mi("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=ch(u[2],o),p.length<l[4].length&&(p=hn(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=uh(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Cg(u[1],o)+l[2]+"/"+l[3]+ch(u[2],o):or(" ",2*o+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:hn(e.substr(0,e.length-i.length))+i;if(l=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=e.indexOf(".")-o,v=e.length-i.length-x;return hn(e.substr(0,x)+i+e.substr(e.length-v))}if(l=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fa(t,e,-r):rs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Ea(0,3-E.length):"")+E})+"."+Ea(0,l[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=rs(""+h);return y!=="0"?d+y:"";default:if(e.match(/\.[0#?]*$/))return Fa(t,e.slice(0,e.lastIndexOf(".")),r)+hn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function mi(t,e,r){return(r|0)===r?Fa(t,e,r):na(t,e,r)}function hO(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var db=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ml(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":oh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(db))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function dO(t,e,r,n){for(var i=[],l="",o=0,u="",h="t",d,p,x,v="H";o<t.length;)switch(u=t.charAt(o)){case"G":if(!oh(t,o))throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(x=t.charCodeAt(++o))!==34&&o<t.length;)l+=String.fromCharCode(x);i[i.length]={t:"t",v:l},++o;break;case"\\":var y=t.charAt(++o),E=y==="("||y===")"?y:"t";i[i.length]={t:E,v:y},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=ts(e,r,t.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=ts(e,r),d==null))return"";for(l=u;++o<t.length&&t.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),i[i.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var w={t:u,v:u};if(d==null&&(d=ts(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",v="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",o+=5,v="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(w.v=d.H>=12?"":""),w.t="T",o+=5,v="h"):(w.t="t",++o),d==null&&w.t==="T")return"";i[i.length]=w,h=u;break;case"[":for(l=u;t.charAt(o++)!=="]"&&o<t.length;)l+=t.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(db)){if(d==null&&(d=ts(e,r),d==null))return"";i[i.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ml(t)||(i[i.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++o<t.length&&(u=t.charAt(o))==="0";)l+=u;i[i.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(o))>-1;)l+=u;i[i.length]={t:"n",v:l};break;case"?":for(l=u;t.charAt(++o)===u;)l+=u;i[i.length]={t:u,v:l},h=u;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)l+=t.charAt(o);i[i.length]={t:"D",v:l};break;case" ":i[i.length]={t:u,v:u},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"t",v:u},++o;break}var S=0,N=0,I;for(o=i.length-1,h="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,h="h",S<1&&(S=1);break;case"s":(I=i[o].v.match(/\.0+$/))&&(N=Math.max(N,I[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=i[o].t;break;case"m":h==="s"&&(i[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[o].v.match(/[Hh]/)&&(S=1),S<2&&i[o].v.match(/[Mm]/)&&(S=2),S<3&&i[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",z;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=nO(i[o].t.charCodeAt(0),i[o].v,d,N),i[o].t="t";break;case"n":case"?":for(z=o+1;i[z]!=null&&((u=i[z].t)==="?"||u==="D"||(u===" "||u==="t")&&i[z+1]!=null&&(i[z+1].t==="?"||i[z+1].t==="t"&&i[z+1].v==="/")||i[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[z].v==="/"||i[z].v===" "&&i[z+1]!=null&&i[z+1].t=="?"));)i[o].v+=i[z].v,i[z]={v:"",t:";"},++z;C+=i[o].v,o=z-1;break;case"G":i[o].t="t",i[o].v=sl(e,r);break}var X="",W,R;if(C.length>0){C.charCodeAt(0)==40?(W=e<0&&C.charCodeAt(0)===45?-e:e,R=mi("n",C,W)):(W=e<0&&n>1?-e:e,R=mi("n",C,W),W<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),z=R.length-1;var Q=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){Q=o;break}var G=i.length;if(Q===i.length&&R.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(z>=i[o].v.length-1?(z-=i[o].v.length,i[o].v=R.substr(z+1,i[o].v.length)):z<0?i[o].v="":(i[o].v=R.substr(0,z+1),z=-1),i[o].t="t",G=o);z>=0&&G<i.length&&(i[G].v=R.substr(0,z+1)+i[G].v)}else if(Q!==i.length&&R.indexOf("E")===-1){for(z=R.indexOf(".")-1,o=Q;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(p=i[o].v.indexOf(".")>-1&&o===Q?i[o].v.indexOf(".")-1:i[o].v.length-1,X=i[o].v.substr(p+1);p>=0;--p)z>=0&&(i[o].v.charAt(p)==="0"||i[o].v.charAt(p)==="#")&&(X=R.charAt(z--)+X);i[o].v=X,i[o].t="t",G=o}for(z>=0&&G<i.length&&(i[G].v=R.substr(0,z+1)+i[G].v),z=R.indexOf(".")+1,o=Q;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==Q)){for(p=i[o].v.indexOf(".")>-1&&o===Q?i[o].v.indexOf(".")+1:0,X=i[o].v.substr(0,p);p<i[o].v.length;++p)z<R.length&&(X+=R.charAt(z++));i[o].v=X,i[o].t="t",G=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(W=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=mi(i[o].t,i[o].v,W),i[o].t="t");var fe="";for(o=0;o!==i.length;++o)i[o]!=null&&(fe+=i[o].v);return fe}var Nw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function mO(t,e){var r=hO(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Nw),u=r[1].match(Nw);return Dw(e,o)?[n,r[0]]:Dw(e,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,l]}function Vn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ye)[t],n==null&&(n=r.table&&r.table[Cw[t]]||Ye[Cw[t]]),n==null&&(n=$R[t]||"General");break}if(oh(n,0))return sl(e,r);e instanceof Date&&(e=ib(e,r.date1904));var i=mO(n,e);if(oh(i[1]))return sl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return dO(i[1],e,r,i[0])}function Ua(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ye[r]==null){e<0&&(e=r);continue}if(Ye[r]==t){e=r;break}}e<0&&(e=391)}return Ye[e]=t,e}function Yu(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ua(t[e],e)}function jc(){Ye=KR()}var mb={format:Vn,load:Ua,_table:Ye,load_table:Yu,parse_date_code:ts,is_date:ml,get_table:function(){return mb._table=Ye}},pO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},pb=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function gO(t){var e=typeof t=="number"?Ye[t]:t;return e=e.replace(pb,"(\\d+)"),new RegExp("^"+e+"$")}function xO(t,e,r){var n=-1,i=-1,l=-1,o=-1,u=-1,h=-1;(e.match(pb)||[]).forEach(function(x,v){var y=parseInt(r[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=y;break;case"d":l=y;break;case"h":o=y;break;case"s":h=y;break;case"m":o>=0?u=y:i=y;break}}),h>=0&&u==-1&&i>=0&&(u=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?d:n==-1&&i==-1&&l==-1?p:d+"T"+p}var vO=(function(){var t={};t.version="1.2.0";function e(){for(var R=0,Q=new Array(256),G=0;G!=256;++G)R=G,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,Q[G]=R;return typeof Int32Array<"u"?new Int32Array(Q):Q}var r=e();function n(R){var Q=0,G=0,fe=0,re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(fe=0;fe!=256;++fe)re[fe]=R[fe];for(fe=0;fe!=256;++fe)for(G=R[fe],Q=256+fe;Q<4096;Q+=256)G=re[Q]=G>>>8^R[G&255];var K=[];for(fe=1;fe!=16;++fe)K[fe-1]=typeof Int32Array<"u"?re.subarray(fe*256,fe*256+256):re.slice(fe*256,fe*256+256);return K}var i=n(r),l=i[0],o=i[1],u=i[2],h=i[3],d=i[4],p=i[5],x=i[6],v=i[7],y=i[8],E=i[9],w=i[10],S=i[11],N=i[12],I=i[13],C=i[14];function z(R,Q){for(var G=Q^-1,fe=0,re=R.length;fe<re;)G=G>>>8^r[(G^R.charCodeAt(fe++))&255];return~G}function X(R,Q){for(var G=Q^-1,fe=R.length-15,re=0;re<fe;)G=C[R[re++]^G&255]^I[R[re++]^G>>8&255]^N[R[re++]^G>>16&255]^S[R[re++]^G>>>24]^w[R[re++]]^E[R[re++]]^y[R[re++]]^v[R[re++]]^x[R[re++]]^p[R[re++]]^d[R[re++]]^h[R[re++]]^u[R[re++]]^o[R[re++]]^l[R[re++]]^r[R[re++]];for(fe+=15;re<fe;)G=G>>>8^r[(G^R[re++])&255];return~G}function W(R,Q){for(var G=Q^-1,fe=0,re=R.length,K=0,ye=0;fe<re;)K=R.charCodeAt(fe++),K<128?G=G>>>8^r[(G^K)&255]:K<2048?(G=G>>>8^r[(G^(192|K>>6&31))&255],G=G>>>8^r[(G^(128|K&63))&255]):K>=55296&&K<57344?(K=(K&1023)+64,ye=R.charCodeAt(fe++)&1023,G=G>>>8^r[(G^(240|K>>8&7))&255],G=G>>>8^r[(G^(128|K>>2&63))&255],G=G>>>8^r[(G^(128|ye>>6&15|(K&3)<<4))&255],G=G>>>8^r[(G^(128|ye&63))&255]):(G=G>>>8^r[(G^(224|K>>12&15))&255],G=G>>>8^r[(G^(128|K>>6&63))&255],G=G>>>8^r[(G^(128|K&63))&255]);return~G}return t.table=r,t.bstr=z,t.buf=X,t.str=W,t})(),We=(function(){var e={};e.version="1.2.1";function r(b,L){for(var D=b.split("/"),O=L.split("/"),F=0,B=0,ie=Math.min(D.length,O.length);F<ie;++F){if(B=D[F].length-O[F].length)return B;if(D[F]!=O[F])return D[F]<O[F]?-1:1}return D.length-O.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var L=b.lastIndexOf("/");return L===-1?b:b.slice(0,L+1)}function i(b){if(b.charAt(b.length-1)=="/")return i(b.slice(0,-1));var L=b.lastIndexOf("/");return L===-1?b:b.slice(L+1)}function l(b,L){typeof L=="string"&&(L=new Date(L));var D=L.getHours();D=D<<6|L.getMinutes(),D=D<<5|L.getSeconds()>>>1,b.write_shift(2,D);var O=L.getFullYear()-1980;O=O<<4|L.getMonth()+1,O=O<<5|L.getDate(),b.write_shift(2,O)}function o(b){var L=b.read_shift(2)&65535,D=b.read_shift(2)&65535,O=new Date,F=D&31;D>>>=5;var B=D&15;D>>>=4,O.setMilliseconds(0),O.setFullYear(D+1980),O.setMonth(B-1),O.setDate(F);var ie=L&31;L>>>=5;var ve=L&63;return L>>>=6,O.setHours(L),O.setMinutes(ve),O.setSeconds(ie<<1),O}function u(b){Xr(b,0);for(var L={},D=0;b.l<=b.length-4;){var O=b.read_shift(2),F=b.read_shift(2),B=b.l+F,ie={};switch(O){case 21589:D=b.read_shift(1),D&1&&(ie.mtime=b.read_shift(4)),F>5&&(D&2&&(ie.atime=b.read_shift(4)),D&4&&(ie.ctime=b.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}b.l=B,L[O]=ie}return L}var h;function d(){return h||(h={})}function p(b,L){if(b[0]==80&&b[1]==75)return ys(b,L);if((b[0]|32)==109&&(b[1]|32)==105)return Es(b,L);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var D=3,O=512,F=0,B=0,ie=0,ve=0,se=0,le=[],oe=b.slice(0,512);Xr(oe,0);var ke=x(oe);switch(D=ke[0],D){case 3:O=512;break;case 4:O=4096;break;case 0:if(ke[1]==0)return ys(b,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}O!==512&&(oe=b.slice(0,O),Xr(oe,28));var Ne=b.slice(0,O);v(oe,D);var Ue=oe.read_shift(4,"i");if(D===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);oe.l+=4,ie=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),ve=oe.read_shift(4,"i"),F=oe.read_shift(4,"i"),se=oe.read_shift(4,"i"),B=oe.read_shift(4,"i");for(var Ae=-1,Be=0;Be<109&&(Ae=oe.read_shift(4,"i"),!(Ae<0));++Be)le[Be]=Ae;var He=y(b,O);S(se,B,He,O,le);var Yt=I(He,ie,le,O);Yt[ie].name="!Directory",F>0&&ve!==ye&&(Yt[ve].name="!MiniFAT"),Yt[le[0]].name="!FAT",Yt.fat_addrs=le,Yt.ssz=O;var Kt={},nr=[],Wn=[],Ts=[];C(ie,Yt,He,nr,F,Kt,Wn,ve),E(Wn,Ts,nr),nr.shift();var Si={FileIndex:Wn,FullPaths:Ts};return L&&L.raw&&(Si.raw={header:Ne,sectors:He}),Si}function x(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(Ie,"Header Signature: "),b.l+=16;var L=b.read_shift(2,"u");return[b.read_shift(2,"u"),L]}function v(b,L){var D=9;switch(b.l+=2,D=b.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function y(b,L){for(var D=Math.ceil(b.length/L)-1,O=[],F=1;F<D;++F)O[F-1]=b.slice(F*L,(F+1)*L);return O[D-1]=b.slice(D*L),O}function E(b,L,D){for(var O=0,F=0,B=0,ie=0,ve=0,se=D.length,le=[],oe=[];O<se;++O)le[O]=oe[O]=O,L[O]=D[O];for(;ve<oe.length;++ve)O=oe[ve],F=b[O].L,B=b[O].R,ie=b[O].C,le[O]===O&&(F!==-1&&le[F]!==F&&(le[O]=le[F]),B!==-1&&le[B]!==B&&(le[O]=le[B])),ie!==-1&&(le[ie]=O),F!==-1&&O!=le[O]&&(le[F]=le[O],oe.lastIndexOf(F)<ve&&oe.push(F)),B!==-1&&O!=le[O]&&(le[B]=le[O],oe.lastIndexOf(B)<ve&&oe.push(B));for(O=1;O<se;++O)le[O]===O&&(B!==-1&&le[B]!==B?le[O]=le[B]:F!==-1&&le[F]!==F&&(le[O]=le[F]));for(O=1;O<se;++O)if(b[O].type!==0){if(ve=O,ve!=le[ve])do ve=le[ve],L[O]=L[ve]+"/"+L[O];while(ve!==0&&le[ve]!==-1&&ve!=le[ve]);le[O]=-1}for(L[0]+="/",O=1;O<se;++O)b[O].type!==2&&(L[O]+="/")}function w(b,L,D){for(var O=b.start,F=b.size,B=[],ie=O;D&&F>0&&ie>=0;)B.push(L.slice(ie*K,ie*K+K)),F-=K,ie=zs(D,ie*4);return B.length===0?pe(0):Pr(B).slice(0,b.size)}function S(b,L,D,O,F){var B=ye;if(b===ye){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var ie=D[b],ve=(O>>>2)-1;if(!ie)return;for(var se=0;se<ve&&(B=zs(ie,se*4))!==ye;++se)F.push(B);S(zs(ie,O-4),L-1,D,O,F)}}function N(b,L,D,O,F){var B=[],ie=[];F||(F=[]);var ve=O-1,se=0,le=0;for(se=L;se>=0;){F[se]=!0,B[B.length]=se,ie.push(b[se]);var oe=D[Math.floor(se*4/O)];if(le=se*4&ve,O<4+le)throw new Error("FAT boundary crossed: "+se+" 4 "+O);if(!b[oe])break;se=zs(b[oe],le)}return{nodes:B,data:zw([ie])}}function I(b,L,D,O){var F=b.length,B=[],ie=[],ve=[],se=[],le=O-1,oe=0,ke=0,Ne=0,Ue=0;for(oe=0;oe<F;++oe)if(ve=[],Ne=oe+L,Ne>=F&&(Ne-=F),!ie[Ne]){se=[];var Ae=[];for(ke=Ne;ke>=0;){Ae[ke]=!0,ie[ke]=!0,ve[ve.length]=ke,se.push(b[ke]);var Be=D[Math.floor(ke*4/O)];if(Ue=ke*4&le,O<4+Ue)throw new Error("FAT boundary crossed: "+ke+" 4 "+O);if(!b[Be]||(ke=zs(b[Be],Ue),Ae[ke]))break}B[Ne]={nodes:ve,data:zw([se])}}return B}function C(b,L,D,O,F,B,ie,ve){for(var se=0,le=O.length?2:0,oe=L[b].data,ke=0,Ne=0,Ue;ke<oe.length;ke+=128){var Ae=oe.slice(ke,ke+128);Xr(Ae,64),Ne=Ae.read_shift(2),Ue=Gh(Ae,0,Ne-le),O.push(Ue);var Be={name:Ue,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},He=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);He!==0&&(Be.ct=z(Ae,Ae.l-8));var Yt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Yt!==0&&(Be.mt=z(Ae,Ae.l-8)),Be.start=Ae.read_shift(4,"i"),Be.size=Ae.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=ye,Be.name=""),Be.type===5?(se=Be.start,F>0&&se!==ye&&(L[se].name="!StreamData")):Be.size>=4096?(Be.storage="fat",L[Be.start]===void 0&&(L[Be.start]=N(D,Be.start,L.fat_addrs,L.ssz)),L[Be.start].name=Be.name,Be.content=L[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:se!==ye&&Be.start!==ye&&L[se]&&(Be.content=w(Be,L[se].data,(L[ve]||{}).data))),Be.content&&Xr(Be.content,0),B[Ue]=Be,ie.push(Be)}}function z(b,L){return new Date((Lr(b,L+4)/1e7*Math.pow(2,32)+Lr(b,L)/1e7-11644473600)*1e3)}function X(b,L){return d(),p(h.readFileSync(b),L)}function W(b,L){var D=L&&L.type;switch(D||ht&&Buffer.isBuffer(b)&&(D="buffer"),D||"base64"){case"file":return X(b,L);case"base64":return p(Un(zn(b)),L);case"binary":return p(Un(b),L)}return p(b,L)}function R(b,L){var D=L||{},O=D.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=O+"/",b.FileIndex[0]={name:O,type:5}),D.CLSID&&(b.FileIndex[0].clsid=D.CLSID),Q(b)}function Q(b){var L="Sh33tJ5";if(!We.find(b,"/"+L)){var D=pe(4);D[0]=55,D[1]=D[3]=50,D[2]=54,b.FileIndex.push({name:L,type:2,content:D,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+L),G(b)}}function G(b,L){R(b);for(var D=!1,O=!1,F=b.FullPaths.length-1;F>=0;--F){var B=b.FileIndex[F];switch(B.type){case 0:O?D=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(B.R*B.L*B.C)&&(D=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!L)){var ie=new Date(1987,1,19),ve=0,se=Object.create?Object.create(null):{},le=[];for(F=0;F<b.FullPaths.length;++F)se[b.FullPaths[F]]=!0,b.FileIndex[F].type!==0&&le.push([b.FullPaths[F],b.FileIndex[F]]);for(F=0;F<le.length;++F){var oe=n(le[F][0]);O=se[oe],O||(le.push([oe,{name:i(oe).replace("/",""),type:1,clsid:Y,ct:ie,mt:ie,content:null}]),se[oe]=!0)}for(le.sort(function(Ue,Ae){return r(Ue[0],Ae[0])}),b.FullPaths=[],b.FileIndex=[],F=0;F<le.length;++F)b.FullPaths[F]=le[F][0],b.FileIndex[F]=le[F][1];for(F=0;F<le.length;++F){var ke=b.FileIndex[F],Ne=b.FullPaths[F];if(ke.name=i(Ne).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||Y,F===0)ke.C=le.length>1?1:-1,ke.size=0,ke.type=5;else if(Ne.slice(-1)=="/"){for(ve=F+1;ve<le.length&&n(b.FullPaths[ve])!=Ne;++ve);for(ke.C=ve>=le.length?-1:ve,ve=F+1;ve<le.length&&n(b.FullPaths[ve])!=n(Ne);++ve);ke.R=ve>=le.length?-1:ve,ke.type=1}else n(b.FullPaths[F+1]||"")==n(Ne)&&(ke.R=F+1),ke.type=2}}}function fe(b,L){var D=L||{};if(D.fileType=="mad")return Jh(b,D);switch(G(b),D.fileType){case"zip":return El(b,D)}var O=(function(Ue){for(var Ae=0,Be=0,He=0;He<Ue.FileIndex.length;++He){var Yt=Ue.FileIndex[He];if(Yt.content){var Kt=Yt.content.length;Kt>0&&(Kt<4096?Ae+=Kt+63>>6:Be+=Kt+511>>9)}}for(var nr=Ue.FullPaths.length+3>>2,Wn=Ae+7>>3,Ts=Ae+127>>7,Si=Wn+Be+nr+Ts,ka=Si+127>>7,qc=ka<=109?0:Math.ceil((ka-109)/127);Si+ka+qc+127>>7>ka;)qc=++ka<=109?0:Math.ceil((ka-109)/127);var gn=[1,qc,ka,Ts,nr,Be,Ae,0];return Ue.FileIndex[0].size=Ae<<6,gn[7]=(Ue.FileIndex[0].start=gn[0]+gn[1]+gn[2]+gn[3]+gn[4]+gn[5])+(gn[6]+7>>3),gn})(b),F=pe(O[7]<<9),B=0,ie=0;{for(B=0;B<8;++B)F.write_shift(1,Ce[B]);for(B=0;B<8;++B)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),B=0;B<3;++B)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,O[2]),F.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:ye),F.write_shift(4,O[3]),F.write_shift(-4,O[1]?O[0]-1:ye),F.write_shift(4,O[1]),B=0;B<109;++B)F.write_shift(-4,B<O[2]?O[1]+B:-1)}if(O[1])for(ie=0;ie<O[1];++ie){for(;B<236+ie*127;++B)F.write_shift(-4,B<O[2]?O[1]+B:-1);F.write_shift(-4,ie===O[1]-1?ye:ie+1)}var ve=function(Ue){for(ie+=Ue;B<ie-1;++B)F.write_shift(-4,B+1);Ue&&(++B,F.write_shift(-4,ye))};for(ie=B=0,ie+=O[1];B<ie;++B)F.write_shift(-4,ue.DIFSECT);for(ie+=O[2];B<ie;++B)F.write_shift(-4,ue.FATSECT);ve(O[3]),ve(O[4]);for(var se=0,le=0,oe=b.FileIndex[0];se<b.FileIndex.length;++se)oe=b.FileIndex[se],oe.content&&(le=oe.content.length,!(le<4096)&&(oe.start=ie,ve(le+511>>9)));for(ve(O[6]+7>>3);F.l&511;)F.write_shift(-4,ue.ENDOFCHAIN);for(ie=B=0,se=0;se<b.FileIndex.length;++se)oe=b.FileIndex[se],oe.content&&(le=oe.content.length,!(!le||le>=4096)&&(oe.start=ie,ve(le+63>>6)));for(;F.l&511;)F.write_shift(-4,ue.ENDOFCHAIN);for(B=0;B<O[4]<<2;++B){var ke=b.FullPaths[B];if(!ke||ke.length===0){for(se=0;se<17;++se)F.write_shift(4,0);for(se=0;se<3;++se)F.write_shift(4,-1);for(se=0;se<12;++se)F.write_shift(4,0);continue}oe=b.FileIndex[B],B===0&&(oe.start=oe.size?oe.start-1:ye);var Ne=B===0&&D.root||oe.name;if(le=2*(Ne.length+1),F.write_shift(64,Ne,"utf16le"),F.write_shift(2,le),F.write_shift(1,oe.type),F.write_shift(1,oe.color),F.write_shift(-4,oe.L),F.write_shift(-4,oe.R),F.write_shift(-4,oe.C),oe.clsid)F.write_shift(16,oe.clsid,"hex");else for(se=0;se<4;++se)F.write_shift(4,0);F.write_shift(4,oe.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,oe.start),F.write_shift(4,oe.size),F.write_shift(4,0)}for(B=1;B<b.FileIndex.length;++B)if(oe=b.FileIndex[B],oe.size>=4096)if(F.l=oe.start+1<<9,ht&&Buffer.isBuffer(oe.content))oe.content.copy(F,F.l,0,oe.size),F.l+=oe.size+511&-512;else{for(se=0;se<oe.size;++se)F.write_shift(1,oe.content[se]);for(;se&511;++se)F.write_shift(1,0)}for(B=1;B<b.FileIndex.length;++B)if(oe=b.FileIndex[B],oe.size>0&&oe.size<4096)if(ht&&Buffer.isBuffer(oe.content))oe.content.copy(F,F.l,0,oe.size),F.l+=oe.size+63&-64;else{for(se=0;se<oe.size;++se)F.write_shift(1,oe.content[se]);for(;se&63;++se)F.write_shift(1,0)}if(ht)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function re(b,L){var D=b.FullPaths.map(function(se){return se.toUpperCase()}),O=D.map(function(se){var le=se.split("/");return le[le.length-(se.slice(-1)=="/"?2:1)]}),F=!1;L.charCodeAt(0)===47?(F=!0,L=D[0].slice(0,-1)+L):F=L.indexOf("/")!==-1;var B=L.toUpperCase(),ie=F===!0?D.indexOf(B):O.indexOf(B);if(ie!==-1)return b.FileIndex[ie];var ve=!B.match(Go);for(B=B.replace(nn,""),ve&&(B=B.replace(Go,"!")),ie=0;ie<D.length;++ie)if((ve?D[ie].replace(Go,"!"):D[ie]).replace(nn,"")==B||(ve?O[ie].replace(Go,"!"):O[ie]).replace(nn,"")==B)return b.FileIndex[ie];return null}var K=64,ye=-2,Ie="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ye,FREESECT:-1,HEADER_SIGNATURE:Ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Me(b,L,D){d();var O=fe(b,D);h.writeFileSync(L,O)}function Z(b){for(var L=new Array(b.length),D=0;D<b.length;++D)L[D]=String.fromCharCode(b[D]);return L.join("")}function Le(b,L){var D=fe(b,L);switch(L&&L.type||"buffer"){case"file":return d(),h.writeFileSync(L.filename,D),D;case"binary":return typeof D=="string"?D:Z(D);case"base64":return wu(typeof D=="string"?D:Z(D));case"buffer":if(ht)return Buffer.isBuffer(D)?D:wi(D);case"array":return typeof D=="string"?Un(D):D}return D}var U;function k(b){try{var L=b.InflateRaw,D=new L;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)U=b;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function P(b,L){if(!U)return nf(b,L);var D=U.InflateRaw,O=new D,F=O._processChunk(b.slice(b.l),O._finishFlushFlag);return b.l+=O.bytesRead,F}function M(b){return U?U.deflateRawSync(b):qe(b)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(b){var L=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(L>>16|L>>8|L)&255}for(var me=typeof Uint8Array<"u",we=me?new Uint8Array(256):[],$e=0;$e<256;++$e)we[$e]=Te($e);function H(b,L){var D=we[b&255];return L<=8?D>>>8-L:(D=D<<8|we[b>>8&255],L<=16?D>>>16-L:(D=D<<8|we[b>>16&255],D>>>24-L))}function At(b,L){var D=L&7,O=L>>>3;return(b[O]|(D<=6?0:b[O+1]<<8))>>>D&3}function at(b,L){var D=L&7,O=L>>>3;return(b[O]|(D<=5?0:b[O+1]<<8))>>>D&7}function be(b,L){var D=L&7,O=L>>>3;return(b[O]|(D<=4?0:b[O+1]<<8))>>>D&15}function de(b,L){var D=L&7,O=L>>>3;return(b[O]|(D<=3?0:b[O+1]<<8))>>>D&31}function te(b,L){var D=L&7,O=L>>>3;return(b[O]|(D<=1?0:b[O+1]<<8))>>>D&127}function Pe(b,L,D){var O=L&7,F=L>>>3,B=(1<<D)-1,ie=b[F]>>>O;return D<8-O||(ie|=b[F+1]<<8-O,D<16-O)||(ie|=b[F+2]<<16-O,D<24-O)||(ie|=b[F+3]<<24-O),ie&B}function Ge(b,L,D){var O=L&7,F=L>>>3;return O<=5?b[F]|=(D&7)<<O:(b[F]|=D<<O&255,b[F+1]=(D&7)>>8-O),L+3}function bt(b,L,D){var O=L&7,F=L>>>3;return D=(D&1)<<O,b[F]|=D,L+1}function vr(b,L,D){var O=L&7,F=L>>>3;return D<<=O,b[F]|=D&255,D>>>=8,b[F+1]=D,L+8}function cn(b,L,D){var O=L&7,F=L>>>3;return D<<=O,b[F]|=D&255,D>>>=8,b[F+1]=D&255,b[F+2]=D>>>8,L+16}function Yr(b,L){var D=b.length,O=2*D>L?2*D:L+5,F=0;if(D>=L)return b;if(ht){var B=Tw(O);if(b.copy)b.copy(B);else for(;F<b.length;++F)B[F]=b[F];return B}else if(me){var ie=new Uint8Array(O);if(ie.set)ie.set(b);else for(;F<D;++F)ie[F]=b[F];return ie}return b.length=O,b}function Ot(b){for(var L=new Array(b),D=0;D<b;++D)L[D]=0;return L}function Oe(b,L,D){var O=1,F=0,B=0,ie=0,ve=0,se=b.length,le=me?new Uint16Array(32):Ot(32);for(B=0;B<32;++B)le[B]=0;for(B=se;B<D;++B)b[B]=0;se=b.length;var oe=me?new Uint16Array(se):Ot(se);for(B=0;B<se;++B)le[F=b[B]]++,O<F&&(O=F),oe[B]=0;for(le[0]=0,B=1;B<=O;++B)le[B+16]=ve=ve+le[B-1]<<1;for(B=0;B<se;++B)ve=b[B],ve!=0&&(oe[B]=le[ve+16]++);var ke=0;for(B=0;B<se;++B)if(ke=b[B],ke!=0)for(ve=H(oe[B],O)>>O-ke,ie=(1<<O+4-ke)-1;ie>=0;--ie)L[ve|ie<<ke]=ke&15|B<<4;return O}var Ve=me?new Uint16Array(512):Ot(512),Qe=me?new Uint16Array(32):Ot(32);if(!me){for(var tt=0;tt<512;++tt)Ve[tt]=0;for(tt=0;tt<32;++tt)Qe[tt]=0}(function(){for(var b=[],L=0;L<32;L++)b.push(5);Oe(b,Qe,32);var D=[];for(L=0;L<=143;L++)D.push(8);for(;L<=255;L++)D.push(9);for(;L<=279;L++)D.push(7);for(;L<=287;L++)D.push(8);Oe(D,Ve,288)})();var Ze=(function(){for(var L=me?new Uint8Array(32768):[],D=0,O=0;D<xe.length-1;++D)for(;O<xe[D+1];++O)L[O]=D;for(;O<32768;++O)L[O]=29;var F=me?new Uint8Array(259):[];for(D=0,O=0;D<ee.length-1;++D)for(;O<ee[D+1];++O)F[O]=D;function B(ve,se){for(var le=0;le<ve.length;){var oe=Math.min(65535,ve.length-le),ke=le+oe==ve.length;for(se.write_shift(1,+ke),se.write_shift(2,oe),se.write_shift(2,~oe&65535);oe-- >0;)se[se.l++]=ve[le++]}return se.l}function ie(ve,se){for(var le=0,oe=0,ke=me?new Uint16Array(32768):[];oe<ve.length;){var Ne=Math.min(65535,ve.length-oe);if(Ne<10){for(le=Ge(se,le,+(oe+Ne==ve.length)),le&7&&(le+=8-(le&7)),se.l=le/8|0,se.write_shift(2,Ne),se.write_shift(2,~Ne&65535);Ne-- >0;)se[se.l++]=ve[oe++];le=se.l*8;continue}le=Ge(se,le,+(oe+Ne==ve.length)+2);for(var Ue=0;Ne-- >0;){var Ae=ve[oe];Ue=(Ue<<5^Ae)&32767;var Be=-1,He=0;if((Be=ke[Ue])&&(Be|=oe&-32768,Be>oe&&(Be-=32768),Be<oe))for(;ve[Be+He]==ve[oe+He]&&He<250;)++He;if(He>2){Ae=F[He],Ae<=22?le=vr(se,le,we[Ae+1]>>1)-1:(vr(se,le,3),le+=5,vr(se,le,we[Ae-23]>>5),le+=3);var Yt=Ae<8?0:Ae-4>>2;Yt>0&&(cn(se,le,He-ee[Ae]),le+=Yt),Ae=L[oe-Be],le=vr(se,le,we[Ae]>>3),le-=3;var Kt=Ae<4?0:Ae-2>>1;Kt>0&&(cn(se,le,oe-Be-xe[Ae]),le+=Kt);for(var nr=0;nr<He;++nr)ke[Ue]=oe&32767,Ue=(Ue<<5^ve[oe])&32767,++oe;Ne-=He-1}else Ae<=143?Ae=Ae+48:le=bt(se,le,1),le=vr(se,le,we[Ae]),ke[Ue]=oe&32767,++oe}le=vr(se,le,0)-1}return se.l=(le+7)/8|0,se.l}return function(se,le){return se.length<8?B(se,le):ie(se,le)}})();function qe(b){var L=pe(50+Math.floor(b.length*1.1)),D=Ze(b,L);return L.slice(0,D)}var Ct=me?new Uint16Array(32768):Ot(32768),Dr=me?new Uint16Array(32768):Ot(32768),gt=me?new Uint16Array(128):Ot(128),dr=1,ha=1;function on(b,L){var D=de(b,L)+257;L+=5;var O=de(b,L)+1;L+=5;var F=be(b,L)+4;L+=4;for(var B=0,ie=me?new Uint8Array(19):Ot(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,le=me?new Uint8Array(8):Ot(8),oe=me?new Uint8Array(8):Ot(8),ke=ie.length,Ne=0;Ne<F;++Ne)ie[j[Ne]]=B=at(b,L),se<B&&(se=B),le[B]++,L+=3;var Ue=0;for(le[0]=0,Ne=1;Ne<=se;++Ne)oe[Ne]=Ue=Ue+le[Ne-1]<<1;for(Ne=0;Ne<ke;++Ne)(Ue=ie[Ne])!=0&&(ve[Ne]=oe[Ue]++);var Ae=0;for(Ne=0;Ne<ke;++Ne)if(Ae=ie[Ne],Ae!=0){Ue=we[ve[Ne]]>>8-Ae;for(var Be=(1<<7-Ae)-1;Be>=0;--Be)gt[Ue|Be<<Ae]=Ae&7|Ne<<3}var He=[];for(se=1;He.length<D+O;)switch(Ue=gt[te(b,L)],L+=Ue&7,Ue>>>=3){case 16:for(B=3+At(b,L),L+=2,Ue=He[He.length-1];B-- >0;)He.push(Ue);break;case 17:for(B=3+at(b,L),L+=3;B-- >0;)He.push(0);break;case 18:for(B=11+te(b,L),L+=7;B-- >0;)He.push(0);break;default:He.push(Ue),se<Ue&&(se=Ue);break}var Yt=He.slice(0,D),Kt=He.slice(D);for(Ne=D;Ne<286;++Ne)Yt[Ne]=0;for(Ne=O;Ne<30;++Ne)Kt[Ne]=0;return dr=Oe(Yt,Ct,286),ha=Oe(Kt,Dr,30),L}function Qh(b,L){if(b[0]==3&&!(b[1]&3))return[hs(L),2];for(var D=0,O=0,F=Tw(L||1<<18),B=0,ie=F.length>>>0,ve=0,se=0;(O&1)==0;){if(O=at(b,D),D+=3,O>>>1)O>>1==1?(ve=9,se=5):(D=on(b,D),ve=dr,se=ha);else{D&7&&(D+=8-(D&7));var le=b[D>>>3]|b[(D>>>3)+1]<<8;if(D+=32,le>0)for(!L&&ie<B+le&&(F=Yr(F,B+le),ie=F.length);le-- >0;)F[B++]=b[D>>>3],D+=8;continue}for(;;){!L&&ie<B+32767&&(F=Yr(F,B+32767),ie=F.length);var oe=Pe(b,D,ve),ke=O>>>1==1?Ve[oe]:Ct[oe];if(D+=ke&15,ke>>>=4,(ke>>>8&255)===0)F[B++]=ke;else{if(ke==256)break;ke-=257;var Ne=ke<8?0:ke-4>>2;Ne>5&&(Ne=0);var Ue=B+ee[ke];Ne>0&&(Ue+=Pe(b,D,Ne),D+=Ne),oe=Pe(b,D,se),ke=O>>>1==1?Qe[oe]:Dr[oe],D+=ke&15,ke>>>=4;var Ae=ke<4?0:ke-2>>1,Be=xe[ke];for(Ae>0&&(Be+=Pe(b,D,Ae),D+=Ae),!L&&ie<Ue&&(F=Yr(F,Ue+100),ie=F.length);B<Ue;)F[B]=F[B-Be],++B}}}return L?[F,D+7>>>3]:[F.slice(0,B),D+7>>>3]}function nf(b,L){var D=b.slice(b.l||0),O=Qh(D,L);return b.l+=O[1],O[0]}function af(b,L){if(b)typeof console<"u"&&console.error(L);else throw new Error(L)}function ys(b,L){var D=b;Xr(D,0);var O=[],F=[],B={FileIndex:O,FullPaths:F};R(B,{root:L.root});for(var ie=D.length-4;(D[ie]!=80||D[ie+1]!=75||D[ie+2]!=5||D[ie+3]!=6)&&ie>=0;)--ie;D.l=ie+4,D.l+=4;var ve=D.read_shift(2);D.l+=6;var se=D.read_shift(4);for(D.l=se,ie=0;ie<ve;++ie){D.l+=20;var le=D.read_shift(4),oe=D.read_shift(4),ke=D.read_shift(2),Ne=D.read_shift(2),Ue=D.read_shift(2);D.l+=8;var Ae=D.read_shift(4),Be=u(D.slice(D.l+ke,D.l+ke+Ne));D.l+=ke+Ne+Ue;var He=D.l;D.l=Ae+4,wl(D,le,oe,B,Be),D.l=He}return B}function wl(b,L,D,O,F){b.l+=2;var B=b.read_shift(2),ie=b.read_shift(2),ve=o(b);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var se=b.read_shift(4),le=b.read_shift(4),oe=b.read_shift(4),ke=b.read_shift(2),Ne=b.read_shift(2),Ue="",Ae=0;Ae<ke;++Ae)Ue+=String.fromCharCode(b[b.l++]);if(Ne){var Be=u(b.slice(b.l,b.l+Ne));(Be[21589]||{}).mt&&(ve=Be[21589].mt),((F||{})[21589]||{}).mt&&(ve=F[21589].mt)}b.l+=Ne;var He=b.slice(b.l,b.l+le);switch(ie){case 8:He=P(b,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var Yt=!1;B&8&&(se=b.read_shift(4),se==134695760&&(se=b.read_shift(4),Yt=!0),le=b.read_shift(4),oe=b.read_shift(4)),le!=L&&af(Yt,"Bad compressed size: "+L+" != "+le),oe!=D&&af(Yt,"Bad uncompressed size: "+D+" != "+oe),Sl(O,Ue,He,{unsafe:!0,mt:ve})}function El(b,L){var D=L||{},O=[],F=[],B=pe(1),ie=D.compression?8:0,ve=0,se=0,le=0,oe=0,ke=0,Ne=b.FullPaths[0],Ue=Ne,Ae=b.FileIndex[0],Be=[],He=0;for(se=1;se<b.FullPaths.length;++se)if(Ue=b.FullPaths[se].slice(Ne.length),Ae=b.FileIndex[se],!(!Ae.size||!Ae.content||Ue=="Sh33tJ5")){var Yt=oe,Kt=pe(Ue.length);for(le=0;le<Ue.length;++le)Kt.write_shift(1,Ue.charCodeAt(le)&127);Kt=Kt.slice(0,Kt.l),Be[ke]=vO.buf(Ae.content,0);var nr=Ae.content;ie==8&&(nr=M(nr)),B=pe(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,ve),B.write_shift(2,ie),Ae.mt?l(B,Ae.mt):B.write_shift(4,0),B.write_shift(-4,Be[ke]),B.write_shift(4,nr.length),B.write_shift(4,Ae.content.length),B.write_shift(2,Kt.length),B.write_shift(2,0),oe+=B.length,O.push(B),oe+=Kt.length,O.push(Kt),oe+=nr.length,O.push(nr),B=pe(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,ve),B.write_shift(2,ie),B.write_shift(4,0),B.write_shift(-4,Be[ke]),B.write_shift(4,nr.length),B.write_shift(4,Ae.content.length),B.write_shift(2,Kt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,Yt),He+=B.l,F.push(B),He+=Kt.length,F.push(Kt),++ke}return B=pe(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,ke),B.write_shift(2,ke),B.write_shift(4,He),B.write_shift(4,oe),B.write_shift(2,0),Pr([Pr(O),Pr(F),B])}var Gn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tl(b,L){if(b.ctype)return b.ctype;var D=b.name||"",O=D.match(/\.([^\.]+)$/);return O&&Gn[O[1]]||L&&(O=(D=L).match(/[\.\\]([^\.\\])+$/),O&&Gn[O[1]])?Gn[O[1]]:"application/octet-stream"}function ws(b){for(var L=wu(b),D=[],O=0;O<L.length;O+=76)D.push(L.slice(O,O+76));return D.join(`\r
`)+`\r
`}function Zh(b){var L=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var oe=le.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],O=L.split(`\r
`),F=0;F<O.length;++F){var B=O[F];if(B.length==0){D.push("");continue}for(var ie=0;ie<B.length;){var ve=76,se=B.slice(ie,ie+ve);se.charAt(ve-1)=="="?ve--:se.charAt(ve-2)=="="?ve-=2:se.charAt(ve-3)=="="&&(ve-=3),se=B.slice(ie,ie+ve),ie+=ve,ie<B.length&&(se+="="),D.push(se)}}return D.join(`\r
`)}function sf(b){for(var L=[],D=0;D<b.length;++D){for(var O=b[D];D<=b.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+b[++D];L.push(O)}for(var F=0;F<L.length;++F)L[F]=L[F].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return Un(L.join(`\r
`))}function Gc(b,L,D){for(var O="",F="",B="",ie,ve=0;ve<10;++ve){var se=L[ve];if(!se||se.match(/^\s*$/))break;var le=se.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":O=le[2].trim();break;case"content-type":B=le[2].trim();break;case"content-transfer-encoding":F=le[2].trim();break}}switch(++ve,F.toLowerCase()){case"base64":ie=Un(zn(L.slice(ve).join("")));break;case"quoted-printable":ie=sf(L.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var oe=Sl(b,O.slice(D.length),ie,{unsafe:!0});B&&(oe.ctype=B)}function Es(b,L){if(Z(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=L&&L.root||"",O=(ht&&Buffer.isBuffer(b)?b.toString("binary"):Z(b)).split(`\r
`),F=0,B="";for(F=0;F<O.length;++F)if(B=O[F],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),D||(D=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),B.slice(0,D.length)!=D););var ie=(O[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var ve="--"+(ie[1]||""),se=[],le=[],oe={FileIndex:se,FullPaths:le};R(oe);var ke,Ne=0;for(F=0;F<O.length;++F){var Ue=O[F];Ue!==ve&&Ue!==ve+"--"||(Ne++&&Gc(oe,O.slice(ke,F),D),ke=F)}return oe}function Jh(b,L){var D=L||{},O=D.boundary||"SheetJS";O="------="+O;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],B=b.FullPaths[0],ie=B,ve=b.FileIndex[0],se=1;se<b.FullPaths.length;++se)if(ie=b.FullPaths[se].slice(B.length),ve=b.FileIndex[se],!(!ve.size||!ve.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var le=ve.content,oe=ht&&Buffer.isBuffer(le)?le.toString("binary"):Z(le),ke=0,Ne=Math.min(1024,oe.length),Ue=0,Ae=0;Ae<=Ne;++Ae)(Ue=oe.charCodeAt(Ae))>=32&&Ue<128&&++ke;var Be=ke>=Ne*4/5;F.push(O),F.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+ie),F.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),F.push("Content-Type: "+Tl(ve,ie)),F.push(""),F.push(Be?Zh(oe):ws(oe))}return F.push(O+`--\r
`),F.join(`\r
`)}function lf(b){var L={};return R(L,b),L}function Sl(b,L,D,O){var F=O&&O.unsafe;F||R(b);var B=!F&&We.find(b,L);if(!B){var ie=b.FullPaths[0];L.slice(0,ie.length)==ie?ie=L:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+L).replace("//","/")),B={name:i(L),type:2},b.FileIndex.push(B),b.FullPaths.push(ie),F||We.utils.cfb_gc(b)}return B.content=D,B.size=D?D.length:0,O&&(O.CLSID&&(B.clsid=O.CLSID),O.mt&&(B.mt=O.mt),O.ct&&(B.ct=O.ct)),B}function cf(b,L){R(b);var D=We.find(b,L);if(D){for(var O=0;O<b.FileIndex.length;++O)if(b.FileIndex[O]==D)return b.FileIndex.splice(O,1),b.FullPaths.splice(O,1),!0}return!1}function Wc(b,L,D){R(b);var O=We.find(b,L);if(O){for(var F=0;F<b.FileIndex.length;++F)if(b.FileIndex[F]==O)return b.FileIndex[F].name=i(D),b.FullPaths[F]=D,!0}return!1}function Xc(b){G(b,!0)}return e.find=re,e.read=W,e.parse=p,e.write=Le,e.writeFile=Me,e.utils={cfb_new:lf,cfb_add:Sl,cfb_del:cf,cfb_mov:Wc,cfb_gc:Xc,ReadShift:Jo,CheckField:Fb,prep_blob:Xr,bconcat:Pr,use_zlib:k,_deflateRaw:qe,_inflateRaw:nf,consts:ue},e})();let ns;function _O(t){ns=t}function yO(t){return typeof t=="string"?qu(t):Array.isArray(t)?WR(t):t}function Ku(t,e,r){if(typeof ns<"u"&&ns.writeFileSync)return r?ns.writeFileSync(t,e,r):ns.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=qu(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?La(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([yO(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=xs(e)),u.write(e),u.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function wO(t){if(typeof ns<"u")return ns.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function hr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Rw(t,e){for(var r=[],n=hr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Hh(t){for(var e=[],r=hr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function zh(t){for(var e=[],r=hr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function EO(t){for(var e=[],r=hr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var fh=new Date(1899,11,30,0,0,0);function Nr(t,e){var r=t.getTime(),n=fh.getTime()+(t.getTimezoneOffset()-fh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var gb=new Date,TO=fh.getTime()+(gb.getTimezoneOffset()-fh.getTimezoneOffset())*6e4,Ow=gb.getTimezoneOffset();function Vh(t){var e=new Date;return e.setTime(t*24*60*60*1e3+TO),e.getTimezoneOffset()!==Ow&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Ow)*6e4),e}function SO(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var l=1;l!=i.length;++l)if(i[l]){switch(r=1,l>3&&(n=!0),i[l].slice(i[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[l].slice(i[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[l],10)}return e}var Fw=new Date("2017-02-19T19:06:09.000Z"),xb=isNaN(Fw.getFullYear())?new Date("2/19/17"):Fw,bO=xb.getFullYear()==2017;function rr(t,e){var r=new Date(t);if(bO)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(xb.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function ll(t,e){if(ht&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return La(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return La(nb(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return La(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return La(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Xt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Xt(t[r]));return e}function or(t,e){for(var r="";r.length<e;)r+=t;return r}function Sa(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,l){return r=-r,l}),!isNaN(e=Number(n)))?e/r:e}var CO=["january","february","march","april","may","june","july","august","september","october","november","december"];function Nc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),l=e.getDate();if(isNaN(l))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&CO.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||l>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var kO=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var l=r.split(n),o=[l[0]],u=1;u<l.length;++u)o.push(i),o.push(l[u]);return o}})();function vb(t){return t?t.content&&t.type?ll(t.content,!0):t.data?hc(t.data):t.asNodeBuffer&&ht?hc(t.asNodeBuffer().toString("binary")):t.asBinary?hc(t.asBinary()):t._data&&t._data.getContent?hc(ll(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function _b(t){if(!t)return null;if(t.data)return lh(t.data);if(t.asNodeBuffer&&ht)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?lh(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function AO(t){return t&&t.name.slice(-4)===".bin"?_b(t):vb(t)}function sa(t,e){for(var r=t.FullPaths||hr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[l]]:t.FileIndex[l]}return null}function Ag(t,e){var r=sa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Sr(t,e,r){if(!r)return AO(Ag(t,e));if(!e)return null;try{return Sr(t,e)}catch{return null}}function jn(t,e,r){if(!r)return vb(Ag(t,e));if(!e)return null;try{return jn(t,e)}catch{return null}}function NO(t,e,r){return _b(Ag(t,e))}function Iw(t){for(var e=t.FullPaths||hr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ft(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ht?n=wi(r):n=XR(r),We.utils.cfb_add(t,e,n)}We.utils.cfb_add(t,e,r)}else t.file(e,r)}function Ng(){return We.utils.cfb_new()}function yb(t,e){switch(e.type){case"base64":return We.read(t,{type:"base64"});case"binary":return We.read(t,{type:"binary"});case"buffer":case"array":return We.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Wo(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var xr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,DO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Mw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,RO=/<[^>]*>/g,ln=xr.match(Mw)?Mw:RO,OO=/<\w*:/,FO=/<(\/?)\w+:/;function rt(t,e,r){for(var n={},i=0,l=0;i!==t.length&&!((l=t.charCodeAt(i))===32||l===10||l===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(DO),u=0,h="",d=0,p="",x="",v=1;if(o)for(d=0;d!=o.length;++d){for(x=o[d],l=0;l!=x.length&&x.charCodeAt(l)!==61;++l);for(p=x.slice(0,l).trim();x.charCodeAt(l+1)==32;)++l;for(v=(i=x.charCodeAt(l+1))==34||i==39?1:0,h=x.slice(l+1+v,x.length-v),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var y=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[y]&&p.slice(u-3,u)=="ext")continue;n[y]=h,n[y.toLowerCase()]=h}}return n}function Va(t){return t.replace(FO,"<$1")}var wb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Dg=Hh(wb),kt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",l=i.indexOf("<![CDATA[");if(l==-1)return i.replace(t,function(u,h){return wb[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=i.indexOf("]]>");return r(i.slice(0,l))+i.slice(l+9,o)+r(i.slice(o+3))}})(),Rg=/[&<>'"]/g,IO=/[\u0000-\u0008\u000b-\u001f]/g;function Ut(t){var e=t+"";return e.replace(Rg,function(r){return Dg[r]}).replace(IO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Lw(t){return Ut(t).replace(/ /g,"_x0020_")}var Eb=/[\u0000-\u001f]/g;function Og(t){var e=t+"";return e.replace(Rg,function(r){return Dg[r]}).replace(/\n/g,"<br/>").replace(Eb,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function MO(t){var e=t+"";return e.replace(Rg,function(r){return Dg[r]}).replace(Eb,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Bw=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function LO(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function er(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Am(t){for(var e="",r=0,n=0,i=0,l=0,o=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(l=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|l&63);continue}o=t.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(l&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function Pw(t){var e=hs(2*t.length),r,n,i=1,l=0,o=0,u;for(n=0;n<t.length;n+=i)i=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[l++]=o&255,e[l++]=o>>>8,o=0),e[l++]=r%256,e[l++]=r>>>8;return e.slice(0,l).toString("ucs2")}function Uw(t){return wi(t,"binary").toString("utf8")}var T0="foo bar baz",Gt=ht&&(Uw(T0)==Am(T0)&&Uw||Pw(T0)==Am(T0)&&Pw)||Am,La=ht?function(t){return wi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Tu=(function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),Tb=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}})(),BO=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),PO=/<\/?(?:vt:)?variant>/g,UO=/<(?:vt:)([^>]*)>([\s\S]*)</;function jw(t,e){var r=rt(t),n=t.match(BO(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(l){var o=l.replace(PO,"").match(UO);o&&i.push({v:Gt(o[2]),t:o[1]})}),i}var Sb=/(^\s|\s$|\n)/;function qr(t,e){return"<"+t+(e.match(Sb)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Su(t){return hr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function De(t,e,r){return"<"+t+(r!=null?Su(r):"")+(e!=null?(e.match(Sb)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function xp(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function jO(t,e){switch(typeof t){case"string":var r=De("vt:lpwstr",Ut(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return De((t|0)==t?"vt:i4":"vt:r8",Ut(String(t)));case"boolean":return De("vt:bool",t?"true":"false")}if(t instanceof Date)return De("vt:filetime",xp(t));throw new Error("Unable to serialize "+t)}function Fg(t){if(ht&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Gt(xs(bg(t)));throw new Error("Bad input format: expected Buffer or string")}var bu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ar={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},pl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function HO(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,l=5;l>=0;--l)i=i*256+t[e+l];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function zO(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,l=0,o=n?-e:e;isFinite(o)?o==0?i=l=0:(i=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?i=-1022:(l-=Math.pow(2,52),i+=1023)):(i=2047,l=isNaN(e)?26985:0);for(var u=0;u<=5;++u,l/=256)t[r+u]=l&255;t[r+6]=(i&15)<<4|l&15,t[r+7]=i>>4|n}var Hw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,l=t[0][n].length;i<l;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},zw=ht?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:wi(e)})):Hw(t)}:Hw,Vw=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(hi(t,i)));return n.join("").replace(nn,"")},Gh=ht?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(nn,""):Vw(t,e,r)}:Vw,Gw=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},bb=ht?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Gw(t,e,r)}:Gw,Ww=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(oc(t,i)));return n.join("")},Hc=ht?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Ww(e,r,n)}:Ww,Cb=function(t,e){var r=Lr(t,e);return r>0?Hc(t,e+4,e+4+r-1):""},Ig=Cb,kb=function(t,e){var r=Lr(t,e);return r>0?Hc(t,e+4,e+4+r-1):""},Mg=kb,Ab=function(t,e){var r=2*Lr(t,e);return r>0?Hc(t,e+4,e+4+r-1):""},Lg=Ab,Nb=function(e,r){var n=Lr(e,r);return n>0?Gh(e,r+4,r+4+n):""},Bg=Nb,Db=function(t,e){var r=Lr(t,e);return r>0?Hc(t,e+4,e+4+r):""},Pg=Db,Rb=function(t,e){return HO(t,e)},hh=Rb,Ug=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ht&&(Ig=function(e,r){if(!Buffer.isBuffer(e))return Cb(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Mg=function(e,r){if(!Buffer.isBuffer(e))return kb(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Lg=function(e,r){if(!Buffer.isBuffer(e))return Ab(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Bg=function(e,r){if(!Buffer.isBuffer(e))return Nb(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Pg=function(e,r){if(!Buffer.isBuffer(e))return Db(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},hh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Rb(e,r)},Ug=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function Ob(){Gh=function(t,e,r){return St.utils.decode(1200,t.slice(e,r)).replace(nn,"")},Hc=function(t,e,r){return St.utils.decode(65001,t.slice(e,r))},Ig=function(t,e){var r=Lr(t,e);return r>0?St.utils.decode(il,t.slice(e+4,e+4+r-1)):""},Mg=function(t,e){var r=Lr(t,e);return r>0?St.utils.decode(Hn,t.slice(e+4,e+4+r-1)):""},Lg=function(t,e){var r=2*Lr(t,e);return r>0?St.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},Bg=function(t,e){var r=Lr(t,e);return r>0?St.utils.decode(1200,t.slice(e+4,e+4+r)):""},Pg=function(t,e){var r=Lr(t,e);return r>0?St.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof St<"u"&&Ob();var oc=function(t,e){return t[e]},hi=function(t,e){return t[e+1]*256+t[e]},VO=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Lr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},zs=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},GO=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Jo(t,e){var r="",n,i,l=[],o,u,h,d;switch(e){case"dbcs":if(d=this.l,ht&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(hi(this,d)),d+=2;t*=2;break;case"utf8":r=Hc(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Gh(this,this.l,this.l+t);break;case"wstr":if(typeof St<"u")r=St.utils.decode(Hn,this.slice(this.l,this.l+2*t));else return Jo.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=Ig(this,this.l),t=4+Lr(this,this.l);break;case"lpstr-cp":r=Mg(this,this.l),t=4+Lr(this,this.l);break;case"lpwstr":r=Lg(this,this.l),t=4+2*Lr(this,this.l);break;case"lpp4":t=4+Lr(this,this.l),r=Bg(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Lr(this,this.l),r=Pg(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=oc(this,this.l+t++))!==0;)l.push(Vo(o));r=l.join("");break;case"_wstr":for(t=0,r="";(o=hi(this,this.l+t))!==0;)l.push(Vo(o)),t+=2;t+=2,r=l.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=oc(this,d),this.l=d+1,u=Jo.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(Vo(hi(this,d))),d+=2}r=l.join(""),t*=2;break;case"cpstr":if(typeof St<"u"){r=St.utils.decode(Hn,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=oc(this,d),this.l=d+1,u=Jo.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(Vo(oc(this,d))),d+=1}r=l.join("");break;default:switch(t){case 1:return n=oc(this,this.l),this.l++,n;case 2:return n=(e==="i"?VO:hi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?zs:GO)(this,this.l),this.l+=4,n):(i=Lr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=hh(this,this.l):i=hh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=bb(this,this.l,t);break}}return this.l+=t,r}var WO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},XO=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},qO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function YO(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)qO(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof St<"u"&&il==874)for(i=0;i!=e.length;++i){var l=St.utils.encode(il,e.charAt(i));this[this.l+i]=l[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var u=e.charCodeAt(i);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,WO(this,e,this.l);break;case 8:if(n=8,r==="f"){zO(this,e,this.l);break}case 16:break;case-4:n=4,XO(this,e,this.l);break}return this.l+=n,this}function Fb(t,e){var r=bb(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Xr(t,e){t.l=e,t.read_shift=Jo,t.chk=Fb,t.write_shift=YO}function sn(t,e){t.l+=e}function pe(t){var e=hs(t);return Xr(e,0),e}function Ei(t,e,r){if(t){var n,i,l;Xr(t,t.l||0);for(var o=t.length,u=0,h=0;t.l<o;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=Ru[u]||Ru[65535];for(n=t.read_shift(1),l=n&127,i=1;i<4&&n&128;++i)l+=((n=t.read_shift(1))&127)<<7*i;h=t.l+l;var p=d.f&&d.f(t,l,r);if(t.l=h,e(p,d,u))return}}}function Nn(){var t=[],e=ht?256:2048,r=function(d){var p=pe(d);return Xr(p,0),p},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},l=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,e)))},o=function(){return i(),Pr(t)},u=function(d){i(),n=d,n.l==null&&(n.l=n.length),l(e)};return{next:l,push:u,end:o,_bufs:t}}function Se(t,e,r,n){var i=+e,l;if(!isNaN(i)){n||(n=Ru[i].p||(r||[]).length||0),l=1+(i>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var o=t.next(l);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Ug(r)&&t.push(r)}}function eu(t,e,r){var n=Xt(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Xw(t,e,r){var n=Xt(t);return n.s=eu(n.s,e.s,r),n.e=eu(n.e,e.s,r),n}function tu(t,e){if(t.cRel&&t.c<0)for(t=Xt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Xt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Je(t);return!t.cRel&&t.cRel!=null&&(r=QO(r)),!t.rRel&&t.rRel!=null&&(r=KO(r)),r}function Nm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+tr(t.s.c)+":"+(t.e.cRel?"":"$")+tr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ur(t.s.r)+":"+(t.e.rRel?"":"$")+ur(t.e.r):tu(t.s,e.biff)+":"+tu(t.e,e.biff)}function jg(t){return parseInt($O(t),10)-1}function ur(t){return""+(t+1)}function KO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $O(t){return t.replace(/\$(\d+)$/,"$1")}function Hg(t){for(var e=ZO(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function tr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function QO(t){return t.replace(/^([A-Z])/,"$$$1")}function ZO(t){return t.replace(/^\$([A-Z])/,"$1")}function JO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Je(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function pn(t){var e=t.indexOf(":");return e==-1?{s:sr(t),e:sr(t)}:{s:sr(t.slice(0,e)),e:sr(t.slice(e+1))}}function ot(t,e){return typeof e>"u"||typeof e=="number"?ot(t.s,t.e):(typeof t!="string"&&(t=Je(t)),typeof e!="string"&&(e=Je(e)),t==e?t:t+":"+e)}function Et(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,l=t.length;for(r=0;n<l&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<l&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===l||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=l&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=l&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function qw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Vn(t.z,r?Nr(e):e)}catch{}try{return t.w=Vn((t.XF||{}).numFmtId||(r?14:0),r?Nr(e):e)}catch{return""+e}}function za(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ti[t.v]||t.v:e==null?qw(t,t.v):qw(t,e))}function vs(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Ib(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,l=t||(i?[]:{}),o=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?sr(n.origin):n.origin;o=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=Et(l["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),o==-1&&(d.e.r=o=p.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[x].length;++v)if(!(typeof e[x][v]>"u")){var y={v:e[x][v]},E=o+x,w=u+v;if(d.s.r>E&&(d.s.r=E),d.s.c>w&&(d.s.c=w),d.e.r<E&&(d.e.r=E),d.e.c<w&&(d.e.c=w),e[x][v]&&typeof e[x][v]=="object"&&!Array.isArray(e[x][v])&&!(e[x][v]instanceof Date))y=e[x][v];else if(Array.isArray(y.v)&&(y.f=e[x][v][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||Ye[14],n.cellDates?(y.t="d",y.w=Vn(y.z,Nr(y.v))):(y.t="n",y.v=Nr(y.v),y.w=Vn(y.z,y.v))):y.t="s";if(i)l[E]||(l[E]=[]),l[E][w]&&l[E][w].z&&(y.z=l[E][w].z),l[E][w]=y;else{var S=Je({c:w,r:E});l[S]&&l[S].z&&(y.z=l[S].z),l[S]=y}}}return d.s.c<1e7&&(l["!ref"]=ot(d)),l}function zc(t,e){return Ib(null,t,e)}function eF(t){return t.read_shift(4,"i")}function ba(t,e){return e||(e=pe(4)),e.write_shift(4,t),e}function an(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ur(t,e){var r=!1;return e==null&&(r=!0,e=pe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function tF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function rF(t,e){return e||(e=pe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function zg(t,e){var r=t.l,n=t.read_shift(1),i=an(t),l=[],o={t:i,h:i};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)l.push(tF(t));o.r=l}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function nF(t,e){var r=!1;return e==null&&(r=!0,e=pe(15+4*t.t.length)),e.write_shift(1,0),Ur(t.t,e),r?e.slice(0,e.l):e}var aF=zg;function iF(t,e){var r=!1;return e==null&&(r=!0,e=pe(23+4*t.t.length)),e.write_shift(1,1),Ur(t.t,e),e.write_shift(4,1),rF({},e),r?e.slice(0,e.l):e}function fa(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function gl(t,e){return e==null&&(e=pe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function xl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function vl(t,e){return e==null&&(e=pe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var sF=an,Mb=Ur;function Vg(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function dh(t,e){var r=!1;return e==null&&(r=!0,e=pe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var lF=an,vp=Vg,Gg=dh;function Wg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?hh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):zs(e,0)>>2;return r?i/100:i}function Lb(t,e){e==null&&(e=pe(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Bb(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function cF(t,e){return e||(e=pe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var _l=Bb,Vc=cF;function rn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function cl(t,e){return(e||pe(8)).write_shift(8,t,"f")}function oF(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),l=t.read_shift(2,"i"),o=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var d=qs[i];d&&(e.rgb=ku(d));break;case 2:e.rgb=ku([o,u,h]);break;case 3:e.theme=i;break}return l!=0&&(e.tint=l>0?l/32767:l/32768),e}function mh(t,e){if(e||(e=pe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function uF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function fF(t,e){e||(e=pe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function Pb(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function hF(t){return Pb(t,1)}function dF(t){return Pb(t,2)}var Xg=2,Tn=3,S0=11,Yw=12,ph=19,b0=64,mF=65,pF=71,gF=4108,xF=4126,Fr=80,Ub=81,vF=[Fr,Ub],_p={1:{n:"CodePage",t:Xg},2:{n:"Category",t:Fr},3:{n:"PresentationFormat",t:Fr},4:{n:"ByteCount",t:Tn},5:{n:"LineCount",t:Tn},6:{n:"ParagraphCount",t:Tn},7:{n:"SlideCount",t:Tn},8:{n:"NoteCount",t:Tn},9:{n:"HiddenCount",t:Tn},10:{n:"MultimediaClipCount",t:Tn},11:{n:"ScaleCrop",t:S0},12:{n:"HeadingPairs",t:gF},13:{n:"TitlesOfParts",t:xF},14:{n:"Manager",t:Fr},15:{n:"Company",t:Fr},16:{n:"LinksUpToDate",t:S0},17:{n:"CharacterCount",t:Tn},19:{n:"SharedDoc",t:S0},22:{n:"HyperlinksChanged",t:S0},23:{n:"AppVersion",t:Tn,p:"version"},24:{n:"DigSig",t:mF},26:{n:"ContentType",t:Fr},27:{n:"ContentStatus",t:Fr},28:{n:"Language",t:Fr},29:{n:"Version",t:Fr},255:{},2147483648:{n:"Locale",t:ph},2147483651:{n:"Behavior",t:ph},1919054434:{}},yp={1:{n:"CodePage",t:Xg},2:{n:"Title",t:Fr},3:{n:"Subject",t:Fr},4:{n:"Author",t:Fr},5:{n:"Keywords",t:Fr},6:{n:"Comments",t:Fr},7:{n:"Template",t:Fr},8:{n:"LastAuthor",t:Fr},9:{n:"RevNumber",t:Fr},10:{n:"EditTime",t:b0},11:{n:"LastPrinted",t:b0},12:{n:"CreatedDate",t:b0},13:{n:"ModifiedDate",t:b0},14:{n:"PageCount",t:Tn},15:{n:"WordCount",t:Tn},16:{n:"CharCount",t:Tn},17:{n:"Thumbnail",t:pF},18:{n:"Application",t:Fr},19:{n:"DocSecurity",t:Tn},255:{},2147483648:{n:"Locale",t:ph},2147483651:{n:"Behavior",t:ph},1919054434:{}},Kw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_F=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function yF(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var wF=yF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qs=Xt(wF),Ti={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},wp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},C0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function qg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function EF(t){var e=qg();if(!t||!t.match)return e;var r={};if((t.match(ln)||[]).forEach(function(n){var i=rt(n);switch(i[0].replace(OO,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[wp[i.ContentType]]!==void 0&&e[wp[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Ar.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function Hb(t,e){var r=EO(wp),n=[],i;n[n.length]=xr,n[n.length]=De("Types",null,{xmlns:Ar.CT,"xmlns:xsd":Ar.xsd,"xmlns:xsi":Ar.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return De("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){t[h]&&t[h].length>0&&(i=t[h][0],n[n.length]=De("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:C0[h][e.bookType]||C0[h].xlsx}))},o=function(h){(t[h]||[]).forEach(function(d){n[n.length]=De("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:C0[h][e.bookType]||C0[h].xlsx})})},u=function(h){(t[h]||[]).forEach(function(d){n[n.length]=De("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return l("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var dt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cu(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function ru(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ln)||[]).forEach(function(i){var l=rt(i);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Wo(l.Target,e);r[u]=o,n[l.Id]=o}}),r["!id"]=n,r}function wc(t){var e=[xr,De("Relationships",null,{xmlns:Ar.RELS})];return hr(t["!id"]).forEach(function(r){e[e.length]=De("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Pt(t,e,r,n,i,l){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[dt.HLINK,dt.XPATH,dt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var TF="application/vnd.oasis.opendocument.spreadsheet";function SF(t,e){for(var r=Fg(t),n,i;n=bu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=rt(n[0],!1),i.path=="/"&&i.type!==TF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function bF(t){var e=[xr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function $w(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function CF(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function kF(t){var e=[xr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push($w(t[r][0],t[r][1])),e.push(CF("",t[r][0]));return e.push($w("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function zb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+yu.version+"</meta:generator></office:meta></office:document-meta>"}var oa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],AF=(function(){for(var t=new Array(oa.length),e=0;e<oa.length;++e){var r=oa[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function Vb(t){var e={};t=Gt(t);for(var r=0;r<oa.length;++r){var n=oa[r],i=t.match(AF[r]);i!=null&&i.length>0&&(e[n[1]]=kt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=rr(e[n[1]]))}return e}function Dm(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Ut(e),n[n.length]=r?De(t,e,r):qr(t,e))}function Gb(t,e){var r=e||{},n=[xr,De("cp:coreProperties",null,{"xmlns:cp":Ar.CORE_PROPS,"xmlns:dc":Ar.dc,"xmlns:dcterms":Ar.dcterms,"xmlns:dcmitype":Ar.dcmitype,"xmlns:xsi":Ar.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Dm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:xp(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Dm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:xp(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var l=0;l!=oa.length;++l){var o=oa[l],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Dm(o[0],u,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ys=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Wb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Xb(t,e,r,n){var i=[];if(typeof t=="string")i=jw(t,n);else for(var l=0;l<t.length;++l)i=i.concat(t[l].map(function(p){return{v:p}}));var o=typeof e=="string"?jw(e,n).map(function(p){return p.v}):e,u=0,h=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(h=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=o.slice(u,u+h);break}u+=h}}function NF(t,e,r){var n={};return e||(e={}),t=Gt(t),Ys.forEach(function(i){var l=(t.match(Tu(i[0]))||[])[1];switch(i[2]){case"string":l&&(e[i[1]]=kt(l));break;case"bool":e[i[1]]=l==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Xb(n.HeadingPairs,n.TitlesOfParts,e,r),e}function qb(t){var e=[],r=De;return t||(t={}),t.Application="SheetJS",e[e.length]=xr,e[e.length]=De("Properties",null,{xmlns:Ar.EXT_PROPS,"xmlns:vt":Ar.vt}),Ys.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ut(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Ut(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var DF=/<[^>]+>[^<]*/g;function RF(t,e){var r={},n="",i=t.match(DF);if(i)for(var l=0;l!=i.length;++l){var o=i[l],u=rt(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=kt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),d=h[0].slice(4),p=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=kt(p);break;case"bool":r[n]=er(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=rr(p);break;case"cy":case"error":r[n]=kt(p);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,h)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function Yb(t){var e=[xr,De("Properties",null,{xmlns:Ar.CUST_PROPS,"xmlns:vt":Ar.vt})];if(!t)return e.join("");var r=1;return hr(t).forEach(function(i){++r,e[e.length]=De("property",jO(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ut(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Ep={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Rm;function OF(t,e,r){Rm||(Rm=Hh(Ep)),e=Rm[e]||e,t[e]=r}function FF(t,e){var r=[];return hr(Ep).map(function(n){for(var i=0;i<oa.length;++i)if(oa[i][1]==n)return oa[i];for(i=0;i<Ys.length;++i)if(Ys[i][1]==n)return Ys[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(qr(Ep[n[1]]||n[1],i))}}),De("DocumentProperties",r.join(""),{xmlns:Pn.o})}function IF(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&hr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)){for(var o=0;o<oa.length;++o)if(l==oa[o][1])return;for(o=0;o<Ys.length;++o)if(l==Ys[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var u=t[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),i.push(De(Lw(l),u,{"dt:dt":h}))}}),e&&hr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)&&!(t&&Object.prototype.hasOwnProperty.call(t,l))){var o=e[l],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),i.push(De(Lw(l),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Pn.o+'">'+i.join("")+"</"+n+">"}function Yg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function MF(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),i+=l);var o=pe(8);return o.write_shift(4,n),o.write_shift(4,i),o}function Kb(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function $b(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function Qb(t,e,r){return e===31?$b(t):Kb(t,e,r)}function Tp(t,e,r){return Qb(t,e,r===!1?0:4)}function LF(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Qb(t,e,0)}function BF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(nn,""),t.l-i&2&&(t.l+=2)}return r}function PF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(nn,"");return r}function UF(t){var e=t.l,r=gh(t,Ub);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=gh(t,Tn);return[r,n]}function jF(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(UF(t));return r}function Qw(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var l=t.read_shift(4),o=t.read_shift(4);n[l]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(nn,"").replace(Go,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Zb(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function HF(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function gh(t,e,r){var n=t.read_shift(2),i,l=r||{};if(t.l+=2,e!==Yw&&n!==e&&vF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Yw?n:e){case 2:return i=t.read_shift(2,"i"),l.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return Kb(t,n,4).replace(nn,"");case 31:return $b(t);case 64:return Yg(t);case 65:return Zb(t);case 71:return HF(t);case 80:return Tp(t,n,!l.raw).replace(nn,"");case 81:return LF(t,n).replace(nn,"");case 4108:return jF(t);case 4126:case 4127:return n==4127?BF(t):PF(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Zw(t,e){var r=pe(4),n=pe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=pe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=MF(e);break;case 31:case 80:for(n=pe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Pr([r,n])}function Jw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),l=[],o=0,u=0,h=-1,d={};for(o=0;o!=i;++o){var p=t.read_shift(4),x=t.read_shift(4);l[o]=[p,x+r]}l.sort(function(I,C){return I[1]-C[1]});var v={};for(o=0;o!=i;++o){if(t.l!==l[o][1]){var y=!0;if(o>0&&e)switch(e[l[o-1][0]].t){case 2:t.l+2===l[o][1]&&(t.l+=2,y=!1);break;case 80:t.l<=l[o][1]&&(t.l=l[o][1],y=!1);break;case 4108:t.l<=l[o][1]&&(t.l=l[o][1],y=!1);break}if((!e||o==0)&&t.l<=l[o][1]&&(y=!1,t.l=l[o][1]),y)throw new Error("Read Error: Expected address "+l[o][1]+" at "+t.l+" :"+o)}if(e){var E=e[l[o][0]];if(v[E.n]=gh(t,E.t,{raw:!0}),E.p==="version"&&(v[E.n]=String(v[E.n]>>16)+"."+("0000"+String(v[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(v[E.n]){case 0:v[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ca(u=v[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[E.n])}}else if(l[o][0]===1){if(u=v.CodePage=gh(t,Xg),ca(u),h!==-1){var w=t.l;t.l=l[h][1],d=Qw(t,u),t.l=w}}else if(l[o][0]===0){if(u===0){h=o,t.l=l[o+1][1];continue}d=Qw(t,u)}else{var S=d[l[o][0]],N;switch(t[t.l]){case 65:t.l+=4,N=Zb(t);break;case 30:t.l+=4,N=Tp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,N=Tp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,N=t.read_shift(4,"i");break;case 19:t.l+=4,N=t.read_shift(4);break;case 5:t.l+=4,N=t.read_shift(8,"f");break;case 11:t.l+=4,N=gr(t,4);break;case 64:t.l+=4,N=rr(Yg(t));break;default:throw new Error("unparsed value: "+t[t.l])}v[S]=N}}return t.l=r+n,v}var Jb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function zF(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function eE(t,e,r){var n=pe(8),i=[],l=[],o=8,u=0,h=pe(8),d=pe(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),l.push(h),i.push(d),o+=8+h.length,!e){d=pe(8),d.write_shift(4,0),i.unshift(d);var p=[pe(4)];for(p[0].write_shift(4,t.length),u=0;u<t.length;++u){var x=t[u][0];for(h=pe(8+2*(x.length+1)+(x.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,x.length+1),h.write_shift(0,x,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=Pr(p),l.unshift(h),o+=8+h.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(Jb.indexOf(t[u][0])>-1||Wb.indexOf(t[u][0])>-1)&&t[u][1]!=null){var v=t[u][1],y=0;if(e){y=+e[t[u][0]];var E=r[y];if(E.p=="version"&&typeof v=="string"){var w=v.split(".");v=(+w[0]<<16)+(+w[1]||0)}h=Zw(E.t,v)}else{var S=zF(v);S==-1&&(S=31,v=String(v)),h=Zw(S,v)}l.push(h),d=pe(8),d.write_shift(4,e?y:2+u),i.push(d),o+=8+h.length}var N=8*(l.length+1);for(u=0;u<l.length;++u)i[u].write_shift(4,N),N+=l[u].length;return n.write_shift(4,o),n.write_shift(4,l.length),Pr([n].concat(i).concat(l))}function tE(t,e,r){var n=t.content;if(!n)return{};Xr(n,0);var i,l,o,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),p=n.read_shift(16);if(p!==We.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(l=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(o=n.read_shift(16),h=n.read_shift(4));var x=Jw(n,e),v={SystemIdentifier:d};for(var y in x)v[y]=x[y];if(v.FMTID=l,i===1)return v;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var E;try{E=Jw(n,null)}catch{}for(y in E)v[y]=E[y];return v.FMTID=[l,o],v}function rE(t,e,r,n,i,l){var o=pe(i?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,We.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var h=eE(t,r,n);if(u.push(h),i){var d=eE(i,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+h.length),u.push(d)}return Pr(u)}function Ki(t,e){return t.read_shift(e),null}function VF(t,e){e||(e=pe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function GF(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function gr(t,e){return t.read_shift(e)===1}function dn(t,e){return e||(e=pe(2)),e.write_shift(2,+!!t),e}function br(t){return t.read_shift(2,"u")}function la(t,e){return e||(e=pe(2)),e.write_shift(2,t),e}function e4(t,e){return GF(t,e,br)}function WF(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function t4(t,e,r){return r||(r=pe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function $u(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",l=Hn;if(r&&r.biff>=8&&(Hn=1200),!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var u=n?t.read_shift(n,i):"";return Hn=l,u}function XF(t){var e=Hn;Hn=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,l=n&8,o=1+(n&1),u=0,h,d={};l&&(u=t.read_shift(2)),i&&(h=t.read_shift(4));var p=o==2?"dbcs-cont":"sbcs-cont",x=r===0?"":t.read_shift(r,p);return l&&(t.l+=4*u),i&&(t.l+=h),d.t=x,l||(d.raw="<t>"+d.t+"</t>",d.r=d.t),Hn=e,d}function qF(t){var e=t.t||"",r=pe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=pe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Pr(i)}function ol(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Qu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):ol(t,n,r)}function yl(t,e,r){if(r.biff>5)return Qu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function r4(t,e,r){return r||(r=pe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function YF(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function KF(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(nn,"");return n&&(t.l+=24),i}function $F(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var l=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(l>>1,"utf16le").replace(nn,"");return r+o}function QF(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return KF(t);case"0303000000000000c000000000000046":return $F(t);default:throw new Error("Unsupported Moniker "+r)}}function k0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(nn,""):"";return r}function nE(t,e){e||(e=pe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function ZF(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var l,o,u,h,d="",p,x;i&16&&(l=k0(t,r-t.l)),i&128&&(o=k0(t,r-t.l)),(i&257)===257&&(u=k0(t,r-t.l)),(i&257)===1&&(h=QF(t,r-t.l)),i&8&&(d=k0(t,r-t.l)),i&32&&(p=t.read_shift(16)),i&64&&(x=Yg(t)),t.l=r;var v=o||u||h||"";v&&d&&(v+="#"+d),v||(v="#"+d),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var y={Target:v};return p&&(y.guid=p),x&&(y.time=x),l&&(y.Tooltip=l),y}function JF(t){var e=pe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),l=i>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}e.write_shift(4,2),e.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(l==28)n=n.slice(1),nE(n,e);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var u=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),l&8&&nE(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,n.length-3*h+1),r=0;r<n.length-3*h;++r)e.write_shift(1,n.charCodeAt(r+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function n4(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function a4(t,e){var r=n4(t);return r[3]=0,r}function Ga(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function ul(t,e,r,n){return n||(n=pe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function eI(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function tI(t,e,r){return e===0?"":yl(t,e,r)}function rI(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),l=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,l,o]}function i4(t){var e=t.read_shift(2),r=Wg(t);return[e,r]}function nI(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=$u(t,e,r),l=t.read_shift(2);if(n-=t.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return t.l+=l,i}function Wh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function s4(t,e){return e||(e=pe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function l4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var aI=l4;function c4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function iI(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function sI(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function $r(t){t.l+=2,t.l+=t.read_shift(2)}var lI={0:$r,4:$r,5:$r,6:$r,7:sI,8:$r,9:$r,10:$r,11:$r,12:$r,13:iI,14:$r,15:$r,16:$r,17:$r,18:$r,19:$r,20:$r,21:c4};function cI(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(lI[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function A0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Kg(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=pe(i);return l.write_shift(2,n),l.write_shift(2,e),i>4&&l.write_shift(2,29282),i>6&&l.write_shift(2,1997),i>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function oI(t,e){return e===0||t.read_shift(2),1200}function uI(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=yl(t,0,r);return t.read_shift(e+n-t.l),i}function fI(t,e){var r=!e||e.biff==8,n=pe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function hI(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function dI(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,l=t.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=$u(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:l,name:o}}function mI(t,e){var r=!e||e.biff>=8?2:1,n=pe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function pI(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),l=[],o=0;o!=i&&t.l<r;++o)l.push(XF(t));return l.Count=n,l.Unique=i,l}function gI(t,e){var r=pe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=qF(t[i]);var l=Pr([r].concat(n));return l.parts=[r.length].concat(n.map(function(o){return o.length})),l}function xI(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function vI(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function _I(t){var e=eI(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function yI(t){return t.read_shift(2),t.read_shift(4)}function aE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,i]}function wI(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:l,CurTab:o,FirstTab:u,Selected:h,TabRatio:d}}function EI(){var t=pe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function TI(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function SI(t){var e=pe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function bI(){}function CI(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=$u(t,0,r),n}function kI(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,l=pe(i);return l.write_shift(2,t.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function AI(t){var e=Ga(t);return e.isst=t.read_shift(4),e}function NI(t,e,r,n){var i=pe(10);return ul(t,e,n,i),i.write_shift(4,r),i}function DI(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Ga(t);r.biff==2&&t.l++;var l=Qu(t,n-t.l,r);return i.val=l,i}function RI(t,e,r,n,i){var l=!i||i.biff==8,o=pe(8+ +l+(1+l)*r.length);return ul(t,e,n,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function OI(t,e,r){var n=t.read_shift(2),i=yl(t,0,r);return[n,i]}function FI(t,e,r,n){var i=r&&r.biff==5;n||(n=pe(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}var II=yl;function iE(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,l=t.read_shift(i),o=t.read_shift(i),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:l,c:u},e:{r:o,c:h}}}function MI(t,e){var r=e.biff==8||!e.biff?4:2,n=pe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function LI(t){var e=t.read_shift(2),r=t.read_shift(2),n=i4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function BI(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),l=[];t.l<r;)l.push(i4(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(l.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:l}}function PI(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),l=[];t.l<r;)l.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(l.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:l}}function UI(t,e,r,n){var i={},l=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return i.patternType=_F[u>>26],n.cellStyles&&(i.alc=l&7,i.fWrap=l>>3&1,i.alcV=l>>4&7,i.fJustLast=l>>7&1,i.trot=l>>8&255,i.cIndent=l>>16&15,i.fShrinkToFit=l>>20&1,i.iReadOrder=l>>22&2,i.fAtrNum=l>>26&1,i.fAtrFnt=l>>27&1,i.fAtrAlc=l>>28&1,i.fAtrBdr=l>>29&1,i.fAtrPat=l>>30&1,i.fAtrProt=l>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function jI(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=UI(t,e,n.fStyle,r),n}function sE(t,e,r,n){var i=r&&r.biff==5;n||(n=pe(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var l=0;return t.numFmtId>0&&i&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function HI(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function zI(t){var e=pe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function lE(t,e,r){var n=Ga(t);(r.biff==2||e==9)&&++t.l;var i=WF(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function VI(t,e,r,n,i,l){var o=pe(8);return ul(t,e,n,o),t4(r,l,o),o}function GI(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ga(t),i=rn(t);return n.val=i,n}function WI(t,e,r,n){var i=pe(14);return ul(t,e,n,i),cl(r,i),i}var cE=tI;function XI(t,e,r){var n=t.l+e,i=t.read_shift(2),l=t.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,i];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=ol(t,l),u=[];n>t.l;)u.push(Qu(t));return[l,i,o,u]}function oE(t,e,r){var n=t.read_shift(2),i,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=nI(t,e-2,r)),l.body=i||t.read_shift(e-2),typeof i=="string"&&(l.Name=i),l}var qI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function uE(t,e,r){var n=t.l+e,i=t.read_shift(2),l=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=ol(t,o,r);i&32&&(d=qI[d.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var x=n==t.l||u===0||!(p>0)?[]:cB(t,p,r,u);return{chKey:l,Name:d,itab:h,rgce:x}}function o4(t,e,r){if(r.biff<8)return YI(t,e,r);for(var n=[],i=t.l+e,l=t.read_shift(r.biff>8?4:2);l--!==0;)n.push(rI(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function YI(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=$u(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function KI(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),l=ol(t,n,r),o=ol(t,i,r);return[l,o]}function $I(t,e,r){var n=l4(t);t.l++;var i=t.read_shift(1);return e-=8,[oB(t,e,r),i,n]}function fE(t,e,r){var n=aI(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,sB(t,e,r)]}function QI(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function ZI(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),o=t.read_shift(2),u=yl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},u,o,l]}}function JI(t,e,r){return ZI(t,e,r)}function eM(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Wh(t));return r}function tM(t){var e=pe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)s4(t[r],e);return e}function rM(t,e,r){if(r&&r.biff<8)return aM(t,e,r);var n=c4(t),i=cI(t,e-22,n[1]);return{cmo:n,ft:i}}var nM={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function aM(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((nM[n]||sn)(t,e,r)),{cmo:[i,n,l],ft:o}}function iM(t,e,r){var n=t.l,i="";try{t.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?t.l+=6:o=YF(t,6,r);var u=t.read_shift(2);t.read_shift(2),br(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var p=t[t.l],x=ol(t,t.lens[d+1]-t.lens[d]-1);if(i+=x,i.length>=(p?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function sM(t,e){var r=Wh(t);t.l+=16;var n=ZF(t,e-24);return[r,n]}function lM(t){var e=pe(24),r=sr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Pr([e,JF(t[1])])}function cM(t,e){t.read_shift(2);var r=Wh(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(nn,""),[r,n]}function oM(t){var e=t[1].Tooltip,r=pe(10+2*(e.length+1));r.write_shift(2,2048);var n=sr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function uM(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Kw[r]||r,r=t.read_shift(2),e[1]=Kw[r]||r,e}function fM(t){return t||(t=pe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function hM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(a4(t));return r}function dM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(a4(t));return r}function mM(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function u4(t,e,r){if(!r.cellStyles)return sn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),l=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:i,e:l,w:o,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function pM(t,e){var r=pe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function gM(t,e){var r={};return e<32||(t.l+=16,r.header=rn(t),r.footer=rn(t),t.l+=2),r}function xM(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function vM(t){for(var e=pe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var _M=Ga,yM=e4,wM=Qu;function EM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function TM(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ga(t);++t.l;var i=yl(t,e-7,r);return n.t="str",n.val=i,n}function SM(t){var e=Ga(t);++t.l;var r=rn(t);return e.t="n",e.val=r,e}function bM(t,e,r){var n=pe(15);return tf(n,t,e),n.write_shift(8,r,"f"),n}function CM(t){var e=Ga(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function kM(t,e,r){var n=pe(9);return tf(n,t,e),n.write_shift(2,r),n}function AM(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function NM(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function DM(t,e,r){var n=t.l+e,i=Ga(t),l=t.read_shift(2),o=ol(t,l,r);return t.l=n,i.t="str",i.val=o,i}var RM=[2,3,48,49,131,139,140,245],Sp=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Hh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],p=hs(1);switch(h.type){case"base64":p=Un(zn(u));break;case"binary":p=Un(u);break;case"buffer":case"array":p=u;break}Xr(p,0);var x=p.read_shift(1),v=!!(x&136),y=!1,E=!1;switch(x){case 2:break;case 3:break;case 48:y=!0,v=!0;break;case 49:y=!0,v=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var w=0,S=521;x==2&&(w=p.read_shift(2)),p.l+=3,x!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),x!=2&&(S=p.read_shift(2));var N=p.read_shift(2),I=h.codepage||1252;x!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(I=t[p[p.l]]),p.l+=1,p.l+=2),E&&(p.l+=36);for(var C=[],z={},X=Math.min(p.length,x==2?521:S-10-(y?264:0)),W=E?32:11;p.l<X&&p[p.l]!=13;)switch(z={},z.name=St.utils.decode(I,p.slice(p.l,p.l+W)).replace(/[\u0000\r\n].*$/g,""),p.l+=W,z.type=String.fromCharCode(p.read_shift(1)),x!=2&&!E&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),x==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&C.push(z),x!=2&&(p.l+=E?13:14),z.type){case"B":(!y||z.len!=8)&&h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=S-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=S;var R=0,Q=0;for(d[0]=[],Q=0;Q!=C.length;++Q)d[0][Q]=C[Q].name;for(;w-- >0;){if(p[p.l]===42){p.l+=N;continue}for(++p.l,d[++R]=[],Q=0,Q=0;Q!=C.length;++Q){var G=p.slice(p.l,p.l+C[Q].len);p.l+=C[Q].len,Xr(G,0);var fe=St.utils.decode(I,G);switch(C[Q].type){case"C":fe.trim().length&&(d[R][Q]=fe.replace(/\s+$/,""));break;case"D":fe.length===8?d[R][Q]=new Date(+fe.slice(0,4),+fe.slice(4,6)-1,+fe.slice(6,8)):d[R][Q]=fe;break;case"F":d[R][Q]=parseFloat(fe.trim());break;case"+":case"I":d[R][Q]=E?G.read_shift(-4,"i")^2147483648:G.read_shift(4,"i");break;case"L":switch(fe.trim().toUpperCase()){case"Y":case"T":d[R][Q]=!0;break;case"N":case"F":d[R][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+fe+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[R][Q]="##MEMO##"+(E?parseInt(fe.trim(),10):G.read_shift(4));break;case"N":fe=fe.replace(/\u0000/g,"").trim(),fe&&fe!="."&&(d[R][Q]=+fe||0);break;case"@":d[R][Q]=new Date(G.read_shift(-8,"f")-621356832e5);break;case"T":d[R][Q]=new Date((G.read_shift(4)-2440588)*864e5+G.read_shift(4));break;case"Y":d[R][Q]=G.read_shift(4,"i")/1e4+G.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[R][Q]=-G.read_shift(-8,"f");break;case"B":if(y&&C[Q].len==8){d[R][Q]=G.read_shift(8,"f");break}case"G":case"P":G.l+=C[Q].len;break;case"0":if(C[Q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[Q].type)}}}if(x!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=C,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var p=zc(r(u,d),d);return p["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,p}function i(u,h){try{return vs(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){var d=h||{};if(+d.codepage>=0&&ca(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=Nn(),x=_h(u,{header:1,raw:!0,cellDates:!0}),v=x[0],y=x.slice(1),E=u["!cols"]||[],w=0,S=0,N=0,I=1;for(w=0;w<v.length;++w){if(((E[w]||{}).DBF||{}).name){v[w]=E[w].DBF.name,++N;continue}if(v[w]!=null){if(++N,typeof v[w]=="number"&&(v[w]=v[w].toString(10)),typeof v[w]!="string")throw new Error("DBF Invalid column name "+v[w]+" |"+typeof v[w]+"|");if(v.indexOf(v[w])!==w){for(S=0;S<1024;++S)if(v.indexOf(v[w]+"_"+S)==-1){v[w]+="_"+S;break}}}}var C=Et(u["!ref"]),z=[],X=[],W=[];for(w=0;w<=C.e.c-C.s.c;++w){var R="",Q="",G=0,fe=[];for(S=0;S<y.length;++S)y[S][w]!=null&&fe.push(y[S][w]);if(fe.length==0||v[w]==null){z[w]="?";continue}for(S=0;S<fe.length;++S){switch(typeof fe[S]){case"number":Q="B";break;case"string":Q="C";break;case"boolean":Q="L";break;case"object":Q=fe[S]instanceof Date?"D":"C";break;default:Q="C"}G=Math.max(G,String(fe[S]).length),R=R&&R!=Q?"C":Q}G>250&&(G=250),Q=((E[w]||{}).DBF||{}).type,Q=="C"&&E[w].DBF.len>G&&(G=E[w].DBF.len),R=="B"&&Q=="N"&&(R="N",W[w]=E[w].DBF.dec,G=E[w].DBF.len),X[w]=R=="C"||Q=="N"?G:l[R]||0,I+=X[w],z[w]=R}var re=p.next(32);for(re.write_shift(4,318902576),re.write_shift(4,y.length),re.write_shift(2,296+32*N),re.write_shift(2,I),w=0;w<4;++w)re.write_shift(4,0);for(re.write_shift(4,0|(+e[il]||3)<<8),w=0,S=0;w<v.length;++w)if(v[w]!=null){var K=p.next(32),ye=(v[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);K.write_shift(1,ye,"sbcs"),K.write_shift(1,z[w]=="?"?"C":z[w],"sbcs"),K.write_shift(4,S),K.write_shift(1,X[w]||l[z[w]]||0),K.write_shift(1,W[w]||0),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(1,0),K.write_shift(4,0),K.write_shift(4,0),S+=X[w]||l[z[w]]||0}var Ie=p.next(264);for(Ie.write_shift(4,13),w=0;w<65;++w)Ie.write_shift(4,0);for(w=0;w<y.length;++w){var Ce=p.next(I);for(Ce.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(z[S]){case"L":Ce.write_shift(1,y[w][S]==null?63:y[w][S]?84:70);break;case"B":Ce.write_shift(8,y[w][S]||0,"f");break;case"N":var Y="0";for(typeof y[w][S]=="number"&&(Y=y[w][S].toFixed(W[S]||0)),N=0;N<X[S]-Y.length;++N)Ce.write_shift(1,32);Ce.write_shift(1,Y,"sbcs");break;case"D":y[w][S]?(Ce.write_shift(4,("0000"+y[w][S].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(y[w][S].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+y[w][S].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(y[w][S]!=null?y[w][S]:"").slice(0,X[S]);for(Ce.write_shift(1,ue,"sbcs"),N=0;N<X[S]-ue.length;++N)Ce.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),f4=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+hr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,y){var E=t[y];return typeof E=="number"?gp(E):E},n=function(v,y,E){var w=y.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return w==59?v:gp(w)};t["|"]=254;function i(v,y){switch(y.type){case"base64":return l(zn(v),y);case"binary":return l(v,y);case"buffer":return l(ht&&Buffer.isBuffer(v)?v.toString("binary"):xs(v),y);case"array":return l(ll(v),y)}throw new Error("Unrecognized type "+y.type)}function l(v,y){var E=v.split(/[\n\r]+/),w=-1,S=-1,N=0,I=0,C=[],z=[],X=null,W={},R=[],Q=[],G=[],fe=0,re;for(+y.codepage>=0&&ca(+y.codepage);N!==E.length;++N){fe=0;var K=E[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),ye=K.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),Ie=ye[0],Ce;if(K.length>0)switch(Ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ye[1].charAt(0)=="P"&&z.push(K.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,ue=!1,Me=!1,Z=!1,Le=-1,U=-1;for(I=1;I<ye.length;++I)switch(ye[I].charAt(0)){case"A":break;case"X":S=parseInt(ye[I].slice(1))-1,ue=!0;break;case"Y":for(w=parseInt(ye[I].slice(1))-1,ue||(S=0),re=C.length;re<=w;++re)C[re]=[];break;case"K":Ce=ye[I].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(Sa(Ce))?isNaN(Nc(Ce).getDate())||(Ce=rr(Ce)):(Ce=Sa(Ce),X!==null&&ml(X)&&(Ce=Vh(Ce))),typeof St<"u"&&typeof Ce=="string"&&(y||{}).type!="string"&&(y||{}).codepage&&(Ce=St.utils.decode(y.codepage,Ce)),Y=!0;break;case"E":Z=!0;var k=Ec(ye[I].slice(1),{r:w,c:S});C[w][S]=[C[w][S],k];break;case"S":Me=!0,C[w][S]=[C[w][S],"S5S"];break;case"G":break;case"R":Le=parseInt(ye[I].slice(1))-1;break;case"C":U=parseInt(ye[I].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+K)}if(Y&&(C[w][S]&&C[w][S].length==2?C[w][S][0]=Ce:C[w][S]=Ce,X=null),Me){if(Z)throw new Error("SYLK shared formula cannot have own formula");var P=Le>-1&&C[Le][U];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");C[w][S][1]=N4(P[1],{r:w-Le,c:S-U})}break;case"F":var M=0;for(I=1;I<ye.length;++I)switch(ye[I].charAt(0)){case"X":S=parseInt(ye[I].slice(1))-1,++M;break;case"Y":for(w=parseInt(ye[I].slice(1))-1,re=C.length;re<=w;++re)C[re]=[];break;case"M":fe=parseInt(ye[I].slice(1))/20;break;case"F":break;case"G":break;case"P":X=z[parseInt(ye[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(G=ye[I].slice(1).split(" "),re=parseInt(G[0],10);re<=parseInt(G[1],10);++re)fe=parseInt(G[2],10),Q[re-1]=fe===0?{hidden:!0}:{wch:fe},ds(Q[re-1]);break;case"C":S=parseInt(ye[I].slice(1))-1,Q[S]||(Q[S]={});break;case"R":w=parseInt(ye[I].slice(1))-1,R[w]||(R[w]={}),fe>0?(R[w].hpt=fe,R[w].hpx=Rc(fe)):fe===0&&(R[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+K)}M<1&&(X=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+K)}}return R.length>0&&(W["!rows"]=R),Q.length>0&&(W["!cols"]=Q),y&&y.sheetRows&&(C=C.slice(0,y.sheetRows)),[C,W]}function o(v,y){var E=i(v,y),w=E[0],S=E[1],N=zc(w,y);return hr(S).forEach(function(I){N[I]=S[I]}),N}function u(v,y){return vs(o(v,y),y)}function h(v,y,E,w){var S="C;Y"+(E+1)+";X"+(w+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+tx(v.f,{r:E,c:w}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(v,y){y.forEach(function(E,w){var S="F;W"+(w+1)+" "+(w+1)+" ";E.hidden?S+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Au(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Nu(E.wpx)),typeof E.wch=="number"&&(S+=Math.round(E.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function p(v,y){y.forEach(function(E,w){var S="F;";E.hidden?S+="M0;":E.hpt?S+="M"+20*E.hpt+";":E.hpx&&(S+="M"+20*Du(E.hpx)+";"),S.length>2&&v.push(S+"R"+(w+1))})}function x(v,y){var E=["ID;PWXL;N;E"],w=[],S=Et(v["!ref"]),N,I=Array.isArray(v),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),v["!cols"]&&d(E,v["!cols"]),v["!rows"]&&p(E,v["!rows"]),E.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var z=S.s.r;z<=S.e.r;++z)for(var X=S.s.c;X<=S.e.c;++X){var W=Je({r:z,c:X});N=I?(v[z]||[])[X]:v[W],!(!N||N.v==null&&(!N.f||N.F))&&w.push(h(N,v,z,X))}return E.join(C)+C+w.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:o,from_sheet:x}})(),h4=(function(){function t(l,o){switch(o.type){case"base64":return e(zn(l),o);case"binary":return e(l,o);case"buffer":return e(ht&&Buffer.isBuffer(l)?l.toString("binary"):xs(l),o);case"array":return e(ll(l),o)}throw new Error("Unrecognized type "+o.type)}function e(l,o){for(var u=l.split(`
`),h=-1,d=-1,p=0,x=[];p!==u.length;++p){if(u[p].trim()==="BOT"){x[++h]=[],d=0;continue}if(!(h<0)){var v=u[p].trim().split(","),y=v[0],E=v[1];++p;for(var w=u[p]||"";(w.match(/["]/g)||[]).length&1&&p<u.length-1;)w+=`
`+u[++p];switch(w=w.trim(),+y){case-1:if(w==="BOT"){x[++h]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?x[h][d]=!0:w==="FALSE"?x[h][d]=!1:isNaN(Sa(E))?isNaN(Nc(E).getDate())?x[h][d]=E:x[h][d]=rr(E):x[h][d]=Sa(E),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),x[h][d++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(l,o){return zc(t(l,o),o)}function n(l,o){return vs(r(l,o),o)}var i=(function(){var l=function(h,d,p,x,v){h.push(d),h.push(p+","+x),h.push('"'+v.replace(/"/g,'""')+'"')},o=function(h,d,p,x){h.push(d+","+p),h.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(h){var d=[],p=Et(h["!ref"]),x,v=Array.isArray(h);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,p.e.r-p.s.r+1,""),l(d,"TUPLES",0,p.e.c-p.s.c+1,""),l(d,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){o(d,-1,0,"BOT");for(var E=p.s.c;E<=p.e.c;++E){var w=Je({r:y,c:E});if(x=v?(h[y]||[])[E]:h[w],!x){o(d,1,0,"");continue}switch(x.t){case"n":var S=x.w;!S&&x.v!=null&&(S=x.v),S==null?x.f&&!x.F?o(d,1,0,"="+x.f):o(d,1,0,""):o(d,0,S,"V");break;case"b":o(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Vn(x.z||Ye[14],Nr(rr(x.v)))),o(d,0,x.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var N=`\r
`,I=d.join(N);return I}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),d4=(function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,v){for(var y=x.split(`
`),E=-1,w=-1,S=0,N=[];S!==y.length;++S){var I=y[S].trim().split(":");if(I[0]==="cell"){var C=sr(I[1]);if(N.length<=C.r)for(E=N.length;E<=C.r;++E)N[E]||(N[E]=[]);switch(E=C.r,w=C.c,I[2]){case"t":N[E][w]=t(I[3]);break;case"v":N[E][w]=+I[3];break;case"vtf":var z=I[I.length-1];case"vtc":switch(I[3]){case"nl":N[E][w]=!!+I[4];break;default:N[E][w]=+I[4];break}I[2]=="vtf"&&(N[E][w]=[N[E][w],z])}}}return v&&v.sheetRows&&(N=N.slice(0,v.sheetRows)),N}function n(x,v){return zc(r(x,v),v)}function i(x,v){return vs(n(x,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var v=[],y=[],E,w="",S=pn(x["!ref"]),N=Array.isArray(x),I=S.s.r;I<=S.e.r;++I)for(var C=S.s.c;C<=S.e.c;++C)if(w=Je({r:I,c:C}),E=N?(x[I]||[])[C]:x[w],!(!E||E.v==null||E.t==="z")){switch(y=["cell",w,"t"],E.t){case"s":case"str":y.push(e(E.v));break;case"n":E.f?(y[2]="vtf",y[3]="n",y[4]=E.v,y[5]=e(E.f)):(y[2]="v",y[3]=E.v);break;case"b":y[2]="vt"+(E.f?"f":"c"),y[3]="nl",y[4]=E.v?"1":"0",y[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var z=Nr(rr(E.v));y[2]="vtc",y[3]="nd",y[4]=""+z,y[5]=E.w||Vn(E.z||Ye[14],z);break;case"e":continue}v.push(y.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(x){return[l,o,u,o,d(x),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}})(),Dc=(function(){function t(p,x,v,y,E){E.raw?x[v][y]=p:p===""||(p==="TRUE"?x[v][y]=!0:p==="FALSE"?x[v][y]=!1:isNaN(Sa(p))?isNaN(Nc(p).getDate())?x[v][y]=p:x[v][y]=rr(p):x[v][y]=Sa(p))}function e(p,x){var v=x||{},y=[];if(!p||p.length===0)return y;for(var E=p.split(/[\r\n]/),w=E.length-1;w>=0&&E[w].length===0;)--w;for(var S=10,N=0,I=0;I<=w;++I)N=E[I].indexOf(" "),N==-1?N=E[I].length:N++,S=Math.max(S,N);for(I=0;I<=w;++I){y[I]=[];var C=0;for(t(E[I].slice(0,S).trim(),y,I,C,v),C=1;C<=(E[I].length-S)/10+1;++C)t(E[I].slice(S+(C-1)*10,S+C*10).trim(),y,I,C,v)}return v.sheetRows&&(y=y.slice(0,v.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var x={},v=!1,y=0,E=0;y<p.length;++y)(E=p.charCodeAt(y))==34?v=!v:!v&&E in r&&(x[E]=(x[E]||0)+1);E=[];for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&E.push([x[y],y]);if(!E.length){x=n;for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&E.push([x[y],y])}return E.sort(function(w,S){return w[0]-S[0]||n[w[1]]-n[S[1]]}),r[E.pop()[1]]||44}function l(p,x){var v=x||{},y="",E=v.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=i(p.slice(0,1024)):v&&v.FS?y=v.FS:y=i(p.slice(0,1024));var S=0,N=0,I=0,C=0,z=0,X=y.charCodeAt(0),W=!1,R=0,Q=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var G=v.dateNF!=null?gO(v.dateNF):null;function fe(){var re=p.slice(C,z),K={};if(re.charAt(0)=='"'&&re.charAt(re.length-1)=='"'&&(re=re.slice(1,-1).replace(/""/g,'"')),re.length===0)K.t="z";else if(v.raw)K.t="s",K.v=re;else if(re.trim().length===0)K.t="s",K.v=re;else if(re.charCodeAt(0)==61)re.charCodeAt(1)==34&&re.charCodeAt(re.length-1)==34?(K.t="s",K.v=re.slice(2,-1).replace(/""/g,'"')):X7(re)?(K.t="n",K.f=re.slice(1)):(K.t="s",K.v=re);else if(re=="TRUE")K.t="b",K.v=!0;else if(re=="FALSE")K.t="b",K.v=!1;else if(!isNaN(I=Sa(re)))K.t="n",v.cellText!==!1&&(K.w=re),K.v=I;else if(!isNaN(Nc(re).getDate())||G&&re.match(G)){K.z=v.dateNF||Ye[14];var ye=0;G&&re.match(G)&&(re=xO(re,v.dateNF,re.match(G)||[]),ye=1),v.cellDates?(K.t="d",K.v=rr(re,ye)):(K.t="n",K.v=Nr(rr(re,ye))),v.cellText!==!1&&(K.w=Vn(K.z,K.v instanceof Date?Nr(K.v):K.v)),v.cellNF||delete K.z}else K.t="s",K.v=re;if(K.t=="z"||(v.dense?(E[S]||(E[S]=[]),E[S][N]=K):E[Je({c:N,r:S})]=K),C=z+1,Q=p.charCodeAt(C),w.e.c<N&&(w.e.c=N),w.e.r<S&&(w.e.r=S),R==X)++N;else if(N=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;z<p.length;++z)switch(R=p.charCodeAt(z)){case 34:Q===34&&(W=!W);break;case X:case 10:case 13:if(!W&&fe())break e;break}return z-C>0&&fe(),E["!ref"]=ot(w),E}function o(p,x){return!(x&&x.PRN)||x.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,x):zc(e(p,x),x)}function u(p,x){var v="",y=x.type=="string"?[0,0,0,0]:ux(p,x);switch(x.type){case"base64":v=zn(p);break;case"binary":v=p;break;case"buffer":x.codepage==65001?v=p.toString("utf8"):x.codepage&&typeof St<"u"?v=St.utils.decode(x.codepage,p):v=ht&&Buffer.isBuffer(p)?p.toString("binary"):xs(p);break;case"array":v=ll(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+x.type)}return y[0]==239&&y[1]==187&&y[2]==191?v=Gt(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=Gt(v):x.type=="binary"&&typeof St<"u"&&x.codepage&&(v=St.utils.decode(x.codepage,St.utils.encode(28591,v))),v.slice(0,19)=="socialcalc:version:"?d4.to_sheet(x.type=="string"?v:Gt(v),x):o(v,x)}function h(p,x){return vs(u(p,x),x)}function d(p){for(var x=[],v=Et(p["!ref"]),y,E=Array.isArray(p),w=v.s.r;w<=v.e.r;++w){for(var S=[],N=v.s.c;N<=v.e.c;++N){var I=Je({r:w,c:N});if(y=E?(p[w]||[])[N]:p[I],!y||y.v==null){S.push("          ");continue}for(var C=(y.w||(za(y),y.w)||"").slice(0,10);C.length<10;)C+=" ";S.push(C+(N===0?" ":""))}x.push(S.join(""))}return x.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function OM(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=f4.to_workbook(t,r);return r.WTF=n,i}catch(l){if(r.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return Dc.to_workbook(t,e)}}var Ks=(function(){function t(k,P,M){if(k){Xr(k,k.l||0);for(var j=M.Enum||Le;k.l<k.length;){var ee=k.read_shift(2),xe=j[ee]||j[65535],Te=k.read_shift(2),me=k.l+Te,we=xe.f&&xe.f(k,Te,M);if(k.l=me,P(we,xe,ee))return}}}function e(k,P){switch(P.type){case"base64":return r(Un(zn(k)),P);case"binary":return r(Un(k),P);case"buffer":case"array":return r(k,P)}throw"Unsupported type "+P.type}function r(k,P){if(!k)return k;var M=P||{},j=M.dense?[]:{},ee="Sheet1",xe="",Te=0,me={},we=[],$e=[],H={s:{r:0,c:0},e:{r:0,c:0}},At=M.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)M.Enum=Le,t(k,function(te,Pe,Ge){switch(Ge){case 0:M.vers=te,te>=4096&&(M.qpro=!0);break;case 6:H=te;break;case 204:te&&(xe=te);break;case 222:xe=te;break;case 15:case 51:M.qpro||(te[1].v=te[1].v.slice(1));case 13:case 14:case 16:Ge==14&&(te[2]&112)==112&&(te[2]&15)>1&&(te[2]&15)<15&&(te[1].z=M.dateNF||Ye[14],M.cellDates&&(te[1].t="d",te[1].v=Vh(te[1].v))),M.qpro&&te[3]>Te&&(j["!ref"]=ot(H),me[ee]=j,we.push(ee),j=M.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Te=te[3],ee=xe||"Sheet"+(Te+1),xe="");var bt=M.dense?(j[te[0].r]||[])[te[0].c]:j[Je(te[0])];if(bt){bt.t=te[1].t,bt.v=te[1].v,te[1].z!=null&&(bt.z=te[1].z),te[1].f!=null&&(bt.f=te[1].f);break}M.dense?(j[te[0].r]||(j[te[0].r]=[]),j[te[0].r][te[0].c]=te[1]):j[Je(te[0])]=te[1];break}},M);else if(k[2]==26||k[2]==14)M.Enum=U,k[2]==14&&(M.qpro=!0,k.l=0),t(k,function(te,Pe,Ge){switch(Ge){case 204:ee=te;break;case 22:te[1].v=te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(te[3]>Te&&(j["!ref"]=ot(H),me[ee]=j,we.push(ee),j=M.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Te=te[3],ee="Sheet"+(Te+1)),At>0&&te[0].r>=At)break;M.dense?(j[te[0].r]||(j[te[0].r]=[]),j[te[0].r][te[0].c]=te[1]):j[Je(te[0])]=te[1],H.e.c<te[0].c&&(H.e.c=te[0].c),H.e.r<te[0].r&&(H.e.r=te[0].r);break;case 27:te[14e3]&&($e[te[14e3][0]]=te[14e3][1]);break;case 1537:$e[te[0]]=te[1],te[0]==Te&&(ee=te[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(j["!ref"]=ot(H),me[xe||ee]=j,we.push(xe||ee),!$e.length)return{SheetNames:we,Sheets:me};for(var at={},be=[],de=0;de<$e.length;++de)me[we[de]]?(be.push($e[de]||we[de]),at[$e[de]]=me[$e[de]]||me[we[de]]):(be.push($e[de]),at[$e[de]]={"!ref":"A1"});return{SheetNames:be,Sheets:at}}function n(k,P){var M=P||{};if(+M.codepage>=0&&ca(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var j=Nn(),ee=Et(k["!ref"]),xe=Array.isArray(k),Te=[];Fe(j,0,l(1030)),Fe(j,6,h(ee));for(var me=Math.min(ee.e.r,8191),we=ee.s.r;we<=me;++we)for(var $e=ur(we),H=ee.s.c;H<=ee.e.c;++H){we===ee.s.r&&(Te[H]=tr(H));var At=Te[H]+$e,at=xe?(k[we]||[])[H]:k[At];if(!(!at||at.t=="z"))if(at.t=="n")(at.v|0)==at.v&&at.v>=-32768&&at.v<=32767?Fe(j,13,y(we,H,at.v)):Fe(j,14,w(we,H,at.v));else{var be=za(at);Fe(j,15,x(we,H,be.slice(0,239)))}}return Fe(j,1),j.end()}function i(k,P){var M=P||{};if(+M.codepage>=0&&ca(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var j=Nn();Fe(j,0,o(k));for(var ee=0,xe=0;ee<k.SheetNames.length;++ee)(k.Sheets[k.SheetNames[ee]]||{})["!ref"]&&Fe(j,27,Z(k.SheetNames[ee],xe++));var Te=0;for(ee=0;ee<k.SheetNames.length;++ee){var me=k.Sheets[k.SheetNames[ee]];if(!(!me||!me["!ref"])){for(var we=Et(me["!ref"]),$e=Array.isArray(me),H=[],At=Math.min(we.e.r,8191),at=we.s.r;at<=At;++at)for(var be=ur(at),de=we.s.c;de<=we.e.c;++de){at===we.s.r&&(H[de]=tr(de));var te=H[de]+be,Pe=$e?(me[at]||[])[de]:me[te];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")Fe(j,23,fe(at,de,Te,Pe.v));else{var Ge=za(Pe);Fe(j,22,R(at,de,Te,Ge.slice(0,239)))}}++Te}}return Fe(j,1),j.end()}function l(k){var P=pe(2);return P.write_shift(2,k),P}function o(k){var P=pe(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var M=0,j=0,ee=0,xe=0;xe<k.SheetNames.length;++xe){var Te=k.SheetNames[xe],me=k.Sheets[Te];if(!(!me||!me["!ref"])){++ee;var we=pn(me["!ref"]);M<we.e.r&&(M=we.e.r),j<we.e.c&&(j=we.e.c)}}return M>8191&&(M=8191),P.write_shift(2,M),P.write_shift(1,ee),P.write_shift(1,j),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function u(k,P,M){var j={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&M.qpro?(j.s.c=k.read_shift(1),k.l++,j.s.r=k.read_shift(2),j.e.c=k.read_shift(1),k.l++,j.e.r=k.read_shift(2),j):(j.s.c=k.read_shift(2),j.s.r=k.read_shift(2),P==12&&M.qpro&&(k.l+=2),j.e.c=k.read_shift(2),j.e.r=k.read_shift(2),P==12&&M.qpro&&(k.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function h(k){var P=pe(8);return P.write_shift(2,k.s.c),P.write_shift(2,k.s.r),P.write_shift(2,k.e.c),P.write_shift(2,k.e.r),P}function d(k,P,M){var j=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(j[0].c=k.read_shift(1),j[3]=k.read_shift(1),j[0].r=k.read_shift(2),k.l+=2):(j[2]=k.read_shift(1),j[0].c=k.read_shift(2),j[0].r=k.read_shift(2)),j}function p(k,P,M){var j=k.l+P,ee=d(k,P,M);if(ee[1].t="s",M.vers==20768){k.l++;var xe=k.read_shift(1);return ee[1].v=k.read_shift(xe,"utf8"),ee}return M.qpro&&k.l++,ee[1].v=k.read_shift(j-k.l,"cstr"),ee}function x(k,P,M){var j=pe(7+M.length);j.write_shift(1,255),j.write_shift(2,P),j.write_shift(2,k),j.write_shift(1,39);for(var ee=0;ee<j.length;++ee){var xe=M.charCodeAt(ee);j.write_shift(1,xe>=128?95:xe)}return j.write_shift(1,0),j}function v(k,P,M){var j=d(k,P,M);return j[1].v=k.read_shift(2,"i"),j}function y(k,P,M){var j=pe(7);return j.write_shift(1,255),j.write_shift(2,P),j.write_shift(2,k),j.write_shift(2,M,"i"),j}function E(k,P,M){var j=d(k,P,M);return j[1].v=k.read_shift(8,"f"),j}function w(k,P,M){var j=pe(13);return j.write_shift(1,255),j.write_shift(2,P),j.write_shift(2,k),j.write_shift(8,M,"f"),j}function S(k,P,M){var j=k.l+P,ee=d(k,P,M);if(ee[1].v=k.read_shift(8,"f"),M.qpro)k.l=j;else{var xe=k.read_shift(2);z(k.slice(k.l,k.l+xe),ee),k.l+=xe}return ee}function N(k,P,M){var j=P&32768;return P&=-32769,P=(j?k:0)+(P>=8192?P-16384:P),(j?"":"$")+(M?tr(P):ur(P))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(k,P){Xr(k,0);for(var M=[],j=0,ee="",xe="",Te="",me="";k.l<k.length;){var we=k[k.l++];switch(we){case 0:M.push(k.read_shift(8,"f"));break;case 1:xe=N(P[0].c,k.read_shift(2),!0),ee=N(P[0].r,k.read_shift(2),!1),M.push(xe+ee);break;case 2:{var $e=N(P[0].c,k.read_shift(2),!0),H=N(P[0].r,k.read_shift(2),!1);xe=N(P[0].c,k.read_shift(2),!0),ee=N(P[0].r,k.read_shift(2),!1),M.push($e+H+":"+xe+ee)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(k.read_shift(2));break;case 6:{for(var At="";we=k[k.l++];)At+=String.fromCharCode(we);M.push('"'+At.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:me=M.pop(),Te=M.pop(),M.push(["AND","OR"][we-20]+"("+Te+","+me+")");break;default:if(we<32&&C[we])me=M.pop(),Te=M.pop(),M.push(Te+C[we]+me);else if(I[we]){if(j=I[we][1],j==69&&(j=k[k.l++]),j>M.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+M.join("|")+"|");return}var at=M.slice(-j);M.length-=j,M.push(I[we][0]+"("+at.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}M.length==1?P[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function X(k){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=k.read_shift(2),P[3]=k[k.l++],P[0].c=k[k.l++],P}function W(k,P){var M=X(k);return M[1].t="s",M[1].v=k.read_shift(P-4,"cstr"),M}function R(k,P,M,j){var ee=pe(6+j.length);ee.write_shift(2,k),ee.write_shift(1,M),ee.write_shift(1,P),ee.write_shift(1,39);for(var xe=0;xe<j.length;++xe){var Te=j.charCodeAt(xe);ee.write_shift(1,Te>=128?95:Te)}return ee.write_shift(1,0),ee}function Q(k,P){var M=X(k);M[1].v=k.read_shift(2);var j=M[1].v>>1;if(M[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return M[1].v=j,M}function G(k,P){var M=X(k),j=k.read_shift(4),ee=k.read_shift(4),xe=k.read_shift(2);if(xe==65535)return j===0&&ee===3221225472?(M[1].t="e",M[1].v=15):j===0&&ee===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var Te=xe&32768;return xe=(xe&32767)-16446,M[1].v=(1-Te*2)*(ee*Math.pow(2,xe+32)+j*Math.pow(2,xe)),M}function fe(k,P,M,j){var ee=pe(14);if(ee.write_shift(2,k),ee.write_shift(1,M),ee.write_shift(1,P),j==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var xe=0,Te=0,me=0,we=0;return j<0&&(xe=1,j=-j),Te=Math.log2(j)|0,j/=Math.pow(2,Te-31),we=j>>>0,(we&2147483648)==0&&(j/=2,++Te,we=j>>>0),j-=we,we|=2147483648,we>>>=0,j*=Math.pow(2,32),me=j>>>0,ee.write_shift(4,me),ee.write_shift(4,we),Te+=16383+(xe?32768:0),ee.write_shift(2,Te),ee}function re(k,P){var M=G(k);return k.l+=P-14,M}function K(k,P){var M=X(k),j=k.read_shift(4);return M[1].v=j>>6,M}function ye(k,P){var M=X(k),j=k.read_shift(8,"f");return M[1].v=j,M}function Ie(k,P){var M=ye(k);return k.l+=P-10,M}function Ce(k,P){return k[k.l+P-1]==0?k.read_shift(P,"cstr"):""}function Y(k,P){var M=k[k.l++];M>P-1&&(M=P-1);for(var j="";j.length<M;)j+=String.fromCharCode(k[k.l++]);return j}function ue(k,P,M){if(!(!M.qpro||P<21)){var j=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var ee=k.read_shift(P-21,"cstr");return[j,ee]}}function Me(k,P){for(var M={},j=k.l+P;k.l<j;){var ee=k.read_shift(2);if(ee==14e3){for(M[ee]=[0,""],M[ee][0]=k.read_shift(2);k[k.l];)M[ee][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return M}function Z(k,P){var M=pe(5+k.length);M.write_shift(2,14e3),M.write_shift(2,P);for(var j=0;j<k.length;++j){var ee=k.charCodeAt(j);M[M.l++]=ee>127?95:ee}return M[M.l++]=0,M}var Le={0:{n:"BOF",f:br},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:G},24:{n:"NUMBER18",f:Q},25:{n:"FORMULA19",f:re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:K},38:{n:"??"},39:{n:"NUMBER27",f:ye},40:{n:"FORMULA28",f:Ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}})();function FM(t){var e={},r=t.match(ln),n=0,i=!1;if(r)for(;n!=r.length;++n){var l=rt(r[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;e.cp=Sg[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=l.val;break;case"<sz":e.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":l.rgb&&(e.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(l[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+l[0])}}return e}var IM=(function(){var t=Tu("t"),e=Tu("rPr");function r(l){var o=l.match(t);if(!o)return{t:"s",v:""};var u={t:"s",v:kt(o[1])},h=l.match(e);return h&&(u.s=FM(h[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(u){return u.v})}})(),MM=(function(){var e=/(\r\n|\n)/g;function r(i,l,o){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),i.b&&(l.push("<b>"),o.push("</b>")),i.i&&(l.push("<i>"),o.push("</i>")),i.strike&&(l.push("<s>"),o.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),i}function n(i){var l=[[],i.v,[]];return i.v?(i.s&&r(i.s,l[0],l[2]),l[0].join("")+l[1].replace(e,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),LM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,BM=/<(?:\w+:)?r>/,PM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function $g(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=kt(Gt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Gt(t),r&&(n.h=Og(n.t))):t.match(BM)&&(n.r=Gt(t),n.t=kt(Gt((t.replace(PM,"").match(LM)||[]).join("").replace(ln,""))),r&&(n.h=MM(IM(n.r)))),n):{t:""}}var UM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jM=/<(?:\w+:)?(?:si|sstItem)>/g,HM=/<\/(?:\w+:)?(?:si|sstItem)>/;function zM(t,e){var r=[],n="";if(!t)return r;var i=t.match(UM);if(i){n=i[2].replace(jM,"").split(HM);for(var l=0;l!=n.length;++l){var o=$g(n[l].trim(),e);o!=null&&(r[r.length]=o)}i=rt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var VM=/^\s|\s$|[\t\n\r]/;function m4(t,e){if(!e.bookSST)return"";var r=[xr];r[r.length]=De("sst",null,{xmlns:pl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],l="<si>";i.r?l+=i.r:(l+="<t",i.t||(i.t=""),i.t.match(VM)&&(l+=' xml:space="preserve"'),l+=">"+Ut(i.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function GM(t){return[t.read_shift(4),t.read_shift(4)]}function WM(t,e){var r=[],n=!1;return Ei(t,function(l,o,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function XM(t,e){return e||(e=pe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var qM=nF;function YM(t){var e=Nn();Se(e,159,XM(t));for(var r=0;r<t.length;++r)Se(e,19,qM(t[r]));return Se(e,160),e.end()}function p4(t){if(typeof St<"u")return St.utils.encode(il,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function pi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function KM(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=pi(t,4),e.U=pi(t,4),e.W=pi(t,4),e}function $M(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),l=[];i-- >0;)l.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=l,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function QM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push($M(t));return e}function ZM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function JM(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=pi(t,4),e.U=pi(t,4),e.W=pi(t,4),e}function eL(t){var e=JM(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function g4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function x4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function tL(t){var e=pi(t);switch(e.Minor){case 2:return[e.Minor,rL(t)];case 3:return[e.Minor,nL()];case 4:return[e.Minor,aL(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function rL(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=g4(t,r),i=x4(t,t.length-t.l);return{t:"Std",h:n,v:i}}function nL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function aL(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ln,function(l){var o=rt(l);switch(Va(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function iL(t,e){var r={},n=r.EncryptionVersionInfo=pi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=g4(t,i),e-=i,r.EncryptionVerifier=x4(t,e),r}function sL(t){var e={},r=e.EncryptionVersionInfo=pi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Qg(t){var e=0,r,n=p4(t),i=n.length+1,l,o,u,h,d;for(r=hs(i),r[0]=n.length,l=1;l!=i;++l)r[l]=n[l-1];for(l=i-1;l>=0;--l)o=r[l],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^o;return e^52811}var v4=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,u){return n(o^u)},l=function(o){for(var u=e[o.length-1],h=104,d=o.length-1;d>=0;--d)for(var p=o[d],x=0;x!=7;++x)p&64&&(u^=r[h]),p*=2,--h;return u};return function(o){for(var u=p4(o),h=l(u),d=u.length,p=hs(16),x=0;x!=16;++x)p[x]=0;var v,y,E;for((d&1)===1&&(v=h>>8,p[d]=i(t[0],v),--d,v=h&255,y=u[u.length-1],p[d]=i(y,v));d>0;)--d,v=h>>8,p[d]=i(u[d],v),--d,v=h&255,p[d]=i(u[d],v);for(d=15,E=15-u.length;E>0;)v=h>>8,p[d]=i(t[E],v),--d,--E,v=h&255,p[d]=i(u[d],v),--d,--E;return p}})(),lL=function(t,e,r,n,i){i||(i=e),n||(n=v4(t));var l,o;for(l=0;l!=e.length;++l)o=e[l],o^=n[r],o=(o>>5|o<<3)&255,i[l]=o,++r;return[i,r,n]},cL=function(t){var e=0,r=v4(t);return function(n){var i=lL("",n,e,r);return e=i[1],i[0]}};function oL(t,e,r,n){var i={key:br(t),verificationBytes:br(t)};return r.password&&(i.verifier=Qg(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=cL(r.password)),i}function uL(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=sL(t):n.Data=iL(t,e),n}function fL(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?uL(t,e-2,n):oL(t,r.biff>=8?e:e-2,r,n),n}var _4=(function(){function t(i,l){switch(l.type){case"base64":return e(zn(i),l);case"binary":return e(i,l);case"buffer":return e(ht&&Buffer.isBuffer(i)?i.toString("binary"):xs(i),l);case"array":return e(ll(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){var o=l||{},u=o.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,x){Array.isArray(u)&&(u[x]=[]);for(var v=/\\\w+\b/g,y=0,E,w=-1;E=v.exec(p);){switch(E[0]){case"\\cell":var S=p.slice(y,v.lastIndex-E[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var N={v:S,t:"s"};Array.isArray(u)?u[x][w]=N:u[Je({r:x,c:w})]=N}break}y=v.lastIndex}w>d.e.c&&(d.e.c=w)}),u["!ref"]=ot(d),u}function r(i,l){return vs(t(i,l),l)}function n(i){for(var l=["{\\rtf1\\ansi"],o=Et(i["!ref"]),u,h=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){l.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var x=Je({r:d,c:p});u=h?(i[d]||[])[p]:i[x],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(za(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function hL(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function ku(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function dL(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),l=Math.min(e,r,n),o=i-l;if(o===0)return[0,0,e];var u=0,h=0,d=i+l;switch(h=o/(d>1?2-d:d),i){case e:u=((r-n)/o+6)%6;break;case r:u=(n-e)/o+2;break;case n:u=(e-r)/o+4;break}return[u/6,h,d/2]}function mL(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),l=n-i/2,o=[l,l,l],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=i*u,o[0]+=i,o[1]+=h;break;case 1:h=i*(2-u),o[0]+=h,o[1]+=i;break;case 2:h=i*(u-2),o[1]+=i,o[2]+=h;break;case 3:h=i*(4-u),o[1]+=h,o[2]+=i;break;case 4:h=i*(u-4),o[2]+=i,o[0]+=h;break;case 5:h=i*(6-u),o[2]+=h,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function xh(t,e){if(e===0)return t;var r=dL(hL(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),ku(mL(r))}var y4=6,pL=15,gL=1,tn=y4;function Au(t){return Math.floor((t+Math.round(128/tn)/256)*tn)}function Nu(t){return Math.floor((t-5)/tn*100+.5)/100}function vh(t){return Math.round((t*tn+5)/tn*256)/256}function Om(t){return vh(Nu(Au(t)))}function Zg(t){var e=Math.abs(t-Om(t)),r=tn;if(e>.005)for(tn=gL;tn<pL;++tn)Math.abs(t-Om(t))<=e&&(e=Math.abs(t-Om(t)),r=tn);tn=r}function ds(t){t.width?(t.wpx=Au(t.width),t.wch=Nu(t.wpx),t.MDW=tn):t.wpx?(t.wch=Nu(t.wpx),t.width=vh(t.wch),t.MDW=tn):typeof t.wch=="number"&&(t.width=vh(t.wch),t.wpx=Au(t.width),t.MDW=tn),t.customWidth&&delete t.customWidth}var xL=96,w4=xL;function Du(t){return t*96/w4}function Rc(t){return t*w4/96}var vL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _L(t,e,r,n){e.Borders=[];var i={},l=!1;(t[0].match(ln)||[]).forEach(function(o){var u=rt(o);switch(Va(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=er(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=er(u.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function yL(t,e,r,n){e.Fills=[];var i={},l=!1;(t[0].match(ln)||[]).forEach(function(o){var u=rt(o);switch(Va(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function wL(t,e,r,n){e.Fonts=[];var i={},l=!1;(t[0].match(ln)||[]).forEach(function(o){var u=rt(o);switch(Va(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=Gt(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?er(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?er(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?er(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?er(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?er(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?er(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?er(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Sg[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=er(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var h=qs[i.color.index];i.color.index==81&&(h=qs[1]),h||(h=qs[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=xh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function EL(t,e,r){e.NumberFmt=[];for(var n=hr(Ye),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Ye[n[i]];var l=t[0].match(ln);if(l)for(i=0;i<l.length;++i){var o=rt(l[i]);switch(Va(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=kt(Gt(o.formatCode)),h=parseInt(o.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}Ua(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function TL(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=De("numFmt",null,{numFmtId:n,formatCode:Ut(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=De("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var N0=["numFmtId","fillId","fontId","borderId","xfId"],D0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function SL(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(ln)||[]).forEach(function(l){var o=rt(l),u=0;switch(Va(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<N0.length;++u)n[N0[u]]&&(n[N0[u]]=parseInt(n[N0[u]],10));for(u=0;u<D0.length;++u)n[D0[u]]&&(n[D0[u]]=er(n[D0[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=er(o.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function bL(t){var e=[];return e[e.length]=De("cellXfs",null),t.forEach(function(r){e[e.length]=De("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=De("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var CL=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&EL(x,p,d),(x=u.match(i))&&wL(x,p,h,d),(x=u.match(n))&&yL(x,p,h,d),(x=u.match(l))&&_L(x,p,h,d),(x=u.match(r))&&SL(x,p,d),p}})();function E4(t,e){var r=[xr,De("styleSheet",null,{xmlns:pl[0],"xmlns:vt":Ar.vt})],n;return t.SSF&&(n=TL(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=bL(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function kL(t,e){var r=t.read_shift(2),n=an(t);return[r,n]}function AL(t,e,r){r||(r=pe(6+4*e.length)),r.write_shift(2,t),Ur(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function NL(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=uF(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var l=t.read_shift(2);switch(l===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=oF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=an(t),n}function DL(t,e){e||(e=pe(153)),e.write_shift(2,t.sz*20),fF(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),mh(t.color,e);var n=0;return n=2,e.write_shift(1,n),Ur(t.name,e),e.length>e.l?e.slice(0,e.l):e}var RL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Fm,OL=sn;function hE(t,e){e||(e=pe(84)),Fm||(Fm=Hh(RL));var r=Fm[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(mh({auto:1},e),mh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function FL(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function T4(t,e,r){r||(r=pe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function zo(t,e){return e||(e=pe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var IL=sn;function ML(t,e){return e||(e=pe(51)),e.write_shift(1,0),zo(null,e),zo(null,e),zo(null,e),zo(null,e),zo(null,e),e.length>e.l?e.slice(0,e.l):e}function LL(t,e){return e||(e=pe(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),dh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function BL(t,e,r){var n=pe(2052);return n.write_shift(4,t),dh(e,n),dh(r,n),n.length>n.l?n.slice(0,n.l):n}function PL(t,e,r){var n={};n.NumberFmt=[];for(var i in Ye)n.NumberFmt[i]=Ye[i];n.CellXf=[],n.Fonts=[];var l=[],o=!1;return Ei(t,function(h,d,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],Ua(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=xh(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(p),o=!0;break;case 38:l.pop(),o=!1;break;default:if(d.T>0)l.push(p);else if(d.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function UL(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Se(t,615,ba(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Se(t,44,AL(i,e[i]))}),Se(t,616))}}function jL(t){var e=1;Se(t,611,ba(e)),Se(t,43,DL({sz:12,color:{theme:1},name:"Calibri",family:2})),Se(t,612)}function HL(t){var e=2;Se(t,603,ba(e)),Se(t,45,hE({patternType:"none"})),Se(t,45,hE({patternType:"gray125"})),Se(t,604)}function zL(t){var e=1;Se(t,613,ba(e)),Se(t,46,ML()),Se(t,614)}function VL(t){var e=1;Se(t,626,ba(e)),Se(t,47,T4({numFmtId:0},65535)),Se(t,627)}function GL(t,e){Se(t,617,ba(e.length)),e.forEach(function(r){Se(t,47,T4(r,0))}),Se(t,618)}function WL(t){var e=1;Se(t,619,ba(e)),Se(t,48,LL({xfId:0,name:"Normal"})),Se(t,620)}function XL(t){var e=0;Se(t,505,ba(e)),Se(t,506)}function qL(t){var e=0;Se(t,508,BL(e,"TableStyleMedium9","PivotStyleMedium4")),Se(t,509)}function YL(t,e){var r=Nn();return Se(r,278),UL(r,t.SSF),jL(r),HL(r),zL(r),VL(r),GL(r,e.cellXfs),WL(r),XL(r),qL(r),Se(r,279),r.end()}var KL=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $L(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ln)||[]).forEach(function(i){var l=rt(i);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(e.themeElements.clrScheme[KL.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function QL(){}function ZL(){}var JL=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,e7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,t7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function r7(t,e,r){e.themeElements={};var n;[["clrScheme",JL,$L],["fontScheme",e7,QL],["fmtScheme",t7,ZL]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var n7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function S4(t,e){(!t||t.length===0)&&(t=Jg());var r,n={};if(!(r=t.match(n7)))throw new Error("themeElements not found in theme");return r7(r[0],n,e),n.raw=t,n}function Jg(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[xr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function a7(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var l=t.slice(t.l);t.l=n;var o;try{o=yb(l,{type:"array"})}catch{return}var u=jn(o,"theme/theme/theme1.xml",!0);if(u)return S4(u,r)}}function i7(t){return t.read_shift(4)}function s7(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=l7(t,4);break;case 2:e.xclrValue=n4(t);break;case 3:e.xclrValue=i7(t);break;case 4:t.l+=4;break}return t.l+=8,e}function l7(t,e){return sn(t,e)}function c7(t,e){return sn(t,e)}function o7(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=s7(t);break;case 6:n[1]=c7(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function u7(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),l=[];i-- >0;)l.push(o7(t,r-t.l));return{ixfe:n,ext:l}}function f7(t,e){e.forEach(function(r){r[0]})}function h7(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:an(t)}}function d7(t){var e=pe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ur(t.name,e),e.slice(0,e.l)}function m7(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function p7(t){var e=pe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function g7(t,e){var r=pe(8+2*e.length);return r.write_shift(4,t),Ur(e,r),r.slice(0,r.l)}function x7(t){return t.l+=4,t.read_shift(4)!=0}function v7(t,e){var r=pe(8);return r.write_shift(4,t),r.write_shift(4,1),r}function _7(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},l=[],o=!1,u=2;return Ei(t,function(h,d,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(p),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function y7(){var t=Nn();return Se(t,332),Se(t,334,ba(1)),Se(t,335,d7({name:"XLDAPR",version:12e4,flags:3496657072})),Se(t,336),Se(t,339,g7(1,"XLDAPR")),Se(t,52),Se(t,35,ba(514)),Se(t,4096,ba(0)),Se(t,4097,la(1)),Se(t,36),Se(t,53),Se(t,340),Se(t,337,v7(1)),Se(t,51,p7([[1,0]])),Se(t,338),Se(t,333),t.end()}function w7(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,l=2,o;return t.replace(ln,function(u){var h=rt(u);switch(Va(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):l==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function b4(){var t=[xr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function E7(t){var e=[];if(!t)return e;var r=1;return(t.match(ln)||[]).forEach(function(n){var i=rt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function T7(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Je(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function S7(t,e,r){var n=[];return Ei(t,function(l,o,u){switch(u){case 63:n.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function b7(t,e,r,n){if(!t)return t;var i=n||{},l=!1;Ei(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function C7(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var dc=1024;function C4(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[De("xml",null,{"xmlns:v":Pn.v,"xmlns:o":Pn.o,"xmlns:x":Pn.x,"xmlns:mv":Pn.mv}).replace(/\/>/,">"),De("o:shapelayout",De("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),De("v:shapetype",[De("v:stroke",null,{joinstyle:"miter"}),De("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];dc<t*1e3;)dc+=1e3;return e.forEach(function(l){var o=sr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?De("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=De("v:fill",h,u),p={on:"t",obscured:"t"};++dc,i=i.concat(["<v:shape"+Su({id:"_x0000_s"+dc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,De("v:shadow",null,p),De("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",qr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),qr("x:AutoFill","False"),qr("x:Row",String(o.r)),qr("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function dE(t,e,r,n){var i=Array.isArray(t),l;e.forEach(function(o){var u=sr(o.ref);if(i?(t[u.r]||(t[u.r]=[]),l=t[u.r][u.c]):l=t[o.ref],!l){l={t:"z"},i?t[u.r][u.c]=l:t[o.ref]=l;var h=Et(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=ot(h);d!==t["!ref"]&&(t["!ref"]=d)}l.c||(l.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var x=l.c.length-1;x>=0;--x){if(!r&&l.c[x].T)return;r&&!l.c[x].T&&l.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(p.a==n[x].id){p.a=n[x].name||p.a;break}}l.c.push(p)})}function k7(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=rt(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=sr(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&$g(x[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=v.h),n.push(d)}}}}),n}function k4(t){var e=[xr,De("comments",null,{xmlns:pl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var l=Ut(i.a);r.indexOf(l)==-1&&(r.push(l),e.push("<author>"+l+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(i=r.indexOf(Ut(h.a))),l.push(h.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),l.length<=1)e.push(qr("t",Ut(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)o+=`Reply:
    `+l[u]+`
`;e.push(qr("t",Ut(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function A7(t,e){var r=[],n=!1,i={},l=0;return t.replace(ln,function(u,h){var d=rt(u);switch(Va(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":i.t=t.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function N7(t,e,r){var n=[xr,De("ThreadedComments",null,{xmlns:Ar.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var l="";(i[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var h={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(De("threadedComment",qr("text",o.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function D7(t,e){var r=[],n=!1;return t.replace(ln,function(l){var o=rt(l);switch(Va(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function R7(t){var e=[xr,De("personList",null,{xmlns:Ar.TCMNT,"xmlns:x":pl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(De("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function O7(t){var e={};e.iauthor=t.read_shift(4);var r=_l(t);return e.rfx=r.s,e.ref=Je(r.s),t.l+=16,e}function F7(t,e){return e==null&&(e=pe(36)),e.write_shift(4,t[1].iauthor),Vc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var I7=an;function M7(t){return Ur(t.slice(0,54))}function L7(t,e){var r=[],n=[],i={},l=!1;return Ei(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function B7(t){var e=Nn(),r=[];return Se(e,628),Se(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Se(e,632,M7(i.a)))})}),Se(e,631),Se(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var l={s:sr(n[0]),e:sr(n[0])};Se(e,635,F7([l,i])),i.t&&i.t.length>0&&Se(e,637,iF(i)),Se(e,636),delete i.iauthor})}),Se(e,634),Se(e,629),e.end()}var P7="application/vnd.ms-office.vbaProject";function U7(t){var e=We.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");We.utils.cfb_add(e,i,t.FileIndex[n].content)}}),We.write(e)}function j7(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&We.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var A4=["xlsb","xlsm","xlam","biff8","xla"];function H7(){return{"!type":"dialog"}}function z7(){return{"!type":"dialog"}}function V7(){return{"!type":"macro"}}function G7(){return{"!type":"macro"}}var Ec=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,l,o){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=e.c:--p,h?d+=e.r:--d,i+(u?"":"$")+tr(p)+(h?"":"$")+ur(d)}return function(i,l){return e=l,i.replace(t,r)}})(),ex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tx=(function(){return function(e,r){return e.replace(ex,function(n,i,l,o,u,h){var d=Hg(o)-(l?0:r.c),p=jg(h)-(u?0:r.r),x=p==0?"":u?p+1:"["+p+"]",v=d==0?"":l?d+1:"["+d+"]";return i+"R"+x+"C"+v})}})();function N4(t,e){return t.replace(ex,function(r,n,i,l,o,u){return n+(i=="$"?i+l:tr(Hg(l)+e.c))+(o=="$"?o+u:ur(jg(u)+e.r))})}function W7(t,e,r){var n=pn(e),i=n.s,l=sr(r),o={r:l.r-i.r,c:l.c-i.c};return N4(t,o)}function X7(t){return t.length!=1}function mE(t){return t.replace(/_xlfn\./g,"")}function Tr(t){t.l+=1}function ms(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function D4(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return R4(t);r.biff==12&&(n=4)}var i=t.read_shift(n),l=t.read_shift(n),o=ms(t),u=ms(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function R4(t){var e=ms(t),r=ms(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function q7(t,e,r){if(r.biff<8)return R4(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),l=ms(t),o=ms(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function O4(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Y7(t);var n=t.read_shift(r&&r.biff==12?4:2),i=ms(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function Y7(t){var e=ms(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function K7(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $7(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Q7(t);var i=t.read_shift(n>=12?4:2),l=t.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;i>524287;)i-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:i,c:l,cRel:o,rRel:u}}function Q7(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function Z7(t,e,r){var n=(t[t.l++]&96)>>5,i=D4(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function J7(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}var o=D4(t,l,r);return[n,i,o]}function e9(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function t9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}return t.l+=l,[n,i]}function r9(t,e,r){var n=(t[t.l++]&96)>>5,i=q7(t,e-1,r);return[n,i]}function n9(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function pE(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function a9(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],l=0;l<=n;++l)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function i9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function s9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function l9(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function c9(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function F4(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function o9(t){return t.read_shift(2),F4(t)}function u9(t){return t.read_shift(2),F4(t)}function f9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=O4(t,0,r);return[n,i]}function h9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=$7(t,0,r);return[n,i]}function d9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var l=O4(t,0,r);return[n,i,l]}function m9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[xB[i],L4[i],n]}function p9(t,e,r){var n=t[t.l++],i=t.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:g9(t);return[i,(l[0]===0?L4:gB)[l[1]]]}function g9(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function x9(t,e,r){t.l+=r&&r.biff==2?3:4}function v9(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function _9(t){return t.l++,Ti[t.read_shift(1)]}function y9(t){return t.l++,t.read_shift(2)}function w9(t){return t.l++,t.read_shift(1)!==0}function E9(t){return t.l++,rn(t)}function T9(t,e,r){return t.l++,$u(t,e-1,r)}function S9(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ti[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=rn(t);break;case 2:r[1]=yl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function b9(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],l=0;l!=n;++l)i.push((r.biff==12?_l:Wh)(t));return i}function C9(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var l=0,o=[];l!=n&&(o[l]=[]);++l)for(var u=0;u!=i;++u)o[l][u]=S9(t,r.biff);return o}function k9(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,l=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,l]}function A9(t,e,r){if(r.biff==5)return N9(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),l=t.read_shift(4);return[n,i,l]}function N9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function D9(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function R9(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function O9(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function F9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return t.l+=l,[n,i]}var I9=sn,M9=sn,L9=sn;function Zu(t,e,r){return t.l+=2,[K7(t)]}function rx(t){return t.l+=6,[]}var B9=Zu,P9=rx,U9=rx,j9=Zu;function I4(t){return t.l+=2,[br(t),t.read_shift(2)&1]}var H9=Zu,z9=I4,V9=rx,G9=Zu,W9=Zu,X9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function q9(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),l=t.read_shift(2),o=X9[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:l}}function Y9(t){return t.l+=2,[t.read_shift(4)]}function K9(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function $9(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Q9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Z9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function J9(t){return t.l+=4,[0,0]}var gE={1:{n:"PtgExp",f:v9},2:{n:"PtgTbl",f:L9},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:T9},26:{n:"PtgSheet",f:K9},27:{n:"PtgEndSheet",f:$9},28:{n:"PtgErr",f:_9},29:{n:"PtgBool",f:w9},30:{n:"PtgInt",f:y9},31:{n:"PtgNum",f:E9},32:{n:"PtgArray",f:n9},33:{n:"PtgFunc",f:m9},34:{n:"PtgFuncVar",f:p9},35:{n:"PtgName",f:k9},36:{n:"PtgRef",f:f9},37:{n:"PtgArea",f:Z7},38:{n:"PtgMemArea",f:D9},39:{n:"PtgMemErr",f:I9},40:{n:"PtgMemNoMem",f:M9},41:{n:"PtgMemFunc",f:R9},42:{n:"PtgRefErr",f:O9},43:{n:"PtgAreaErr",f:e9},44:{n:"PtgRefN",f:h9},45:{n:"PtgAreaN",f:r9},46:{n:"PtgMemAreaN",f:Q9},47:{n:"PtgMemNoMemN",f:Z9},57:{n:"PtgNameX",f:A9},58:{n:"PtgRef3d",f:d9},59:{n:"PtgArea3d",f:J7},60:{n:"PtgRefErr3d",f:F9},61:{n:"PtgAreaErr3d",f:t9},255:{}},eB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tB={1:{n:"PtgElfLel",f:I4},2:{n:"PtgElfRw",f:G9},3:{n:"PtgElfCol",f:B9},6:{n:"PtgElfRwV",f:W9},7:{n:"PtgElfColV",f:j9},10:{n:"PtgElfRadical",f:H9},11:{n:"PtgElfRadicalS",f:V9},13:{n:"PtgElfColS",f:P9},15:{n:"PtgElfColSV",f:U9},16:{n:"PtgElfRadicalLel",f:z9},25:{n:"PtgList",f:q9},29:{n:"PtgSxName",f:Y9},255:{}},rB={0:{n:"PtgAttrNoop",f:J9},1:{n:"PtgAttrSemi",f:c9},2:{n:"PtgAttrIf",f:s9},4:{n:"PtgAttrChoose",f:a9},8:{n:"PtgAttrGoto",f:i9},16:{n:"PtgAttrSum",f:x9},32:{n:"PtgAttrBaxcel",f:pE},33:{n:"PtgAttrBaxcel",f:pE},64:{n:"PtgAttrSpace",f:o9},65:{n:"PtgAttrSpaceSemi",f:u9},128:{n:"PtgAttrIfError",f:l9},255:{}};function Ju(t,e,r,n){if(n.biff<8)return sn(t,e);for(var i=t.l+e,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=C9(t,0,n),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=b9(t,r[o][1],n),l.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&l.push(sn(t,e)),l}function ef(t,e,r){for(var n=t.l+e,i,l,o=[];n!=t.l;)e=n-t.l,l=t[t.l],i=gE[l]||gE[eB[l]],(l===24||l===25)&&(i=(l===24?tB:rB)[t[t.l+1]]),!i||!i.f?sn(t,e):o.push([i.n,i.f(t,e,r)]);return o}function nB(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],l=0;l<n.length;++l){var o=n[l];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var aB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function iB(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function M4(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xE(t,e,r){var n=M4(t,e,r);return n=="#REF"?n:iB(n,r)}function Jr(t,e,r,n,i){var l=i&&i.biff||8,o={s:{c:0,r:0}},u=[],h,d,p,x=0,v=0,y,E="";if(!t[0]||!t[0][0])return"";for(var w=-1,S="",N=0,I=t[0].length;N<I;++N){var C=t[0][N];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),w>=0){switch(t[0][w][1][0]){case 0:S=or(" ",t[0][w][1][1]);break;case 1:S=or("\r",t[0][w][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}d=d+S,w=-1}u.push(d+aB[C[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=eu(C[1][1],o,i),u.push(tu(p,l));break;case"PtgRefN":p=r?eu(C[1][1],r,i):C[1][1],u.push(tu(p,l));break;case"PtgRef3d":x=C[1][1],p=eu(C[1][2],o,i),E=xE(n,x,i),u.push(E+"!"+tu(p,l));break;case"PtgFunc":case"PtgFuncVar":var z=C[1][0],X=C[1][1];z||(z=0),z&=127;var W=z==0?[]:u.slice(-z);u.length-=z,X==="User"&&(X=W.shift()),u.push(X+"("+W.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":y=Xw(C[1][1],r?{s:r}:o,i),u.push(Nm(y,i));break;case"PtgArea":y=Xw(C[1][1],o,i),u.push(Nm(y,i));break;case"PtgArea3d":x=C[1][1],y=C[1][2],E=xE(n,x,i),u.push(E+"!"+Nm(y,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var R=(n.names||[])[v-1]||(n[0]||[])[v],Q=R?R.Name:"SH33TJSNAME"+String(v);Q&&Q.slice(0,6)=="_xlfn."&&!i.xlfn&&(Q=Q.slice(6)),u.push(Q);break;case"PtgNameX":var G=C[1][1];v=C[1][2];var fe;if(i.biff<=5)G<0&&(G=-G),n[G]&&(fe=n[G][v]);else{var re="";if(((n[G]||[])[0]||[])[0]==14849||(((n[G]||[])[0]||[])[0]==1025?n[G][v]&&n[G][v].itab>0&&(re=n.SheetNames[n[G][v].itab-1]+"!"):re=n.SheetNames[v-1]+"!"),n[G]&&n[G][v])re+=n[G][v].Name;else if(n[0]&&n[0][v])re+=n[0][v].Name;else{var K=(M4(n,G,i)||"").split(";;");K[v-1]?re=K[v-1]:re+="SH33TJSERRX"}u.push(re);break}fe||(fe={Name:"SH33TJSERRY"}),u.push(fe.Name);break;case"PtgParen":var ye="(",Ie=")";if(w>=0){switch(S="",t[0][w][1][0]){case 2:ye=or(" ",t[0][w][1][1])+ye;break;case 3:ye=or("\r",t[0][w][1][1])+ye;break;case 4:Ie=or(" ",t[0][w][1][1])+Ie;break;case 5:Ie=or("\r",t[0][w][1][1])+Ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}u.push(ye+u.pop()+Ie);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var Ce={c:r.c,r:r.r};if(n.sharedf[Je(p)]){var Y=n.sharedf[Je(p)];u.push(Jr(Y,o,Ce,n,i))}else{var ue=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Jr(d[1],o,Ce,n,i)),ue=!0;break}ue||u.push(C[1])}break;case"PtgArray":u.push("{"+nB(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&w>=0&&Me.indexOf(t[0][N][0])==-1){C=t[0][w];var Z=!0;switch(C[1][0]){case 4:Z=!1;case 0:S=or(" ",C[1][1]);break;case 5:Z=!1;case 1:S=or("\r",C[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((Z?S:"")+u.pop()+(Z?"":S)),w=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function sB(t,e,r){var n=t.l+e,i=r.biff==2?1:2,l,o=t.read_shift(i);if(o==65535)return[[],sn(t,e-2)];var u=ef(t,o,r);return e!==o+i&&(l=Ju(t,e-o-i,u,r)),t.l=n,[u,l]}function lB(t,e,r){var n=t.l+e,i=r.biff==2?1:2,l,o=t.read_shift(i);if(o==65535)return[[],sn(t,e-2)];var u=ef(t,o,r);return e!==o+i&&(l=Ju(t,e-o-i,u,r)),t.l=n,[u,l]}function cB(t,e,r,n){var i=t.l+e,l=ef(t,n,r),o;return i!==t.l&&(o=Ju(t,i-t.l,l,r)),[l,o]}function oB(t,e,r){var n=t.l+e,i,l=t.read_shift(2),o=ef(t,l,r);return l==65535?[[],sn(t,e-2)]:(e!==l+2&&(i=Ju(t,n-l-2,o,r)),[o,i])}function uB(t){var e;if(hi(t,t.l+6)!==65535)return[rn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function fB(t){if(t==null){var e=pe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return cl(t);return cl(0)}function Im(t,e,r){var n=t.l+e,i=Ga(t);r.biff==2&&++t.l;var l=uB(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=lB(t,n-t.l,r);return{cell:i,val:l[0],formula:u,shared:o>>3&1,tt:l[1]}}function hB(t,e,r,n,i){var l=ul(e,r,i),o=fB(t.v),u=pe(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=pe(t.bf.length),p=0;p<t.bf.length;++p)d[p]=t.bf[p];var x=Pr([l,o,u,d]);return x}function Xh(t,e,r){var n=t.read_shift(4),i=ef(t,n,r),l=t.read_shift(4),o=l>0?Ju(t,l,i,r):null;return[i,o]}var dB=Xh,qh=Xh,mB=Xh,pB=Xh,gB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},L4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},xB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function vB(t){var e="of:="+t.replace(ex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Mm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function _B(t){return t.replace(/\./,"!")}var nu={},Tc={},au=typeof Map<"u";function nx(t,e,r){var n=0,i=t.length;if(r){if(au?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var l=au?r.get(e):r[e];n<l.length;++n)if(t[l[n]].t===e)return t.Count++,l[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(au?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Yh(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(tn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Nu(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=vh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function $s(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function _s(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,l=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ua(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=l;++i)if(t[i].numFmtId===n)return i;return t[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function B4(t,e,r,n,i,l){try{n.cellNF&&(t.z=Ye[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=rr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Ye[e]==null&&Ua(pO[e]||"General",e),t.t==="e")t.w=t.w||Ti[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Eu(t.v);else if(t.t==="d"){var o=Nr(t.v);(o|0)===o?t.w=o.toString(10):t.w=Eu(o)}else{if(t.v===void 0)return"";t.w=sl(t.v,Tc)}else t.t==="d"?t.w=Vn(e,Nr(t.v),Tc):t.w=Vn(e,t.v,Tc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=l.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=xh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=xh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&l.Fills)throw u}}}function yB(t,e,r){if(t&&t["!ref"]){var n=Et(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function wB(t,e){var r=Et(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=ot(r))}var EB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,TB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,SB=/<(?:\w:)?hyperlink [^>]*>/mg,bB=/"(\w*:\w*)"/,CB=/<(?:\w:)?col\b[^>]*[\/]?>/g,kB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,AB=/<(?:\w:)?pageMargins[^>]*\/>/g,P4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,NB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,DB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function RB(t,e,r,n,i,l,o){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",x=t.match(TB);x?(d=t.slice(0,x.index),p=t.slice(x.index+x[0].length)):d=p=t;var v=d.match(P4);v?ax(v[0],u,i,r):(v=d.match(NB))&&FB(v[0],v[1]||"",u,i,r);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var E=d.slice(y,y+50).match(bB);E&&wB(u,E[1])}var w=d.match(DB);w&&w[1]&&XB(w[1],i);var S=[];if(e.cellStyles){var N=d.match(CB);N&&HB(S,N)}x&&KB(x[1],u,e,h,l,o);var I=p.match(kB);I&&(u["!autofilter"]=VB(I[0]));var C=[],z=p.match(EB);if(z)for(y=0;y!=z.length;++y)C[y]=Et(z[y].slice(z[y].indexOf('"')+1));var X=p.match(SB);X&&PB(u,X,n);var W=p.match(AB);if(W&&(u["!margins"]=UB(rt(W[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=ot(h)),e.sheetRows>0&&u["!ref"]){var R=Et(u["!ref"]);e.sheetRows<=+R.e.r&&(R.e.r=e.sheetRows-1,R.e.r>h.e.r&&(R.e.r=h.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>h.e.c&&(R.e.c=h.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),u["!fullref"]=u["!ref"],u["!ref"]=ot(R))}return S.length>0&&(u["!cols"]=S),C.length>0&&(u["!merges"]=C),u}function OB(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+ot(t[r])+'"/>';return e+"</mergeCells>"}function ax(t,e,r,n){var i=rt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=kt(Gt(i.codeName)))}function FB(t,e,r,n,i){ax(t.slice(0,t.indexOf(">")),r,n,i)}function IB(t,e,r,n,i){var l=!1,o={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[r];try{e.Workbook&&(h=e.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,o.codeName=La(Ut(h))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+De("outlinePr",null,d)}!l&&!u||(i[i.length]=De("sheetPr",u,o))}var MB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],LB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function BB(t){var e={sheet:1};return MB.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),LB.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Qg(t.password).toString(16).toUpperCase()),De("sheetProtection",null,e)}function PB(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var l=rt(Gt(e[i]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+kt(l.location))):(l.Target="#"+kt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Et(l.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var p=Je({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=l):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=l)}}}function UB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function jB(t){return $s(t),De("pageMargins",null,t)}function HB(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=rt(e[n],!0);i.hidden&&(i.hidden=er(i.hidden));var l=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Zg(i.width)),ds(i);l<=o;)t[l++]=Xt(i)}}function zB(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=De("col",null,Yh(i,n)));return r[r.length]="</cols>",r.join("")}function VB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function GB(t,e,r,n){var i=typeof t.ref=="string"?t.ref:ot(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=pn(i);o.s.r==o.e.r&&(o.e.r=pn(e["!ref"]).e.r,i=ot(o));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),De("autoFilter",null,{ref:i})}var WB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function XB(t,e){e.Views||(e.Views=[{}]),(t.match(WB)||[]).forEach(function(r,n){var i=rt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),er(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function qB(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),De("sheetViews",De("sheetView",null,i),{})}function YB(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",l=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Ti[t.v];break;case"d":n&&n.cellDates?i=rr(t.v,-1).toISOString():(t=Xt(t),t.t="n",i=""+(t.v=Nr(rr(t.v)))),typeof t.z>"u"&&(t.z=Ye[14]);break;default:i=t.v;break}var u=qr("v",Ut(i)),h={r:e},d=_s(n.cellXfs,t,n);switch(d!==0&&(h.s=d),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=qr("v",""+nx(n.Strings,t.v,n.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=l&&(t.t=l,t.v=o),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=De("f",Ut(t.f),p)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(h.cm=1),De("c",u,h)}var KB=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,l=Tu("v"),o=Tu("f");return function(h,d,p,x,v,y){for(var E=0,w="",S=[],N=[],I=0,C=0,z=0,X="",W,R,Q=0,G=0,fe,re,K=0,ye=0,Ie=Array.isArray(y.CellXf),Ce,Y=[],ue=[],Me=Array.isArray(d),Z=[],Le={},U=!1,k=!!p.sheetStubs,P=h.split(e),M=0,j=P.length;M!=j;++M){w=P[M].trim();var ee=w.length;if(ee!==0){var xe=0;e:for(E=0;E<ee;++E)switch(w[E]){case">":if(w[E-1]!="/"){++E;break e}if(p&&p.cellStyles){if(R=rt(w.slice(xe,E),!0),Q=R.r!=null?parseInt(R.r,10):Q+1,G=-1,p.sheetRows&&p.sheetRows<Q)continue;Le={},U=!1,R.ht&&(U=!0,Le.hpt=parseFloat(R.ht),Le.hpx=Rc(Le.hpt)),R.hidden=="1"&&(U=!0,Le.hidden=!0),R.outlineLevel!=null&&(U=!0,Le.level=+R.outlineLevel),U&&(Z[Q-1]=Le)}break;case"<":xe=E;break}if(xe>=E)break;if(R=rt(w.slice(xe,E),!0),Q=R.r!=null?parseInt(R.r,10):Q+1,G=-1,!(p.sheetRows&&p.sheetRows<Q)){x.s.r>Q-1&&(x.s.r=Q-1),x.e.r<Q-1&&(x.e.r=Q-1),p&&p.cellStyles&&(Le={},U=!1,R.ht&&(U=!0,Le.hpt=parseFloat(R.ht),Le.hpx=Rc(Le.hpt)),R.hidden=="1"&&(U=!0,Le.hidden=!0),R.outlineLevel!=null&&(U=!0,Le.level=+R.outlineLevel),U&&(Z[Q-1]=Le)),S=w.slice(E).split(t);for(var Te=0;Te!=S.length&&S[Te].trim().charAt(0)=="<";++Te);for(S=S.slice(Te),E=0;E!=S.length;++E)if(w=S[E].trim(),w.length!==0){if(N=w.match(r),I=E,C=0,z=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,N!=null&&N.length===2){for(I=0,X=N[1],C=0;C!=X.length&&!((z=X.charCodeAt(C)-64)<1||z>26);++C)I=26*I+z;--I,G=I}else++G;for(C=0;C!=w.length&&w.charCodeAt(C)!==62;++C);if(++C,R=rt(w.slice(0,C),!0),R.r||(R.r=Je({r:Q-1,c:G})),X=w.slice(C),W={t:""},(N=X.match(l))!=null&&N[1]!==""&&(W.v=kt(N[1])),p.cellFormula){if((N=X.match(o))!=null&&N[1]!==""){if(W.f=kt(Gt(N[1])).replace(/\r\n/g,`
`),p.xlfn||(W.f=mE(W.f)),N[0].indexOf('t="array"')>-1)W.F=(X.match(i)||[])[1],W.F.indexOf(":")>-1&&Y.push([Et(W.F),W.F]);else if(N[0].indexOf('t="shared"')>-1){re=rt(N[0]);var me=kt(Gt(N[1]));p.xlfn||(me=mE(me)),ue[parseInt(re.si,10)]=[re,me,R.r]}}else(N=X.match(/<f[^>]*\/>/))&&(re=rt(N[0]),ue[re.si]&&(W.f=W7(ue[re.si][1],ue[re.si][2],R.r)));var we=sr(R.r);for(C=0;C<Y.length;++C)we.r>=Y[C][0].s.r&&we.r<=Y[C][0].e.r&&we.c>=Y[C][0].s.c&&we.c<=Y[C][0].e.c&&(W.F=Y[C][1])}if(R.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(k)W.t="z";else continue;else W.t=R.t||"n";switch(x.s.c>G&&(x.s.c=G),x.e.c<G&&(x.e.c=G),W.t){case"n":if(W.v==""||W.v==null){if(!k)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!k)continue;W.t="z"}else fe=nu[parseInt(W.v,10)],W.v=fe.t,W.r=fe.r,p.cellHTML&&(W.h=fe.h);break;case"str":W.t="s",W.v=W.v!=null?Gt(W.v):"",p.cellHTML&&(W.h=Og(W.v));break;case"inlineStr":N=X.match(n),W.t="s",N!=null&&(fe=$g(N[1]))?(W.v=fe.t,p.cellHTML&&(W.h=fe.h)):W.v="";break;case"b":W.v=er(W.v);break;case"d":p.cellDates?W.v=rr(W.v,1):(W.v=Nr(rr(W.v,1)),W.t="n");break;case"e":(!p||p.cellText!==!1)&&(W.w=W.v),W.v=jb[W.v];break}if(K=ye=0,Ce=null,Ie&&R.s!==void 0&&(Ce=y.CellXf[R.s],Ce!=null&&(Ce.numFmtId!=null&&(K=Ce.numFmtId),p.cellStyles&&Ce.fillId!=null&&(ye=Ce.fillId))),B4(W,K,ye,p,v,y),p.cellDates&&Ie&&W.t=="n"&&ml(Ye[K])&&(W.t="d",W.v=Vh(W.v)),R.cm&&p.xlmeta){var $e=(p.xlmeta.Cell||[])[+R.cm-1];$e&&$e.type=="XLDAPR"&&(W.D=!0)}if(Me){var H=sr(R.r);d[H.r]||(d[H.r]=[]),d[H.r][H.c]=W}else d[R.r]=W}}}}Z.length>0&&(d["!rows"]=Z)}})();function $B(t,e,r,n){var i=[],l=[],o=Et(t["!ref"]),u="",h,d="",p=[],x=0,v=0,y=t["!rows"],E=Array.isArray(t),w={r:d},S,N=-1;for(v=o.s.c;v<=o.e.c;++v)p[v]=tr(v);for(x=o.s.r;x<=o.e.r;++x){for(l=[],d=ur(x),v=o.s.c;v<=o.e.c;++v){h=p[v]+d;var I=E?(t[x]||[])[v]:t[h];I!==void 0&&(u=YB(I,h,t,e))!=null&&l.push(u)}(l.length>0||y&&y[x])&&(w={r:d},y&&y[x]&&(S=y[x],S.hidden&&(w.hidden=1),N=-1,S.hpx?N=Du(S.hpx):S.hpt&&(N=S.hpt),N>-1&&(w.ht=N,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),i[i.length]=De("row",l.join(""),w))}if(y)for(;x<y.length;++x)y&&y[x]&&(w={r:x+1},S=y[x],S.hidden&&(w.hidden=1),N=-1,S.hpx?N=Du(S.hpx):S.hpt&&(N=S.hpt),N>-1&&(w.ht=N,w.customHeight=1),S.level&&(w.outlineLevel=S.level),i[i.length]=De("row","",w));return i.join("")}function U4(t,e,r,n){var i=[xr,De("worksheet",null,{xmlns:pl[0],"xmlns:r":Ar.r})],l=r.SheetNames[t],o=0,u="",h=r.Sheets[l];h==null&&(h={});var d=h["!ref"]||"A1",p=Et(d);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=ot(p)}n||(n={}),h["!comments"]=[];var x=[];IB(h,r,t,e,i),i[i.length]=De("dimension",null,{ref:d}),i[i.length]=qB(h,e,t,r),e.sheetFormat&&(i[i.length]=De("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(i[i.length]=zB(h,h["!cols"])),i[o=i.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=$B(h,e),u.length>0&&(i[i.length]=u)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),h["!protect"]&&(i[i.length]=BB(h["!protect"])),h["!autofilter"]!=null&&(i[i.length]=GB(h["!autofilter"],h,r,t)),h["!merges"]!=null&&h["!merges"].length>0&&(i[i.length]=OB(h["!merges"]));var v=-1,y,E=-1;return h["!links"].length>0&&(i[i.length]="<hyperlinks>",h["!links"].forEach(function(w){w[1].Target&&(y={ref:w[0]},w[1].Target.charAt(0)!="#"&&(E=Pt(n,-1,Ut(w[1].Target).replace(/#.*$/,""),dt.HLINK),y["r:id"]="rId"+E),(v=w[1].Target.indexOf("#"))>-1&&(y.location=Ut(w[1].Target.slice(v+1))),w[1].Tooltip&&(y.tooltip=Ut(w[1].Tooltip)),i[i.length]=De("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(i[i.length]=jB(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=qr("ignoredErrors",De("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(E=Pt(n,-1,"../drawings/drawing"+(t+1)+".xml",dt.DRAW),i[i.length]=De("drawing",null,{"r:id":"rId"+E}),h["!drawing"]=x),h["!comments"].length>0&&(E=Pt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",dt.VML),i[i.length]=De("legacyDrawing",null,{"r:id":"rId"+E}),h["!legacy"]=E),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function QB(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var l=t.read_shift(1);return t.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=i/20),r}function ZB(t,e,r){var n=pe(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var l=320;i.hpx?l=Du(i.hpx)*20:i.hpt&&(l=i.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,h=n.l;n.l+=4;for(var d={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var x=-1,v=-1,y=p<<10;y<p+1<<10;++y){d.c=y;var E=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Je(d)];E&&(x<0&&(x=y),v=y)}x<0||(++u,n.write_shift(4,x),n.write_shift(4,v))}var w=n.l;return n.l=h,n.write_shift(4,u),n.l=w,n.length>n.l?n.slice(0,n.l):n}function JB(t,e,r,n){var i=ZB(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Se(t,0,i)}var eP=_l,tP=Vc;function rP(){}function nP(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=sF(t),r}function aP(t,e,r){r==null&&(r=pe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return mh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Mb(t,r),r.slice(0,r.l)}function iP(t){var e=fa(t);return[e]}function sP(t,e,r){return r==null&&(r=pe(8)),gl(e,r)}function lP(t){var e=xl(t);return[e]}function cP(t,e,r){return r==null&&(r=pe(4)),vl(e,r)}function oP(t){var e=fa(t),r=t.read_shift(1);return[e,r,"b"]}function uP(t,e,r){return r==null&&(r=pe(9)),gl(e,r),r.write_shift(1,t.v?1:0),r}function fP(t){var e=xl(t),r=t.read_shift(1);return[e,r,"b"]}function hP(t,e,r){return r==null&&(r=pe(5)),vl(e,r),r.write_shift(1,t.v?1:0),r}function dP(t){var e=fa(t),r=t.read_shift(1);return[e,r,"e"]}function mP(t,e,r){return r==null&&(r=pe(9)),gl(e,r),r.write_shift(1,t.v),r}function pP(t){var e=xl(t),r=t.read_shift(1);return[e,r,"e"]}function gP(t,e,r){return r==null&&(r=pe(8)),vl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function xP(t){var e=fa(t),r=t.read_shift(4);return[e,r,"s"]}function vP(t,e,r){return r==null&&(r=pe(12)),gl(e,r),r.write_shift(4,e.v),r}function _P(t){var e=xl(t),r=t.read_shift(4);return[e,r,"s"]}function yP(t,e,r){return r==null&&(r=pe(8)),vl(e,r),r.write_shift(4,e.v),r}function wP(t){var e=fa(t),r=rn(t);return[e,r,"n"]}function EP(t,e,r){return r==null&&(r=pe(16)),gl(e,r),cl(t.v,r),r}function j4(t){var e=xl(t),r=rn(t);return[e,r,"n"]}function TP(t,e,r){return r==null&&(r=pe(12)),vl(e,r),cl(t.v,r),r}function SP(t){var e=fa(t),r=Wg(t);return[e,r,"n"]}function bP(t,e,r){return r==null&&(r=pe(12)),gl(e,r),Lb(t.v,r),r}function CP(t){var e=xl(t),r=Wg(t);return[e,r,"n"]}function kP(t,e,r){return r==null&&(r=pe(8)),vl(e,r),Lb(t.v,r),r}function AP(t){var e=fa(t),r=zg(t);return[e,r,"is"]}function NP(t){var e=fa(t),r=an(t);return[e,r,"str"]}function DP(t,e,r){return r==null&&(r=pe(12+4*t.v.length)),gl(e,r),Ur(t.v,r),r.length>r.l?r.slice(0,r.l):r}function RP(t){var e=xl(t),r=an(t);return[e,r,"str"]}function OP(t,e,r){return r==null&&(r=pe(8+4*t.v.length)),vl(e,r),Ur(t.v,r),r.length>r.l?r.slice(0,r.l):r}function FP(t,e,r){var n=t.l+e,i=fa(t);i.r=r["!row"];var l=t.read_shift(1),o=[i,l,"b"];if(r.cellFormula){t.l+=2;var u=qh(t,n-t.l,r);o[3]=Jr(u,null,i,r.supbooks,r)}else t.l=n;return o}function IP(t,e,r){var n=t.l+e,i=fa(t);i.r=r["!row"];var l=t.read_shift(1),o=[i,l,"e"];if(r.cellFormula){t.l+=2;var u=qh(t,n-t.l,r);o[3]=Jr(u,null,i,r.supbooks,r)}else t.l=n;return o}function MP(t,e,r){var n=t.l+e,i=fa(t);i.r=r["!row"];var l=rn(t),o=[i,l,"n"];if(r.cellFormula){t.l+=2;var u=qh(t,n-t.l,r);o[3]=Jr(u,null,i,r.supbooks,r)}else t.l=n;return o}function LP(t,e,r){var n=t.l+e,i=fa(t);i.r=r["!row"];var l=an(t),o=[i,l,"str"];if(r.cellFormula){t.l+=2;var u=qh(t,n-t.l,r);o[3]=Jr(u,null,i,r.supbooks,r)}else t.l=n;return o}var BP=_l,PP=Vc;function UP(t,e){return e==null&&(e=pe(4)),e.write_shift(4,t),e}function jP(t,e){var r=t.l+e,n=_l(t),i=Vg(t),l=an(t),o=an(t),u=an(t);t.l=r;var h={rfx:n,relId:i,loc:l,display:u};return o&&(h.Tooltip=o),h}function HP(t,e){var r=pe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Vc({s:sr(t[0]),e:sr(t[0])},r),Gg("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Ur(i||"",r),Ur(t[1].Tooltip||"",r),Ur("",r),r.slice(0,r.l)}function zP(){}function VP(t,e,r){var n=t.l+e,i=Bb(t),l=t.read_shift(1),o=[i];if(o[2]=l,r.cellFormula){var u=dB(t,n-t.l,r);o[1]=u}else t.l=n;return o}function GP(t,e,r){var n=t.l+e,i=_l(t),l=[i];if(r.cellFormula){var o=pB(t,n-t.l,r);l[1]=o,t.l=n}else t.l=n;return l}function WP(t,e,r){r==null&&(r=pe(18));var n=Yh(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var H4=["left","right","top","bottom","header","footer"];function XP(t){var e={};return H4.forEach(function(r){e[r]=rn(t)}),e}function qP(t,e){return e==null&&(e=pe(48)),$s(t),H4.forEach(function(r){cl(t[r],e)}),e}function YP(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function KP(t,e,r){r==null&&(r=pe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $P(t){var e=pe(24);return e.write_shift(4,4),e.write_shift(4,1),Vc(t,e),e}function QP(t,e){return e==null&&(e=pe(66)),e.write_shift(2,t.password?Qg(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function ZP(){}function JP(){}function eU(t,e,r,n,i,l,o){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,y,E,w,S,N,I,C,z,X,W=[];u.biff=12,u["!row"]=0;var R=0,Q=!1,G=[],fe={},re=u.supbooks||i.supbooks||[[]];if(re.sharedf=fe,re.arrayf=G,re.SheetNames=i.SheetNames||i.Sheets.map(function(Me){return Me.name}),!u.supbooks&&(u.supbooks=re,i.Names))for(var K=0;K<i.Names.length;++K)re[0][K+1]=i.Names[K];var ye=[],Ie=[],Ce=!1;Ru[16]={n:"BrtShortReal",f:j4};var Y;if(Ei(t,function(Z,Le,U){if(!v)switch(U){case 148:d=Z;break;case 0:y=Z,u.sheetRows&&u.sheetRows<=y.r&&(v=!0),z=ur(S=y.r),u["!row"]=y.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=Rc(Z.hpt)),Ie[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:Z[2]},Z[2]){case"n":E.v=Z[1];break;case"s":C=nu[Z[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!Z[1];break;case"e":E.v=Z[1],u.cellText!==!1&&(E.w=Ti[E.v]);break;case"str":E.t="s",E.v=Z[1];break;case"is":E.t="s",E.v=Z[1].t;break}if((w=o.CellXf[Z[0].iStyleRef])&&B4(E,w.numFmtId,null,u,l,o),N=Z[0].c==-1?N+1:Z[0].c,u.dense?(h[S]||(h[S]=[]),h[S][N]=E):h[tr(N)+z]=E,u.cellFormula){for(Q=!1,R=0;R<G.length;++R){var k=G[R];y.r>=k[0].s.r&&y.r<=k[0].e.r&&N>=k[0].s.c&&N<=k[0].e.c&&(E.F=ot(k[0]),Q=!0)}!Q&&Z.length>3&&(E.f=Z[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>N&&(p.s.c=N),p.e.r<y.r&&(p.e.r=y.r),p.e.c<N&&(p.e.c=N),u.cellDates&&w&&E.t=="n"&&ml(Ye[w.numFmtId])){var P=ts(E.v);P&&(E.t="d",E.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}Y&&(Y.type=="XLDAPR"&&(E.D=!0),Y=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;E={t:"z",v:void 0},N=Z[0].c==-1?N+1:Z[0].c,u.dense?(h[S]||(h[S]=[]),h[S][N]=E):h[tr(N)+z]=E,p.s.r>y.r&&(p.s.r=y.r),p.s.c>N&&(p.s.c=N),p.e.r<y.r&&(p.e.r=y.r),p.e.c<N&&(p.e.c=N),Y&&(Y.type=="XLDAPR"&&(E.D=!0),Y=void 0);break;case 176:W.push(Z);break;case 49:Y=((u.xlmeta||{}).Cell||[])[Z-1];break;case 494:var M=n["!id"][Z.relId];for(M?(Z.Target=M.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=M):Z.relId==""&&(Z.Target="#"+Z.loc),S=Z.rfx.s.r;S<=Z.rfx.e.r;++S)for(N=Z.rfx.s.c;N<=Z.rfx.e.c;++N)u.dense?(h[S]||(h[S]=[]),h[S][N]||(h[S][N]={t:"z",v:void 0}),h[S][N].l=Z):(I=Je({c:N,r:S}),h[I]||(h[I]={t:"z",v:void 0}),h[I].l=Z);break;case 426:if(!u.cellFormula)break;G.push(Z),X=u.dense?h[S][N]:h[tr(N)+z],X.f=Jr(Z[1],p,{r:y.r,c:N},re,u),X.F=ot(Z[0]);break;case 427:if(!u.cellFormula)break;fe[Je(Z[0].s)]=Z[1],X=u.dense?h[S][N]:h[tr(N)+z],X.f=Jr(Z[1],p,{r:y.r,c:N},re,u);break;case 60:if(!u.cellStyles)break;for(;Z.e>=Z.s;)ye[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},Ce||(Ce=!0,Zg(Z.w/256)),ds(ye[Z.e+1]);break;case 161:h["!autofilter"]={ref:ot(Z)};break;case 476:h["!margins"]=Z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Z.name&&(i.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(h["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Le.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=ot(d||p)),u.sheetRows&&h["!ref"]){var ue=Et(h["!ref"]);u.sheetRows<=+ue.e.r&&(ue.e.r=u.sheetRows-1,ue.e.r>p.e.r&&(ue.e.r=p.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>p.e.c&&(ue.e.c=p.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),h["!fullref"]=h["!ref"],h["!ref"]=ot(ue))}return W.length>0&&(h["!merges"]=W),ye.length>0&&(h["!cols"]=ye),Ie.length>0&&(h["!rows"]=Ie),h}function tU(t,e,r,n,i,l,o){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=Xt(e),e.z=e.z||Ye[14],e.v=Nr(rr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var h={r,c:n};switch(h.s=_s(i.cellXfs,e,i),e.l&&l["!links"].push([Je(h),e.l]),e.c&&l["!comments"].push([Je(h),e.c]),e.t){case"s":case"str":return i.bookSST?(u=nx(i.Strings,e.v,i.revStrings),h.t="s",h.v=u,o?Se(t,18,yP(e,h)):Se(t,7,vP(e,h))):(h.t="str",o?Se(t,17,OP(e,h)):Se(t,6,DP(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Se(t,13,kP(e,h)):Se(t,2,bP(e,h)):o?Se(t,16,TP(e,h)):Se(t,5,EP(e,h)),!0;case"b":return h.t="b",o?Se(t,15,hP(e,h)):Se(t,4,uP(e,h)),!0;case"e":return h.t="e",o?Se(t,14,gP(e,h)):Se(t,3,mP(e,h)),!0}return o?Se(t,12,cP(e,h)):Se(t,1,sP(e,h)),!0}function rU(t,e,r,n){var i=Et(e["!ref"]||"A1"),l,o="",u=[];Se(t,145);var h=Array.isArray(e),d=i.e.r;e["!rows"]&&(d=Math.max(i.e.r,e["!rows"].length-1));for(var p=i.s.r;p<=d;++p){o=ur(p),JB(t,e,i,p);var x=!1;if(p<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){p===i.s.r&&(u[v]=tr(v)),l=u[v]+o;var y=h?(e[p]||[])[v]:e[l];if(!y){x=!1;continue}x=tU(t,y,p,v,n,e,x)}}Se(t,146)}function nU(t,e){!e||!e["!merges"]||(Se(t,177,UP(e["!merges"].length)),e["!merges"].forEach(function(r){Se(t,176,PP(r))}),Se(t,178))}function aU(t,e){!e||!e["!cols"]||(Se(t,390),e["!cols"].forEach(function(r,n){r&&Se(t,60,WP(n,r))}),Se(t,391))}function iU(t,e){!e||!e["!ref"]||(Se(t,648),Se(t,649,$P(Et(e["!ref"]))),Se(t,650))}function sU(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Pt(r,-1,n[1].Target.replace(/#.*$/,""),dt.HLINK);Se(t,494,HP(n,i))}}),delete e["!links"]}function lU(t,e,r,n){if(e["!comments"].length>0){var i=Pt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",dt.VML);Se(t,551,Gg("rId"+i)),e["!legacy"]=i}}function cU(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],l=typeof i.ref=="string"?i.ref:ot(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=pn(l);u.s.r==u.e.r&&(u.e.r=pn(e["!ref"]).e.r,l=ot(u));for(var h=0;h<o.length;++h){var d=o[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+l;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),Se(t,161,Vc(Et(l))),Se(t,162)}}function oU(t,e,r){Se(t,133),Se(t,137,KP(e,r)),Se(t,138),Se(t,134)}function uU(t,e){e["!protect"]&&Se(t,535,QP(e["!protect"]))}function fU(t,e,r,n){var i=Nn(),l=r.SheetNames[t],o=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var h=Et(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Se(i,129),(r.vbaraw||o["!outline"])&&Se(i,147,aP(u,o["!outline"])),Se(i,148,tP(h)),oU(i,o,r.Workbook),aU(i,o),rU(i,o,t,e),uU(i,o),cU(i,o,r,t),nU(i,o),sU(i,o,n),o["!margins"]&&Se(i,476,qP(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&iU(i,o),lU(i,o,t,n),Se(i,130),i.end()}function hU(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=kt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[e,i,n]}function dU(t,e,r,n,i,l){var o=l||{"!type":"chart"};if(!t)return l;var u=0,h=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=hU(x);p.s.r=p.s.c=0,p.e.c=u,d=tr(u),v[0].forEach(function(y,E){o[d+ur(E)]={t:"n",v:y,z:v[1]},h=E}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(o["!ref"]=ot(p)),o}function mU(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,u=t.match(P4);return u&&ax(u[0],l,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function pU(t,e){t.l+=10;var r=an(t);return{name:r}}function gU(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ei(t,function(h,d,p){switch(p){case 550:l["!rel"]=h;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),h.name&&(i.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var ix=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],vU=[],_U=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function _E(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var l=e[i];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=er(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function yE(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=er(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function z4(t){yE(t.WBProps,ix),yE(t.CalcPr,_U),_E(t.WBView,xU),_E(t.Sheets,vU),Tc.date1904=er(t.WBProps.date1904)}function yU(t){return!t.Workbook||!t.Workbook.WBProps?"false":er(t.Workbook.WBProps.date1904)?"true":"false"}var wU="][*?/\\".split("");function V4(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return wU.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function EU(t,e,r){t.forEach(function(n,i){V4(n);for(var l=0;l<i;++l)if(n==t[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function G4(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];EU(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)yB(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var TU=/<\w+:workbook/;function SU(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",l={},o=0;if(t.replace(ln,function(h,d){var p=rt(h);switch(Va(p[0])){case"<?xml":break;case"<workbook":h.match(TU)&&(i="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[i];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ix.forEach(function(x){if(p[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=er(p[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(p[x[0]],10);break;default:r.WBProps[x[0]]=p[x[0]]}}),p.codeName&&(r.WBProps.CodeName=Gt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=kt(Gt(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=Gt(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),er(p.hidden||"0")&&(l.Hidden=!0),o=d+h.length;break;case"</definedName>":l.Ref=kt(Gt(t.slice(o,d))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),pl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return z4(r),r}function W4(t){var e=[xr];e[e.length]=De("workbook",null,{xmlns:pl[0],"xmlns:r":Ar.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(ix.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=De("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],l=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",l=0;l!=t.SheetNames.length&&!(!i[l]||!i[l].Hidden);++l);l==t.SheetNames.length&&(l=0),e[e.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",l=0;l!=t.SheetNames.length;++l){var o={name:Ut(t.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),i[l])switch(i[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=De("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(e[e.length]=De("definedName",Ut(u.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function bU(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=vp(t),r.name=an(t),r}function CU(t,e){return e||(e=pe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Gg(t.strRelID,e),Ur(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function kU(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?an(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function AU(t,e){e||(e=pe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Mb(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function NU(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function DU(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),l=lF(t),o=mB(t,0,r),u=Vg(t);t.l=n;var h={Name:l,Ptg:o};return i<268435455&&(h.Sheet=i),u&&(h.Comment=u),h}function RU(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],Ru[16]={n:"BrtFRTArchID$",f:NU},Ei(t,function(h,d,p){switch(p){case 156:o.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=Jr(h.Ptg,null,null,o,e),delete e.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,h]):o[0]=[p,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(p),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),z4(r),r.Names=l,r.supbooks=o,r}function OU(t,e){Se(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Se(t,156,CU(i))}Se(t,144)}function FU(t,e){e||(e=pe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ur("SheetJS",e),Ur(yu.version,e),Ur(yu.version,e),Ur("7262",e),e.length>e.l?e.slice(0,e.l):e}function IU(t,e){e||(e=pe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function MU(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&l==-1&&(l=n);l>i||(Se(t,135),Se(t,158,IU(i)),Se(t,136))}}function LU(t,e){var r=Nn();return Se(r,131),Se(r,128,FU()),Se(r,153,AU(t.Workbook&&t.Workbook.WBProps||null)),MU(r,t),OU(r,t),Se(r,132),r.end()}function BU(t,e,r){return e.slice(-4)===".bin"?RU(t,r):SU(t,r)}function PU(t,e,r,n,i,l,o,u){return e.slice(-4)===".bin"?eU(t,n,r,i,l,o,u):RB(t,n,r,i,l,o,u)}function UU(t,e,r,n,i,l,o,u){return e.slice(-4)===".bin"?gU(t,n,r,i,l):mU(t,n,r,i,l)}function jU(t,e,r,n,i,l,o,u){return e.slice(-4)===".bin"?V7():G7()}function HU(t,e,r,n,i,l,o,u){return e.slice(-4)===".bin"?H7():z7()}function zU(t,e,r,n){return e.slice(-4)===".bin"?PL(t,r,n):CL(t,r,n)}function VU(t,e,r){return S4(t,r)}function GU(t,e,r){return e.slice(-4)===".bin"?WM(t,r):zM(t,r)}function WU(t,e,r){return e.slice(-4)===".bin"?L7(t,r):k7(t,r)}function XU(t,e,r){return e.slice(-4)===".bin"?S7(t):E7(t)}function qU(t,e,r,n){return r.slice(-4)===".bin"?b7(t,e,r,n):void 0}function YU(t,e,r){return e.slice(-4)===".bin"?_7(t,e,r):w7(t,e,r)}function KU(t,e,r){return(e.slice(-4)===".bin"?LU:W4)(t)}function $U(t,e,r,n,i){return(e.slice(-4)===".bin"?fU:U4)(t,r,n,i)}function QU(t,e,r){return(e.slice(-4)===".bin"?YL:E4)(t,r)}function ZU(t,e,r){return(e.slice(-4)===".bin"?YM:m4)(t,r)}function JU(t,e,r){return(e.slice(-4)===".bin"?B7:k4)(t)}function ej(t){return(t.slice(-4)===".bin"?y7:b4)()}var X4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,q4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ga(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(X4),l,o,u,h;if(i)for(h=0;h!=i.length;++h)l=i[h].match(q4),(o=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(o+1),n[u]=l[2].slice(1,l[2].length-1));return n}function tj(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(X4),i,l,o,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(q4),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),r[o]=i[2].slice(1,i[2].length-1));return r}var iu;function rj(t,e){var r=iu[t]||kt(t);return r==="General"?sl(e):Vn(r,e)}function nj(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=er(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=rr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[kt(e)]=i}function aj(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ti[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Eu(t.v):t.w=sl(t.v):t.w=rj(e||"General",t.v)}catch(l){if(r.WTF)throw l}try{var n=iu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&ml(n)){var i=ts(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(l){if(r.WTF)throw l}}}function ij(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=vL[n.Pattern]||n.Pattern)}t[e.ID]=e}function sj(t,e,r,n,i,l,o,u,h,d){var p="General",x=n.StyleID,v={};d=d||{};var y=[],E=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);l[x]!==void 0&&(l[x].nf&&(p=l[x].nf),l[x].Interior&&y.push(l[x].Interior),!!l[x].Parent);)x=l[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=er(t);break;case"String":n.t="s",n.r=Bw(kt(t)),n.v=t.indexOf("<")>-1?kt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(rr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=kt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jb[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Bw(e||t));break}if(aj(n,p,d),d.cellFormula!==!1)if(n.Formula){var w=kt(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=Ec(w,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ec("RC:RC",i):n.ArrayRange&&(n.F=Ec(n.ArrayRange,i),h.push([Et(n.F),n.F]))}else for(E=0;E<h.length;++E)i.r>=h[E][0].s.r&&i.r<=h[E][0].e.r&&i.c>=h[E][0].s.c&&i.c<=h[E][0].e.c&&(n.F=h[E][1]);d.cellStyles&&(y.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function lj(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Lm(t,e){var r=e||{};jc();var n=hc(Fg(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof St<"u"?n=St.utils.decode(65001,lh(n)):n=Gt(n));var i=n.slice(0,1024).toLowerCase(),l=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Xt(r);return o.type="string",Dc.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Pe){i.indexOf("<"+Pe)>=0&&(l=!0)}),l)return Vj(n,r);iu={"General Number":"General","General Date":Ye[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ye[15],"Short Date":Ye[14],"Long Time":Ye[19],"Medium Time":Ye[18],"Short Time":Ye[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ye[2],Standard:Ye[4],Percent:Ye[10],Scientific:Ye[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,p={},x=[],v=r.dense?[]:{},y="",E={},w={},S=ga('<Data ss:Type="String">'),N=0,I=0,C=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},W={},R="",Q=0,G=[],fe={},re={},K=0,ye=[],Ie=[],Ce={},Y=[],ue,Me=!1,Z=[],Le=[],U={},k=0,P=0,M={Sheets:[],WBProps:{date1904:!1}},j={};bu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";u=bu.exec(n);)switch(u[3]=(ee=u[3]).toLowerCase()){case"data":if(ee=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?sj(n.slice(N,u.index),R,S,h[h.length-1][0]=="comment"?Ce:E,{c:I,r:C},X,Y[I],w,Z,r):(R="",S=ga(u[0]),N=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ie.length>0&&(E.c=Ie),(!r.sheetRows||r.sheetRows>C)&&E.v!==void 0&&(r.dense?(v[C]||(v[C]=[]),v[C][I]=E):v[tr(I)+ur(C)]=E),E.HRef&&(E.l={Target:kt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(k=I+(parseInt(E.MergeAcross,10)|0),P=C+(parseInt(E.MergeDown,10)|0),G.push({s:{c:I,r:C},e:{c:k,r:P}})),!r.sheetStubs)E.MergeAcross?I=k+1:++I;else if(E.MergeAcross||E.MergeDown){for(var xe=I;xe<=k;++xe)for(var Te=C;Te<=P;++Te)(xe>I||Te>C)&&(r.dense?(v[Te]||(v[Te]=[]),v[Te][xe]={t:"z"}):v[tr(xe)+ur(Te)]={t:"z"});I=k+1}else++I;else E=tj(u[0]),E.Index&&(I=+E.Index-1),I<z.s.c&&(z.s.c=I),I>z.e.c&&(z.e.c=I),u[0].slice(-2)==="/>"&&++I,Ie=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<z.s.r&&(z.s.r=C),C>z.e.r&&(z.e.r=C),u[0].slice(-2)==="/>"&&(w=ga(u[0]),w.Index&&(C=+w.Index-1)),I=0,++C):(w=ga(u[0]),w.Index&&(C=+w.Index-1),U={},(w.AutoFitHeight=="0"||w.Height)&&(U.hpx=parseInt(w.Height,10),U.hpt=Du(U.hpx),Le[C]=U),w.Hidden=="1"&&(U.hidden=!0,Le[C]=U));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(y),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(v["!ref"]=ot(z),r.sheetRows&&r.sheetRows<=z.e.r&&(v["!fullref"]=v["!ref"],z.e.r=r.sheetRows-1,v["!ref"]=ot(z))),G.length&&(v["!merges"]=G),Y.length>0&&(v["!cols"]=Y),Le.length>0&&(v["!rows"]=Le),p[y]=v}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=I=0,h.push([u[3],!1]),d=ga(u[0]),y=kt(d.Name),v=r.dense?[]:{},G=[],Z=[],Le=[],j={name:y,Hidden:0},M.Sheets.push(j);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),Y=[],Me=!1}break;case"style":u[1]==="/"?ij(X,W,r):W=ga(u[0]);break;case"numberformat":W.nf=kt(ga(u[0]).Format||"General"),iu[W.nf]&&(W.nf=iu[W.nf]);for(var me=0;me!=392&&Ye[me]!=W.nf;++me);if(me==392){for(me=57;me!=392;++me)if(Ye[me]==null){Ua(W.nf,me);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ue=ga(u[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!Me&&ue.wpx>10){Me=!0,tn=y4;for(var we=0;we<Y.length;++we)Y[we]&&ds(Y[we])}Me&&ds(ue),Y[ue.Index-1||Y.length]=ue;for(var $e=0;$e<+ue.Span;++$e)Y[Y.length]=Xt(ue);break;case"namedrange":if(u[1]==="/")break;M.Names||(M.Names=[]);var H=rt(u[0]),At={Name:H.Name,Ref:Ec(H.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(At.Sheet=M.Sheets.length-1),M.Names.push(At);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?R+=n.slice(Q,u.index):Q=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=ga(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?OF(fe,ee,n.slice(K,u.index)):K=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));lj(Ce),Ie.push(Ce)}else h.push([u[3],!1]),d=ga(u[0]),Ce={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var at=ga(u[0]);v["!autofilter"]={ref:Ec(at.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return bE(n,r);var be=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:be=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:be=!1}break;case"excelworkbook":switch(u[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:be=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:be=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(K,u.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else K=u.index+u[0].length;break;case"header":v["!margins"]||$s(v["!margins"]={},"xlml"),isNaN(+rt(u[0]).Margin)||(v["!margins"].header=+rt(u[0]).Margin);break;case"footer":v["!margins"]||$s(v["!margins"]={},"xlml"),isNaN(+rt(u[0]).Margin)||(v["!margins"].footer=+rt(u[0]).Margin);break;case"pagemargins":var de=rt(u[0]);v["!margins"]||$s(v["!margins"]={},"xlml"),isNaN(+de.Top)||(v["!margins"].top=+de.Top),isNaN(+de.Left)||(v["!margins"].left=+de.Left),isNaN(+de.Right)||(v["!margins"].right=+de.Right),isNaN(+de.Bottom)||(v["!margins"].bottom=+de.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:be=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:be=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:be=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:be=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:be=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:be=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:be=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:be=!1}break;case"smarttags":break;default:be=!1;break}if(be||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?nj(re,ee,ye,n.slice(K,u.index)):(ye=u,K=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var te={};return!r.bookSheets&&!r.bookProps&&(te.Sheets=p),te.SheetNames=x,te.Workbook=M,te.SSF=Xt(Ye),te.Props=fe,te.Custprops=re,te}function bp(t,e){switch(cx(e=e||{}),e.type||"base64"){case"base64":return Lm(zn(t),e);case"binary":case"buffer":case"file":return Lm(t,e);case"array":return Lm(xs(t),e)}}function cj(t,e){var r=[];return t.Props&&r.push(FF(t.Props,e)),t.Custprops&&r.push(IF(t.Props,t.Custprops)),r.join("")}function oj(){return""}function uj(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var l=[];l.push(De("NumberFormat",null,{"ss:Format":Ut(Ye[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(De("Style",l.join(""),o))}),De("Styles",r.join(""))}function Y4(t){return De("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+tx(t.Ref,{r:0,c:0})})}function fj(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Y4(i)))}return De("Names",r.join(""))}function hj(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,l=[],o=0;o<i.length;++o){var u=i[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(Y4(u)))}return l.join("")}function dj(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(De("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(De("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(De("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(De("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(qr("ProtectContents","True")),t["!protect"].objects&&i.push(qr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(qr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(qr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(qr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":De("WorksheetOptions",i.join(""),{xmlns:Pn.x})}function mj(t){return t.map(function(e){var r=LO(e.t||""),n=De("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return De("Comment",n,{"ss:Author":e.a})}).join("")}function pj(t,e,r,n,i,l,o){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+Ut(tx(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var h=sr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=Ut(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=Ut(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],p=0;p!=d.length;++p)d[p].s.c!=o.c||d[p].s.r!=o.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var x="",v="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":x="Number",v=String(t.v);break;case"b":x="Boolean",v=t.v?"1":"0";break;case"e":x="Error",v=Ti[t.v];break;case"d":x="DateTime",v=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ye[14]);break;case"s":x="String",v=MO(t.v||"");break}var y=_s(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+y),u["ss:Index"]=o.c+1;var E=t.v!=null?v:"",w=t.t=="z"?"":'<Data ss:Type="'+x+'">'+E+"</Data>";return(t.c||[]).length>0&&(w+=mj(t.c)),De("Cell",w,u)}function gj(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Rc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function xj(t,e,r,n){if(!t["!ref"])return"";var i=Et(t["!ref"]),l=t["!merges"]||[],o=0,u=[];t["!cols"]&&t["!cols"].forEach(function(S,N){ds(S);var I=!!S.width,C=Yh(N,S),z={"ss:Index":N+1};I&&(z["ss:Width"]=Au(C.width)),S.hidden&&(z["ss:Hidden"]="1"),u.push(De("Column",null,z))});for(var h=Array.isArray(t),d=i.s.r;d<=i.e.r;++d){for(var p=[gj(d,(t["!rows"]||[])[d])],x=i.s.c;x<=i.e.c;++x){var v=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>x)&&!(l[o].s.r>d)&&!(l[o].e.c<x)&&!(l[o].e.r<d)){(l[o].s.c!=x||l[o].s.r!=d)&&(v=!0);break}if(!v){var y={r:d,c:x},E=Je(y),w=h?(t[d]||[])[x]:t[E];p.push(pj(w,E,t,e,r,n,y))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function vj(t,e,r){var n=[],i=r.SheetNames[t],l=r.Sheets[i],o=l?hj(l,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=l?xj(l,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(dj(l,e,t,r)),n.join("")}function _j(t,e){e||(e={}),t.SSF||(t.SSF=Xt(Ye)),t.SSF&&(jc(),Yu(t.SSF),e.revssf=zh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],_s(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(cj(t,e)),r.push(oj()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(De("Worksheet",vj(n,e,t),{"ss:Name":Ut(t.SheetNames[n])}));return r[2]=uj(t,e),r[3]=fj(t),xr+De("Workbook",r.join(""),{xmlns:Pn.ss,"xmlns:o":Pn.o,"xmlns:x":Pn.x,"xmlns:ss":Pn.ss,"xmlns:dt":Pn.dt,"xmlns:html":Pn.html})}function yj(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=hF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=dF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var wj=[60,1084,2066,2165,2175];function Ej(t,e,r,n,i){var l=n,o=[],u=r.slice(r.l,r.l+l);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}o.push(u),r.l+=l;for(var h=hi(r,r.l),d=Cp[h],p=0;d!=null&&wj.indexOf(h)>-1;)l=hi(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+l),o.push(u),r.l+=4+l,d=Cp[h=hi(r,r.l)];var x=Pr(o);Xr(x,0);var v=0;x.lens=[];for(var y=0;y<o.length;++y)x.lens.push(v),v+=o[y].length;if(x.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,i)}function Oa(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ye[n])}catch(l){if(e.WTF)throw l}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ti[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Eu(t.v):t.w=sl(t.v):t.w=Vn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(l){if(e.WTF)throw l}if(e.cellDates&&n&&t.t=="n"&&ml(Ye[n]||String(n))){var i=ts(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function R0(t,e,r){return{v:t,ixfe:e,t:r}}function Tj(t,e){var r={opts:{}},n={},i=e.dense?[]:{},l={},o={},u=null,h=[],d="",p={},x,v="",y,E,w,S,N={},I=[],C,z,X=[],W=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Q={},G=function(qe){return qe<8?qs[qe]:qe<64&&W[qe-8]||qs[qe]},fe=function(qe,Ct,Dr){var gt=Ct.XF.data;if(!(!gt||!gt.patternType||!Dr||!Dr.cellStyles)){Ct.s={},Ct.s.patternType=gt.patternType;var dr;(dr=ku(G(gt.icvFore)))&&(Ct.s.fgColor={rgb:dr}),(dr=ku(G(gt.icvBack)))&&(Ct.s.bgColor={rgb:dr})}},re=function(qe,Ct,Dr){if(!(U>1)&&!(Dr.sheetRows&&qe.r>=Dr.sheetRows)){if(Dr.cellStyles&&Ct.XF&&Ct.XF.data&&fe(qe,Ct,Dr),delete Ct.ixfe,delete Ct.XF,x=qe,v=Je(qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),qe.r<o.s.r&&(o.s.r=qe.r),qe.c<o.s.c&&(o.s.c=qe.c),qe.r+1>o.e.r&&(o.e.r=qe.r+1),qe.c+1>o.e.c&&(o.e.c=qe.c+1),Dr.cellFormula&&Ct.f){for(var gt=0;gt<I.length;++gt)if(!(I[gt][0].s.c>qe.c||I[gt][0].s.r>qe.r)&&!(I[gt][0].e.c<qe.c||I[gt][0].e.r<qe.r)){Ct.F=ot(I[gt][0]),(I[gt][0].s.c!=qe.c||I[gt][0].s.r!=qe.r)&&delete Ct.f,Ct.f&&(Ct.f=""+Jr(I[gt][1],o,qe,Z,K));break}}Dr.dense?(i[qe.r]||(i[qe.r]=[]),i[qe.r][qe.c]=Ct):i[v]=Ct}},K={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(K.password=e.password);var ye,Ie=[],Ce=[],Y=[],ue=[],Me=!1,Z=[];Z.SheetNames=K.snames,Z.sharedf=K.sharedf,Z.arrayf=K.arrayf,Z.names=[],Z.XTI=[];var Le=0,U=0,k=0,P=[],M=[],j;K.codepage=1200,ca(1200);for(var ee=!1;t.l<t.length-1;){var xe=t.l,Te=t.read_shift(2);if(Te===0&&Le===10)break;var me=t.l===t.length?0:t.read_shift(2),we=Cp[Te];if(we&&we.f){if(e.bookSheets&&Le===133&&Te!==133)break;if(Le=Te,we.r===2||we.r==12){var $e=t.read_shift(2);if(me-=2,!K.enc&&$e!==Te&&(($e&255)<<8|$e>>8)!==Te)throw new Error("rt mismatch: "+$e+"!="+Te);we.r==12&&(t.l+=10,me-=10)}var H={};if(Te===10?H=we.f(t,me,K):H=Ej(Te,we,t,me,K),U==0&&[9,521,1033,2057].indexOf(Le)===-1)continue;switch(Te){case 34:r.opts.Date1904=R.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(K.enc||(t.l=0),K.enc=H,!e.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:K.lastuser=H;break;case 66:var At=Number(H);switch(At){case 21010:At=1200;break;case 32768:At=1e4;break;case 32769:At=1252;break}ca(K.codepage=At),ee=!0;break;case 317:K.rrtabid=H;break;case 25:K.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:K.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:X.push(H);break;case 430:Z.push([H]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(H);break;case 24:case 536:j={Name:H.Name,Ref:Jr(H.rgce,o,null,Z,K)},H.itab>0&&(j.Sheet=H.itab-1),Z.names.push(j),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(M[H.itab-1]={ref:ot(H.rgce[0][0][1][2])});break;case 22:K.ExternCount=H;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(H),Z.XTI=Z.XTI.concat(H);break;case 2196:if(K.biff<8)break;j!=null&&(j.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&K.WTF&&console.error("Password verifier: "+H);break;case 133:l[H.pos]=H,K.snames.push(H.name);break;case 10:{if(--U)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=ot(o),e.sheetRows&&e.sheetRows<=o.e.r){var at=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=ot(o),o.e.r=at}o.e.r++,o.e.c++}Ie.length>0&&(i["!merges"]=Ie),Ce.length>0&&(i["!objects"]=Ce),Y.length>0&&(i["!cols"]=Y),ue.length>0&&(i["!rows"]=ue),R.Sheets.push(Q)}d===""?p=i:n[d]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(K.biff===8&&(K.biff={9:2,521:3,1033:4}[Te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),K.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(K.biff=5,ee=!0,ca(K.codepage=28591)),K.biff==8&&H.BIFFVer==0&&H.dt==16&&(K.biff=2),U++)break;if(i=e.dense?[]:{},K.biff<8&&!ee&&(ee=!0,ca(K.codepage=e.codepage||1252)),K.biff<5||H.BIFFVer==0&&H.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var be={pos:t.l-me,name:d};l[be.pos]=be,K.snames.push(d)}else d=(l[xe]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),Ie=[],Ce=[],K.arrayf=I=[],Y=[],ue=[],Me=!1,Q={Hidden:(l[xe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[H.r]||[])[H.c]:i[Je({c:H.c,r:H.r})])&&++H.c,C={ixfe:H.ixfe,XF:X[H.ixfe]||{},v:H.val,t:"n"},k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re({c:H.c,r:H.r},C,e);break;case 5:case 517:C={ixfe:H.ixfe,XF:X[H.ixfe],v:H.val,t:H.t},k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re({c:H.c,r:H.r},C,e);break;case 638:C={ixfe:H.ixfe,XF:X[H.ixfe],v:H.rknum,t:"n"},k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re({c:H.c,r:H.r},C,e);break;case 189:for(var de=H.c;de<=H.C;++de){var te=H.rkrec[de-H.c][0];C={ixfe:te,XF:X[te],v:H.rkrec[de-H.c][1],t:"n"},k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re({c:de,r:H.r},C,e)}break;case 6:case 518:case 1030:{if(H.val=="String"){u=H;break}if(C=R0(H.val,H.cell.ixfe,H.tt),C.XF=X[C.ixfe],e.cellFormula){var Pe=H.formula;if(Pe&&Pe[0]&&Pe[0][0]&&Pe[0][0][0]=="PtgExp"){var Ge=Pe[0][0][1][0],bt=Pe[0][0][1][1],vr=Je({r:Ge,c:bt});N[vr]?C.f=""+Jr(H.formula,o,H.cell,Z,K):C.F=((e.dense?(i[Ge]||[])[bt]:i[vr])||{}).F}else C.f=""+Jr(H.formula,o,H.cell,Z,K)}k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re(H.cell,C,e),u=H}break;case 7:case 519:if(u)u.val=H,C=R0(H,u.cell.ixfe,"s"),C.XF=X[C.ixfe],e.cellFormula&&(C.f=""+Jr(u.formula,o,u.cell,Z,K)),k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re(u.cell,C,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(H);var cn=Je(H[0].s);if(y=e.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[cn],e.cellFormula&&y){if(!u||!cn||!y)break;y.f=""+Jr(H[1],o,H[0],Z,K),y.F=ot(H[0])}}break;case 1212:{if(!e.cellFormula)break;if(v){if(!u)break;N[Je(u.cell)]=H[0],y=e.dense?(i[u.cell.r]||[])[u.cell.c]:i[Je(u.cell)],(y||{}).f=""+Jr(H[0],o,x,Z,K)}}break;case 253:C=R0(h[H.isst].t,H.ixfe,"s"),h[H.isst].h&&(C.h=h[H.isst].h),C.XF=X[C.ixfe],k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re({c:H.c,r:H.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:H.ixfe,XF:X[H.ixfe],t:"z"},k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re({c:H.c,r:H.r},C,e));break;case 190:if(e.sheetStubs)for(var Yr=H.c;Yr<=H.C;++Yr){var Ot=H.ixfe[Yr-H.c];C={ixfe:Ot,XF:X[Ot],t:"z"},k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re({c:Yr,r:H.r},C,e)}break;case 214:case 516:case 4:C=R0(H.val,H.ixfe,"s"),C.XF=X[C.ixfe],k>0&&(C.z=P[C.ixfe>>8&63]),Oa(C,e,r.opts.Date1904),re({c:H.c,r:H.r},C,e);break;case 0:case 512:U===1&&(o=H);break;case 252:h=H;break;case 1054:if(K.biff==4){P[k++]=H[1];for(var Oe=0;Oe<k+163&&Ye[Oe]!=H[1];++Oe);Oe>=163&&Ua(H[1],k+163)}else Ua(H[1],H[0]);break;case 30:{P[k++]=H;for(var Ve=0;Ve<k+163&&Ye[Ve]!=H;++Ve);Ve>=163&&Ua(H,k+163)}break;case 229:Ie=Ie.concat(H);break;case 93:Ce[H.cmo[0]]=K.lastobj=H;break;case 438:K.lastobj.TxO=H;break;case 127:K.lastobj.ImData=H;break;case 440:for(S=H[0].s.r;S<=H[0].e.r;++S)for(w=H[0].s.c;w<=H[0].e.c;++w)y=e.dense?(i[S]||[])[w]:i[Je({c:w,r:S})],y&&(y.l=H[1]);break;case 2048:for(S=H[0].s.r;S<=H[0].e.r;++S)for(w=H[0].s.c;w<=H[0].e.c;++w)y=e.dense?(i[S]||[])[w]:i[Je({c:w,r:S})],y&&y.l&&(y.l.Tooltip=H[1]);break;case 28:{if(K.biff<=5&&K.biff>=2)break;y=e.dense?(i[H[0].r]||[])[H[0].c]:i[Je(H[0])];var Qe=Ce[H[2]];y||(e.dense?(i[H[0].r]||(i[H[0].r]=[]),y=i[H[0].r][H[0].c]={t:"z"}):y=i[Je(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),y.c||(y.c=[]),E={a:H[1],t:Qe.TxO.t},y.c.push(E)}break;case 2173:f7(X[H.ixfe],H.ext);break;case 125:{if(!K.cellStyles)break;for(;H.e>=H.s;)Y[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},Me||(Me=!0,Zg(H.w/256)),ds(Y[H.e+1])}break;case 520:{var tt={};H.level!=null&&(ue[H.r]=tt,tt.level=H.level),H.hidden&&(ue[H.r]=tt,tt.hidden=!0),H.hpt&&(ue[H.r]=tt,tt.hpt=H.hpt,tt.hpx=Rc(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||$s(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Te]]=H;break;case 161:i["!margins"]||$s(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(R.Views[0].RTL=!0);break;case 146:W=H;break;case 2198:ye=H;break;case 140:z=H;break;case 442:d?Q.CodeName=H||Q.name:R.WBProps.CodeName=H||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+Te.toString(16)),t.l+=me}return r.SheetNames=hr(l).sort(function(Ze,qe){return Number(Ze)-Number(qe)}).map(function(Ze){return l[Ze].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&M.forEach(function(Ze,qe){r.Sheets[r.SheetNames[qe]]["!autofilter"]=Ze}),r.Strings=h,r.SSF=Xt(Ye),K.enc&&(r.Encryption=K.enc),ye&&(r.Themes=ye),r.Metadata={},z!==void 0&&(r.Metadata.Country=z),Z.names.length>0&&(R.Names=Z.names),r.Workbook=R,r}var su={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Sj(t,e,r){var n=We.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=tE(n,_p,su.DSI);for(var l in i)e[l]=i[l]}catch(d){if(r.WTF)throw d}var o=We.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var u=tE(o,yp,su.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(Xb(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function bj(t,e){var r=[],n=[],i=[],l=0,o,u=Rw(_p,"n"),h=Rw(yp,"n");if(t.Props)for(o=hr(t.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?n:i).push([o[l],t.Props[o[l]]]);if(t.Custprops)for(o=hr(t.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(t.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?n:i).push([o[l],t.Custprops[o[l]]]);var d=[];for(l=0;l<i.length;++l)Jb.indexOf(i[l][0])>-1||Wb.indexOf(i[l][0])>-1||i[l][1]!=null&&d.push(i[l]);n.length&&We.utils.cfb_add(e,"/SummaryInformation",rE(n,su.SI,h,yp)),(r.length||d.length)&&We.utils.cfb_add(e,"/DocumentSummaryInformation",rE(r,su.DSI,u,_p,d.length?d:null,su.UDI))}function sx(t,e){e||(e={}),cx(e),jh(),e.codepage&&Uh(e.codepage);var r,n;if(t.FullPaths){if(We.find(t,"/encryption"))throw new Error("File is password-protected");r=We.find(t,"!CompObj"),n=We.find(t,"/Workbook")||We.find(t,"/Book")}else{switch(e.type){case"base64":t=Un(zn(t));break;case"binary":t=Un(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Xr(t,0),n={content:t}}var i,l;if(r&&yj(r),e.bookProps&&!e.bookSheets)i={};else{var o=ht?"buffer":"array";if(n&&n.content)i=Tj(n.content,e);else if((l=We.find(t,"PerfectOffice_MAIN"))&&l.content)i=Ks.to_workbook(l.content,(e.type=o,e));else if((l=We.find(t,"NativeContent_MAIN"))&&l.content)i=Ks.to_workbook(l.content,(e.type=o,e));else throw(l=We.find(t,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&We.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=U7(t))}var u={};return t.FullPaths&&Sj(t,u,e),i.Props=i.Custprops=u,e.bookFiles&&(i.cfb=t),i}function Cj(t,e){var r=e||{},n=We.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return We.utils.cfb_add(n,i,K4(t,r)),r.biff==8&&(t.Props||t.Custprops)&&bj(t,n),r.biff==8&&t.vbaraw&&j7(n,We.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Ru={0:{f:QB},1:{f:iP},2:{f:SP},3:{f:dP},4:{f:oP},5:{f:wP},6:{f:NP},7:{f:xP},8:{f:LP},9:{f:MP},10:{f:FP},11:{f:IP},12:{f:lP},13:{f:CP},14:{f:pP},15:{f:fP},16:{f:j4},17:{f:RP},18:{f:_P},19:{f:zg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:DU},40:{},42:{},43:{f:NL},44:{f:kL},45:{f:OL},46:{f:IL},47:{f:FL},48:{},49:{f:eF},50:{},51:{f:m7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:u4},62:{f:AP},63:{f:T7},64:{f:ZP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:sn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:YP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:nP},148:{f:eP,p:16},151:{f:zP},152:{},153:{f:kU},154:{},155:{},156:{f:bU},157:{},158:{},159:{T:1,f:GM},160:{T:-1},161:{T:1,f:_l},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:BP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:h7},336:{T:-1},337:{f:x7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:vp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:o4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:VP},427:{f:GP},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:XP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:rP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:jP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:vp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:I7},633:{T:1},634:{T:-1},635:{T:1,f:O7},636:{T:-1},637:{f:aF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:JP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Cp={6:{f:Im},10:{f:Ki},12:{f:br},13:{f:br},14:{f:gr},15:{f:gr},16:{f:rn},17:{f:gr},18:{f:gr},19:{f:br},20:{f:cE},21:{f:cE},23:{f:o4},24:{f:uE},25:{f:gr},26:{},27:{},28:{f:JI},29:{},34:{f:gr},35:{f:oE},38:{f:rn},39:{f:rn},40:{f:rn},41:{f:rn},42:{f:gr},43:{f:gr},47:{f:fL},49:{f:CI},51:{f:br},60:{},61:{f:wI},64:{f:gr},65:{f:bI},66:{f:br},77:{},80:{},81:{},82:{},85:{f:br},89:{},90:{},91:{},92:{f:uI},93:{f:rM},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:u4},128:{f:HI},129:{f:hI},130:{f:br},131:{f:gr},132:{f:gr},133:{f:dI},134:{},140:{f:uM},141:{f:br},144:{},146:{f:dM},151:{},152:{},153:{},154:{},155:{},156:{f:br},157:{},158:{},160:{f:yM},161:{f:gM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:BI},190:{f:PI},193:{f:Ki},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:br},220:{},221:{f:gr},222:{},224:{f:jI},225:{f:oI},226:{f:Ki},227:{},229:{f:eM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pI},253:{f:AI},255:{f:xI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:e4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:Ki},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:XI},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:iM},439:{f:gr},440:{f:sM},441:{},442:{f:Qu},443:{},444:{f:br},445:{},446:{},448:{f:Ki},449:{f:yI,r:2},450:{f:Ki},512:{f:iE},513:{f:_M},515:{f:GI},516:{f:DI},517:{f:lE},519:{f:wM},520:{f:vI},523:{},545:{f:fE},549:{f:aE},566:{},574:{f:TI},638:{f:LI},659:{},1048:{},1054:{f:OI},1084:{},1212:{f:$I},2048:{f:cM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:A0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ki},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mM,r:12},2173:{f:u7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:KI,r:12},2197:{},2198:{f:a7,r:12},2199:{},2200:{},2201:{},2202:{f:QI,r:12},2203:{f:Ki},2204:{},2205:{},2206:{},2207:{},2211:{f:_I},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:br},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:xM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:hM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:iE},1:{},2:{f:CM},3:{f:SM},4:{f:TM},5:{f:lE},7:{f:AM},8:{},9:{f:A0},11:{},22:{f:br},30:{f:II},31:{},32:{},33:{f:fE},36:{},37:{f:aE},50:{f:NM},62:{},52:{},67:{},68:{f:br},69:{},86:{},126:{},127:{f:EM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:DM},223:{},234:{},354:{},421:{},518:{f:Im},521:{f:A0},536:{f:uE},547:{f:oE},561:{},579:{},1030:{f:Im},1033:{f:A0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Fe(t,e,r,n){var i=e;if(!isNaN(i)){var l=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,l),l>0&&Ug(r)&&t.push(r)}}function kj(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Fe(t,e,r,i);var l=e;if(!isNaN(l)){for(var o=r.parts||[],u=0,h=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var p=t.next(4);for(p.write_shift(2,l),p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d;h<i;){for(p=t.next(4),p.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d}}}function tf(t,e,r){return t||(t=pe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Aj(t,e,r,n){var i=pe(9);return tf(i,t,e),t4(r,n||"b",i),i}function Nj(t,e,r){var n=pe(8+2*r.length);return tf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Dj(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Nr(rr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Fe(t,2,kM(r,n,i)):Fe(t,3,bM(r,n,i));return;case"b":case"e":Fe(t,5,Aj(r,n,e.v,e.t));return;case"s":case"str":Fe(t,4,Nj(r,n,(e.v||"").slice(0,255)));return}Fe(t,1,tf(null,r,n))}function Rj(t,e,r,n){var i=Array.isArray(e),l=Et(e["!ref"]||"A1"),o,u="",h=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=ot(l)}for(var d=l.s.r;d<=l.e.r;++d){u=ur(d);for(var p=l.s.c;p<=l.e.c;++p){d===l.s.r&&(h[p]=tr(p)),o=h[p]+u;var x=i?(e[d]||[])[p]:e[o];x&&Dj(t,x,d,p)}}}function Oj(t,e){for(var r=e||{},n=Nn(),i=0,l=0;l<t.SheetNames.length;++l)t.SheetNames[l]==r.sheet&&(i=l);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Fe(n,r.biff==4?1033:r.biff==3?521:9,Kg(t,16,r)),Rj(n,t.Sheets[t.SheetNames[i]],i,r),Fe(n,10),n.end()}function Fj(t,e,r){Fe(t,49,kI({sz:12,name:"Arial"},r))}function Ij(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Fe(t,1054,FI(i,e[i],r))})}function Mj(t,e){var r=pe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Fe(t,2151,r),r=pe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),s4(Et(e["!ref"]||"A1"),r),r.write_shift(4,4),Fe(t,2152,r)}function Lj(t,e){for(var r=0;r<16;++r)Fe(t,224,sE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Fe(t,224,sE(n,0,e))})}function Bj(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Fe(t,440,lM(n)),n[1].Tooltip&&Fe(t,2048,oM(n))}delete e["!links"]}function Pj(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Fe(t,125,pM(Yh(i,n),i))})}}function Uj(t,e,r,n,i){var l=16+_s(i.cellXfs,e,i);if(e.v==null&&!e.bf){Fe(t,513,ul(r,n,l));return}if(e.bf)Fe(t,6,hB(e,r,n,i,l));else switch(e.t){case"d":case"n":var o=e.t=="d"?Nr(rr(e.v)):e.v;Fe(t,515,WI(r,n,o,l));break;case"b":case"e":Fe(t,517,VI(r,n,e.v,l,i,e.t));break;case"s":case"str":if(i.bookSST){var u=nx(i.Strings,e.v,i.revStrings);Fe(t,253,NI(r,n,u,l))}else Fe(t,516,RI(r,n,(e.v||"").slice(0,255),l,i));break;default:Fe(t,513,ul(r,n,l))}}function jj(t,e,r){var n=Nn(),i=r.SheetNames[t],l=r.Sheets[i]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[t]||{},h=Array.isArray(l),d=e.biff==8,p,x="",v=[],y=Et(l["!ref"]||"A1"),E=d?65536:16384;if(y.e.c>255||y.e.r>=E){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,E-1)}Fe(n,2057,Kg(r,16,e)),Fe(n,13,la(1)),Fe(n,12,la(100)),Fe(n,15,dn(!0)),Fe(n,17,dn(!1)),Fe(n,16,cl(.001)),Fe(n,95,dn(!0)),Fe(n,42,dn(!1)),Fe(n,43,dn(!1)),Fe(n,130,la(1)),Fe(n,128,zI()),Fe(n,131,dn(!1)),Fe(n,132,dn(!1)),d&&Pj(n,l["!cols"]),Fe(n,512,MI(y,e)),d&&(l["!links"]=[]);for(var w=y.s.r;w<=y.e.r;++w){x=ur(w);for(var S=y.s.c;S<=y.e.c;++S){w===y.s.r&&(v[S]=tr(S)),p=v[S]+x;var N=h?(l[w]||[])[S]:l[p];N&&(Uj(n,N,w,S,e),d&&N.l&&l["!links"].push([p,N.l]))}}var I=u.CodeName||u.name||i;return d&&Fe(n,574,SI((o.Views||[])[0])),d&&(l["!merges"]||[]).length&&Fe(n,229,tM(l["!merges"])),d&&Bj(n,l),Fe(n,442,r4(I)),d&&Mj(n,l),Fe(n,10),n.end()}function Hj(t,e,r){var n=Nn(),i=(t||{}).Workbook||{},l=i.Sheets||[],o=i.WBProps||{},u=r.biff==8,h=r.biff==5;if(Fe(n,2057,Kg(t,5,r)),r.bookType=="xla"&&Fe(n,135),Fe(n,225,u?la(1200):null),Fe(n,193,VF(2)),h&&Fe(n,191),h&&Fe(n,192),Fe(n,226),Fe(n,92,fI("SheetJS",r)),Fe(n,66,la(u?1200:1252)),u&&Fe(n,353,la(0)),u&&Fe(n,448),Fe(n,317,vM(t.SheetNames.length)),u&&t.vbaraw&&Fe(n,211),u&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";Fe(n,442,r4(d))}Fe(n,156,la(17)),Fe(n,25,dn(!1)),Fe(n,18,dn(!1)),Fe(n,19,la(0)),u&&Fe(n,431,dn(!1)),u&&Fe(n,444,la(0)),Fe(n,61,EI()),Fe(n,64,dn(!1)),Fe(n,141,la(0)),Fe(n,34,dn(yU(t)=="true")),Fe(n,14,dn(!0)),u&&Fe(n,439,dn(!1)),Fe(n,218,la(0)),Fj(n,t,r),Ij(n,t.SSF,r),Lj(n,r),u&&Fe(n,352,dn(!1));var p=n.end(),x=Nn();u&&Fe(x,140,fM()),u&&r.Strings&&kj(x,252,gI(r.Strings)),Fe(x,10);var v=x.end(),y=Nn(),E=0,w=0;for(w=0;w<t.SheetNames.length;++w)E+=(u?12:11)+(u?2:1)*t.SheetNames[w].length;var S=p.length+E+v.length;for(w=0;w<t.SheetNames.length;++w){var N=l[w]||{};Fe(y,133,mI({pos:S,hs:N.Hidden||0,dt:0,name:t.SheetNames[w]},r)),S+=e[w].length}var I=y.end();if(E!=I.length)throw new Error("BS8 "+E+" != "+I.length);var C=[];return p.length&&C.push(p),I.length&&C.push(I),v.length&&C.push(v),Pr(C)}function zj(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Xt(Ye)),t&&t.SSF&&(jc(),Yu(t.SSF),r.revssf=zh(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ox(r),r.cellXfs=[],_s(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=jj(i,r,t);return n.unshift(Hj(t,n,r)),Pr(n)}function K4(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=pn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=e||{};switch(l.biff||2){case 8:case 5:return zj(t,e);case 4:case 3:case 2:return Oj(t,e)}throw new Error("invalid type "+l.bookType+" for BIFF")}function wE(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var l=t.match(/<\/table/i),o=i.index,u=l&&l.index||t.length,h=kO(t.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,p=0,x=0,v=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<h.length;++o){var w=h[o].trim(),S=w.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}p=0;continue}if(!(S!="<td"&&S!="<th")){var N=w.split(/<\/t[dh]>/i);for(u=0;u<N.length;++u){var I=N[u].trim();if(I.match(/<t[dh]/i)){for(var C=I,z=0;C.charAt(0)=="<"&&(z=C.indexOf(">"))>-1;)C=C.slice(z+1);for(var X=0;X<E.length;++X){var W=E[X];W.s.c==p&&W.s.r<d&&d<=W.e.r&&(p=W.e.c+1,X=-1)}var R=rt(I.slice(0,I.indexOf(">")));v=R.colspan?+R.colspan:1,((x=+R.rowspan)>1||v>1)&&E.push({s:{r:d,c:p},e:{r:d+(x||1)-1,c:p+v-1}});var Q=R.t||R["data-t"]||"";if(!C.length){p+=v;continue}if(C=Tb(C),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!C.length){p+=v;continue}var G={t:"s",v:C};r.raw||!C.trim().length||Q=="s"||(C==="TRUE"?G={t:"b",v:!0}:C==="FALSE"?G={t:"b",v:!1}:isNaN(Sa(C))?isNaN(Nc(C).getDate())||(G={t:"d",v:rr(C)},r.cellDates||(G={t:"n",v:Nr(G.v)}),G.z=r.dateNF||Ye[14]):G={t:"n",v:Sa(C)}),r.dense?(n[d]||(n[d]=[]),n[d][p]=G):n[Je({r:d,c:p})]=G,p+=v}}}}return n["!ref"]=ot(y),E.length&&(n["!merges"]=E),n}function $4(t,e,r,n){for(var i=t["!merges"]||[],l=[],o=e.s.c;o<=e.e.c;++o){for(var u=0,h=0,d=0;d<i.length;++d)if(!(i[d].s.r>r||i[d].s.c>o)&&!(i[d].e.r<r||i[d].e.c<o)){if(i[d].s.r<r||i[d].s.c<o){u=-1;break}u=i[d].e.r-i[d].s.r+1,h=i[d].e.c-i[d].s.c+1;break}if(!(u<0)){var p=Je({r,c:o}),x=n.dense?(t[r]||[])[o]:t[p],v=x&&x.v!=null&&(x.h||Og(x.w||(za(x),x.w)||""))||"",y={};u>1&&(y.rowspan=u),h>1&&(y.colspan=h),n.editable?v='<span contenteditable="true">'+v+"</span>":x&&(y["data-t"]=x&&x.t||"z",x.v!=null&&(y["data-v"]=x.v),x.z!=null&&(y["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),y.id=(n.id||"sjs")+"-"+p,l.push(De("td",v,y))}}var E="<tr>";return E+l.join("")+"</tr>"}var Q4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Z4="</body></html>";function Vj(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return vs(wE(r[0],e),e);var n=mx();return r.forEach(function(i,l){px(n,wE(i,e),"Sheet"+(l+1))}),n}function J4(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function eC(t,e){var r=e||{},n=r.header!=null?r.header:Q4,i=r.footer!=null?r.footer:Z4,l=[n],o=pn(t["!ref"]);r.dense=Array.isArray(t),l.push(J4(t,o,r));for(var u=o.s.r;u<=o.e.r;++u)l.push($4(t,o,u,r));return l.push("</table>"+i),l.join("")}function tC(t,e,r){var n=r||{},i=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?sr(n.origin):n.origin;i=o.r,l=o.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:i,c:l}};if(t["!ref"]){var p=pn(t["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),i==-1&&(d.e.r=i=p.e.r+1)}var x=[],v=0,y=t["!rows"]||(t["!rows"]=[]),E=0,w=0,S=0,N=0,I=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<u.length&&w<h;++E){var z=u[E];if(EE(z)){if(n.display)continue;y[w]={hidden:!0}}var X=z.children;for(S=N=0;S<X.length;++S){var W=X[S];if(!(n.display&&EE(W))){var R=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):Tb(W.innerHTML),Q=W.getAttribute("data-z")||W.getAttribute("z");for(v=0;v<x.length;++v){var G=x[v];G.s.c==N+l&&G.s.r<w+i&&w+i<=G.e.r&&(N=G.e.c+1-l,v=-1)}C=+W.getAttribute("colspan")||1,((I=+W.getAttribute("rowspan")||1)>1||C>1)&&x.push({s:{r:w+i,c:N+l},e:{r:w+i+(I||1)-1,c:N+l+(C||1)-1}});var fe={t:"s",v:R},re=W.getAttribute("data-t")||W.getAttribute("t")||"";R!=null&&(R.length==0?fe.t=re||"z":n.raw||R.trim().length==0||re=="s"||(R==="TRUE"?fe={t:"b",v:!0}:R==="FALSE"?fe={t:"b",v:!1}:isNaN(Sa(R))?isNaN(Nc(R).getDate())||(fe={t:"d",v:rr(R)},n.cellDates||(fe={t:"n",v:Nr(fe.v)}),fe.z=n.dateNF||Ye[14]):fe={t:"n",v:Sa(R)})),fe.z===void 0&&Q!=null&&(fe.z=Q);var K="",ye=W.getElementsByTagName("A");if(ye&&ye.length)for(var Ie=0;Ie<ye.length&&!(ye[Ie].hasAttribute("href")&&(K=ye[Ie].getAttribute("href"),K.charAt(0)!="#"));++Ie);K&&K.charAt(0)!="#"&&(fe.l={Target:K}),n.dense?(t[w+i]||(t[w+i]=[]),t[w+i][N+l]=fe):t[Je({c:N+l,r:w+i})]=fe,d.e.c<N+l&&(d.e.c=N+l),N+=C}}++w}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,w-1+i),t["!ref"]=ot(d),w>=h&&(t["!fullref"]=ot((d.e.r=u.length-E+w-1+i,d))),t}function rC(t,e){var r=e||{},n=r.dense?[]:{};return tC(n,t,e)}function Gj(t,e){return vs(rC(t,e),e)}function EE(t){var e="",r=Wj(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Wj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Xj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=kt(e.replace(/<[^>]*>/g,""));return[r]}var TE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function nC(t,e){var r=e||{},n=Fg(t),i=[],l,o,u={name:""},h="",d=0,p,x,v={},y=[],E=r.dense?[]:{},w,S,N={value:""},I="",C=0,z=[],X=-1,W=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},Q=0,G={},fe=[],re={},K=0,ye=0,Ie=[],Ce=1,Y=1,ue=[],Me={Names:[]},Z={},Le=["",""],U=[],k={},P="",M=0,j=!1,ee=!1,xe=0;for(bu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=bu.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?E["!ref"]=ot(R):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=R.e.r&&(E["!fullref"]=E["!ref"],R.e.r=r.sheetRows-1,E["!ref"]=ot(R)),fe.length&&(E["!merges"]=fe),Ie.length&&(E["!rows"]=Ie),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),v[p.name]=E,ee=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=rt(w[0],!1),X=W=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,E=r.dense?[]:{},fe=[],Ie=[],ee=!0);break;case"table-row-group":w[1]==="/"?--Q:++Q;break;case"table-row":case"":if(w[1]==="/"){X+=Ce,Ce=1;break}if(x=rt(w[0],!1),x.?X=x.-1:X==-1&&(X=0),Ce=+x["number-rows-repeated"]||1,Ce<10)for(xe=0;xe<Ce;++xe)Q>0&&(Ie[X+xe]={level:Q});W=-1;break;case"covered-table-cell":w[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(E[X]||(E[X]=[]),E[X][W]={t:"z"}):E[Je({r:X,c:W})]={t:"z"}),I="",z=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++W,N=rt(w[0],!1),Y=parseInt(N["number-columns-repeated"]||"1",10),S={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(S.f=vE(kt(N.formula))),(N.||N["value-type"])=="string"&&(S.t="s",S.v=kt(N["string-value"]||""),r.dense?(E[X]||(E[X]=[]),E[X][W]=S):E[Je({r:X,c:W})]=S),W+=Y-1;else if(w[1]!=="/"){++W,I="",C=0,z=[],Y=1;var Te=Ce?X+Ce-1:X;if(W>R.e.c&&(R.e.c=W),W<R.s.c&&(R.s.c=W),X<R.s.r&&(R.s.r=X),Te>R.e.r&&(R.e.r=Te),N=rt(w[0],!1),U=[],k={},S={t:N.||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=kt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(K=parseInt(N["number-matrix-rows-spanned"],10)||0,ye=parseInt(N["number-matrix-columns-spanned"],10)||0,re={s:{r:X,c:W},e:{r:X+K-1,c:W+ye-1}},S.F=ot(re),ue.push([re,S.F])),N.formula)S.f=vE(N.formula);else for(xe=0;xe<ue.length;++xe)X>=ue[xe][0].s.r&&X<=ue[xe][0].e.r&&W>=ue[xe][0].s.c&&W<=ue[xe][0].e.c&&(S.F=ue[xe][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(K=parseInt(N["number-rows-spanned"],10)||0,ye=parseInt(N["number-columns-spanned"],10)||0,re={s:{r:X,c:W},e:{r:X+K-1,c:W+ye-1}},fe.push(re)),N["number-columns-repeated"]&&(Y=parseInt(N["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=er(N["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(N.value);break;case"percentage":S.t="n",S.v=parseFloat(N.value);break;case"currency":S.t="n",S.v=parseFloat(N.value);break;case"date":S.t="d",S.v=rr(N["date-value"]),r.cellDates||(S.t="n",S.v=Nr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=SO(N["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Vh(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(N.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",N["string-value"]!=null&&(I=kt(N["string-value"]),z=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(j=!1,S.t==="s"&&(S.v=I||"",z.length&&(S.R=z),j=C==0),Z.Target&&(S.l=Z),U.length>0&&(S.c=U,U=[]),I&&r.cellText!==!1&&(S.w=I),j&&(S.t="z",delete S.v),(!j||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var me=0;me<Ce;++me){if(Y=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(E[X+me]||(E[X+me]=[]),E[X+me][W]=me==0?S:Xt(S);--Y>0;)E[X+me][W+Y]=Xt(S);else for(E[Je({r:X+me,c:W})]=S;--Y>0;)E[Je({r:X+me,c:W+Y})]=Xt(S);R.e.c<=W&&(R.e.c=W)}Y=parseInt(N["number-columns-repeated"]||"1",10),W+=Y-1,Y=0,S={},I="",z=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=i.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=i.pop())[0]!==w[3])throw"Bad state: "+l;k.t=I,z.length&&(k.R=z),k.a=P,U.push(k)}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!1]);P="",M=0,I="",C=0,z=[];break;case"creator":w[1]==="/"?P=n.slice(M,w.index):M=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=i.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!1]);I="",C=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(G[u.name]=h,(l=i.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(h="",u=rt(w[0],!1),i.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=rt(w[0],!1),h+=TE[w[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=rt(w[0],!1),h+=TE[w[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":o=rt(w[0],!1),Le=Mm(o["cell-range-address"]);var we={Name:o.name,Ref:Le[0]+"!"+Le[1]};ee&&(we.Sheet=y.length),Me.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(w[1]==="/"&&(!N||!N["string-value"])){var $e=Xj(n.slice(C,w.index));I=(I.length>0?I+`
`:"")+$e[0]}else rt(w[0],!1),C=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Le=Mm(rt(w[0])["target-range-address"]),v[Le[0]]["!autofilter"]={ref:Le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(Z=rt(w[0],!1),!Z.href)break;Z.Target=kt(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(Le=Mm(Z.Target.slice(1)),Z.Target="#"+Le[0]+"!"+Le[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var H={Sheets:v,SheetNames:y,Workbook:Me};return r.bookSheets&&delete H.Sheets,H}function SE(t,e){e=e||{},sa(t,"META-INF/manifest.xml")&&SF(Sr(t,"META-INF/manifest.xml"),e);var r=jn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=nC(Gt(r),e);return sa(t,"meta.xml")&&(n.Props=Vb(Sr(t,"meta.xml"))),n}function bE(t,e){return nC(t,e)}var qj=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Su({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return xr+e}})(),CE=(function(){var t=function(l){return Ut(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,o,u){var h=[];h.push('      <table:table table:name="'+Ut(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,x=pn(l["!ref"]||"A1"),v=l["!merges"]||[],y=0,E=Array.isArray(l);if(l["!cols"])for(p=0;p<=x.e.c;++p)h.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var w="",S=l["!rows"]||[];for(d=0;d<x.s.r;++d)w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=x.e.r;++d){for(w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+w+`>
`),p=0;p<x.s.c;++p)h.push(e);for(;p<=x.e.c;++p){var N=!1,I={},C="";for(y=0;y!=v.length;++y)if(!(v[y].s.c>p)&&!(v[y].s.r>d)&&!(v[y].e.c<p)&&!(v[y].e.r<d)){(v[y].s.c!=p||v[y].s.r!=d)&&(N=!0),I["table:number-columns-spanned"]=v[y].e.c-v[y].s.c+1,I["table:number-rows-spanned"]=v[y].e.r-v[y].s.r+1;break}if(N){h.push(r);continue}var z=Je({r:d,c:p}),X=E?(l[d]||[])[p]:l[z];if(X&&X.f&&(I["table:formula"]=Ut(vB(X.f)),X.F&&X.F.slice(0,z.length)==z)){var W=pn(X.F);I["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,I["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!X){h.push(e);continue}switch(X.t){case"b":C=X.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=X.v?"true":"false";break;case"n":C=X.w||String(X.v||0),I["office:value-type"]="float",I["office:value"]=X.v||0;break;case"s":case"str":C=X.v==null?"":X.v,I["office:value-type"]="string";break;case"d":C=X.w||rr(X.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=rr(X.v).toISOString(),I["table:style-name"]="ce1";break;default:h.push(e);continue}var R=t(C);if(X.l&&X.l.Target){var Q=X.l.Target;Q=Q.charAt(0)=="#"?"#"+_B(Q.slice(1)):Q,Q.charAt(0)!="#"&&!Q.match(/^\w+:/)&&(Q="../"+Q),R=De("text:a",R,{"xlink:href":Q.replace(/&/g,"&amp;")})}h.push("          "+De("table:table-cell",De("text:p",R,{}),I)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},i=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var x=d["!cols"][p];if(x.width==null&&x.wpx==null&&x.wch==null)continue;ds(x),x.ods=u;var v=d["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=h;var x=d["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,u){var h=[xr],d=Su({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Su({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+p+`>
`),h.push(zb().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),i(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)h.push(n(o.Sheets[o.SheetNames[x]],o,x));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function aC(t,e){if(e.bookType=="fods")return CE(t,e);var r=Ng(),n="",i=[],l=[];return n="mimetype",ft(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ft(r,n,CE(t,e)),i.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",ft(r,n,qj(t,e)),i.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",ft(r,n,xr+zb()),i.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",ft(r,n,kF(l)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ft(r,n,bF(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function kp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Gt(xs(t))}function Yj(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Un(La(t))}function Kj(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function ps(t){var e=t.reduce(function(i,l){return i+l.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function kE(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function $j(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Qj(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var l=0;i>=1;++l,i/=256)t[e+l]=i&255;t[e+15]|=r>=0?0:128}function Ou(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Bt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function fr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Rt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Ou(t,r),l=i&7;i=Math.floor(i/8);var o=0,u;if(i==0)break;switch(l){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:o=4,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ou(t,r),u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(i," at offset ").concat(n))}var d={data:u,type:l};e[i]==null?e[i]=[d]:e[i].push(d)}return e}function Gr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Bt(n*8+i.type)),i.type==2&&e.push(Bt(i.data.length)),e.push(i.data))})}),ps(e)}function lx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function aa(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Ou(t,n),l=Rt(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:fr(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Rt(u.data),d=fr(h[3][0].data);o.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=l[3])!=null&&e[0]&&(o.merge=fr(l[3][0].data)>>>0>0),r.push(o)}return r}function sc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Bt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Bt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Bt(o.data.length)}],n[2].push({data:Gr(o.meta),type:2})});var l=Gr(n);e.push(Bt(l.length)),e.push(l),i.forEach(function(o){return e.push(o)})}),ps(e)}function Zj(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Ou(e,r),i=[];r[0]<e.length;){var l=e[r[0]]&3;if(l==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=e[r[0]],u>1&&(o|=e[r[0]+1]<<8),u>2&&(o|=e[r[0]+2]<<16),u>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,d=0;if(l==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,l==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ps(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(i.push(i[0].slice(-h)),d-=h;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-h,-h+d))}}var p=ps(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function ia(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Zj(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return ps(e)}function lc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var l=Bt(n),o=l.length;e.push(l),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return ps(e)}function Jj(t,e,r,n){var i=fl(t),l=i.getUint32(4,!0),o=(n>1?12:8)+kE(l&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,p=new Date(2001,0,1);l&512&&(u=i.getUint32(o,!0),o+=4),o+=kE(l&(n>1?12288:4096))*4,l&16&&(h=i.getUint32(o,!0),o+=4),l&32&&(d=i.getFloat64(o,!0),o+=8),l&64&&(p.setTime(p.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:e[h]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(h>-1)x={t:"s",v:e[h]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function eH(t,e,r){var n=fl(t),i=n.getUint32(8,!0),l=12,o=-1,u=-1,h=NaN,d=NaN,p=new Date(2001,0,1);i&1&&(h=$j(t,l),l+=16),i&2&&(d=n.getFloat64(l,!0),l+=8),i&4&&(p.setTime(p.getTime()+n.getFloat64(l,!0)*1e3),l+=8),i&8&&(u=n.getUint32(l,!0),l+=4),i&16&&(o=n.getUint32(l,!0),l+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return x}function Bm(t,e){var r=new Uint8Array(32),n=fl(r),i=12,l=0;switch(r[0]=5,t.t){case"n":r[1]=2,Qj(r,i,t.v),l|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),l|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),l|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,l,!0),r.slice(0,i)}function Pm(t,e){var r=new Uint8Array(32),n=fl(r),i=12,l=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),l|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),l|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),l|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,l,!0),r.slice(0,i)}function tH(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Jj(t,e,r,t[0]);case 5:return eH(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Zr(t){var e=Rt(t);return Ou(e[1][0].data)}function AE(t,e){var r=Rt(e.data),n=fr(r[1][0].data),i=r[3],l=[];return(i||[]).forEach(function(o){var u=Rt(o.data),h=fr(u[1][0].data)>>>0;switch(n){case 1:l[h]=kp(u[3][0].data);break;case 8:{var d=t[Zr(u[9][0].data)][0],p=Rt(d.data),x=t[Zr(p[1][0].data)][0],v=fr(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var y=Rt(x.data);l[h]=y[3].map(function(E){return kp(E.data)}).join("")}break}}),l}function rH(t,e){var r,n,i,l,o,u,h,d,p,x,v,y,E,w,S=Rt(t),N=fr(S[1][0].data)>>>0,I=fr(S[2][0].data)>>>0,C=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&fr(S[8][0].data)>0||!1,z,X;if((l=(i=S[7])==null?void 0:i[0])!=null&&l.data&&e!=0)z=(u=(o=S[7])==null?void 0:o[0])==null?void 0:u.data,X=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((x=(p=S[4])==null?void 0:p[0])!=null&&x.data&&e!=1)z=(y=(v=S[4])==null?void 0:v[0])==null?void 0:y.data,X=(w=(E=S[3])==null?void 0:E[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var W=C?4:1,R=fl(z),Q=[],G=0;G<z.length/2;++G){var fe=R.getUint16(G*2,!0);fe<65535&&Q.push([G,fe])}if(Q.length!=I)throw"Expected ".concat(I," cells, found ").concat(Q.length);var re=[];for(G=0;G<Q.length-1;++G)re[Q[G][0]]=X.subarray(Q[G][1]*W,Q[G+1][1]*W);return Q.length>=1&&(re[Q[Q.length-1][0]]=X.subarray(Q[Q.length-1][1]*W)),{R:N,cells:re}}function nH(t,e){var r,n=Rt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?fr(n[7][0].data)>>>0>0?1:0:-1,l=lx(n[5],function(o){return rH(o,i)});return{nrows:fr(n[4][0].data)>>>0,data:l.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=h}),o},[])}}function aH(t,e,r){var n,i=Rt(e.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(fr(i[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(l.e.c=(fr(i[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=ot(l);var o=Rt(i[4][0].data),u=AE(t,t[Zr(o[4][0].data)][0]),h=(n=o[17])!=null&&n[0]?AE(t,t[Zr(o[17][0].data)][0]):[],d=Rt(o[3][0].data),p=0;d[1].forEach(function(x){var v=Rt(x.data),y=t[Zr(v[2][0].data)][0],E=fr(y.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var w=nH(t,y);w.data.forEach(function(S,N){S.forEach(function(I,C){var z=Je({r:p+N,c:C}),X=tH(I,u,h);X&&(r[z]=X)})}),p+=w.nrows})}function iH(t,e){var r=Rt(e.data),n={"!ref":"A1"},i=t[Zr(r[2][0].data)],l=fr(i[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return aH(t,i[0],n),n}function sH(t,e){var r,n=Rt(e.data),i={name:(r=n[1])!=null&&r[0]?kp(n[1][0].data):"",sheets:[]},l=lx(n[2],Zr);return l.forEach(function(o){t[o].forEach(function(u){var h=fr(u.meta[1][0].data);h==6e3&&i.sheets.push(iH(t,u))})}),i}function lH(t,e){var r=mx(),n=Rt(e.data),i=lx(n[1],Zr);if(i.forEach(function(l){t[l].forEach(function(o){var u=fr(o.meta[1][0].data);if(u==2){var h=sH(t,o);h.sheets.forEach(function(d,p){px(r,d,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Um(t){var e,r,n,i,l={},o=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=ia(h.content)}catch(x){return console.log("?? "+h.content.length+" "+(x.message||x))}var p;try{p=aa(d)}catch(x){return console.log("## "+(x.message||x))}p.forEach(function(x){l[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((i=(n=(r=(e=l==null?void 0:l[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&fr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||o.forEach(function(h){l[h].forEach(function(d){var p=fr(d.meta[1][0].data)>>>0;if(p==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return lH(l,u)}function cH(t,e,r){var n,i,l,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(l=t[8])==null?void 0:l[0])==null?void 0:o.data)&&fr(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=fl(t[7][0].data),p=0,x=[],v=fl(t[4][0].data),y=0,E=[],w=0;w<e.length;++w){if(e[w]==null){d.setUint16(w*2,65535,!0),v.setUint16(w*2,65535);continue}d.setUint16(w*2,p,!0),v.setUint16(w*2,y,!0);var S,N;switch(typeof e[w]){case"string":S=Bm({t:"s",v:e[w]},r),N=Pm({t:"s",v:e[w]},r);break;case"number":S=Bm({t:"n",v:e[w]},r),N=Pm({t:"n",v:e[w]},r);break;case"boolean":S=Bm({t:"b",v:e[w]},r),N=Pm({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}x.push(S),p+=S.length,E.push(N),y+=N.length,++h}for(t[2][0].data=Bt(h);w<t[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),v.setUint16(w*2,65535,!0);return t[6][0].data=ps(x),t[3][0].data=ps(E),h}function oH(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=pn(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ot(n)));var l=_h(r,{range:n,header:1}),o=["~Sh33tJ5~"];l.forEach(function(P){return P.forEach(function(M){typeof M=="string"&&o.push(M)})});var u={},h=[],d=We.read(e.numbers,{type:"base64"});d.FileIndex.map(function(P,M){return[P,d.FullPaths[M]]}).forEach(function(P){var M=P[0],j=P[1];if(M.type==2&&M.name.match(/\.iwa/)){var ee=M.content,xe=ia(ee),Te=aa(xe);Te.forEach(function(me){h.push(me.id),u[me.id]={deps:[],location:j,type:fr(me.messages[0].meta[1][0].data)}})}}),h.sort(function(P,M){return P-M});var p=h.filter(function(P){return P>1}).map(function(P){return[P,Bt(P)]});d.FileIndex.map(function(P,M){return[P,d.FullPaths[M]]}).forEach(function(P){var M=P[0];if(P[1],!!M.name.match(/\.iwa/)){var j=aa(ia(M.content));j.forEach(function(ee){ee.messages.forEach(function(xe){p.forEach(function(Te){ee.messages.some(function(me){return fr(me.meta[1][0].data)!=11006&&Kj(me.data,Te[1])})&&u[Te[0]].deps.push(ee.id)})})})}});for(var x=We.find(d,u[1].location),v=aa(ia(x.content)),y,E=0;E<v.length;++E){var w=v[E];w.id==1&&(y=w)}var S=Zr(Rt(y.messages[0].data)[1][0].data);for(x=We.find(d,u[S].location),v=aa(ia(x.content)),E=0;E<v.length;++E)w=v[E],w.id==S&&(y=w);for(S=Zr(Rt(y.messages[0].data)[2][0].data),x=We.find(d,u[S].location),v=aa(ia(x.content)),E=0;E<v.length;++E)w=v[E],w.id==S&&(y=w);for(S=Zr(Rt(y.messages[0].data)[2][0].data),x=We.find(d,u[S].location),v=aa(ia(x.content)),E=0;E<v.length;++E)w=v[E],w.id==S&&(y=w);var N=Rt(y.messages[0].data);{N[6][0].data=Bt(n.e.r+1),N[7][0].data=Bt(n.e.c+1);var I=Zr(N[46][0].data),C=We.find(d,u[I].location),z=aa(ia(C.content));{for(var X=0;X<z.length&&z[X].id!=I;++X);if(z[X].id!=I)throw"Bad ColumnRowUIDMapArchive";var W=Rt(z[X].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var R=0;R<=n.e.c;++R){var Q=[];Q[1]=Q[2]=[{type:0,data:Bt(R+420690)}],W[1].push({type:2,data:Gr(Q)}),W[2].push({type:0,data:Bt(R)}),W[3].push({type:0,data:Bt(R)})}W[4]=[],W[5]=[],W[6]=[];for(var G=0;G<=n.e.r;++G)Q=[],Q[1]=Q[2]=[{type:0,data:Bt(G+726270)}],W[4].push({type:2,data:Gr(Q)}),W[5].push({type:0,data:Bt(G)}),W[6].push({type:0,data:Bt(G)});z[X].messages[0].data=Gr(W)}C.content=lc(sc(z)),C.size=C.content.length,delete N[46];var fe=Rt(N[4][0].data);{fe[7][0].data=Bt(n.e.r+1);var re=Rt(fe[1][0].data),K=Zr(re[2][0].data);C=We.find(d,u[K].location),z=aa(ia(C.content));{if(z[0].id!=K)throw"Bad HeaderStorageBucket";var ye=Rt(z[0].messages[0].data);for(G=0;G<l.length;++G){var Ie=Rt(ye[2][0].data);Ie[1][0].data=Bt(G),Ie[4][0].data=Bt(l[G].length),ye[2][G]={type:ye[2][0].type,data:Gr(Ie)}}z[0].messages[0].data=Gr(ye)}C.content=lc(sc(z)),C.size=C.content.length;var Ce=Zr(fe[2][0].data);C=We.find(d,u[Ce].location),z=aa(ia(C.content));{if(z[0].id!=Ce)throw"Bad HeaderStorageBucket";for(ye=Rt(z[0].messages[0].data),R=0;R<=n.e.c;++R)Ie=Rt(ye[2][0].data),Ie[1][0].data=Bt(R),Ie[4][0].data=Bt(n.e.r+1),ye[2][R]={type:ye[2][0].type,data:Gr(Ie)};z[0].messages[0].data=Gr(ye)}C.content=lc(sc(z)),C.size=C.content.length;var Y=Zr(fe[4][0].data);(function(){for(var P=We.find(d,u[Y].location),M=aa(ia(P.content)),j,ee=0;ee<M.length;++ee){var xe=M[ee];xe.id==Y&&(j=xe)}var Te=Rt(j.messages[0].data);{Te[3]=[];var me=[];o.forEach(function(H,At){me[1]=[{type:0,data:Bt(At)}],me[2]=[{type:0,data:Bt(1)}],me[3]=[{type:2,data:Yj(H)}],Te[3].push({type:2,data:Gr(me)})})}j.messages[0].data=Gr(Te);var we=sc(M),$e=lc(we);P.content=$e,P.size=P.content.length})();var ue=Rt(fe[3][0].data);{var Me=ue[1][0];delete ue[2];var Z=Rt(Me.data);{var Le=Zr(Z[2][0].data);(function(){for(var P=We.find(d,u[Le].location),M=aa(ia(P.content)),j,ee=0;ee<M.length;++ee){var xe=M[ee];xe.id==Le&&(j=xe)}var Te=Rt(j.messages[0].data);{delete Te[6],delete ue[7];var me=new Uint8Array(Te[5][0].data);Te[5]=[];for(var we=0,$e=0;$e<=n.e.r;++$e){var H=Rt(me);we+=cH(H,l[$e],o),H[1][0].data=Bt($e),Te[5].push({data:Gr(H),type:2})}Te[1]=[{type:0,data:Bt(n.e.c+1)}],Te[2]=[{type:0,data:Bt(n.e.r+1)}],Te[3]=[{type:0,data:Bt(we)}],Te[4]=[{type:0,data:Bt(n.e.r+1)}]}j.messages[0].data=Gr(Te);var At=sc(M),at=lc(At);P.content=at,P.size=P.content.length})()}Me.data=Gr(Z)}fe[3][0].data=Gr(ue)}N[4][0].data=Gr(fe)}y.messages[0].data=Gr(N);var U=sc(v),k=lc(U);return x.content=k,x.size=x.content.length,d}function iC(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function cx(t){iC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function ox(t){iC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function uH(t){return dt.WS.indexOf(t)>-1?"sheet":t==dt.CS?"chart":t==dt.DS?"dialog":t==dt.MS?"macro":t&&t.length?t:"sheet"}function fH(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,uH(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function hH(t,e,r,n,i,l,o,u,h,d,p,x){try{l[n]=ru(jn(t,r,!0),e);var v=Sr(t,e),y;switch(u){case"sheet":y=PU(v,e,i,h,l[n],d,p,x);break;case"chart":if(y=UU(v,e,i,h,l[n],d,p,x),!y||!y["!drawel"])break;var E=Wo(y["!drawel"].Target,e),w=Cu(E),S=C7(jn(t,E,!0),ru(jn(t,w,!0),E)),N=Wo(S,E),I=Cu(N);y=dU(jn(t,N,!0),N,h,ru(jn(t,I,!0),N),d,y);break;case"macro":y=jU(v,e,i,h,l[n],d,p,x);break;case"dialog":y=HU(v,e,i,h,l[n],d,p,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=y;var C=[];l&&l[n]&&hr(l[n]).forEach(function(z){var X="";if(l[n][z].Type==dt.CMNT){X=Wo(l[n][z].Target,e);var W=WU(Sr(t,X,!0),X,h);if(!W||!W.length)return;dE(y,W,!1)}l[n][z].Type==dt.TCMNT&&(X=Wo(l[n][z].Target,e),C=C.concat(A7(Sr(t,X,!0),h)))}),C&&C.length&&dE(y,C,!0,h.people||[])}catch(z){if(h.WTF)throw z}}function ra(t){return t.charAt(0)=="/"?t.slice(1):t}function sC(t,e){if(jc(),e=e||{},cx(e),sa(t,"META-INF/manifest.xml")||sa(t,"objectdata.xml"))return SE(t,e);if(sa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Um<"u"){if(t.FileIndex)return Um(t);var r=We.utils.cfb_new();return Iw(t).forEach(function(Ie){ft(r,Ie,NO(t,Ie))}),Um(r)}throw new Error("Unsupported NUMBERS file")}if(!sa(t,"[Content_Types].xml"))throw sa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):sa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Iw(t),i=EF(jn(t,"[Content_Types].xml")),l=!1,o,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",Sr(t,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!Sr(t,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),l=!0}i.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(nu=[],i.sst)try{nu=GU(Sr(t,ra(i.sst)),i.sst,e)}catch(Ie){if(e.WTF)throw Ie}e.cellStyles&&i.themes.length&&(h=VU(jn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(d=zU(Sr(t,ra(i.style)),i.style,h,e))}i.links.map(function(Ie){try{var Ce=ru(jn(t,Cu(ra(Ie))),Ie);return qU(Sr(t,ra(Ie)),Ce,Ie,e)}catch{}});var p=BU(Sr(t,ra(i.workbooks[0])),i.workbooks[0],e),x={},v="";i.coreprops.length&&(v=Sr(t,ra(i.coreprops[0]),!0),v&&(x=Vb(v)),i.extprops.length!==0&&(v=Sr(t,ra(i.extprops[0]),!0),v&&NF(v,x,e)));var y={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(v=jn(t,ra(i.custprops[0]),!0),v&&(y=RF(v,e)));var E={};if((e.bookSheets||e.bookProps)&&(p.Sheets?o=p.Sheets.map(function(Ce){return Ce.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),e.bookProps&&(E.Props=x,E.Custprops=y),e.bookSheets&&typeof o<"u"&&(E.SheetNames=o),e.bookSheets?E.SheetNames:e.bookProps))return E;o={};var w={};e.bookDeps&&i.calcchain&&(w=XU(Sr(t,ra(i.calcchain)),i.calcchain));var S=0,N={},I,C;{var z=p.Sheets;x.Worksheets=z.length,x.SheetNames=[];for(var X=0;X!=z.length;++X)x.SheetNames[X]=z[X].name}var W=l?"bin":"xml",R=i.workbooks[0].lastIndexOf("/"),Q=(i.workbooks[0].slice(0,R+1)+"_rels/"+i.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");sa(t,Q)||(Q="xl/_rels/workbook."+W+".rels");var G=ru(jn(t,Q,!0),Q.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=YU(Sr(t,ra(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=D7(Sr(t,ra(i.people[0])),e)),G&&(G=fH(G,p.Sheets));var fe=Sr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=x.Worksheets;++S){var re="sheet";if(G&&G[S]?(I="xl/"+G[S][1].replace(/[\/]?xl\//,""),sa(t,I)||(I=G[S][1]),sa(t,I)||(I=Q.replace(/_rels\/.*$/,"")+G[S][1]),re=G[S][2]):(I="xl/worksheets/sheet"+(S+1-fe)+"."+W,I=I.replace(/sheet0\./,"sheet.")),C=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(x.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var K=!1,ye=0;ye!=e.sheets.length;++ye)typeof e.sheets[ye]=="number"&&e.sheets[ye]==S&&(K=1),typeof e.sheets[ye]=="string"&&e.sheets[ye].toLowerCase()==x.SheetNames[S].toLowerCase()&&(K=1);if(!K)continue e}}hH(t,I,C,x.SheetNames[S],S,N,o,re,e,p,h,d)}return E={Directory:i,Workbook:p,Props:x,Custprops:y,Deps:w,Sheets:o,SheetNames:x.SheetNames,Strings:nu,Styles:d,Themes:h,SSF:Xt(Ye)},e&&e.bookFiles&&(t.files?(E.keys=n,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Ie,Ce){Ie=Ie.replace(/^Root Entry[\/]/,""),E.keys.push(Ie),E.files[Ie]=t.FileIndex[Ce]}))),e&&e.bookVBA&&(i.vba.length>0?E.vbaraw=Sr(t,ra(i.vba[0]),!0):i.defaults&&i.defaults.bin===P7&&(E.vbaraw=Sr(t,"xl/vbaProject.bin",!0))),E}function dH(t,e){var r=e||{},n="Workbook",i=We.find(t,n);try{if(n="/!DataSpaces/Version",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(KM(i.content),n="/!DataSpaces/DataSpaceMap",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=QM(i.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=ZM(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);eL(i.content)}catch{}if(n="/EncryptionInfo",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=tL(i.content);if(n="/EncryptedPackage",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function mH(t,e){return e.bookType=="ods"?aC(t,e):e.bookType=="numbers"?oH(t,e):e.bookType=="xlsb"?pH(t,e):lC(t,e)}function pH(t,e){dc=1024,t&&!t.SSF&&(t.SSF=Xt(Ye)),t&&t.SSF&&(jc(),Yu(t.SSF),e.revssf=zh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,au?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=A4.indexOf(e.bookType)>-1,i=qg();ox(e=e||{});var l=Ng(),o="",u=0;if(e.cellXfs=[],_s(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",ft(l,o,Gb(t.Props,e)),i.coreprops.push(o),Pt(e.rels,2,o,dt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,ft(l,o,qb(t.Props)),i.extprops.push(o),Pt(e.rels,3,o,dt.EXT_PROPS),t.Custprops!==t.Props&&hr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",ft(l,o,Yb(t.Custprops)),i.custprops.push(o),Pt(e.rels,4,o,dt.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var p={"!id":{}},x=t.Sheets[t.SheetNames[u-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,ft(l,o,$U(u-1,o,e,t,p)),i.sheets.push(o),Pt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,dt.WS[0])}if(x){var y=x["!comments"],E=!1,w="";y&&y.length>0&&(w="xl/comments"+u+"."+r,ft(l,w,JU(y,w)),i.comments.push(w),Pt(p,-1,"../comments"+u+"."+r,dt.CMNT),E=!0),x["!legacy"]&&E&&ft(l,"xl/drawings/vmlDrawing"+u+".vml",C4(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&ft(l,Cu(o),wc(p))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,ft(l,o,ZU(e.Strings,o,e)),i.strs.push(o),Pt(e.wbrels,-1,"sharedStrings."+r,dt.SST)),o="xl/workbook."+r,ft(l,o,KU(t,o)),i.workbooks.push(o),Pt(e.rels,1,o,dt.WB),o="xl/theme/theme1.xml",ft(l,o,Jg(t.Themes,e)),i.themes.push(o),Pt(e.wbrels,-1,"theme/theme1.xml",dt.THEME),o="xl/styles."+r,ft(l,o,QU(t,o,e)),i.styles.push(o),Pt(e.wbrels,-1,"styles."+r,dt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",ft(l,o,t.vbaraw),i.vba.push(o),Pt(e.wbrels,-1,"vbaProject.bin",dt.VBA)),o="xl/metadata."+r,ft(l,o,ej(o)),i.metadata.push(o),Pt(e.wbrels,-1,"metadata."+r,dt.XLMETA),ft(l,"[Content_Types].xml",Hb(i,e)),ft(l,"_rels/.rels",wc(e.rels)),ft(l,"xl/_rels/workbook."+r+".rels",wc(e.wbrels)),delete e.revssf,delete e.ssf,l}function lC(t,e){dc=1024,t&&!t.SSF&&(t.SSF=Xt(Ye)),t&&t.SSF&&(jc(),Yu(t.SSF),e.revssf=zh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,au?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=A4.indexOf(e.bookType)>-1,i=qg();ox(e=e||{});var l=Ng(),o="",u=0;if(e.cellXfs=[],_s(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",ft(l,o,Gb(t.Props,e)),i.coreprops.push(o),Pt(e.rels,2,o,dt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,ft(l,o,qb(t.Props)),i.extprops.push(o),Pt(e.rels,3,o,dt.EXT_PROPS),t.Custprops!==t.Props&&hr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",ft(l,o,Yb(t.Custprops)),i.custprops.push(o),Pt(e.rels,4,o,dt.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var x={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,ft(l,o,U4(u-1,e,t,x)),i.sheets.push(o),Pt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,dt.WS[0])}if(v){var E=v["!comments"],w=!1,S="";if(E&&E.length>0){var N=!1;E.forEach(function(I){I[1].forEach(function(C){C.T==!0&&(N=!0)})}),N&&(S="xl/threadedComments/threadedComment"+u+"."+r,ft(l,S,N7(E,p,e)),i.threadedcomments.push(S),Pt(x,-1,"../threadedComments/threadedComment"+u+"."+r,dt.TCMNT)),S="xl/comments"+u+"."+r,ft(l,S,k4(E)),i.comments.push(S),Pt(x,-1,"../comments"+u+"."+r,dt.CMNT),w=!0}v["!legacy"]&&w&&ft(l,"xl/drawings/vmlDrawing"+u+".vml",C4(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&ft(l,Cu(o),wc(x))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,ft(l,o,m4(e.Strings,e)),i.strs.push(o),Pt(e.wbrels,-1,"sharedStrings."+r,dt.SST)),o="xl/workbook."+r,ft(l,o,W4(t)),i.workbooks.push(o),Pt(e.rels,1,o,dt.WB),o="xl/theme/theme1.xml",ft(l,o,Jg(t.Themes,e)),i.themes.push(o),Pt(e.wbrels,-1,"theme/theme1.xml",dt.THEME),o="xl/styles."+r,ft(l,o,E4(t,e)),i.styles.push(o),Pt(e.wbrels,-1,"styles."+r,dt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",ft(l,o,t.vbaraw),i.vba.push(o),Pt(e.wbrels,-1,"vbaProject.bin",dt.VBA)),o="xl/metadata."+r,ft(l,o,b4()),i.metadata.push(o),Pt(e.wbrels,-1,"metadata."+r,dt.XLMETA),p.length>1&&(o="xl/persons/person.xml",ft(l,o,R7(p)),i.people.push(o),Pt(e.wbrels,-1,"persons/person.xml",dt.PEOPLE)),ft(l,"[Content_Types].xml",Hb(i,e)),ft(l,"_rels/.rels",wc(e.rels)),ft(l,"xl/_rels/workbook."+r+".rels",wc(e.wbrels)),delete e.revssf,delete e.ssf,l}function ux(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=zn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function gH(t,e){return We.find(t,"EncryptedPackage")?dH(t,e):sx(t,e)}function xH(t,e){var r,n=t,i=e||{};return i.type||(i.type=ht&&Buffer.isBuffer(t)?"buffer":"base64"),r=yb(n,i),sC(r,i)}function cC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return bp(t.slice(r),e);default:break e}return Dc.to_workbook(t,e)}function vH(t,e){var r="",n=ux(t,e);switch(e.type){case"base64":r=zn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ll(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Gt(r)),e.type="binary",cC(r,e)}function _H(t,e){var r=t;return e.type=="base64"&&(r=zn(r)),r=St.utils.decode(1200,r.slice(2),"str"),e.type="binary",cC(r,e)}function yH(t){return t.match(/[^\x00-\x7F]/)?La(t):t}function jm(t,e,r,n){return n?(r.type="string",Dc.to_workbook(t,r)):Dc.to_workbook(e,r)}function Fu(t,e){jh();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Fu(new Uint8Array(t),(r=Xt(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Tc={},r.dateNF&&(Tc.dateNF=r.dateNF),r.type||(r.type=ht&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ht?"buffer":"binary",n=wO(t),typeof Uint8Array<"u"&&!ht&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,n=yH(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=Xt(r),r.type="array",Fu(bg(n),r)}switch((i=ux(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return gH(We.read(n,r),r);break;case 9:if(i[1]<=8)return sx(n,r);break;case 60:return bp(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return OM(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return h4.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?xH(n,r):jm(t,n,r,l);case 239:return i[3]===60?bp(n,r):jm(t,n,r,l);case 255:if(i[1]===254)return _H(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ks.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ks.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Sp.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return _4.to_workbook(n,r);break;case 10:case 13:case 32:return vH(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return RM.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Sp.to_workbook(n,r):jm(t,n,r,l)}function NE(t,e){var r=e||{};return r.type="file",Fu(t,r)}function oC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Ku(e.file,We.write(t,{type:ht?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return We.write(t,e)}function wH(t,e){var r=Xt(e||{}),n=mH(t,r);return uC(n,r)}function EH(t,e){var r=Xt(e||{}),n=lC(t,r);return uC(n,r)}function uC(t,e){var r={},n=ht?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?We.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(qu(i))}return e.password&&typeof encrypt_agile<"u"?oC(encrypt_agile(i,e.password),e):e.type==="file"?Ku(e.file,i):e.type=="string"?Gt(i):i}function TH(t,e){var r=e||{},n=Cj(t,r);return oC(n,r)}function Ia(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return wu(La(n));case"binary":return La(n);case"string":return t;case"file":return Ku(e.file,n,"utf8");case"buffer":return ht?wi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ia(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function SH(t,e){switch(e.type){case"base64":return wu(t);case"binary":return t;case"string":return t;case"file":return Ku(e.file,t,"binary");case"buffer":return ht?wi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function O0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?wu(r):e.type=="string"?Gt(r):r;case"file":return Ku(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function fx(t,e){jh(),G4(t);var r=Xt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=fx(t,r);return r.type="array",qu(n)}return EH(t,r)}function Kh(t,e){jh(),G4(t);var r=Xt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Kh(t,r);return r.type="array",qu(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ia(_j(t,r),r);case"slk":case"sylk":return Ia(f4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Ia(eC(t.Sheets[t.SheetNames[i]],r),r);case"txt":return SH(dC(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Ia(dx(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ia(h4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return O0(Sp.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Ia(Dc.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Ia(_4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Ia(d4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Ia(aC(t,r),r);case"wk1":return O0(Ks.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return O0(Ks.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),O0(K4(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),TH(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return wH(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function hx(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function DE(t,e,r){var n=r||{};return n.type="file",n.file=e,hx(n),Kh(t,n)}function bH(t,e,r){var n=r||{};return n.type="file",n.file=e,hx(n),fx(t,n)}function CH(t,e,r,n){var i=r||{};i.type="file",i.file=t,hx(i),i.type="buffer";var l=n;return l instanceof Function||(l=r),ns.writeFile(t,Kh(e,i),l)}function fC(t,e,r,n,i,l,o,u){var h=ur(r),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||t[r])for(var y=e.s.c;y<=e.e.c;++y){var E=o?t[r][y]:t[n[y]+h];if(E===void 0||E.t===void 0){if(d===void 0)continue;l[y]!=null&&(v[l[y]]=d);continue}var w=E.v;switch(E.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(l[y]!=null){if(w==null)if(E.t=="e"&&w===null)v[l[y]]=null;else if(d!==void 0)v[l[y]]=d;else if(p&&w===null)v[l[y]]=null;else continue;else v[l[y]]=p&&(E.t!=="n"||E.t==="n"&&u.rawNumbers!==!1)?w:za(E,w,u);w!=null&&(x=!1)}}return{row:v,isempty:x}}function _h(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,l=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},p=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof p){case"string":h=Et(p);break;case"number":h=Et(t["!ref"]),h.s.r=p;break;default:h=p}n>0&&(i=0);var x=ur(h.s.r),v=[],y=[],E=0,w=0,S=Array.isArray(t),N=h.s.r,I=0,C={};S&&!t[N]&&(t[N]=[]);var z=d.skipHidden&&t["!cols"]||[],X=d.skipHidden&&t["!rows"]||[];for(I=h.s.c;I<=h.e.c;++I)if(!(z[I]||{}).hidden)switch(v[I]=tr(I),r=S?t[N][I]:t[v[I]+x],n){case 1:l[I]=I-h.s.c;break;case 2:l[I]=v[I];break;case 3:l[I]=d.header[I-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=za(r,null,d),w=C[o]||0,!w)C[o]=1;else{do u=o+"_"+w++;while(C[u]);C[o]=w,C[u]=1}l[I]=u}for(N=h.s.r+i;N<=h.e.r;++N)if(!(X[N]||{}).hidden){var W=fC(t,h,N,v,n,l,S,d);(W.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[E++]=W.row)}return y.length=E,y}var RE=/"/g;function hC(t,e,r,n,i,l,o,u){for(var h=!0,d=[],p="",x=ur(r),v=e.s.c;v<=e.e.c;++v)if(n[v]){var y=u.dense?(t[r]||[])[v]:t[n[v]+x];if(y==null)p="";else if(y.v!=null){h=!1,p=""+(u.rawNumbers&&y.t=="n"?y.v:za(y,null,u));for(var E=0,w=0;E!==p.length;++E)if((w=p.charCodeAt(E))===i||w===l||w===34||u.forceQuotes){p='"'+p.replace(RE,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(h=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(RE,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&h?null:d.join(o)}function dx(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Et(t["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),p="",x=[];n.dense=Array.isArray(t);for(var v=n.skipHidden&&t["!cols"]||[],y=n.skipHidden&&t["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(v[E]||{}).hidden||(x[E]=tr(E));for(var w=0,S=i.s.r;S<=i.e.r;++S)(y[S]||{}).hidden||(p=hC(t,i,S,x,o,h,l,n),p!=null&&(n.strip&&(p=p.replace(d,"")),(p||n.blankrows!==!1)&&r.push((w++?u:"")+p)));return delete n.dense,r.join("")}function dC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=dx(t,e);if(typeof St>"u"||e.type=="string")return r;var n=St.utils.encode(1200,r,"str");return""+n}function kH(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Et(t["!ref"]),l="",o=[],u,h=[],d=Array.isArray(t);for(u=i.s.c;u<=i.e.c;++u)o[u]=tr(u);for(var p=i.s.r;p<=i.e.r;++p)for(l=ur(p),u=i.s.c;u<=i.e.c;++u)if(e=o[u]+l,r=d?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function mC(t,e,r){var n=r||{},i=+!n.skipHeader,l=t||{},o=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?sr(n.origin):n.origin;o=h.r,u=h.c}var d,p={s:{c:0,r:0},e:{c:u,r:o+e.length-1+i}};if(l["!ref"]){var x=Et(l["!ref"]);p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),o==-1&&(o=x.e.r+1,p.e.r=o+e.length-1+i)}else o==-1&&(o=0,p.e.r=e.length-1+i);var v=n.header||[],y=0;e.forEach(function(w,S){hr(w).forEach(function(N){(y=v.indexOf(N))==-1&&(v[y=v.length]=N);var I=w[N],C="z",z="",X=Je({c:u+y,r:o+S+i});d=Iu(l,X),I&&typeof I=="object"&&!(I instanceof Date)?l[X]=I:(typeof I=="number"?C="n":typeof I=="boolean"?C="b":typeof I=="string"?C="s":I instanceof Date?(C="d",n.cellDates||(C="n",I=Nr(I)),z=n.dateNF||Ye[14]):I===null&&n.nullError&&(C="e",I=0),d?(d.t=C,d.v=I,delete d.w,delete d.R,z&&(d.z=z)):l[X]=d={t:C,v:I},z&&(d.z=z))})}),p.e.c=Math.max(p.e.c,u+v.length-1);var E=ur(o);if(i)for(y=0;y<v.length;++y)l[tr(y+u)+E]={t:"s",v:v[y]};return l["!ref"]=ot(p),l}function AH(t,e){return mC(null,t,e)}function Iu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=sr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Iu(t,Je(e)):Iu(t,Je({r:e,c:r||0}))}function NH(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function mx(){return{SheetNames:[],Sheets:{}}}function px(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);i=l&&+l[2]||0;var o=l&&l[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(V4(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function DH(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=NH(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function RH(t,e){return t.z=e,t}function pC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function OH(t,e,r){return pC(t,"#"+e,r)}function FH(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function IH(t,e,r,n){for(var i=typeof e!="string"?e:Et(e),l=typeof e=="string"?e:ot(e),o=i.s.r;o<=i.e.r;++o)for(var u=i.s.c;u<=i.e.c;++u){var h=Iu(t,o,u);h.t="n",h.F=l,delete h.v,o==i.s.r&&u==i.s.c&&(h.f=r,n&&(h.D=!0))}return t}var MH={encode_col:tr,encode_row:ur,encode_cell:Je,encode_range:ot,decode_col:Hg,decode_row:jg,split_cell:JO,decode_cell:sr,decode_range:pn,format_cell:za,sheet_add_aoa:Ib,sheet_add_json:mC,sheet_add_dom:tC,aoa_to_sheet:zc,json_to_sheet:AH,table_to_sheet:rC,table_to_book:Gj,sheet_to_csv:dx,sheet_to_txt:dC,sheet_to_json:_h,sheet_to_html:eC,sheet_to_formulae:kH,sheet_to_row_object_array:_h,sheet_get_cell:Iu,book_new:mx,book_append_sheet:px,book_set_sheet_visibility:DH,cell_set_number_format:RH,cell_set_hyperlink:pC,cell_set_internal_link:OH,cell_add_comment:FH,sheet_set_array_formula:IH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},$h;function LH(t){$h=t}function BH(t,e){var r=$h(),n=e??{};if(t==null||t["!ref"]==null)return r.push(null),r;var i=Et(t["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),p="",x=[];n.dense=Array.isArray(t);for(var v=n.skipHidden&&t["!cols"]||[],y=n.skipHidden&&t["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(v[E]||{}).hidden||(x[E]=tr(E));var w=i.s.r,S=!1,N=0;return r._read=function(){if(!S)return S=!0,r.push("\uFEFF");for(;w<=i.e.r;)if(++w,!(y[w-1]||{}).hidden&&(p=hC(t,i,w-1,x,o,h,l,n),p!=null&&(n.strip&&(p=p.replace(d,"")),p||n.blankrows!==!1)))return r.push((N++?u:"")+p);return r.push(null)},r}function PH(t,e){var r=$h(),n=e||{},i=n.header!=null?n.header:Q4,l=n.footer!=null?n.footer:Z4;r.push(i);var o=pn(t["!ref"]);n.dense=Array.isArray(t),r.push(J4(t,o,n));var u=o.s.r,h=!1;return r._read=function(){if(u>o.e.r)return h||(h=!0,r.push("</table>"+l)),r.push(null);for(;u<=o.e.r;){r.push($4(t,o,u,n)),++u;break}},r}function UH(t,e){var r=$h({objectMode:!0});if(t==null||t["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},i=0,l=1,o=[],u=0,h="",d={s:{r:0,c:0},e:{r:0,c:0}},p=e||{},x=p.range!=null?p.range:t["!ref"];switch(p.header===1?i=1:p.header==="A"?i=2:Array.isArray(p.header)&&(i=3),typeof x){case"string":d=Et(x);break;case"number":d=Et(t["!ref"]),d.s.r=x;break;default:d=x}i>0&&(l=0);var v=ur(d.s.r),y=[],E=0,w=Array.isArray(t),S=d.s.r,N=0,I={};w&&!t[S]&&(t[S]=[]);var C=p.skipHidden&&t["!cols"]||[],z=p.skipHidden&&t["!rows"]||[];for(N=d.s.c;N<=d.e.c;++N)if(!(C[N]||{}).hidden)switch(y[N]=tr(N),n=w?t[S][N]:t[y[N]+v],i){case 1:o[N]=N-d.s.c;break;case 2:o[N]=y[N];break;case 3:o[N]=p.header[N-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),h=u=za(n,null,p),E=I[u]||0,!E)I[u]=1;else{do h=u+"_"+E++;while(I[h]);I[u]=E,I[h]=1}o[N]=h}return S=d.s.r+l,r._read=function(){for(;S<=d.e.r;)if(!(z[S-1]||{}).hidden){var X=fC(t,d,S,y,i,o,w,p);if(++S,X.isempty===!1||(i===1?p.blankrows!==!1:p.blankrows)){r.push(X.row);return}}return r.push(null)},r}var jH={to_json:UH,to_html:PH,to_csv:BH,set_readable:LH};const HH=yu.version,OE=Object.freeze(Object.defineProperty({__proto__:null,CFB:We,SSF:mb,parse_xlscfb:sx,parse_zip:sC,read:Fu,readFile:NE,readFileSync:NE,set_cptable:GR,set_fs:_O,stream:jH,utils:MH,version:HH,write:Kh,writeFile:DE,writeFileAsync:CH,writeFileSync:DE,writeFileXLSX:bH,writeXLSX:fx},Symbol.toStringTag,{value:"Module"})),rf=()=>OE,gx=(t,e)=>{const r={},n=Object.keys(t);for(const[i,l]of Object.entries(e)){const o=n.find(u=>u.trim().toLowerCase().includes(i.toLowerCase()));o&&(r[l]=t[o])}return r},zH=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=i=>{var l;try{const o=rf(),u=(l=i.target)==null?void 0:l.result,h=o.read(u,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],x=o.utils.sheet_to_json(d).map(v=>{const y=gx(v,{cccd:"cccd",mssv:"mssv","h tn":"hoTen","ngy vo":"ngayVaoDang","chnh thc":"loaiDangVien",nhm:"nhom"});return!y.cccd||!y.hoTen?null:{cccd:String(y.cccd).trim(),mssv:y.mssv?String(y.mssv).trim():"",hoTen:y.hoTen,ngayVaoDang:y.ngayVaoDang||"",loaiDangVien:y.loaiDangVien||"",nhom:y.nhom||"",hasVotedPhase1:!1,hasVotedPhase2:!1}}).filter(Boolean);e(x)}catch(o){r(o)}},n.readAsBinaryString(t)}),VH=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=i=>{var l;try{const o=rf(),u=(l=i.target)==null?void 0:l.result,h=o.read(u,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],x=o.utils.sheet_to_json(d).map(v=>{const y=gx(v,{cccd:"cccd",mssv:"mssv","h tn":"hoTen","ngy vo":"ngayVaoDang","chnh thc":"loaiDangVien",nhm:"nhom",kha:"khoa","chc v":"chucVu","im ht":"diemHT","im rl":"diemRL","thnh tch":"thanhTich","t nh gi":"tuDanhGia","mc  htnv":"tuDanhGia"});return y.cccd?{...y,cccd:String(y.cccd).trim(),mssv:y.mssv?String(y.mssv).trim():"",tuDanhGia:y.tuDanhGia||""}:null}).filter(Boolean);e(x)}catch(o){r(o)}},n.readAsBinaryString(t)}),GH=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=i=>{var l;try{const o=rf(),u=(l=i.target)==null?void 0:l.result,h=o.read(u,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],x=o.utils.sheet_to_json(d).map(v=>{const y=gx(v,{cccd:"cccd",mssv:"mssv","h tn":"hoTen","ngy vo":"ngayVaoDang","chnh thc":"loaiDangVien",nhm:"nhom",kha:"khoa","chc v":"chucVu","im ht":"diemHT","im rl":"diemRL","thnh tch":"thanhTich"," xut":"chiBoDeXuat"});return y.cccd?{...y,cccd:String(y.cccd).trim(),mssv:y.mssv?String(y.mssv).trim():"",tuDanhGia:""}:null}).filter(Boolean);e(x)}catch(o){r(o)}},n.readAsBinaryString(t)}),P0=(t,e)=>{try{const r=rf(),n=r.utils.json_to_sheet(t),i=r.utils.book_new();r.utils.book_append_sheet(i,n,"Result"),r.writeFile(i,`${e}.xlsx`)}catch(r){console.error("Export error",r),alert("Li xut file Excel. Vui lng th li.")}},WH=(t,e)=>{try{const r=rf(),n=r.utils.book_new(),i=t.votesP1.map(h=>{const d=t.voters.find(x=>x.cccd===h.voterCCCD),p=t.candidatesP1.find(x=>x.cccd===h.candidateCCCD);return{"CCCD Ngi Bu":h.voterCCCD,"Tn Ngi Bu":(d==null?void 0:d.hoTen)||"Unknown","CCCD Ngi c Bu":h.candidateCCCD,"Tn Ngi c Bu":(p==null?void 0:p.hoTen)||"Unknown","Mc nh Gi":h.level}}),l=r.utils.json_to_sheet(i);r.utils.book_append_sheet(n,l,"Chi_Tiet_P1");const o=t.votesP2.map(h=>{const d=t.voters.find(x=>x.cccd===h.voterCCCD),p=t.candidatesP2.find(x=>x.cccd===h.candidateCCCD);return{"CCCD Ngi Bu":h.voterCCCD,"Tn Ngi Bu":(d==null?void 0:d.hoTen)||"Unknown","CCCD Ngi c Bu":h.candidateCCCD,"Tn Ngi c Bu":(p==null?void 0:p.hoTen)||"Unknown","Loi Bu":"Xut sc"}}),u=r.utils.json_to_sheet(o);r.utils.book_append_sheet(n,u,"Chi_Tiet_P2"),r.writeFile(n,`${e}.xlsx`)}catch(r){console.error("Export audit error",r),alert("Li xut bo co chi tit.")}},Hm=t=>{let e=[],r="";t==="voters"?(e=[{CCCD:"0123456789",MSSV:"B123456","H tn":"Nguyn Vn A","Ngy vo ng":"03/02/2020","Chnh thc/D b":"Chnh thc",Nhm:"Chi b 1"}],r="Mau_DS_Cu_Tri"):t==="p1"?(e=[{CCCD:"0123456789",MSSV:"B123456","H tn":"Nguyn Vn A","Ngy vo ng":"03/02/2020","Chnh thc/D b":"Chnh thc",Nhm:"Chi b 1",Kha:"K46","Chc v":"ng vin","im HT":90,"im RL":85,"Thnh tch":"Giy khen","T nh gi mc  HTNV":"Hon thnh tt"}],r="Mau_DS_Bau_P1"):(e=[{CCCD:"0123456789",MSSV:"B123456","H tn":"Nguyn Vn A","Ngy vo ng":"03/02/2020","Chnh thc/D b":"Chnh thc",Nhm:"Chi b 1",Kha:"K46","Chc v":"ng vin","im HT":90,"im RL":85,"Thnh tch":"Giy khen","Chi b  xut":"Xut sc"}],r="Mau_DS_Bau_P2"),P0(e,r)};var Sn=(t=>(t.KHONG_HOAN_THANH="Khng hon thnh",t.HOAN_THANH="Hon thnh",t.HOAN_THANH_TOT="Hon thnh tt",t))(Sn||{});const Qr=({children:t,variant:e="primary",className:r,...n})=>{let i="px-4 py-2 rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed";const l={primary:"bg-[#BE1E2D] text-white hover:bg-[#991B1B] focus:ring-red-500",gold:"bg-yellow-500 text-red-900 hover:bg-yellow-400 focus:ring-yellow-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 focus:ring-red-500"};return _.jsx("button",{className:`${i} ${l[e]} ${r||""}`,...n,children:t})};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XH=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qH=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),FE=t=>{const e=qH(t);return e.charAt(0).toUpperCase()+e.slice(1)},gC=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),YH=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var KH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $H=it.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:l,iconNode:o,...u},h)=>it.createElement("svg",{ref:h,...KH,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:gC("lucide",i),...!l&&!YH(u)&&{"aria-hidden":"true"},...u},[...o.map(([d,p])=>it.createElement(d,p)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=(t,e)=>{const r=it.forwardRef(({className:n,...i},l)=>it.createElement($H,{ref:l,iconNode:e,className:gC(`lucide-${XH(FE(t))}`,`lucide-${t}`,n),...i}));return r.displayName=FE(t),r};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QH=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],zm=st("activity",QH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZH=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],IE=st("award",ZH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JH=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ez=st("book-open",JH);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],rz=st("calendar",tz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ME=st("check",nz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],iz=st("chevron-down",az);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],LE=st("chevron-right",sz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],cz=st("chevron-up",lz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],lu=st("circle-alert",oz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Xs=st("circle-check-big",uz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],BE=st("circle-minus",fz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],dz=st("circle-question-mark",hz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],pz=st("cloud-lightning",mz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],xz=st("cloud-off",gz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],_z=st("cloud",vz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],cc=st("download",yz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],PE=st("eye-off",wz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],UE=st("eye",Ez);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],jE=st("file-spreadsheet",Tz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],bz=st("flag",Sz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],xC=st("funnel",Cz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Az=st("hash",kz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Ap=st("layout-grid",Nz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],vC=st("list",Dz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Vm=st("loader-circle",Rz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],HE=st("lock",Oz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Iz=st("log-out",Fz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Lz=st("refresh-cw",Mz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bz=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Pz=st("rotate-ccw",Bz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],cu=st("search",Uz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zE=st("settings",jz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hz=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],zz=st("shield-check",Hz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Gz=st("shield",Vz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wz=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Xz=st("square-check-big",Wz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qz=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Sc=st("star",qz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Kz=st("tag",Yz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $z=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],Qz=st("thumbs-up",$z);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],VE=st("toggle-left",Zz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],GE=st("toggle-right",Jz);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eV=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Gm=st("trash-2",eV);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tV=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Wm=st("triangle-alert",tV);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rV=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Xm=st("upload",rV);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nV=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],WE=st("user-check",nV);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aV=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ou=st("users",aV);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iV=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],XE=st("x",iV);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sV=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],lV=st("zap",sV),cV=({onBack:t})=>{const[e,r]=it.useState(!1),[n,i]=it.useState(""),[l,o]=it.useState(""),[u,h]=it.useState(Wr()),[d,p]=it.useState("system"),[x,v]=it.useState(null),[y,E]=it.useState(!1),[w,S]=it.useState(""),[N,I]=it.useState("all"),[C,z]=it.useState({isOpen:!1,type:"full"}),[X,W]=it.useState(""),[R,Q]=it.useState(""),[G,fe]=it.useState(null),re=Uc();it.useEffect(()=>{const be=()=>h(Wr());return window.addEventListener("db_update",be),()=>window.removeEventListener("db_update",be)},[]);const K=be=>{be.preventDefault(),n==="admin123"?(r(!0),o("")):o("Mt khu khng chnh xc")},ye=be=>{v(be),setTimeout(()=>v(null),3e3)},Ie=async(be,de)=>{const te=Wr();te.config={...te.config,[be]:de},await Ma(te),h(te),ye(" lu cu hnh.")},Ce=async(be,de)=>{const te=Wr();te.config.p1Display[be]=de,await Ma(te),h(te)},Y=async(be,de)=>{const te=Wr();te.config.p2Display[be]=de,await Ma(te),h(te)},ue=async()=>{if(!confirm("Hnh ng ny s ly d liu t my ca BN v ghi  ln Cloud. Hy chc chn d liu trn my bn l chun nht."))return;E(!0);const be=await MR();E(!1),be.success?(ye("ng b thnh cng!"),alert(be.message)):(ye("ng b tht bi"),alert(be.message))},Me=async(be,de)=>{var te;if((te=be.target.files)!=null&&te[0]){try{const Pe=be.target.files[0],Ge=Wr();if(de==="voters"){const vr=(await zH(Pe)).map(cn=>{const Yr=Ge.voters.find(Ot=>String(Ot.cccd).trim()===String(cn.cccd).trim());return Yr?{...cn,hasVotedPhase1:Yr.hasVotedPhase1,hasVotedPhase2:Yr.hasVotedPhase2}:cn});Ge.voters=vr}else de==="p1"?Ge.candidatesP1=await VH(Pe):Ge.candidatesP2=await GH(Pe);await Ma(Ge),h(Ge),ye("Import d liu thnh cng!")}catch{ye("Li c file Excel.")}be.target.value=""}},Z=be=>{z({isOpen:!0,type:be}),W(""),Q("")},Le=async be=>{be.preventDefault(),X==="admin123"?(C.type==="full"?await rb(!0):C.type==="voters"?await PR():C.type==="p1"?await LR():C.type==="p2"&&await BR(),h(Wr()),z({...C,isOpen:!1}),ye(" xa d liu thnh cng.")):Q("Mt khu xc nhn khng ng!")},U=()=>{switch(C.type){case"voters":return"Hnh ng ny s xa ton b DANH SCH C TRI v KT QU BU C hin ti. D liu ng vin s c gi li.";case"p1":return"Hnh ng ny s xa ton b NG VIN PHN 1 v KT QU NH GI P1. Trng thi ' vote' ca c tri s c reset.";case"p2":return"Hnh ng ny s xa ton b NG VIN PHN 2 v KT QU BNH BU P2. Trng thi ' vote' ca c tri s c reset.";default:return"Hnh ng ny s XA VNH VIN ton b C tri, ng vin v Kt qu phiu bu hin ti."}},k=be=>{const de=u.votesP1.filter(te=>String(te.candidateCCCD).trim()===String(be).trim());return{kht:de.filter(te=>te.level===Sn.KHONG_HOAN_THANH).length,ht:de.filter(te=>te.level===Sn.HOAN_THANH).length,htt:de.filter(te=>te.level===Sn.HOAN_THANH_TOT).length,total:de.length}},P=()=>{const be=u.candidatesP1.map(de=>{const te=k(de.cccd),Pe=te.total||1,Ge=bt=>`${bt} (${(bt/Pe*100).toFixed(1)}%)`;return{"M D (CCCD)":de.cccd,MSSV:de.mssv,"H Tn":de.hoTen,"Ngy vo ng":de.ngayVaoDang,"Loi V":de.loaiDangVien,"Chi b/Nhm":de.nhom,"n v (Kha)":de.khoa,"Chc v":de.chucVu,"im HT":de.diemHT,"im RL":de.diemRL,"Thnh tch":de.thanhTich,"T nh gi":de.tuDanhGia,"K.Hon Thnh":Ge(te.kht),"Hon Thnh":Ge(te.ht),"HT Tt":Ge(te.htt),"Tng phiu":te.total}});P0(be,`Ket_Qua_Danh_Gia_P1_${new Date().getTime()}`)},M=()=>{const be=u.voters.filter(te=>te.hasVotedPhase2).length||1,de=(u.candidatesP2||[]).map(te=>{const Pe=u.votesP2.filter(bt=>String(bt.candidateCCCD).trim()===String(te.cccd).trim()).length,Ge=(Pe/be*100).toFixed(2)+"%";return{"M D (CCCD)":te.cccd,MSSV:te.mssv,"H Tn":te.hoTen,"Ngy vo ng":te.ngayVaoDang,"Loi V":te.loaiDangVien,"Chi b/Nhm":te.nhom,"n v (Kha)":te.khoa,"Chc v":te.chucVu,"im HT":te.diemHT,"im RL":te.diemRL,"Thnh tch":te.thanhTich,"Chi b  xut":te.chiBoDeXuat,"S phiu bu":Pe,"T l t":Ge}}).sort((te,Pe)=>Pe["S phiu bu"]-te["S phiu bu"]);P0(de,`Ket_Qua_Binh_Bau_P2_${new Date().getTime()}`)},j=()=>{WH(u,`Chi_Tiet_Lich_Su_Bau_${new Date().getTime()}`)},ee=()=>{const be=u.voters.map(de=>({CCCD:de.cccd,MSSV:de.mssv,"H Tn":de.hoTen,"Ngy Vo ng":de.ngayVaoDang,"Chi B":de.nhom,"Trng thi P1":de.hasVotedPhase1?" Vote":"Cha","Trng thi P2":de.hasVotedPhase2?" Vote":"Cha"}));P0(be,`Trang_Thai_Cu_Tri_${new Date().getTime()}`)},xe=be=>{const de=u.votesP1.filter(Pe=>Pe.voterCCCD===be.cccd).map(Pe=>{const Ge=u.candidatesP1.find(bt=>bt.cccd===Pe.candidateCCCD);return{name:(Ge==null?void 0:Ge.hoTen)||Pe.candidateCCCD,level:Pe.level}}),te=u.votesP2.filter(Pe=>Pe.voterCCCD===be.cccd).map(Pe=>{const Ge=u.candidatesP2.find(bt=>bt.cccd===Pe.candidateCCCD);return{name:(Ge==null?void 0:Ge.hoTen)||Pe.candidateCCCD}});return{p1:de,p2:te}},Te=({title:be,value:de,subtext:te,icon:Pe,color:Ge})=>_.jsxs("div",{className:`bg-white rounded-xl p-5 shadow-sm border border-gray-100 flex items-center justify-between group hover:border-${Ge}-200 transition-all`,children:[_.jsxs("div",{children:[_.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase tracking-wider mb-1",children:be}),_.jsx("h3",{className:`text-2xl font-black text-${Ge}-600`,children:de}),te&&_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:te})]}),_.jsx("div",{className:`p-3 rounded-full bg-${Ge}-50 text-${Ge}-600`,children:_.jsx(Pe,{className:"w-6 h-6"})})]}),me=({label:be,field:de})=>_.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer bg-white p-2 rounded border border-gray-200 hover:bg-gray-50 transition-colors",children:[_.jsx("input",{type:"checkbox",className:"rounded text-[#BE1E2D] focus:ring-red-500",checked:u.config.p1Display[de],onChange:te=>Ce(de,te.target.checked)}),_.jsx("span",{className:"text-sm text-gray-700 font-medium",children:be})]}),we=({label:be,field:de})=>_.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer bg-white p-2 rounded border border-gray-200 hover:bg-gray-50 transition-colors",children:[_.jsx("input",{type:"checkbox",className:"rounded text-yellow-600 focus:ring-yellow-500",checked:u.config.p2Display[de],onChange:te=>Y(de,te.target.checked)}),_.jsx("span",{className:"text-sm text-gray-700 font-medium",children:be})]}),$e=()=>{const be=u.voters.filter(de=>de.hoTen.toLowerCase().includes(w.toLowerCase())||de.mssv.toLowerCase().includes(w.toLowerCase())||de.cccd.includes(w)?N==="p1_done"?de.hasVotedPhase1:N==="p1_not"?!de.hasVotedPhase1:N==="p2_done"?de.hasVotedPhase2:N==="p2_not"?!de.hasVotedPhase2:!0:!1);return _.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[_.jsx(Te,{title:"Tng C Tri",value:u.voters.length,subtext:"S lng ng vin trong h thng",icon:ou,color:"gray"}),_.jsxs("div",{className:"md:col-span-2 bg-gradient-to-r from-gray-800 to-gray-900 rounded-xl p-6 text-white flex flex-col justify-center relative overflow-hidden shadow-lg",children:[_.jsx("div",{className:"absolute right-0 top-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-10 -mt-10"}),_.jsxs("div",{className:"flex justify-between items-start",children:[_.jsxs("div",{children:[_.jsxs("h3",{className:"text-xl font-bold mb-2 flex items-center gap-2",children:[_.jsx(zE,{className:"w-5 h-5"})," Trng thi H thng"]}),_.jsxs("div",{className:"flex gap-8 mt-2",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("span",{className:`w-3 h-3 rounded-full ${u.config.isPhase1Open?"bg-green-400 shadow-[0_0_10px_rgba(74,222,128,0.5)]":"bg-red-500"}`}),_.jsxs("span",{className:"font-medium",children:["Cng 1: ",u.config.isPhase1Open?"ang m":" ng"]})]}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("span",{className:`w-3 h-3 rounded-full ${u.config.isPhase2Open?"bg-green-400 shadow-[0_0_10px_rgba(74,222,128,0.5)]":"bg-red-500"}`}),_.jsxs("span",{className:"font-medium",children:["Cng 2: ",u.config.isPhase2Open?"ang m":" ng"]})]}),!re&&_.jsxs("div",{className:"flex items-center gap-3 text-yellow-300",children:[_.jsx(Wm,{className:"w-4 h-4"})," ",_.jsx("span",{children:"Offline Mode (LocalStorage)"})]})]})]}),re&&_.jsxs("button",{onClick:ue,disabled:y,className:"bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-lg flex items-center gap-2 shadow-lg transition-all",title:"Nu ngi khc khng thy d liu, bm vo y  y d liu t my bn ln Cloud.",children:[_.jsx(Lz,{className:`w-4 h-4 ${y?"animate-spin":""}`}),y?"ang y ln...":"ng b ln Cloud"]})]})]})]}),_.jsx("div",{className:"grid md:grid-cols-1 gap-6",children:_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col",children:[_.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[_.jsx(ou,{className:"w-4 h-4 text-gray-500"}),_.jsx("h3",{className:"font-bold text-gray-800",children:"Qun l D liu H thng"})]}),_.jsxs("div",{className:"p-6 flex flex-col md:flex-row gap-6",children:[_.jsx("div",{className:"flex-1 flex flex-col gap-4",children:_.jsxs("div",{className:"flex items-center justify-between bg-blue-50 p-4 rounded-lg border border-blue-100",children:[_.jsxs("div",{children:[_.jsx("div",{className:"font-bold text-blue-900",children:"Nhp Danh Sch C Tri"}),_.jsx("div",{className:"text-xs text-blue-700",children:"File Excel (.xlsx) cha CCCD, H tn..."})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:()=>Hm("voters"),className:"p-2 bg-white text-blue-600 rounded border border-blue-200 hover:bg-blue-50",title:"Ti mu",children:_.jsx(cc,{className:"w-4 h-4"})}),_.jsxs("label",{className:"p-2 bg-blue-600 text-white rounded cursor-pointer hover:bg-blue-700 shadow-sm",children:[_.jsx(Xm,{className:"w-4 h-4"}),_.jsx("input",{type:"file",hidden:!0,accept:".xlsx",onChange:de=>Me(de,"voters")})]})]})]})}),_.jsxs("div",{className:"flex-1 border-l border-gray-100 pl-6 flex flex-col justify-center",children:[_.jsxs("h4",{className:"font-bold text-red-800 text-sm mb-2 flex items-center gap-1",children:[_.jsx(Wm,{className:"w-4 h-4"})," Reset H thng"]}),_.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Ty chn xa d liu  bt u li."}),_.jsxs("div",{className:"flex flex-col gap-2",children:[_.jsxs(Qr,{variant:"danger",className:"w-full text-sm py-2",onClick:()=>Z("full"),children:[_.jsx(Gm,{className:"w-4 h-4 mr-2 inline"})," Xa Ton b H thng"]}),_.jsxs(Qr,{variant:"outline",className:"w-full text-sm py-2 text-red-600 border-red-200 hover:bg-red-50",onClick:()=>Z("voters"),children:[_.jsx(ou,{className:"w-4 h-4 mr-2 inline"})," Ch xa DS C tri"]})]})]})]})]})}),_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col min-h-[400px]",children:[_.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-wrap justify-between items-center gap-4 bg-gray-50",children:[_.jsxs("h3",{className:"font-bold text-gray-800 uppercase text-sm tracking-wider flex items-center gap-2",children:[_.jsx(Xs,{className:"w-4 h-4 text-green-600"})," Theo di Trng thi Bu c"]}),_.jsxs("div",{className:"flex gap-2 flex-1 justify-end max-w-2xl",children:[_.jsxs("div",{className:"relative flex-1",children:[_.jsx(cu,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),_.jsx("input",{className:"w-full pl-9 pr-3 py-1.5 rounded border border-gray-300 text-sm focus:ring-1 focus:ring-blue-500",placeholder:"Tm tn, MSSV, CCCD...",value:w,onChange:de=>S(de.target.value)})]}),_.jsxs("div",{className:"relative",children:[_.jsxs("select",{className:"pl-2 pr-8 py-1.5 rounded border border-gray-300 text-sm appearance-none bg-white cursor-pointer hover:bg-gray-50 focus:ring-1 focus:ring-blue-500 outline-none",value:N,onChange:de=>I(de.target.value),children:[_.jsx("option",{value:"all",children:"Tt c c tri"}),_.jsx("option",{value:"p1_done",children:" Vote P1"}),_.jsx("option",{value:"p1_not",children:"Cha Vote P1"}),_.jsx("option",{value:"p2_done",children:" Vote P2"}),_.jsx("option",{value:"p2_not",children:"Cha Vote P2"})]}),_.jsx(xC,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400 pointer-events-none"})]}),_.jsxs(Qr,{variant:"outline",onClick:ee,className:"py-1.5 text-xs h-auto bg-white whitespace-nowrap",children:[_.jsx(vC,{className:"w-3 h-3 mr-1"})," DS C tri"]}),_.jsxs(Qr,{onClick:j,className:"py-1.5 text-xs h-auto bg-gray-800 text-white hover:bg-gray-900 whitespace-nowrap",children:[_.jsx(cc,{className:"w-3 h-3 mr-1"})," Bo co Chi tit"]})]})]}),_.jsx("div",{className:"overflow-x-auto flex-1",children:_.jsxs("table",{className:"w-full text-sm text-left",children:[_.jsx("thead",{className:"bg-gray-100 text-gray-700 font-bold uppercase text-xs",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-4 py-3 w-10 text-center border-r",children:"STT"}),_.jsx("th",{className:"px-4 py-3 border-r",children:"C Tri"}),_.jsx("th",{className:"px-4 py-3 w-32 border-r",children:"CCCD"}),_.jsx("th",{className:"px-4 py-3 w-32 text-center border-r",children:"Vote Phn 1"}),_.jsx("th",{className:"px-4 py-3 w-32 text-center border-r",children:"Vote Phn 2"}),_.jsx("th",{className:"px-4 py-3 w-20 text-center",children:"Chi tit"})]})}),_.jsx("tbody",{className:"divide-y divide-gray-100",children:be.length===0?_.jsx("tr",{children:_.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:"Khng tm thy d liu ph hp"})}):be.map((de,te)=>_.jsxs("tr",{className:"hover:bg-gray-50",children:[_.jsx("td",{className:"px-4 py-3 text-center text-gray-500 border-r",children:te+1}),_.jsxs("td",{className:"px-4 py-3 border-r",children:[_.jsx("div",{className:"font-bold text-gray-800",children:de.hoTen}),_.jsxs("div",{className:"text-xs text-gray-400",children:[de.mssv," - ",de.nhom]})]}),_.jsx("td",{className:"px-4 py-3 border-r font-mono text-gray-500 text-xs",children:de.cccd}),_.jsx("td",{className:"px-4 py-3 text-center border-r",children:de.hasVotedPhase1?_.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-bold text-green-600 bg-green-50 px-2 py-1 rounded-full border border-green-200",children:[_.jsx(Xs,{className:"w-3 h-3"}),"  Vote"]}):_.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-400 bg-gray-100 px-2 py-1 rounded-full",children:[_.jsx(BE,{className:"w-3 h-3"})," Cha"]})}),_.jsx("td",{className:"px-4 py-3 text-center border-r",children:de.hasVotedPhase2?_.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-bold text-green-600 bg-green-50 px-2 py-1 rounded-full border border-green-200",children:[_.jsx(Xs,{className:"w-3 h-3"}),"  Vote"]}):_.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-400 bg-gray-100 px-2 py-1 rounded-full",children:[_.jsx(BE,{className:"w-3 h-3"})," Cha"]})}),_.jsx("td",{className:"px-4 py-3 text-center",children:_.jsx("button",{onClick:()=>fe(de),className:"p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Xem chi tit phiu bu",children:_.jsx(UE,{className:"w-4 h-4"})})})]},de.cccd))})]})})]})]})},H=()=>{const be=u.voters.filter(te=>te.hasVotedPhase1).length,de=(u.candidatesP1||[]).filter(te=>te.hoTen.toLowerCase().includes(w.toLowerCase())||te.mssv.toLowerCase().includes(w.toLowerCase()));return _.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[_.jsx(Te,{title:"Tin  nh gi",value:`${Math.round(be/u.voters.length*100||0)}%`,subtext:`${be}/${u.voters.length} c tri  vote`,icon:zm,color:"red"}),_.jsxs("div",{className:"md:col-span-3 bg-white rounded-xl border border-gray-200 shadow-sm p-5 flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-bold text-gray-800",children:"iu khin Cng 1"}),_.jsx("p",{className:"text-sm text-gray-500",children:"Bt/Tt quyn truy cp nh gi xp loi"})]}),_.jsx("div",{className:"flex items-center gap-4",children:_.jsxs("button",{onClick:()=>Ie("isPhase1Open",!u.config.isPhase1Open),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold text-white transition-all ${u.config.isPhase1Open?"bg-red-600 hover:bg-red-700 shadow-red-200":"bg-gray-400 hover:bg-gray-500"}`,children:[u.config.isPhase1Open?_.jsx(GE,{className:"w-5 h-5"}):_.jsx(VE,{className:"w-5 h-5"}),u.config.isPhase1Open?"ang M":" ng"]})})]})]}),_.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[_.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[_.jsx(Ap,{className:"w-4 h-4 text-gray-500"}),_.jsx("h3",{className:"font-bold text-gray-800",children:"Cu hnh hin th th (P1)"})]}),_.jsx("div",{className:"p-6",children:_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsx(me,{field:"showCCCD",label:"CCCD/M D"}),_.jsx(me,{field:"showMSSV",label:"M s sinh vin"}),_.jsx(me,{field:"showNgayVaoDang",label:"Ngy vo ng"}),_.jsx(me,{field:"showLoaiDangVien",label:"Loi ng vin"}),_.jsx(me,{field:"showNhom",label:"Chi b/Nhm"}),_.jsx(me,{field:"showKhoa",label:"n v (Kha)"}),_.jsx(me,{field:"showChucVu",label:"Chc v"}),_.jsx(me,{field:"showDiemHT",label:"im HT"}),_.jsx(me,{field:"showDiemRL",label:"im RL"}),_.jsx(me,{field:"showThanhTich",label:"Thnh tch"}),_.jsx(me,{field:"showTuDanhGia",label:"T nh gi"})]})})]}),_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm flex flex-col overflow-hidden",children:[_.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[_.jsx(jE,{className:"w-4 h-4 text-gray-500"}),_.jsxs("div",{className:"flex-1",children:[_.jsx("h3",{className:"font-bold text-gray-800",children:"D liu ng vin (P1)"}),_.jsxs("div",{className:"text-xs text-gray-500",children:["Hin c: ",_.jsx("b",{children:u.candidatesP1.length})," ng vin"]})]})]}),_.jsx("div",{className:"p-6 flex-1 flex items-center",children:_.jsxs("div",{className:"w-full flex gap-3 bg-gray-50 p-4 rounded-lg border border-gray-100 items-center",children:[_.jsx("div",{className:"flex-1 text-sm text-gray-600",children:"Nhp danh sch ng vin cn nh gi t Excel."}),_.jsxs("button",{onClick:()=>Hm("p1"),className:"px-3 py-2 bg-white border border-gray-300 rounded text-sm font-medium hover:bg-gray-50 flex items-center gap-2",children:[_.jsx(cc,{className:"w-4 h-4"})," Ti mu"]}),_.jsxs("label",{className:"px-3 py-2 bg-[#BE1E2D] text-white rounded text-sm font-medium hover:bg-[#991B1B] cursor-pointer flex items-center gap-2 shadow-sm",children:[_.jsx(Xm,{className:"w-4 h-4"})," Nhp Excel",_.jsx("input",{type:"file",hidden:!0,accept:".xlsx",onChange:te=>Me(te,"p1")})]}),_.jsx("div",{className:"w-px h-8 bg-gray-200 mx-1"}),_.jsxs("button",{onClick:()=>Z("p1"),className:"px-3 py-2 bg-red-50 text-red-600 border border-red-200 rounded hover:bg-red-100 transition-colors flex items-center gap-1 font-bold text-xs whitespace-nowrap",title:"Xa d liu P1",children:[_.jsx(Gm,{className:"w-4 h-4"})," Xa D Liu"]})]})})]})]}),_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col min-h-[400px]",children:[_.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-wrap justify-between items-center gap-4 bg-gray-50",children:[_.jsx("h3",{className:"font-bold text-red-800 uppercase text-sm tracking-wider",children:"Kt qu Xp loi"}),_.jsxs("div",{className:"flex gap-2 flex-1 justify-end max-w-xl",children:[_.jsxs("div",{className:"relative flex-1",children:[_.jsx(cu,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),_.jsx("input",{className:"w-full pl-9 pr-3 py-1.5 rounded border border-gray-300 text-sm",placeholder:"Tm kim...",value:w,onChange:te=>S(te.target.value)})]}),_.jsxs(Qr,{variant:"outline",onClick:P,className:"py-1.5 text-xs h-auto bg-white",children:[_.jsx(cc,{className:"w-3 h-3 mr-1"})," Xut Excel"]})]})]}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-sm text-left",children:[_.jsx("thead",{className:"bg-gray-100 text-gray-700 font-bold uppercase text-xs",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-4 py-3 w-10 text-center border-r",children:"STT"}),_.jsx("th",{className:"px-4 py-3 border-r",children:"ng vin"}),_.jsx("th",{className:"px-2 py-2 text-center w-28 border-r text-red-600 bg-red-50",children:"Khng HT"}),_.jsx("th",{className:"px-2 py-2 text-center w-28 border-r text-blue-600 bg-blue-50",children:"Hon thnh"}),_.jsx("th",{className:"px-2 py-2 text-center w-28 text-green-600 bg-green-50",children:"HT Tt"})]})}),_.jsx("tbody",{className:"divide-y divide-gray-100",children:de.length===0?_.jsx("tr",{children:_.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-400",children:"Cha c d liu"})}):de.map((te,Pe)=>{const Ge=k(te.cccd),bt=Ge.total||1;return _.jsxs("tr",{className:"hover:bg-gray-50",children:[_.jsx("td",{className:"px-4 py-3 text-center text-gray-500 border-r",children:Pe+1}),_.jsxs("td",{className:"px-4 py-3 border-r font-medium",children:[te.hoTen,_.jsxs("div",{className:"text-xs text-gray-400 font-normal",children:[te.mssv," - ",te.khoa]})]}),_.jsxs("td",{className:"px-4 py-3 text-center border-r font-bold text-red-600 bg-red-50/20",children:[_.jsx("div",{children:Ge.kht||0}),_.jsxs("div",{className:"text-[10px] font-normal opacity-75",children:[Math.round(Ge.kht/bt*100),"%"]})]}),_.jsxs("td",{className:"px-4 py-3 text-center border-r font-bold text-blue-600 bg-blue-50/20",children:[_.jsx("div",{children:Ge.ht||0}),_.jsxs("div",{className:"text-[10px] font-normal opacity-75",children:[Math.round(Ge.ht/bt*100),"%"]})]}),_.jsxs("td",{className:"px-4 py-3 text-center font-bold text-green-600 bg-green-50/20",children:[_.jsx("div",{children:Ge.htt||0}),_.jsxs("div",{className:"text-[10px] font-normal opacity-75",children:[Math.round(Ge.htt/bt*100),"%"]})]})]},te.cccd)})})]})})]})]})},At=()=>{const be=u.voters.filter(Pe=>Pe.hasVotedPhase2).length,te=(u.candidatesP2||[]).map(Pe=>({...Pe,votes:u.votesP2.filter(Ge=>String(Ge.candidateCCCD).trim()===String(Pe.cccd).trim()).length})).sort((Pe,Ge)=>Ge.votes-Pe.votes).filter(Pe=>Pe.hoTen.toLowerCase().includes(w.toLowerCase()));return _.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[_.jsx(Te,{title:"Tin  Bu c",value:`${Math.round(be/u.voters.length*100||0)}%`,subtext:`${be}/${u.voters.length} c tri  vote`,icon:Sc,color:"yellow"}),_.jsxs("div",{className:"md:col-span-3 bg-white rounded-xl border border-gray-200 shadow-sm p-5 flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-bold text-gray-800",children:"iu khin Cng 2"}),_.jsx("p",{className:"text-sm text-gray-500",children:"Cu hnh s lng bu & hin th"})]}),_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 px-3 py-1.5 rounded-lg border border-gray-200",children:[_.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Max Vote:"}),_.jsx("input",{type:"number",min:"1",className:"w-12 text-center border rounded py-0.5 text-sm font-bold",value:u.config.maxExcellentVotes,onChange:Pe=>Ie("maxExcellentVotes",parseInt(Pe.target.value)||1)})]}),_.jsxs("button",{onClick:()=>Ie("isPhase2Open",!u.config.isPhase2Open),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold text-white transition-all ${u.config.isPhase2Open?"bg-yellow-500 hover:bg-yellow-600 shadow-yellow-200":"bg-gray-400 hover:bg-gray-500"}`,children:[u.config.isPhase2Open?_.jsx(GE,{className:"w-5 h-5"}):_.jsx(VE,{className:"w-5 h-5"}),u.config.isPhase2Open?"ang M":" ng"]})]})]})]}),_.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[_.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[_.jsx(Ap,{className:"w-4 h-4 text-gray-500"}),_.jsx("h3",{className:"font-bold text-gray-800",children:"Cu hnh hin th th (P2)"})]}),_.jsx("div",{className:"p-6",children:_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsx(we,{field:"showCCCD",label:"CCCD/M D"}),_.jsx(we,{field:"showMSSV",label:"M s sinh vin"}),_.jsx(we,{field:"showNgayVaoDang",label:"Ngy vo ng"}),_.jsx(we,{field:"showLoaiDangVien",label:"Loi ng vin"}),_.jsx(we,{field:"showNhom",label:"Chi b/Nhm"}),_.jsx(we,{field:"showKhoa",label:"n v (Kha)"}),_.jsx(we,{field:"showChucVu",label:"Chc v"}),_.jsx(we,{field:"showDiemHT",label:"im HT"}),_.jsx(we,{field:"showDiemRL",label:"im RL"}),_.jsx(we,{field:"showThanhTich",label:"Thnh tch"}),_.jsx(we,{field:"showChiBoDeXuat",label:" xut"})]})})]}),_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm flex flex-col overflow-hidden",children:[_.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-2",children:[_.jsx(jE,{className:"w-4 h-4 text-gray-500"}),_.jsxs("div",{className:"flex-1",children:[_.jsx("h3",{className:"font-bold text-gray-800",children:"D liu ng vin (P2)"}),_.jsxs("div",{className:"text-xs text-gray-500",children:["Hin c: ",_.jsx("b",{children:u.candidatesP2.length})," ng vin"]})]})]}),_.jsx("div",{className:"p-6 flex-1 flex items-center",children:_.jsxs("div",{className:"w-full flex gap-3 bg-gray-50 p-4 rounded-lg border border-gray-100 items-center",children:[_.jsx("div",{className:"flex-1 text-sm text-gray-600",children:"Nhp danh sch ng vin c  xut bu xut sc."}),_.jsxs("button",{onClick:()=>Hm("p2"),className:"px-3 py-2 bg-white border border-gray-300 rounded text-sm font-medium hover:bg-gray-50 flex items-center gap-2",children:[_.jsx(cc,{className:"w-4 h-4"})," Ti mu"]}),_.jsxs("label",{className:"px-3 py-2 bg-yellow-500 text-white rounded text-sm font-medium hover:bg-yellow-600 cursor-pointer flex items-center gap-2 shadow-sm",children:[_.jsx(Xm,{className:"w-4 h-4"})," Nhp Excel",_.jsx("input",{type:"file",hidden:!0,accept:".xlsx",onChange:Pe=>Me(Pe,"p2")})]}),_.jsx("div",{className:"w-px h-8 bg-gray-200 mx-1"}),_.jsxs("button",{onClick:()=>Z("p2"),className:"px-3 py-2 bg-red-50 text-red-600 border border-red-200 rounded hover:bg-red-100 transition-colors flex items-center gap-1 font-bold text-xs whitespace-nowrap",title:"Xa d liu P2",children:[_.jsx(Gm,{className:"w-4 h-4"})," Xa D Liu"]})]})})]})]}),_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col min-h-[400px]",children:[_.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[_.jsx("h3",{className:"font-bold text-yellow-700 uppercase text-sm tracking-wider",children:"Chi tit Phiu Bu"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsxs("div",{className:"relative w-48",children:[_.jsx(cu,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400"}),_.jsx("input",{className:"w-full pl-7 pr-2 py-1 rounded border border-gray-300 text-xs",placeholder:"Tm tn...",value:w,onChange:Pe=>S(Pe.target.value)})]}),_.jsxs("button",{onClick:M,className:"px-2 py-1 bg-white border border-gray-300 rounded text-xs hover:bg-gray-50",children:[_.jsx(cc,{className:"w-3 h-3 inline"})," Xut"]})]})]}),_.jsx("div",{className:"overflow-x-auto flex-1",children:_.jsxs("table",{className:"w-full text-sm text-left",children:[_.jsx("thead",{className:"bg-gray-100 text-gray-700 font-bold uppercase text-xs",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-4 py-3 w-10 text-center",children:"#"}),_.jsx("th",{className:"px-4 py-3",children:"ng vin"}),_.jsx("th",{className:"px-4 py-3",children:"Chi b  xut"}),_.jsx("th",{className:"px-4 py-3 text-center",children:"S phiu"}),_.jsx("th",{className:"px-4 py-3 w-24 text-right",children:"T l"})]})}),_.jsx("tbody",{className:"divide-y divide-gray-100",children:te.map((Pe,Ge)=>{const bt=u.voters.filter(cn=>cn.hasVotedPhase2).length||1,vr=Math.round(Pe.votes/bt*100);return _.jsxs("tr",{className:"hover:bg-gray-50",children:[_.jsx("td",{className:"px-4 py-3 text-center font-bold text-gray-500",children:Ge+1}),_.jsx("td",{className:"px-4 py-3 font-medium",children:Pe.hoTen}),_.jsx("td",{className:"px-4 py-3 text-xs text-amber-700",children:Pe.chiBoDeXuat}),_.jsx("td",{className:"px-4 py-3 text-center font-bold text-lg",children:Pe.votes}),_.jsxs("td",{className:"px-4 py-3 text-right text-xs text-gray-500",children:[vr,"%"]})]},Pe.cccd)})})]})})]})]})};if(!e)return _.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:_.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-sm p-8 border border-gray-200",children:[_.jsxs("div",{className:"text-center mb-6",children:[_.jsx("div",{className:"w-12 h-12 bg-[#BE1E2D] text-white rounded-full flex items-center justify-center mx-auto mb-3",children:_.jsx(zz,{className:"w-6 h-6"})}),_.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"ng nhp Qun Tr"}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Khu vc dnh cho cp y"})]}),_.jsxs("form",{onSubmit:K,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsxs("div",{className:"relative",children:[_.jsx(HE,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),_.jsx("input",{type:"password",className:"w-full pl-9 pr-3 py-2.5 rounded-lg border border-gray-300 text-sm focus:ring-2 focus:ring-[#BE1E2D] focus:border-[#BE1E2D] outline-none transition-all",placeholder:"Mt khu",value:n,onChange:be=>i(be.target.value),autoFocus:!0})]}),l&&_.jsx("p",{className:"text-red-500 text-xs mt-2 pl-1",children:l})]}),_.jsx(Qr,{type:"submit",className:"w-full bg-[#BE1E2D] hover:bg-[#991B1B] text-white",children:"Xc nhn"}),_.jsx("button",{type:"button",onClick:t,className:"w-full text-xs text-gray-500 hover:text-gray-800 py-2",children:"Quay li trang ch"})]})]})});const at={system:"Cu hnh H thng & C tri",p1:"Qun l Phn 1: nh gi Xp loi",p2:"Qun l Phn 2: Bnh bu Xut sc"};return _.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col font-sans",children:[x&&_.jsx("div",{className:"fixed top-4 right-4 z-50 bg-gray-900 text-white px-4 py-3 rounded shadow-lg animate-bounce",children:x}),G&&_.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in",children:_.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[_.jsxs("div",{className:"p-4 border-b bg-gray-50 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-blue-100 rounded-full text-blue-600",children:_.jsx(UE,{className:"w-5 h-5"})}),_.jsxs("div",{children:[_.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Lch s Bu C"}),_.jsx("div",{className:"text-lg font-bold text-gray-800",children:G.hoTen}),_.jsx("div",{className:"text-xs text-gray-400 font-mono",children:G.cccd})]})]}),_.jsx("button",{onClick:()=>fe(null),className:"text-gray-400 hover:text-red-500",children:_.jsx(XE,{className:"w-6 h-6"})})]}),_.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[_.jsxs("div",{children:[_.jsxs("h4",{className:"font-bold text-red-800 border-b border-red-100 pb-2 mb-3 flex items-center gap-2",children:[_.jsx(zm,{className:"w-4 h-4"})," Kt qu nh gi P1"]}),G.hasVotedPhase1?_.jsx("div",{className:"bg-white border rounded-lg overflow-hidden text-sm",children:_.jsxs("table",{className:"w-full text-left",children:[_.jsx("thead",{className:"bg-gray-100 text-gray-700 text-xs uppercase",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-3 py-2 border-r w-10 text-center",children:"#"}),_.jsx("th",{className:"px-3 py-2 border-r",children:"ng vin c nh gi"}),_.jsx("th",{className:"px-3 py-2 text-center w-32",children:"Mc "})]})}),_.jsx("tbody",{className:"divide-y",children:xe(G).p1.map((be,de)=>_.jsxs("tr",{className:"hover:bg-gray-50",children:[_.jsx("td",{className:"px-3 py-2 text-center text-gray-500 border-r",children:de+1}),_.jsx("td",{className:"px-3 py-2 border-r font-medium",children:be.name}),_.jsx("td",{className:"px-3 py-2 text-center",children:_.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold ${be.level===Sn.KHONG_HOAN_THANH?"bg-red-100 text-red-700":be.level===Sn.HOAN_THANH?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:be.level})})]},de))})]})}):_.jsx("div",{className:"text-sm text-gray-400 italic bg-gray-50 p-4 rounded text-center",children:"C tri cha thc hin nh gi Phn 1."})]}),_.jsxs("div",{children:[_.jsxs("h4",{className:"font-bold text-yellow-700 border-b border-yellow-100 pb-2 mb-3 flex items-center gap-2",children:[_.jsx(Sc,{className:"w-4 h-4"})," Bu Xut sc P2"]}),G.hasVotedPhase2?_.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:xe(G).p2.length===0?_.jsx("div",{className:"col-span-2 text-sm text-gray-500 p-3 bg-gray-50 rounded italic text-center",children:"Phiu trng (Khng chn ai)"}):xe(G).p2.map((be,de)=>_.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-yellow-900 text-sm font-medium",children:[_.jsx(Xs,{className:"w-4 h-4 text-yellow-600"})," ",be.name]},de))}):_.jsx("div",{className:"text-sm text-gray-400 italic bg-gray-50 p-4 rounded text-center",children:"C tri cha thc hin bu Phn 2."})]})]}),_.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:_.jsx(Qr,{variant:"secondary",onClick:()=>fe(null),children:"ng"})})]})}),C.isOpen&&_.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in",children:_.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 border border-red-200",children:[_.jsxs("div",{className:"flex justify-between items-center mb-4",children:[_.jsxs("h3",{className:"text-lg font-bold text-red-800 flex items-center gap-2",children:[_.jsx(Wm,{className:"w-5 h-5"})," Xc nhn Reset"]}),_.jsx("button",{onClick:()=>z({...C,isOpen:!1}),className:"text-gray-400 hover:text-gray-800",children:_.jsx(XE,{className:"w-5 h-5"})})]}),_.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[U(),_.jsx("br",{}),_.jsx("br",{}),"Vui lng nhp mt khu admin  xc nhn."]}),_.jsxs("form",{onSubmit:Le,children:[_.jsxs("div",{className:"mb-4",children:[_.jsx("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-red-500 outline-none",placeholder:"Nhp mt khu...",value:X,onChange:be=>W(be.target.value),autoFocus:!0}),R&&_.jsxs("p",{className:"text-red-600 text-xs mt-1 flex items-center gap-1",children:[_.jsx(lu,{className:"w-3 h-3"})," ",R]})]}),_.jsxs("div",{className:"flex justify-end gap-2",children:[_.jsx(Qr,{type:"button",variant:"outline",onClick:()=>z({...C,isOpen:!1}),children:"Hy"}),_.jsx(Qr,{type:"submit",variant:"danger",children:"Xc nhn Xa"})]})]})]})}),_.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between sticky top-0 z-30 shadow-sm",children:[_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-800",title:"ng xut",children:_.jsx(HE,{className:"w-5 h-5"})}),_.jsx("div",{className:"h-8 w-1 bg-[#BE1E2D] rounded-full hidden sm:block"}),_.jsx("h1",{className:"font-black text-lg sm:text-xl text-gray-800 tracking-tight uppercase",children:at[d]}),re?_.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-green-600 bg-green-50 px-2 py-0.5 rounded-full border border-green-100 font-bold",children:[_.jsx(_z,{className:"w-3 h-3"})," Online"]}):_.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full border border-gray-200 font-bold",children:[_.jsx(xz,{className:"w-3 h-3"})," Local"]})]}),_.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[_.jsxs("button",{onClick:()=>{p("system"),S("")},className:`px-3 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${d==="system"?"bg-white shadow-sm text-gray-900":"text-gray-500 hover:text-gray-700"}`,children:[_.jsx(zE,{className:"w-4 h-4"})," ",_.jsx("span",{className:"hidden sm:inline",children:"H Thng"})]}),_.jsxs("button",{onClick:()=>{p("p1"),S("")},className:`px-3 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${d==="p1"?"bg-white shadow-sm text-[#BE1E2D]":"text-gray-500 hover:text-gray-700"}`,children:[_.jsx(zm,{className:"w-4 h-4"})," ",_.jsx("span",{className:"hidden sm:inline",children:"Phn 1"})]}),_.jsxs("button",{onClick:()=>{p("p2"),S("")},className:`px-3 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-all ${d==="p2"?"bg-white shadow-sm text-yellow-600":"text-gray-500 hover:text-gray-700"}`,children:[_.jsx(Sc,{className:"w-4 h-4"})," ",_.jsx("span",{className:"hidden sm:inline",children:"Phn 2"})]})]})]}),_.jsxs("div",{className:"flex-1 p-6 max-w-7xl mx-auto w-full",children:[d==="system"&&_.jsx($e,{}),d==="p1"&&_.jsx(H,{}),d==="p2"&&_.jsx(At,{})]})]})},qE=({isOpen:t,title:e,message:r,type:n="confirm",onConfirm:i,onCancel:l,confirmText:o="ng ",cancelText:u="Hy b"})=>t?_.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:_.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full overflow-hidden transform transition-all scale-100",children:[_.jsxs("div",{className:`p-4 flex items-center gap-3 border-b ${n==="danger"?"bg-red-50 border-red-100":"bg-gray-50 border-gray-100"}`,children:[n==="danger"?_.jsx("div",{className:"p-2 bg-red-100 rounded-full text-red-600",children:_.jsx(lu,{className:"w-5 h-5"})}):_.jsx("div",{className:"p-2 bg-blue-100 rounded-full text-blue-600",children:_.jsx(dz,{className:"w-5 h-5"})}),_.jsx("h3",{className:`font-bold text-lg ${n==="danger"?"text-red-800":"text-gray-800"}`,children:e})]}),_.jsx("div",{className:"p-5 text-gray-600 text-sm leading-relaxed whitespace-pre-wrap",children:r}),_.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-100 flex justify-end gap-3",children:[n!=="alert"&&_.jsx(Qr,{variant:"outline",onClick:l,className:"w-full sm:w-auto",children:u}),_.jsx(Qr,{variant:n==="danger"?"danger":"primary",onClick:i,className:"w-full sm:w-auto shadow-md",children:o})]})]})}):null,oV=({onLogout:t})=>{const[e,r]=it.useState(Wr()),[n,i]=it.useState(null),[l,o]=it.useState(""),[u,h]=it.useState(""),[d,p]=it.useState(!0),[x,v]=it.useState(!1),[y,E]=it.useState("login"),[w,S]=it.useState(null),[N,I]=it.useState(!1),[C,z]=it.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[X,W]=it.useState({}),[R,Q]=it.useState([]),[G,fe]=it.useState(""),[re,K]=it.useState("ALL"),[ye,Ie]=it.useState(!1),[Ce,Y]=it.useState("grid"),[ue,Me]=it.useState({}),[Z,Le]=it.useState("ALL"),[U,k]=it.useState(!1),[P,M]=it.useState(!1);it.useEffect(()=>{const Oe=()=>{const tt=Wr();r(tt);const Ze=tt.voters.length>0;v(Ze),Ze&&p(!1)};Oe();const Ve=()=>{if(Oe(),p(!1),n){const Ze=Wr().voters.find(qe=>qe.cccd===n.cccd);Ze&&i(Ze)}};window.addEventListener("storage",Ve),window.addEventListener("db_update",Ve);const Qe=setTimeout(()=>p(!1),3e3);return()=>{window.removeEventListener("storage",Ve),window.removeEventListener("db_update",Ve),clearTimeout(Qe)}},[n]);const j=(Oe,Ve="success")=>{S({msg:Oe,type:Ve}),setTimeout(()=>S(null),4e3)},ee=()=>z(Oe=>({...Oe,isOpen:!1})),xe=()=>{i(null),W({}),Q([]),E("login"),t(),window.scrollTo(0,0)},Te=Oe=>{if(Oe.preventDefault(),h(""),!x){h("H thng cha c d liu. Vui lng lin h Admin.");return}const Ve=l.trim();if(!Ve)return;const Qe=e.voters.find(gt=>String(gt.cccd).trim()===Ve||String(gt.mssv).trim().toLowerCase()===Ve.toLowerCase());if(!Qe){h("Khng tm thy thng tin ng vin.");return}i(Qe);const tt=e.votesP1.filter(gt=>gt.voterCCCD===Qe.cccd),Ze={};tt.forEach(gt=>Ze[gt.candidateCCCD]=gt.level),W(Ze);const qe=e.votesP2.filter(gt=>gt.voterCCCD===Qe.cccd);Q(qe.map(gt=>gt.candidateCCCD));const{isPhase1Open:Ct,isPhase2Open:Dr}=e.config;if(Qe.hasVotedPhase1&&Qe.hasVotedPhase2)E("done");else if(Ct&&!Qe.hasVotedPhase1)E("p1");else if(Dr&&!Qe.hasVotedPhase2)E("p2");else if(Qe.hasVotedPhase1&&!Dr)E("done");else if(!Ct&&Qe.hasVotedPhase2)E("done");else if(!Ct&&!Dr){h("H thng ang ng.");return}else E("done")},me=async Oe=>{if(n){ee(),I(!0);try{await new Promise(tt=>setTimeout(tt,500));const Ve=Object.entries(Oe).map(([tt,Ze])=>({candidateCCCD:tt,level:Ze}));await UR(n.cccd,Ve)?(j(" gi nh gi P1 thnh cng!","success"),setTimeout(()=>{Wr().config.isPhase2Open?E("p2"):E("done"),window.scrollTo(0,0)},800)):j("Li lu d liu. B nh c th  y.","error")}catch(Ve){console.error(Ve),j("Li h thng.","error")}finally{I(!1)}}},we=()=>{const Oe=be.filter(Ve=>!X[Ve.cccd]);Oe.length>0?z({isOpen:!0,title:"Xc nhn t ng in",message:_.jsxs("span",{children:["Bn cn ",_.jsx("b",{className:"text-red-600",children:Oe.length})," ngi cha nh gi.",_.jsx("br",{}),_.jsx("br",{}),"H thng s t ng in mc ",_.jsx("b",{className:"text-blue-600",children:'"HON THNH"'})," cho nhng ngi ny v np phiu ngay."]}),confirmText:"ng  & Gi ngay",onConfirm:()=>{let Ve={...X};Oe.forEach(Qe=>Ve[Qe.cccd]=Sn.HOAN_THANH),me(Ve)}}):z({isOpen:!0,title:"Xc nhn gi",message:"Bn  nh gi y . Bn c chc chn mun gi kt qu khng?",confirmText:"Gi kt qu",onConfirm:()=>me(X)})},$e=async()=>{if(n){ee(),I(!0);try{await new Promise(Ve=>setTimeout(Ve,500)),await jR(n.cccd,R)?(j(" gi phiu bu xut sc!","success"),setTimeout(()=>{E("done"),window.scrollTo(0,0)},800)):j("Li lu d liu.","error")}catch(Oe){console.error(Oe),j("Li h thng.","error")}finally{I(!1)}}},H=()=>{R.length===0?z({isOpen:!0,title:"Np phiu trng?",message:"Bn cha chn ng ch no. Bn c chc chn mun np phiu trng khng?",type:"danger",confirmText:"Np phiu trng",onConfirm:()=>$e()}):z({isOpen:!0,title:"Xc nhn bu c",message:`Bn  chn ${R.length} ng ch xut sc. Xc nhn np phiu?`,confirmText:"Np phiu",onConfirm:()=>$e()})},At=()=>{const Ve=Object.values(bt).flat().filter(Qe=>!X[Qe.cccd]);if(Ve.length===0){j("Danh sch ang hin th  c nh gi ht.","error");return}z({isOpen:!0,title:"in nhanh",message:`in mc "Hon thnh" cho ${Ve.length} ngi ang hin th?`,confirmText:"in ngay",onConfirm:()=>{const Qe={...X};Ve.forEach(tt=>Qe[tt.cccd]=Sn.HOAN_THANH),W(Qe),ee(),j(" in xong!")}})},at=async()=>{z({isOpen:!0,title:"Reset d liu?",message:"Hnh ng ny s xa ton b d liu trn trnh duyt ny. Bn c chc khng?",type:"danger",confirmText:"XA SCH",onConfirm:async()=>{await rb(),ee()}})},be=e.candidatesP1||[],de=e.config.p1Display,te=e.config.p2Display,Pe=it.useMemo(()=>Array.from(new Set(be.map(Oe=>Oe.khoa||"Khc"))).sort(),[be]),Ge=it.useMemo(()=>Array.from(new Set((e.candidatesP2||[]).map(Oe=>Oe.chiBoDeXuat||"Khc"))).sort(),[e.candidatesP2]),bt=it.useMemo(()=>{const Oe=be.filter(Qe=>{const tt=(Qe.hoTen||"").toLowerCase().includes(G.toLowerCase())||(Qe.mssv||"").toLowerCase().includes(G.toLowerCase()),Ze=re==="ALL"||(Qe.khoa||"Khc")===re,qe=ye?!X[Qe.cccd]:!0;return tt&&Ze&&qe}),Ve={};return Oe.forEach(Qe=>{const tt=Qe.khoa||"Khc";Ve[tt]||(Ve[tt]=[]),Ve[tt].push(Qe)}),Ve},[be,G,re,ye,X]),vr=it.useMemo(()=>(e.candidatesP2||[]).filter(Oe=>{const Ve=(Oe.hoTen||"").toLowerCase().includes(G.toLowerCase()),Qe=Z==="ALL"||(Oe.chiBoDeXuat||"Khc")===Z;let tt=!0;return U&&(tt=R.includes(Oe.cccd)),P&&(tt=!R.includes(Oe.cccd)),Ve&&Qe&&tt}),[e.candidatesP2,G,Z,U,P,R]),cn=()=>w?_.jsxs("div",{className:`fixed top-20 left-1/2 -translate-x-1/2 z-[100] px-6 py-4 rounded-lg shadow-2xl flex items-center gap-3 animate-bounce border-2 ${w.type==="success"?"bg-emerald-600 border-emerald-500 text-white":"bg-red-600 border-red-500 text-white"}`,children:[w.type==="success"?_.jsx(Xs,{className:"w-6 h-6"}):_.jsx(lu,{className:"w-6 h-6"}),_.jsx("span",{className:"font-bold text-lg",children:w.msg})]}):null,Yr=({current:Oe,total:Ve})=>{const Qe=Math.min(100,Math.round(Oe/(Ve||1)*100));return _.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-[40] shadow-sm px-4 py-3",children:_.jsxs("div",{className:"max-w-4xl mx-auto",children:[_.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-500 uppercase tracking-wide mb-1",children:[_.jsx("span",{children:"Tin  nh gi"}),_.jsxs("span",{className:Qe===100?"text-green-600":"text-[#BE1E2D]",children:[Oe,"/",Ve," (",Qe,"%)"]})]}),_.jsx("div",{className:"h-2.5 w-full bg-gray-100 rounded-full overflow-hidden",children:_.jsx("div",{className:"h-full bg-gradient-to-r from-[#BE1E2D] to-red-400 transition-all duration-500 ease-out",style:{width:`${Qe}%`}})})]})})};if(y==="login")return _.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-[#fffef5] p-4 relative overflow-hidden",children:[_.jsx(qE,{...C,onCancel:ee}),_.jsx("div",{className:"absolute -top-[30%] -right-[10%] w-[70%] h-[70%] bg-[#BE1E2D] rounded-full blur-3xl opacity-5 pointer-events-none"}),_.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl border border-gray-100 p-8 relative z-10",children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-red-100",children:_.jsx(WE,{className:"w-8 h-8 text-[#BE1E2D]"})}),_.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"ng nhp h thng"}),_.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Nhp CCCD hoc M nh danh"})]}),d?_.jsxs("div",{className:"mb-6 flex flex-col items-center justify-center p-6 bg-gray-50 rounded-xl border border-gray-100 animate-pulse",children:[_.jsx(Vm,{className:"w-8 h-8 text-[#BE1E2D] animate-spin mb-2"}),_.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"ang kt ni d liu Cloud..."})]}):x?_.jsxs("div",{className:"mb-6 p-2 bg-green-50 text-green-700 text-xs rounded-lg border border-green-100 flex items-center justify-center gap-1",children:[_.jsx(pz,{className:"w-3 h-3"})," H thng Online"]}):_.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 text-yellow-800 rounded-xl text-sm border border-yellow-200 flex flex-col gap-2",children:[_.jsxs("div",{className:"flex items-center gap-2 font-bold",children:[_.jsx(lu,{className:"w-5 h-5"})," H thng cha c d liu"]}),_.jsxs("p",{children:["Vui lng lin h Ban T Chc hoc vo trang ",_.jsx("b",{children:"Qun Tr Vin"}),"  nhp danh sch."]}),_.jsx("p",{className:"text-xs text-yellow-600 border-t border-yellow-200 pt-2 mt-1",children:"*Nu bn l Admin v  nhp liu: Hy kim tra quyn truy cp (Rules) hoc m bo d liu  c y ln Cloud thnh cng."})]}),_.jsxs("form",{onSubmit:Te,className:"space-y-4",children:[_.jsx("div",{children:_.jsx("input",{type:"text",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#BE1E2D] focus:border-[#BE1E2D] outline-none text-center text-lg font-medium",placeholder:"Nhp m s...",value:l,onChange:Oe=>o(Oe.target.value),disabled:!x||d,autoFocus:!0})}),u&&_.jsxs("div",{className:"bg-red-50 text-red-600 text-sm p-3 rounded-lg flex items-center gap-2",children:[_.jsx(lu,{className:"w-4 h-4 flex-shrink-0"})," ",u]}),_.jsx(Qr,{disabled:!x||d,className:"w-full py-3 text-base bg-[#BE1E2D] hover:bg-[#991B1B] text-white",children:"Xc thc & Bt u"})]}),_.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 flex flex-col gap-2",children:[_.jsx("button",{onClick:xe,className:"text-sm text-gray-500 hover:text-gray-800",children:"Quay li trang ch"}),_.jsxs("button",{onClick:at,className:"text-xs text-red-400 hover:text-red-600 flex items-center justify-center gap-1 mt-2",children:[_.jsx(Pz,{className:"w-3 h-3"})," Reset khn cp d liu"]})]})]})]});if(y==="done")return _.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#fffef5] p-6 text-center relative z-50",children:[_.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mb-6 animate-in zoom-in duration-500",children:_.jsx(ME,{className:"w-12 h-12 text-green-600"})}),_.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Hon thnh nhim v!"}),_.jsxs("p",{className:"text-gray-600 max-w-md mb-8",children:["Cm n ng ch ",_.jsx("strong",{children:n==null?void 0:n.hoTen}),"  hon thnh cc ni dung b phiu."]}),_.jsx(Qr,{onClick:xe,className:"w-full max-w-xs bg-[#BE1E2D] hover:bg-[#991B1B] text-white py-3 shadow-lg",children:"ng xut / V trang ch"})]});const Ot=y==="p2"?"bg-gradient-to-r from-yellow-500 to-yellow-600 border-b border-yellow-600":"bg-[#BE1E2D] border-b border-[#991B1B]";return _.jsxs("div",{className:"min-h-screen bg-[#fffef5] pb-24 font-sans",children:[_.jsx(cn,{}),_.jsx(qE,{...C,onCancel:ee}),_.jsx("div",{className:`${Ot} text-white px-4 py-3 shadow-md sticky top-0 z-[50] transition-colors duration-500`,children:_.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-9 h-9 bg-white/10 backdrop-blur-sm rounded-full flex items-center justify-center border border-white/20 font-bold text-sm",children:n==null?void 0:n.hoTen.charAt(0)}),_.jsxs("div",{children:[_.jsx("div",{className:"font-bold text-sm md:text-base leading-tight flex items-center gap-2",children:y==="p1"?"NH GI CHT LNG":_.jsxs(_.Fragment,{children:[_.jsx(Sc,{className:"w-4 h-4 fill-white"})," BU XUT SC"]})}),_.jsx("div",{className:"text-xs text-white/80 opacity-90",children:n==null?void 0:n.hoTen})]})]}),_.jsxs("button",{onClick:xe,className:"text-xs bg-black/20 hover:bg-black/30 px-3 py-1.5 rounded-lg transition-colors flex items-center gap-1",children:[_.jsx(Iz,{className:"w-3 h-3"})," ",_.jsx("span",{className:"hidden sm:inline",children:"Thot"})]})]})}),y==="p1"&&_.jsx(Yr,{current:Object.keys(X).length,total:be.length}),_.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-3 sticky top-[57px] z-[30] shadow-sm",children:_.jsxs("div",{className:"max-w-4xl mx-auto space-y-3",children:[_.jsxs("div",{className:"flex gap-2",children:[_.jsxs("div",{className:"relative flex-1",children:[_.jsx(cu,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),_.jsx("input",{className:"w-full pl-9 pr-3 py-2 rounded-lg border border-gray-300 text-sm focus:ring-1 focus:ring-[#BE1E2D] outline-none",placeholder:"Tm tn, MSSV...",value:G,onChange:Oe=>fe(Oe.target.value)})]}),y==="p1"&&_.jsxs("button",{onClick:()=>Ie(!ye),className:`px-3 py-2 rounded-lg border text-sm font-medium whitespace-nowrap transition-colors flex items-center gap-1.5 ${ye?"bg-orange-50 border-orange-200 text-orange-700":"bg-gray-50 border-gray-300 text-gray-600"}`,children:[ye?_.jsx(PE,{className:"w-4 h-4"}):_.jsx(Xs,{className:"w-4 h-4"}),_.jsx("span",{className:"hidden sm:inline",children:"n  vote"})]}),y==="p2"&&_.jsxs(_.Fragment,{children:[_.jsxs("button",{onClick:()=>{U||M(!1),k(!U)},className:`px-3 py-2 rounded-lg border text-sm font-medium whitespace-nowrap transition-colors flex items-center gap-1.5 ${U?"bg-yellow-100 border-yellow-300 text-yellow-800":"bg-gray-50 border-gray-300 text-gray-600"}`,children:[_.jsx(Xz,{className:"w-4 h-4"}),_.jsxs("span",{className:"hidden sm:inline",children:[" chn (",R.length,")"]})]}),_.jsxs("button",{onClick:()=>{P||k(!1),M(!P)},className:`px-3 py-2 rounded-lg border text-sm font-medium whitespace-nowrap transition-colors flex items-center gap-1.5 ${P?"bg-orange-50 border-orange-200 text-orange-700":"bg-gray-50 border-gray-300 text-gray-600"}`,children:[P?_.jsx(PE,{className:"w-4 h-4"}):_.jsx(Xs,{className:"w-4 h-4"}),_.jsx("span",{className:"hidden sm:inline",children:"n  chn"})]})]})]}),_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar",children:[_.jsx(xC,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),y==="p1"&&_.jsxs(_.Fragment,{children:[_.jsx("button",{onClick:()=>K("ALL"),className:`whitespace-nowrap px-3 py-1 rounded-full text-xs font-medium border transition-colors ${re==="ALL"?"bg-[#BE1E2D] text-white border-[#BE1E2D]":"bg-white text-gray-600 border-gray-300"}`,children:"Tt c Kha"}),Pe.map(Oe=>_.jsx("button",{onClick:()=>K(Oe),className:`whitespace-nowrap px-3 py-1 rounded-full text-xs font-medium border transition-colors ${re===Oe?"bg-[#BE1E2D] text-white border-[#BE1E2D]":"bg-white text-gray-600 border-gray-300"}`,children:Oe},Oe))]}),y==="p2"&&_.jsxs(_.Fragment,{children:[_.jsx("button",{onClick:()=>Le("ALL"),className:`whitespace-nowrap px-3 py-1 rounded-full text-xs font-medium border transition-colors flex items-center gap-1 ${Z==="ALL"?"bg-yellow-600 text-white border-yellow-600":"bg-white text-gray-600 border-gray-300"}`,children:"Tt c  xut"}),Ge.map(Oe=>_.jsxs("button",{onClick:()=>Le(Oe),className:`whitespace-nowrap px-3 py-1 rounded-full text-xs font-medium border transition-colors flex items-center gap-1 ${Z===Oe?"bg-yellow-600 text-white border-yellow-600":"bg-white text-gray-600 border-gray-300"}`,children:[_.jsx(Kz,{className:"w-3 h-3"})," ",Oe]},Oe))]})]}),y==="p1"&&_.jsx("div",{className:"flex items-center gap-2 border-l pl-3 ml-2 border-gray-300",children:_.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-0.5",children:[_.jsx("button",{onClick:()=>Y("list"),className:`p-1.5 rounded-md ${Ce==="list"?"bg-white shadow-sm text-gray-800":"text-gray-400"}`,children:_.jsx(vC,{className:"w-4 h-4"})}),_.jsx("button",{onClick:()=>Y("grid"),className:`p-1.5 rounded-md ${Ce==="grid"?"bg-white shadow-sm text-gray-800":"text-gray-400"}`,children:_.jsx(Ap,{className:"w-4 h-4"})})]})})]})]})}),_.jsx("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:y==="p1"?_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"flex justify-end mb-2",children:_.jsxs("button",{onClick:At,className:"text-sm font-semibold text-blue-600 flex items-center gap-1 hover:bg-blue-50 px-3 py-1.5 rounded-lg transition-colors",children:[_.jsx(lV,{className:"w-4 h-4"}),' in nhanh "Hon thnh"']})}),Object.entries(bt).map(([Oe,Ve])=>{if(Ve.length===0)return null;const Qe=ue[Oe],tt=Ve.filter(Ze=>X[Ze.cccd]).length;return _.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[_.jsxs("div",{onClick:()=>Me(Ze=>({...Ze,[Oe]:!Ze[Oe]})),className:"bg-gray-50 px-4 py-3 flex justify-between items-center cursor-pointer hover:bg-gray-100 transition-colors border-b border-gray-100",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("h3",{className:"font-bold text-gray-800",children:Oe}),_.jsx("span",{className:"text-xs bg-white border border-gray-200 px-2 py-0.5 rounded text-gray-500",children:Ve.length})]}),_.jsxs("div",{className:"flex items-center gap-3 text-xs font-medium",children:[_.jsxs("span",{className:tt===Ve.length?"text-green-600":"text-orange-600",children:[tt,"/",Ve.length]}),Qe?_.jsx(iz,{className:"w-4 h-4 text-gray-400"}):_.jsx(cz,{className:"w-4 h-4 text-gray-400"})]})]}),!Qe&&_.jsx("div",{className:`p-4 ${Ce==="grid"?"grid grid-cols-1 md:grid-cols-2 gap-4":"space-y-4"}`,children:Ve.map(Ze=>{const qe=X[Ze.cccd];return _.jsxs("div",{className:`bg-white border rounded-lg p-4 transition-all ${qe?"border-l-4 border-l-green-500 shadow-sm":"border-gray-200 border-l-4 border-l-gray-300"}`,children:[_.jsxs("div",{className:"mb-4",children:[_.jsx("div",{className:"font-bold text-gray-800 text-lg mb-1",children:Ze.hoTen}),_.jsxs("div",{className:"flex flex-wrap gap-x-3 gap-y-1.5 text-xs text-gray-500 mb-2",children:[de.showCCCD&&_.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[_.jsx(Az,{className:"w-3 h-3"})," ",Ze.cccd]}),de.showMSSV&&_.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[_.jsx(ez,{className:"w-3 h-3"})," ",Ze.mssv]}),de.showChucVu&&_.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[_.jsx(WE,{className:"w-3 h-3"})," ",Ze.chucVu]}),de.showKhoa&&_.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[_.jsx(bz,{className:"w-3 h-3"})," ",Ze.khoa]}),de.showNgayVaoDang&&_.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[_.jsx(rz,{className:"w-3 h-3"})," ",Ze.ngayVaoDang]}),de.showLoaiDangVien&&_.jsxs("span",{className:"flex items-center gap-1 bg-gray-50 px-1.5 py-0.5 rounded",children:[_.jsx(ou,{className:"w-3 h-3"})," ",Ze.loaiDangVien]})]}),_.jsxs("div",{className:"space-y-1.5",children:[(de.showDiemHT||de.showDiemRL)&&_.jsxs("div",{className:"flex items-center gap-3 text-xs bg-gray-50 p-2 rounded border border-gray-100",children:[de.showDiemHT&&_.jsxs("div",{children:["HT: ",_.jsx("b",{className:"text-gray-800",children:Ze.diemHT})]}),de.showDiemHT&&de.showDiemRL&&_.jsx("div",{className:"w-px h-3 bg-gray-300"}),de.showDiemRL&&_.jsxs("div",{children:["RL: ",_.jsx("b",{className:"text-gray-800",children:Ze.diemRL})]})]}),de.showThanhTich&&Ze.thanhTich&&_.jsxs("div",{className:"text-xs text-amber-700 bg-amber-50 p-2 rounded border border-amber-100 flex items-start gap-1.5",children:[_.jsx(IE,{className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5"}),_.jsx("span",{children:Ze.thanhTich})]}),de.showTuDanhGia&&Ze.tuDanhGia&&_.jsxs("div",{className:"text-xs text-blue-700 bg-blue-50 p-2 rounded border border-blue-100 flex items-start gap-1.5",children:[_.jsx(Sc,{className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5"}),_.jsxs("span",{children:["T nh gi: ",_.jsx("b",{children:Ze.tuDanhGia})]})]})]})]}),_.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[_.jsx("button",{onClick:()=>W(Ct=>({...Ct,[Ze.cccd]:Sn.KHONG_HOAN_THANH})),className:`py-2 rounded text-xs font-semibold transition-all ${qe===Sn.KHONG_HOAN_THANH?"bg-red-600 text-white shadow-md ring-2 ring-red-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:"K.H.Thnh"}),_.jsx("button",{onClick:()=>W(Ct=>({...Ct,[Ze.cccd]:Sn.HOAN_THANH})),className:`py-2 rounded text-xs font-semibold transition-all ${qe===Sn.HOAN_THANH?"bg-blue-600 text-white shadow-md ring-2 ring-blue-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:"Hon thnh"}),_.jsx("button",{onClick:()=>W(Ct=>({...Ct,[Ze.cccd]:Sn.HOAN_THANH_TOT})),className:`py-2 rounded text-xs font-semibold transition-all ${qe===Sn.HOAN_THANH_TOT?"bg-green-600 text-white shadow-md ring-2 ring-green-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:"Tt"})]})]},Ze.cccd)})})]},Oe)})]}):_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 text-red-900 p-6 rounded-xl shadow-lg mb-6 flex justify-between items-center relative overflow-hidden border border-yellow-400",children:[_.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-10 -mt-10 blur-xl"}),_.jsxs("div",{className:"relative z-10",children:[_.jsx("div",{className:"text-xs opacity-90 uppercase tracking-wider font-bold text-red-800 mb-1",children:"S lng bnh bu"}),_.jsxs("div",{className:"text-3xl font-black",children:[R.length," / ",e.config.maxExcellentVotes," ",_.jsx("span",{className:"text-sm font-normal align-middle opacity-75",children:"ng ch"})]})]}),_.jsx("div",{className:"relative z-10 bg-white/20 p-3 rounded-full",children:_.jsx(Sc,{className:"w-8 h-8 text-red-800 fill-red-800 animate-pulse"})})]}),vr.length===0&&_.jsxs("div",{className:"text-center py-10 text-gray-500 bg-white rounded-xl border border-dashed border-gray-300",children:[_.jsx(cu,{className:"w-10 h-10 mx-auto mb-2 opacity-20"}),_.jsx("p",{children:"Khng tm thy ng vin ph hp vi b lc."})]}),_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:vr.map(Oe=>{const Ve=R.includes(Oe.cccd);return _.jsxs("div",{onClick:()=>{Ve?Q(Qe=>Qe.filter(tt=>tt!==Oe.cccd)):R.length>=e.config.maxExcellentVotes?j(`Ch c chn ti a ${e.config.maxExcellentVotes} ngi`,"error"):Q(Qe=>[...Qe,Oe.cccd])},className:`relative bg-white rounded-xl p-5 border-2 transition-all cursor-pointer group hover:shadow-lg ${Ve?"border-yellow-500 bg-yellow-50/50 shadow-md ring-1 ring-yellow-500/30":"border-gray-200 hover:border-yellow-300"}`,children:[te.showChiBoDeXuat&&Oe.chiBoDeXuat&&_.jsxs("div",{className:"absolute -top-3 left-4 bg-[#BE1E2D] text-white text-[10px] font-bold px-3 py-1 rounded-full shadow-sm border border-yellow-500 z-10 flex items-center gap-1",children:[_.jsx(Qz,{className:"w-3 h-3"}),"  xut: ",Oe.chiBoDeXuat]}),_.jsxs("div",{className:"flex justify-between items-start mt-2",children:[_.jsxs("div",{className:"flex-1 pr-2",children:[_.jsx("div",{className:`font-bold text-lg mb-0.5 ${Ve?"text-[#BE1E2D]":"text-gray-800"}`,children:Oe.hoTen}),_.jsxs("div",{className:"text-xs text-gray-500 font-medium flex flex-col gap-1",children:[te.showKhoa&&_.jsx("span",{children:Oe.khoa}),_.jsxs("div",{className:"flex flex-wrap gap-x-2 gap-y-1 text-gray-400 font-normal",children:[te.showMSSV&&Oe.mssv&&_.jsx("span",{children:Oe.mssv}),te.showChucVu&&Oe.chucVu&&_.jsxs("span",{children:[" ",Oe.chucVu]}),te.showCCCD&&_.jsxs("span",{children:[" ID: ",Oe.cccd]}),te.showNhom&&_.jsxs("span",{children:[" ",Oe.nhom]}),te.showLoaiDangVien&&_.jsxs("span",{children:[" ",Oe.loaiDangVien]})]})]}),(te.showDiemHT||te.showDiemRL)&&_.jsxs("div",{className:"flex flex-wrap gap-1 mt-3",children:[te.showDiemHT&&_.jsxs("span",{className:"text-[10px] bg-gray-100 text-gray-600 px-2 py-0.5 rounded border border-gray-200",children:["HT: ",Oe.diemHT]}),te.showDiemRL&&_.jsxs("span",{className:"text-[10px] bg-gray-100 text-gray-600 px-2 py-0.5 rounded border border-gray-200",children:["RL: ",Oe.diemRL]})]}),te.showThanhTich&&Oe.thanhTich&&_.jsxs("div",{className:"mt-2 text-[10px] text-amber-700 bg-amber-50 p-1.5 rounded border border-amber-100 flex items-start gap-1",children:[_.jsx(IE,{className:"w-3 h-3 flex-shrink-0"}),_.jsx("span",{className:"line-clamp-2",children:Oe.thanhTich})]})]}),_.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 shadow-sm ${Ve?"bg-yellow-500 text-white scale-110":"bg-gray-100 text-gray-300 group-hover:bg-yellow-100 group-hover:text-yellow-400"}`,children:_.jsx(ME,{className:"w-5 h-5",strokeWidth:3})})]})]},Oe.cccd)})})]})}),_.jsx("div",{className:"fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 p-4 z-[50] shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)]",children:_.jsx("div",{className:"max-w-4xl mx-auto flex items-center justify-between gap-4",children:y==="p1"?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"text-xs text-gray-500 font-medium hidden sm:block",children:["Hon thnh: ",_.jsx("b",{className:"text-gray-900",children:Object.keys(X).length})," / ",be.length]}),_.jsxs(Qr,{onClick:we,disabled:N,className:"w-full sm:w-auto bg-[#BE1E2D] hover:bg-[#991B1B] text-white shadow-lg shadow-red-900/20 px-8 py-3 text-base flex items-center justify-center gap-2",children:[N&&_.jsx(Vm,{className:"w-4 h-4 animate-spin"}),N?"ang gi...":"Gi kt qu"]})]}):_.jsxs(_.Fragment,{children:[_.jsx(Qr,{variant:"outline",onClick:()=>Q([]),disabled:N,className:"border-gray-300 text-gray-500 hover:text-red-600 hover:border-red-200",children:"Xa chn"}),_.jsxs(Qr,{onClick:H,disabled:N,className:"flex-1 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white shadow-lg shadow-yellow-900/20 py-3 text-base flex items-center justify-center gap-2 font-bold border border-yellow-400",children:[N&&_.jsx(Vm,{className:"w-4 h-4 animate-spin"}),N?"ang gi...":"Hon thnh bu c"]})]})})})]})},uV=()=>{const[t,e]=it.useState("home");return t==="admin"?_.jsx(cV,{onBack:()=>e("home")}):t==="voter"?_.jsx(oV,{onLogout:()=>e("home")}):_.jsxs("div",{className:"min-h-screen flex flex-col relative bg-[#fffef5] font-sans selection:bg-red-100 overflow-x-hidden",children:[_.jsx("div",{className:"absolute top-0 left-0 w-[500px] h-[500px] bg-[#BE1E2D] rounded-full blur-3xl opacity-5 -translate-x-1/2 -translate-y-1/2 pointer-events-none"}),_.jsx("div",{className:"absolute top-0 right-0 w-[400px] h-[400px] bg-[#FFD700] rounded-full blur-3xl opacity-5 translate-x-1/3 -translate-y-1/3 pointer-events-none"}),_.jsxs("div",{className:"relative w-full h-2 bg-[#BE1E2D] shadow-sm flex",children:[_.jsx("div",{className:"h-full w-1/3 bg-[#BE1E2D]"}),_.jsx("div",{className:"h-full w-1/3 bg-[#FFD700]"}),_.jsx("div",{className:"h-full w-1/3 bg-[#BE1E2D]"})]}),_.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 sm:p-8 w-full max-w-7xl mx-auto z-10",children:[_.jsxs("div",{className:"text-center space-y-4 mb-10 md:mb-16 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[_.jsx("div",{className:"w-28 h-28 mx-auto mb-6 relative z-20 transition-transform hover:scale-105 duration-300 drop-shadow-md",children:_.jsx("img",{src:"https://drive.google.com/thumbnail?id=1O7UZhqrJoTc6xac8yB05_laRxhZsfhom&sz=w1000",alt:"Logo Chi B Sinh Vin",className:"w-full h-full object-contain"})}),_.jsxs("div",{className:"flex flex-col items-center gap-1",children:[_.jsx("h3",{className:"text-[#BE1E2D] font-bold uppercase tracking-wide text-sm md:text-base opacity-90",children:"ng b trng i hc Kinh T"}),_.jsx("h2",{className:"text-[#BE1E2D] font-black uppercase tracking-wider text-xl md:text-2xl lg:text-3xl mb-4 bg-white/50 backdrop-blur-sm px-4 py-1 rounded-lg border border-red-50/50 shadow-sm inline-block",children:"Chi b sinh vin"}),_.jsx("div",{className:"mt-4",children:_.jsxs("h1",{className:"text-3xl md:text-5xl lg:text-6xl font-black text-[#BE1E2D] leading-tight drop-shadow-sm uppercase",children:["H THNG NH GI, XP LOI ",_.jsx("br",{}),_.jsxs("span",{className:"text-[#D32F2F] relative inline-block mt-2",children:["NG VIN NM 2025",_.jsx("svg",{className:"absolute w-full h-3 -bottom-2 left-0 text-[#FFD700]/60 -z-10",viewBox:"0 0 100 10",preserveAspectRatio:"none",children:_.jsx("path",{d:"M0 5 Q 50 10 100 5",stroke:"currentColor",strokeWidth:"8",fill:"none"})})]})]})})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4 mt-8",children:[_.jsx("div",{className:"h-px w-8 md:w-16 bg-red-200"}),_.jsx("p",{className:"text-gray-600 font-medium text-sm md:text-base tracking-wide",children:"Minh bch - Khch quan - Chnh xc"}),_.jsx("div",{className:"h-px w-8 md:w-16 bg-red-200"})]})]}),_.jsxs("div",{className:"grid md:grid-cols-2 gap-6 md:gap-10 w-full max-w-4xl px-2 mb-12",children:[_.jsxs("div",{className:"group bg-white rounded-2xl shadow-xl border border-red-100 overflow-hidden hover:shadow-2xl hover:border-red-300 transition-all duration-300 hover:-translate-y-1 flex flex-col relative",children:[_.jsx("div",{className:"absolute top-0 left-0 w-full h-1.5 bg-[#BE1E2D]"}),_.jsxs("div",{className:"bg-gradient-to-b from-red-50 to-white p-6 flex justify-center items-center relative overflow-hidden h-40 md:h-48",children:[_.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),_.jsx("div",{className:"relative z-10 w-28 h-28 md:w-32 md:h-32 bg-white rounded-full flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform duration-500 border-4 border-red-50",children:_.jsx(ou,{className:"w-14 h-14 md:w-16 md:h-16 text-[#BE1E2D]"})})]}),_.jsxs("div",{className:"p-6 md:p-8 flex-1 flex flex-col text-center relative z-10",children:[_.jsx("h3",{className:"text-2xl font-bold text-[#BE1E2D] mb-2 uppercase",children:"ng Vin"}),_.jsx("p",{className:"text-gray-500 text-sm mb-6 flex-1 leading-relaxed",children:"Truy cp  thc hin nh gi xp loi v bnh bu danh hiu xut sc."}),_.jsxs("button",{onClick:()=>e("voter"),className:"w-full py-3.5 rounded-xl bg-[#BE1E2D] text-white font-bold hover:bg-[#991B1B] transition-all shadow-lg shadow-red-900/20 flex items-center justify-center gap-2 group-hover:gap-3 hover:shadow-red-900/30",children:["ng nhp ngay ",_.jsx(LE,{className:"w-4 h-4"})]})]})]}),_.jsxs("div",{className:"group bg-white rounded-2xl shadow-xl border border-yellow-100 overflow-hidden hover:shadow-2xl hover:border-yellow-300 transition-all duration-300 hover:-translate-y-1 flex flex-col relative",children:[_.jsx("div",{className:"absolute top-0 left-0 w-full h-1.5 bg-[#FFD700]"}),_.jsxs("div",{className:"bg-gradient-to-b from-yellow-50 to-white p-6 flex justify-center items-center relative overflow-hidden h-40 md:h-48",children:[_.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),_.jsx("div",{className:"relative z-10 w-28 h-28 md:w-32 md:h-32 bg-white rounded-full flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform duration-500 border-4 border-yellow-50",children:_.jsx(Gz,{className:"w-14 h-14 md:w-16 md:h-16 text-[#F59E0B]"})})]}),_.jsxs("div",{className:"p-6 md:p-8 flex-1 flex flex-col text-center relative z-10",children:[_.jsx("h3",{className:"text-2xl font-bold text-[#B45309] mb-2 uppercase",children:"Qun Tr Vin"}),_.jsx("p",{className:"text-gray-500 text-sm mb-6 flex-1 leading-relaxed",children:"Khu vc dnh cho cp y cu hnh h thng, nhp liu v xut bo co."}),_.jsxs("button",{onClick:()=>e("admin"),className:"w-full py-3.5 rounded-xl bg-[#FFD700] text-red-900 font-bold hover:bg-[#FCD34D] transition-all shadow-lg shadow-yellow-900/10 flex items-center justify-center gap-2 group-hover:gap-3 hover:shadow-yellow-900/20",children:["Truy cp h thng ",_.jsx(LE,{className:"w-4 h-4"})]})]})]})]})]}),_.jsx("div",{className:"relative z-10 bg-[#BE1E2D] text-white py-6 mt-auto",children:_.jsx("div",{className:"container mx-auto px-6 text-center relative z-10",children:_.jsx("p",{className:"text-xs md:text-sm font-medium opacity-90 tracking-wide",children:" 2025 Bn quyn thuc v Chi b Sinh vin"})})})]})},_C=document.getElementById("root");if(!_C)throw new Error("Could not find root element to mount to");const fV=Pk.createRoot(_C);fV.render(_.jsx(Rk.StrictMode,{children:_.jsx(uV,{})}));
